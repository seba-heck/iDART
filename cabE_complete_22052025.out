/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 26 = (8*3 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:05<09:15,  5.61s/it]  2%|▏         | 2/100 [00:06<04:55,  3.01s/it]  3%|▎         | 3/100 [00:08<03:59,  2.47s/it]  4%|▍         | 4/100 [00:09<03:09,  1.97s/it]  5%|▌         | 5/100 [00:11<02:41,  1.70s/it]  6%|▌         | 6/100 [00:12<02:19,  1.49s/it]  7%|▋         | 7/100 [00:13<02:06,  1.36s/it]  8%|▊         | 8/100 [00:14<01:59,  1.30s/it]  9%|▉         | 9/100 [00:15<01:54,  1.26s/it] 10%|█         | 10/100 [00:16<01:49,  1.22s/it] 11%|█         | 11/100 [00:18<01:51,  1.25s/it] 12%|█▏        | 12/100 [00:19<01:59,  1.36s/it] 13%|█▎        | 13/100 [00:20<01:55,  1.33s/it] 14%|█▍        | 14/100 [00:22<01:51,  1.29s/it] 15%|█▌        | 15/100 [00:23<01:52,  1.33s/it] 16%|█▌        | 16/100 [00:24<01:48,  1.29s/it] 17%|█▋        | 17/100 [00:25<01:43,  1.24s/it] 18%|█▊        | 18/100 [00:27<01:40,  1.23s/it] 19%|█▉        | 19/100 [00:28<01:37,  1.21s/it] 20%|██        | 20/100 [00:29<01:34,  1.19s/it] 21%|██        | 21/100 [00:30<01:33,  1.18s/it] 22%|██▏       | 22/100 [00:31<01:32,  1.18s/it] 23%|██▎       | 23/100 [00:32<01:29,  1.16s/it] 24%|██▍       | 24/100 [00:33<01:28,  1.16s/it] 25%|██▌       | 25/100 [00:35<01:30,  1.21s/it] 26%|██▌       | 26/100 [00:36<01:29,  1.21s/it] 27%|██▋       | 27/100 [00:37<01:32,  1.27s/it] 28%|██▊       | 28/100 [00:39<01:29,  1.24s/it] 29%|██▉       | 29/100 [00:40<01:27,  1.23s/it] 30%|███       | 30/100 [00:41<01:24,  1.20s/it] 31%|███       | 31/100 [00:42<01:23,  1.21s/it] 32%|███▏      | 32/100 [00:44<01:25,  1.26s/it] 33%|███▎      | 33/100 [00:45<01:23,  1.25s/it] 34%|███▍      | 34/100 [00:46<01:21,  1.24s/it] 35%|███▌      | 35/100 [00:47<01:21,  1.25s/it] 36%|███▌      | 36/100 [00:49<01:20,  1.26s/it] 37%|███▋      | 37/100 [00:50<01:19,  1.26s/it] 38%|███▊      | 38/100 [00:51<01:17,  1.24s/it] 39%|███▉      | 39/100 [00:52<01:15,  1.25s/it] 40%|████      | 40/100 [00:54<01:15,  1.25s/it] 41%|████      | 41/100 [00:55<01:13,  1.25s/it] 42%|████▏     | 42/100 [00:56<01:12,  1.25s/it] 43%|████▎     | 43/100 [00:57<01:11,  1.25s/it] 44%|████▍     | 44/100 [00:59<01:10,  1.26s/it] 45%|████▌     | 45/100 [01:00<01:08,  1.24s/it] 46%|████▌     | 46/100 [01:01<01:06,  1.24s/it] 47%|████▋     | 47/100 [01:02<01:05,  1.24s/it] 48%|████▊     | 48/100 [01:03<01:04,  1.25s/it] 49%|████▉     | 49/100 [01:05<01:03,  1.24s/it] 50%|█████     | 50/100 [01:06<01:01,  1.24s/it] 51%|█████     | 51/100 [01:07<01:00,  1.24s/it] 52%|█████▏    | 52/100 [01:08<01:00,  1.27s/it] 53%|█████▎    | 53/100 [01:10<00:59,  1.27s/it] 54%|█████▍    | 54/100 [01:11<00:58,  1.27s/it] 55%|█████▌    | 55/100 [01:12<00:56,  1.25s/it] 56%|█████▌    | 56/100 [01:13<00:54,  1.24s/it] 57%|█████▋    | 57/100 [01:15<00:53,  1.25s/it] 58%|█████▊    | 58/100 [01:16<00:52,  1.25s/it] 59%|█████▉    | 59/100 [01:17<00:50,  1.23s/it] 60%|██████    | 60/100 [01:18<00:49,  1.23s/it] 61%|██████    | 61/100 [01:20<00:47,  1.23s/it] 62%|██████▏   | 62/100 [01:21<00:47,  1.24s/it] 63%|██████▎   | 63/100 [01:22<00:46,  1.24s/it] 64%|██████▍   | 64/100 [01:23<00:44,  1.25s/it] 65%|██████▌   | 65/100 [01:25<00:43,  1.24s/it] 66%|██████▌   | 66/100 [01:26<00:43,  1.27s/it] 67%|██████▋   | 67/100 [01:27<00:41,  1.26s/it] 68%|██████▊   | 68/100 [01:29<00:40,  1.27s/it] 69%|██████▉   | 69/100 [01:30<00:39,  1.27s/it] 70%|███████   | 70/100 [01:31<00:37,  1.26s/it] 71%|███████   | 71/100 [01:32<00:36,  1.26s/it] 72%|███████▏  | 72/100 [01:33<00:34,  1.25s/it] 73%|███████▎  | 73/100 [01:35<00:33,  1.25s/it] 74%|███████▍  | 74/100 [01:36<00:32,  1.25s/it] 75%|███████▌  | 75/100 [01:37<00:30,  1.23s/it] 76%|███████▌  | 76/100 [01:38<00:29,  1.23s/it] 77%|███████▋  | 77/100 [01:40<00:28,  1.23s/it] 78%|███████▊  | 78/100 [01:41<00:26,  1.22s/it] 79%|███████▉  | 79/100 [01:42<00:25,  1.21s/it] 80%|████████  | 80/100 [01:43<00:24,  1.22s/it] 81%|████████  | 81/100 [01:44<00:23,  1.21s/it] 82%|████████▏ | 82/100 [01:46<00:21,  1.22s/it] 83%|████████▎ | 83/100 [01:47<00:21,  1.27s/it] 84%|████████▍ | 84/100 [01:48<00:20,  1.31s/it] 85%|████████▌ | 85/100 [01:50<00:19,  1.29s/it] 86%|████████▌ | 86/100 [01:51<00:18,  1.30s/it] 87%|████████▋ | 87/100 [01:52<00:16,  1.29s/it] 88%|████████▊ | 88/100 [01:54<00:15,  1.28s/it] 89%|████████▉ | 89/100 [01:55<00:13,  1.25s/it] 90%|█████████ | 90/100 [01:56<00:12,  1.25s/it] 91%|█████████ | 91/100 [01:57<00:11,  1.25s/it] 92%|█████████▏| 92/100 [01:58<00:09,  1.24s/it] 93%|█████████▎| 93/100 [02:00<00:08,  1.23s/it] 94%|█████████▍| 94/100 [02:01<00:07,  1.24s/it] 95%|█████████▌| 95/100 [02:02<00:06,  1.27s/it] 96%|█████████▌| 96/100 [02:04<00:05,  1.27s/it] 97%|█████████▋| 97/100 [02:05<00:03,  1.26s/it] 98%|█████████▊| 98/100 [02:06<00:02,  1.26s/it] 99%|█████████▉| 99/100 [02:07<00:01,  1.30s/it]100%|██████████| 100/100 [02:12<00:00,  2.36s/it]100%|██████████| 100/100 [02:12<00:00,  1.33s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-4.png]
[0/100] loss: 0.23598694801330566 loss_joints: 0.22967135906219482 loss_collision: 0.04633904621005058 loss_jerk: 0.015774041414260864 loss_floor_contact: 0.0010427087545394897
[1/100] loss: 0.22860363125801086 loss_joints: 0.22294902801513672 loss_collision: 0.04001207277178764 loss_jerk: 0.015548871830105782 loss_floor_contact: 0.0009851828217506409
[2/100] loss: 0.2181612253189087 loss_joints: 0.2121705412864685 loss_collision: 0.043089527636766434 loss_jerk: 0.01528580766171217 loss_floor_contact: 0.0015315674245357513
[3/100] loss: 0.20575807988643646 loss_joints: 0.19987663626670837 loss_collision: 0.04059683531522751 loss_jerk: 0.015798231586813927 loss_floor_contact: 0.00241929292678833
[4/100] loss: 0.19479095935821533 loss_joints: 0.18914029002189636 loss_collision: 0.037769660353660583 loss_jerk: 0.01641775853931904 loss_floor_contact: 0.002319253981113434
[5/100] loss: 0.1814970225095749 loss_joints: 0.17669861018657684 loss_collision: 0.02923087403178215 loss_jerk: 0.016217801719903946 loss_floor_contact: 0.0025353729724884033
[6/100] loss: 0.16871723532676697 loss_joints: 0.1647816151380539 loss_collision: 0.021573886275291443 loss_jerk: 0.016349751502275467 loss_floor_contact: 0.001432608813047409
[7/100] loss: 0.16101598739624023 loss_joints: 0.15672650933265686 loss_collision: 0.023778792470693588 loss_jerk: 0.01678873784840107 loss_floor_contact: 0.0023272037506103516
[8/100] loss: 0.15450263023376465 loss_joints: 0.1501084268093109 loss_collision: 0.02387528494000435 loss_jerk: 0.017444686964154243 loss_floor_contact: 0.002622201107442379
[9/100] loss: 0.14702436327934265 loss_joints: 0.14246729016304016 loss_collision: 0.023776277899742126 loss_jerk: 0.01818161830306053 loss_floor_contact: 0.003612726926803589
[10/100] loss: 0.1390712559223175 loss_joints: 0.13445541262626648 loss_collision: 0.022313307970762253 loss_jerk: 0.01878434792160988 loss_floor_contact: 0.005060773342847824
[11/100] loss: 0.1329280287027359 loss_joints: 0.12817734479904175 loss_collision: 0.02230670675635338 loss_jerk: 0.01932467892765999 loss_floor_contact: 0.005875434726476669
[12/100] loss: 0.12715430557727814 loss_joints: 0.12241708487272263 loss_collision: 0.02300693467259407 loss_jerk: 0.019764170050621033 loss_floor_contact: 0.004601046908646822
[13/100] loss: 0.1213485449552536 loss_joints: 0.11671914905309677 loss_collision: 0.021661587059497833 loss_jerk: 0.02013765275478363 loss_floor_contact: 0.004494711756706238
[14/100] loss: 0.11565174162387848 loss_joints: 0.1109967827796936 loss_collision: 0.02101041004061699 loss_jerk: 0.02045760676264763 loss_floor_contact: 0.005081562325358391
[15/100] loss: 0.1098056435585022 loss_joints: 0.10494592040777206 loss_collision: 0.02187279611825943 loss_jerk: 0.020777758210897446 loss_floor_contact: 0.005946684628725052
[16/100] loss: 0.10385717451572418 loss_joints: 0.09884902834892273 loss_collision: 0.02251768857240677 loss_jerk: 0.021050477400422096 loss_floor_contact: 0.006513291969895363
[17/100] loss: 0.09822776168584824 loss_joints: 0.09321418404579163 loss_collision: 0.021900858730077744 loss_jerk: 0.021237125620245934 loss_floor_contact: 0.006997790187597275
[18/100] loss: 0.09290803968906403 loss_joints: 0.0882403701543808 loss_collision: 0.019268322736024857 loss_jerk: 0.02134597674012184 loss_floor_contact: 0.006062358617782593
[19/100] loss: 0.08862505108118057 loss_joints: 0.08384403586387634 loss_collision: 0.01977403089404106 loss_jerk: 0.021399492397904396 loss_floor_contact: 0.006636591628193855
[20/100] loss: 0.0846504271030426 loss_joints: 0.0798475593328476 loss_collision: 0.019512411206960678 loss_jerk: 0.021415138617157936 loss_floor_contact: 0.007101146038621664
[21/100] loss: 0.08086200058460236 loss_joints: 0.07607648521661758 loss_collision: 0.0194813534617424 loss_jerk: 0.02140582911670208 loss_floor_contact: 0.006968019530177116
[22/100] loss: 0.07749006152153015 loss_joints: 0.07243572920560837 loss_collision: 0.022284556180238724 loss_jerk: 0.02137729711830616 loss_floor_contact: 0.006881500594317913
[23/100] loss: 0.07364416122436523 loss_joints: 0.06889618933200836 loss_collision: 0.01917477324604988 loss_jerk: 0.021333463490009308 loss_floor_contact: 0.00697152316570282
[24/100] loss: 0.070555679500103 loss_joints: 0.06546006351709366 loss_collision: 0.022624611854553223 loss_jerk: 0.02127714268863201 loss_floor_contact: 0.007054463028907776
[25/100] loss: 0.0669100359082222 loss_joints: 0.062139250338077545 loss_collision: 0.01902446150779724 loss_jerk: 0.021211110055446625 loss_floor_contact: 0.007472282741218805
[26/100] loss: 0.06407143920660019 loss_joints: 0.05894240736961365 loss_collision: 0.02184390276670456 loss_jerk: 0.021137544885277748 loss_floor_contact: 0.008308854885399342
[27/100] loss: 0.06065322458744049 loss_joints: 0.05585349351167679 loss_collision: 0.018954016268253326 loss_jerk: 0.021058423444628716 loss_floor_contact: 0.007984844967722893
[28/100] loss: 0.05791616439819336 loss_joints: 0.052860796451568604 loss_collision: 0.021096274256706238 loss_jerk: 0.022818105295300484 loss_floor_contact: 0.00663927523419261
[29/100] loss: 0.05542359501123428 loss_joints: 0.05001799017190933 loss_collision: 0.022662319242954254 loss_jerk: 0.024194713681936264 loss_floor_contact: 0.00719902478158474
[30/100] loss: 0.0527835488319397 loss_joints: 0.04733889922499657 loss_collision: 0.022290360182523727 loss_jerk: 0.025143366307020187 loss_floor_contact: 0.007012791465967894
[31/100] loss: 0.05028431490063667 loss_joints: 0.04481855779886246 loss_collision: 0.021912049502134323 loss_jerk: 0.025692544877529144 loss_floor_contact: 0.007052985951304436
[32/100] loss: 0.04802749678492546 loss_joints: 0.04245718941092491 loss_collision: 0.022449813783168793 loss_jerk: 0.025880008935928345 loss_floor_contact: 0.007373243570327759
[33/100] loss: 0.04590996727347374 loss_joints: 0.04029354453086853 loss_collision: 0.02287270873785019 loss_jerk: 0.025765860453248024 loss_floor_contact: 0.007525648456066847
[34/100] loss: 0.043809279799461365 loss_joints: 0.03832865133881569 loss_collision: 0.019735954701900482 loss_jerk: 0.025415988638997078 loss_floor_contact: 0.009654343128204346
[35/100] loss: 0.04235289990901947 loss_joints: 0.03645910322666168 loss_collision: 0.024006053805351257 loss_jerk: 0.024828404188156128 loss_floor_contact: 0.01010352186858654
[36/100] loss: 0.040514025837183 loss_joints: 0.03462522476911545 loss_collision: 0.024070538580417633 loss_jerk: 0.024020614102482796 loss_floor_contact: 0.010796874761581421
[37/100] loss: 0.038746677339076996 loss_joints: 0.03283286467194557 loss_collision: 0.02480369433760643 loss_jerk: 0.023078784346580505 loss_floor_contact: 0.01125568151473999
[38/100] loss: 0.03663590922951698 loss_joints: 0.031082650646567345 loss_collision: 0.021870043128728867 loss_jerk: 0.022135533392429352 loss_floor_contact: 0.011527007445693016
[39/100] loss: 0.03503338247537613 loss_joints: 0.02935471385717392 loss_collision: 0.022582385689020157 loss_jerk: 0.02216269075870514 loss_floor_contact: 0.012041617184877396
[40/100] loss: 0.03329962119460106 loss_joints: 0.027630195021629333 loss_collision: 0.022918295115232468 loss_jerk: 0.022240731865167618 loss_floor_contact: 0.011535195633769035
[41/100] loss: 0.031505782157182693 loss_joints: 0.025898579508066177 loss_collision: 0.02207091450691223 loss_jerk: 0.022386668249964714 loss_floor_contact: 0.011614460498094559
[42/100] loss: 0.029563739895820618 loss_joints: 0.024151522666215897 loss_collision: 0.019448697566986084 loss_jerk: 0.022606294602155685 loss_floor_contact: 0.01206718385219574
[43/100] loss: 0.028211919590830803 loss_joints: 0.022418919950723648 loss_collision: 0.023231394588947296 loss_jerk: 0.02289016917347908 loss_floor_contact: 0.011808425188064575
[44/100] loss: 0.02646527625620365 loss_joints: 0.02073677070438862 loss_collision: 0.022579967975616455 loss_jerk: 0.023215003311634064 loss_floor_contact: 0.011490081436932087
[45/100] loss: 0.024514127522706985 loss_joints: 0.01911340467631817 loss_collision: 0.019194338470697403 loss_jerk: 0.02356908842921257 loss_floor_contact: 0.011243805289268494
[46/100] loss: 0.02299453504383564 loss_joints: 0.017552396282553673 loss_collision: 0.019349485635757446 loss_jerk: 0.023909706622362137 loss_floor_contact: 0.011162187904119492
[47/100] loss: 0.02109522931277752 loss_joints: 0.016072113066911697 loss_collision: 0.019135955721139908 loss_jerk: 0.024222005158662796 loss_floor_contact: 0.0068732015788555145
[48/100] loss: 0.020339472219347954 loss_joints: 0.014695375226438046 loss_collision: 0.02265201508998871 loss_jerk: 0.024461645632982254 loss_floor_contact: 0.009327299892902374
[49/100] loss: 0.0182923786342144 loss_joints: 0.013437546789646149 loss_collision: 0.01907721906900406 loss_jerk: 0.024733588099479675 loss_floor_contact: 0.004737498238682747
[50/100] loss: 0.01720302924513817 loss_joints: 0.012281837873160839 loss_collision: 0.018140703439712524 loss_jerk: 0.025001872330904007 loss_floor_contact: 0.00606932770460844
[51/100] loss: 0.016791578382253647 loss_joints: 0.011218992993235588 loss_collision: 0.02315875142812729 loss_jerk: 0.025346875190734863 loss_floor_contact: 0.007220228668302298
[52/100] loss: 0.015524163842201233 loss_joints: 0.010228019207715988 loss_collision: 0.019495658576488495 loss_jerk: 0.025767622515559196 loss_floor_contact: 0.007698163390159607
[53/100] loss: 0.014698505401611328 loss_joints: 0.009278550744056702 loss_collision: 0.022560514509677887 loss_jerk: 0.026090573519468307 loss_floor_contact: 0.005548454821109772
[54/100] loss: 0.013936894945800304 loss_joints: 0.00842052511870861 loss_collision: 0.026004798710346222 loss_jerk: 0.02658003382384777 loss_floor_contact: 0.0025788620114326477
[55/100] loss: 0.012927104718983173 loss_joints: 0.007577994838356972 loss_collision: 0.019520524889230728 loss_jerk: 0.02697233483195305 loss_floor_contact: 0.006998248398303986
[56/100] loss: 0.012202433310449123 loss_joints: 0.006734815426170826 loss_collision: 0.022005558013916016 loss_jerk: 0.027268294245004654 loss_floor_contact: 0.005402322858572006
[57/100] loss: 0.011276294477283955 loss_joints: 0.005870354361832142 loss_collision: 0.021941721439361572 loss_jerk: 0.027496276423335075 loss_floor_contact: 0.004621397703886032
[58/100] loss: 0.010444199666380882 loss_joints: 0.005006879102438688 loss_collision: 0.021984752267599106 loss_jerk: 0.02785293012857437 loss_floor_contact: 0.00453551858663559
[59/100] loss: 0.0095661086961627 loss_joints: 0.0041708024218678474 loss_collision: 0.022378984838724136 loss_jerk: 0.02808399870991707 loss_floor_contact: 0.0034900829195976257
[60/100] loss: 0.008767727762460709 loss_joints: 0.0034448374062776566 loss_collision: 0.0214015394449234 loss_jerk: 0.028230689465999603 loss_floor_contact: 0.0035966746509075165
[61/100] loss: 0.00827733427286148 loss_joints: 0.0028299184050410986 loss_collision: 0.0221560075879097 loss_jerk: 0.028231661766767502 loss_floor_contact: 0.004086481407284737
[62/100] loss: 0.007808972150087357 loss_joints: 0.0022695730440318584 loss_collision: 0.02208799496293068 loss_jerk: 0.028075367212295532 loss_floor_contact: 0.005230624228715897
[63/100] loss: 0.00733347050845623 loss_joints: 0.0017544146394357085 loss_collision: 0.022098269313573837 loss_jerk: 0.027829239144921303 loss_floor_contact: 0.005863048601895571
[64/100] loss: 0.006851570680737495 loss_joints: 0.0012860780116170645 loss_collision: 0.024266425520181656 loss_jerk: 0.027400270104408264 loss_floor_contact: 0.003988228738307953
[65/100] loss: 0.006361130625009537 loss_joints: 0.0009169626282528043 loss_collision: 0.023077156394720078 loss_jerk: 0.027164535596966743 loss_floor_contact: 0.004199986346065998
[66/100] loss: 0.005988931283354759 loss_joints: 0.0006078827427700162 loss_collision: 0.02168002724647522 loss_jerk: 0.026975315064191818 loss_floor_contact: 0.0051551382057368755
[67/100] loss: 0.005651775281876326 loss_joints: 0.0003588481049519032 loss_collision: 0.021702956408262253 loss_jerk: 0.02659040503203869 loss_floor_contact: 0.004635910969227552
[68/100] loss: 0.0051674204878509045 loss_joints: 0.00018698400526773185 loss_collision: 0.018437832593917847 loss_jerk: 0.025989562273025513 loss_floor_contact: 0.005376965738832951
[69/100] loss: 0.004984206985682249 loss_joints: 0.00010836782166734338 loss_collision: 0.018597576767206192 loss_jerk: 0.025593174621462822 loss_floor_contact: 0.004567638970911503
[70/100] loss: 0.0050665345042943954 loss_joints: 8.618205174570903e-05 loss_collision: 0.019841141998767853 loss_jerk: 0.025189882144331932 loss_floor_contact: 0.004772497341036797
[71/100] loss: 0.005544599145650864 loss_joints: 0.00012549289385788143 loss_collision: 0.023696675896644592 loss_jerk: 0.025507763028144836 loss_floor_contact: 0.004986622836440802
[72/100] loss: 0.005189517978578806 loss_joints: 0.00018655268650036305 loss_collision: 0.01861356571316719 loss_jerk: 0.026141246780753136 loss_floor_contact: 0.0052748373709619045
[73/100] loss: 0.005348706617951393 loss_joints: 0.00024158164160326123 loss_collision: 0.019349034875631332 loss_jerk: 0.02645496465265751 loss_floor_contact: 0.005267246160656214
[74/100] loss: 0.005804160609841347 loss_joints: 0.0002849565935321152 loss_collision: 0.02366270124912262 loss_jerk: 0.026638630777597427 loss_floor_contact: 0.004890711512416601
[75/100] loss: 0.005506415851414204 loss_joints: 0.00030703790253028274 loss_collision: 0.020410947501659393 loss_jerk: 0.026659628376364708 loss_floor_contact: 0.004923205357044935
[76/100] loss: 0.005547911860048771 loss_joints: 0.0003120179462712258 loss_collision: 0.020814355462789536 loss_jerk: 0.026603559032082558 loss_floor_contact: 0.004941017832607031
[77/100] loss: 0.005726794712245464 loss_joints: 0.00029909133445471525 loss_collision: 0.022899556905031204 loss_jerk: 0.026436684653162956 loss_floor_contact: 0.0049407933838665485
[78/100] loss: 0.005304427817463875 loss_joints: 0.00027704291278496385 loss_collision: 0.01898203045129776 loss_jerk: 0.02622954547405243 loss_floor_contact: 0.0050622751004993916
[79/100] loss: 0.005644993856549263 loss_joints: 0.00025183576508425176 loss_collision: 0.022301461547613144 loss_jerk: 0.026004694402217865 loss_floor_contact: 0.005625424440950155
[80/100] loss: 0.005218733102083206 loss_joints: 0.0002203638869104907 loss_collision: 0.018892761319875717 loss_jerk: 0.025658298283815384 loss_floor_contact: 0.0054326350800693035
[81/100] loss: 0.005328653380274773 loss_joints: 0.00018223462393507361 loss_collision: 0.021120280027389526 loss_jerk: 0.02520889788866043 loss_floor_contact: 0.005135012324899435
[82/100] loss: 0.005145428702235222 loss_joints: 0.00016401466564275324 loss_collision: 0.02040664479136467 loss_jerk: 0.024929698556661606 loss_floor_contact: 0.00447780080139637
[83/100] loss: 0.005135064013302326 loss_joints: 0.00016114719619508833 loss_collision: 0.019144441932439804 loss_jerk: 0.02480100281536579 loss_floor_contact: 0.00579372001811862
[84/100] loss: 0.005351867992430925 loss_joints: 0.00016979266365524381 loss_collision: 0.02207108959555626 loss_jerk: 0.024782143533229828 loss_floor_contact: 0.004967521410435438
[85/100] loss: 0.005453926511108875 loss_joints: 0.00018841282872017473 loss_collision: 0.022809091955423355 loss_jerk: 0.024854907765984535 loss_floor_contact: 0.004991136956959963
[86/100] loss: 0.005490297917276621 loss_joints: 0.00019470001279842108 loss_collision: 0.022289305925369263 loss_jerk: 0.024803275242447853 loss_floor_contact: 0.00586339645087719
[87/100] loss: 0.00541369803249836 loss_joints: 0.00019077214528806508 loss_collision: 0.02195999026298523 loss_jerk: 0.024659765884280205 loss_floor_contact: 0.005609504878520966
[88/100] loss: 0.00530667370185256 loss_joints: 0.00017930404283106327 loss_collision: 0.02225274220108986 loss_jerk: 0.024448854848742485 loss_floor_contact: 0.004572100937366486
[89/100] loss: 0.004952559247612953 loss_joints: 0.0001634180371183902 loss_collision: 0.01854371652007103 loss_jerk: 0.02419494278728962 loss_floor_contact: 0.005152752622961998
[90/100] loss: 0.005253213457763195 loss_joints: 0.00015743948461022228 loss_collision: 0.02122664824128151 loss_jerk: 0.024048466235399246 loss_floor_contact: 0.005682624876499176
[91/100] loss: 0.005093885585665703 loss_joints: 0.0001582849508849904 loss_collision: 0.019505631178617477 loss_jerk: 0.024043111130595207 loss_floor_contact: 0.005807260051369667
[92/100] loss: 0.00531928101554513 loss_joints: 0.00016390094242524356 loss_collision: 0.022247791290283203 loss_jerk: 0.02403809316456318 loss_floor_contact: 0.00526791624724865
[93/100] loss: 0.004949986934661865 loss_joints: 0.00017316985758952796 loss_collision: 0.018815267831087112 loss_jerk: 0.024048713967204094 loss_floor_contact: 0.0049041882157325745
[94/100] loss: 0.005026791710406542 loss_joints: 0.0001849248365033418 loss_collision: 0.01900194212794304 loss_jerk: 0.02412768080830574 loss_floor_contact: 0.005289047956466675
[95/100] loss: 0.005432712845504284 loss_joints: 0.00019054318545386195 loss_collision: 0.02245388552546501 loss_jerk: 0.0241483673453331 loss_floor_contact: 0.005819443613290787
[96/100] loss: 0.005048511084169149 loss_joints: 0.0001917017943924293 loss_collision: 0.018663395196199417 loss_jerk: 0.024131208658218384 loss_floor_contact: 0.005773488432168961
[97/100] loss: 0.005407804157584906 loss_joints: 0.00019001202599611133 loss_collision: 0.02231033891439438 loss_jerk: 0.024091854691505432 loss_floor_contact: 0.005775727331638336
[98/100] loss: 0.005391609389334917 loss_joints: 0.0001870260457508266 loss_collision: 0.022154416888952255 loss_jerk: 0.02404617890715599 loss_floor_contact: 0.005845237523317337
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-4.png]
[99/100] loss: 0.005011603701859713 loss_joints: 0.00018405664013698697 loss_collision: 0.019214902073144913 loss_jerk: 0.024024398997426033 loss_floor_contact: 0.005036167800426483
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path1-walk3-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 132.77375                                                    ║
    ║     rollout = 52.40088                                                     ║
    ║     sdf     = 17.74954                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00501160                                                 ║
    ║     joints    = 0.00018406                                                 ║
    ║     collision = 0.01921490                                                 ║
    ║     jerk      = 0.02402440                                                 ║
    ║     floor     = 0.00503617                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	2m34.075s
user	2m16.927s
sys	0m10.903s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x5cf6cc1bac00] using SAR=1/1
[libx264 @ 0x5cf6cc1bac00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x5cf6cc1bac00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x5cf6cc1bac00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_walk_3.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x5cf6cc1b8fc0] video:182kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.621627%
frame=   25 fps=0.0 q=-1.0 Lsize=     184kB time=00:00:02.20 bitrate= 683.4kbits/s speed=3.12x    
[libx264 @ 0x5cf6cc1bac00] frame I:1     Avg QP:18.68  size: 71623
[libx264 @ 0x5cf6cc1bac00] frame P:10    Avg QP:19.28  size:  8271
[libx264 @ 0x5cf6cc1bac00] frame B:14    Avg QP:21.53  size:  2268
[libx264 @ 0x5cf6cc1bac00] consecutive B-frames: 20.0% 16.0%  0.0% 64.0%
[libx264 @ 0x5cf6cc1bac00] mb I  I16..4:  4.5% 66.3% 29.2%
[libx264 @ 0x5cf6cc1bac00] mb P  I16..4:  0.1%  1.5%  1.3%  P16..4:  9.2%  1.9%  1.4%  0.0%  0.0%    skip:84.6%
[libx264 @ 0x5cf6cc1bac00] mb B  I16..4:  0.2%  0.4%  0.1%  B16..8: 11.0%  1.0%  0.4%  direct: 0.8%  skip:86.2%  L0:47.3% L1:49.3% BI: 3.4%
[libx264 @ 0x5cf6cc1bac00] 8x8 transform intra:62.7% inter:62.3%
[libx264 @ 0x5cf6cc1bac00] coded y,uvDC,uvAC intra: 31.5% 20.8% 19.6% inter: 3.5% 3.9% 1.3%
[libx264 @ 0x5cf6cc1bac00] i16 v,h,dc,p: 58% 26% 16%  0%
[libx264 @ 0x5cf6cc1bac00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 52%  8% 33%  1%  1%  2%  1%  2%  1%
[libx264 @ 0x5cf6cc1bac00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 35% 24% 13%  5%  4%  4%  4%  9%  3%
[libx264 @ 0x5cf6cc1bac00] i8c dc,h,v,p: 88%  2%  7%  3%
[libx264 @ 0x5cf6cc1bac00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x5cf6cc1bac00] ref P L0: 54.9% 17.4% 15.7% 11.9%
[libx264 @ 0x5cf6cc1bac00] ref B L0: 85.0% 13.2%  1.8%
[libx264 @ 0x5cf6cc1bac00] ref B L1: 95.2%  4.8%
[libx264 @ 0x5cf6cc1bac00] kb/s:595.45
[INFO] Video saved as 'bin/result/optim_walk_3.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 50 = (8*6 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:07<12:45,  7.73s/it]  2%|▏         | 2/100 [00:10<07:41,  4.70s/it]  3%|▎         | 3/100 [00:13<06:36,  4.09s/it]  4%|▍         | 4/100 [00:16<05:26,  3.40s/it]  5%|▌         | 5/100 [00:18<04:46,  3.02s/it]  6%|▌         | 6/100 [00:20<04:23,  2.80s/it]  7%|▋         | 7/100 [00:23<04:06,  2.65s/it]  8%|▊         | 8/100 [00:25<03:56,  2.57s/it]  9%|▉         | 9/100 [00:27<03:47,  2.50s/it] 10%|█         | 10/100 [00:30<03:39,  2.44s/it] 11%|█         | 11/100 [00:32<03:32,  2.39s/it] 12%|█▏        | 12/100 [00:34<03:28,  2.37s/it] 13%|█▎        | 13/100 [00:37<03:25,  2.36s/it] 14%|█▍        | 14/100 [00:39<03:24,  2.38s/it] 15%|█▌        | 15/100 [00:41<03:19,  2.35s/it] 16%|█▌        | 16/100 [00:44<03:15,  2.32s/it] 17%|█▋        | 17/100 [00:46<03:16,  2.37s/it] 18%|█▊        | 18/100 [00:48<03:15,  2.38s/it] 19%|█▉        | 19/100 [00:51<03:11,  2.36s/it] 20%|██        | 20/100 [00:53<03:09,  2.37s/it] 21%|██        | 21/100 [00:56<03:08,  2.39s/it] 22%|██▏       | 22/100 [00:58<03:05,  2.38s/it] 23%|██▎       | 23/100 [01:00<03:01,  2.36s/it] 24%|██▍       | 24/100 [01:03<03:02,  2.40s/it] 25%|██▌       | 25/100 [01:05<02:56,  2.35s/it] 26%|██▌       | 26/100 [01:07<02:52,  2.33s/it] 27%|██▋       | 27/100 [01:10<02:53,  2.37s/it] 28%|██▊       | 28/100 [01:12<02:51,  2.38s/it] 29%|██▉       | 29/100 [01:14<02:48,  2.37s/it] 30%|███       | 30/100 [01:17<02:45,  2.37s/it] 31%|███       | 31/100 [01:19<02:48,  2.44s/it] 32%|███▏      | 32/100 [01:22<02:50,  2.51s/it] 33%|███▎      | 33/100 [01:25<02:50,  2.55s/it] 34%|███▍      | 34/100 [01:27<02:48,  2.55s/it] 35%|███▌      | 35/100 [01:30<02:45,  2.54s/it] 36%|███▌      | 36/100 [01:32<02:40,  2.51s/it] 37%|███▋      | 37/100 [01:35<02:36,  2.48s/it] 38%|███▊      | 38/100 [01:37<02:33,  2.48s/it] 39%|███▉      | 39/100 [01:39<02:28,  2.43s/it] 40%|████      | 40/100 [01:42<02:23,  2.39s/it] 41%|████      | 41/100 [01:44<02:19,  2.36s/it] 42%|████▏     | 42/100 [01:46<02:16,  2.35s/it] 43%|████▎     | 43/100 [01:49<02:13,  2.34s/it] 44%|████▍     | 44/100 [01:51<02:10,  2.33s/it] 45%|████▌     | 45/100 [01:53<02:08,  2.34s/it] 46%|████▌     | 46/100 [01:56<02:06,  2.34s/it] 47%|████▋     | 47/100 [01:58<02:08,  2.42s/it] 48%|████▊     | 48/100 [02:01<02:03,  2.38s/it] 49%|████▉     | 49/100 [02:03<02:00,  2.35s/it] 50%|█████     | 50/100 [02:05<01:57,  2.34s/it] 51%|█████     | 51/100 [02:07<01:53,  2.33s/it] 52%|█████▏    | 52/100 [02:10<01:48,  2.27s/it] 53%|█████▎    | 53/100 [02:12<01:44,  2.23s/it] 54%|█████▍    | 54/100 [02:14<01:40,  2.19s/it] 55%|█████▌    | 55/100 [02:16<01:37,  2.18s/it] 56%|█████▌    | 56/100 [02:18<01:35,  2.16s/it] 57%|█████▋    | 57/100 [02:20<01:34,  2.19s/it] 58%|█████▊    | 58/100 [02:22<01:30,  2.16s/it] 59%|█████▉    | 59/100 [02:25<01:28,  2.16s/it] 60%|██████    | 60/100 [02:27<01:26,  2.16s/it] 61%|██████    | 61/100 [02:29<01:23,  2.15s/it] 62%|██████▏   | 62/100 [02:31<01:21,  2.15s/it] 63%|██████▎   | 63/100 [02:33<01:19,  2.15s/it] 64%|██████▍   | 64/100 [02:35<01:17,  2.14s/it] 65%|██████▌   | 65/100 [02:37<01:15,  2.15s/it] 66%|██████▌   | 66/100 [02:40<01:13,  2.16s/it] 67%|██████▋   | 67/100 [02:42<01:11,  2.16s/it] 68%|██████▊   | 68/100 [02:44<01:09,  2.16s/it] 69%|██████▉   | 69/100 [02:46<01:06,  2.15s/it] 70%|███████   | 70/100 [02:49<01:06,  2.22s/it] 71%|███████   | 71/100 [02:51<01:03,  2.20s/it] 72%|███████▏  | 72/100 [02:53<01:01,  2.19s/it] 73%|███████▎  | 73/100 [02:55<00:58,  2.18s/it] 74%|███████▍  | 74/100 [02:57<00:56,  2.17s/it] 75%|███████▌  | 75/100 [02:59<00:53,  2.14s/it] 76%|███████▌  | 76/100 [03:01<00:51,  2.13s/it] 77%|███████▋  | 77/100 [03:03<00:48,  2.12s/it] 78%|███████▊  | 78/100 [03:05<00:46,  2.10s/it] 79%|███████▉  | 79/100 [03:08<00:44,  2.12s/it] 80%|████████  | 80/100 [03:10<00:42,  2.11s/it] 81%|████████  | 81/100 [03:12<00:39,  2.09s/it] 82%|████████▏ | 82/100 [03:14<00:37,  2.10s/it] 83%|████████▎ | 83/100 [03:16<00:35,  2.11s/it] 84%|████████▍ | 84/100 [03:18<00:34,  2.14s/it] 85%|████████▌ | 85/100 [03:20<00:32,  2.14s/it] 86%|████████▌ | 86/100 [03:22<00:29,  2.13s/it] 87%|████████▋ | 87/100 [03:25<00:28,  2.16s/it] 88%|████████▊ | 88/100 [03:27<00:25,  2.15s/it] 89%|████████▉ | 89/100 [03:29<00:23,  2.13s/it] 90%|█████████ | 90/100 [03:31<00:21,  2.14s/it] 91%|█████████ | 91/100 [03:33<00:19,  2.15s/it] 92%|█████████▏| 92/100 [03:35<00:17,  2.14s/it] 93%|█████████▎| 93/100 [03:38<00:15,  2.19s/it] 94%|█████████▍| 94/100 [03:40<00:13,  2.18s/it] 95%|█████████▌| 95/100 [03:42<00:10,  2.17s/it] 96%|█████████▌| 96/100 [03:44<00:08,  2.19s/it] 97%|█████████▋| 97/100 [03:46<00:06,  2.20s/it] 98%|█████████▊| 98/100 [03:49<00:04,  2.18s/it] 99%|█████████▉| 99/100 [03:51<00:02,  2.17s/it]100%|██████████| 100/100 [03:58<00:00,  3.58s/it]100%|██████████| 100/100 [03:58<00:00,  2.38s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-7.png]
[0/100] loss: 0.09602522850036621 loss_joints: 0.0911450907588005 loss_collision: 0.027042413130402565 loss_jerk: 0.015773985534906387 loss_floor_contact: 0.005984987132251263
[1/100] loss: 0.08665665239095688 loss_joints: 0.08203449100255966 loss_collision: 0.025253381580114365 loss_jerk: 0.01576421409845352 loss_floor_contact: 0.005203971639275551
[2/100] loss: 0.07765314728021622 loss_joints: 0.07311500608921051 loss_collision: 0.024551009759306908 loss_jerk: 0.015629148110747337 loss_floor_contact: 0.0052012181840837
[3/100] loss: 0.06951871514320374 loss_joints: 0.0653202012181282 loss_collision: 0.02011025696992874 loss_jerk: 0.015402058139443398 loss_floor_contact: 0.006472875364124775
[4/100] loss: 0.05813692882657051 loss_joints: 0.0539199635386467 loss_collision: 0.01944766752421856 loss_jerk: 0.015145066194236279 loss_floor_contact: 0.00757695734500885
[5/100] loss: 0.04503044858574867 loss_joints: 0.04019160568714142 loss_collision: 0.02306707575917244 loss_jerk: 0.01646714098751545 loss_floor_contact: 0.008854245766997337
[6/100] loss: 0.03513815626502037 loss_joints: 0.03076763078570366 loss_collision: 0.020613107830286026 loss_jerk: 0.01613547094166279 loss_floor_contact: 0.006956664379686117
[7/100] loss: 0.030986690893769264 loss_joints: 0.02634064480662346 loss_collision: 0.020446952432394028 loss_jerk: 0.01862017810344696 loss_floor_contact: 0.007393337786197662
[8/100] loss: 0.026282986626029015 loss_joints: 0.02229118160903454 loss_collision: 0.01671229861676693 loss_jerk: 0.016628263518214226 loss_floor_contact: 0.006577486637979746
[9/100] loss: 0.02235068939626217 loss_joints: 0.018530359491705894 loss_collision: 0.015067854896187782 loss_jerk: 0.016623148694634438 loss_floor_contact: 0.0065123033709824085
[10/100] loss: 0.017743408679962158 loss_joints: 0.01411019079387188 loss_collision: 0.014909223653376102 loss_jerk: 0.01702284626662731 loss_floor_contact: 0.00440010242164135
[11/100] loss: 0.013691852800548077 loss_joints: 0.009927114471793175 loss_collision: 0.015089037828147411 loss_jerk: 0.017602279782295227 loss_floor_contact: 0.004956071265041828
[12/100] loss: 0.010619753040373325 loss_joints: 0.00685403635725379 loss_collision: 0.015466143377125263 loss_jerk: 0.01828785426914692 loss_floor_contact: 0.003903175238519907
[13/100] loss: 0.008325047791004181 loss_joints: 0.004609314259141684 loss_collision: 0.013935906812548637 loss_jerk: 0.019015543162822723 loss_floor_contact: 0.004205889999866486
[14/100] loss: 0.00721339788287878 loss_joints: 0.0030909255146980286 loss_collision: 0.01686912402510643 loss_jerk: 0.019552547484636307 loss_floor_contact: 0.00480305403470993
[15/100] loss: 0.0057977475225925446 loss_joints: 0.001727250637486577 loss_collision: 0.015425588935613632 loss_jerk: 0.01990552619099617 loss_floor_contact: 0.005373853724449873
[16/100] loss: 0.004775680601596832 loss_joints: 0.0007231446215882897 loss_collision: 0.012983197346329689 loss_jerk: 0.020140331238508224 loss_floor_contact: 0.007401824463158846
[17/100] loss: 0.004441436380147934 loss_joints: 0.00014579054550267756 loss_collision: 0.013600948266685009 loss_jerk: 0.02028048224747181 loss_floor_contact: 0.009075025096535683
[18/100] loss: 0.004547003656625748 loss_joints: 2.023264823947102e-05 loss_collision: 0.013485517352819443 loss_jerk: 0.02040882036089897 loss_floor_contact: 0.011373373679816723
[19/100] loss: 0.004342975094914436 loss_joints: 0.00010485460370546207 loss_collision: 0.011017616838216782 loss_jerk: 0.020515495911240578 loss_floor_contact: 0.01084809098392725
[20/100] loss: 0.00468223774805665 loss_joints: 0.00037890809471718967 loss_collision: 0.011627014726400375 loss_jerk: 0.020584043115377426 loss_floor_contact: 0.010822239331901073
[21/100] loss: 0.0047465055249631405 loss_joints: 0.000829523429274559 loss_collision: 0.013156072236597538 loss_jerk: 0.020605139434337616 loss_floor_contact: 0.005408608820289373
[22/100] loss: 0.0051662735641002655 loss_joints: 0.0012755664065480232 loss_collision: 0.012391571886837482 loss_jerk: 0.020562700927257538 loss_floor_contact: 0.005952801089733839
[23/100] loss: 0.005311250686645508 loss_joints: 0.001476552220992744 loss_collision: 0.012786312028765678 loss_jerk: 0.020515430718660355 loss_floor_contact: 0.005045238416641951
[24/100] loss: 0.005343956872820854 loss_joints: 0.001447519171051681 loss_collision: 0.013726522214710712 loss_jerk: 0.02046460285782814 loss_floor_contact: 0.004773251712322235
[25/100] loss: 0.0051133884117007256 loss_joints: 0.0012476079864427447 loss_collision: 0.013855673372745514 loss_jerk: 0.02040967345237732 loss_floor_contact: 0.0043924590572714806
[26/100] loss: 0.00461245933547616 loss_joints: 0.0009530473034828901 loss_collision: 0.01132239494472742 loss_jerk: 0.020357688888907433 loss_floor_contact: 0.004914035089313984
[27/100] loss: 0.004524850286543369 loss_joints: 0.0006647251429967582 loss_collision: 0.011345491744577885 loss_jerk: 0.020302575081586838 loss_floor_contact: 0.006953186355531216
[28/100] loss: 0.004565910901874304 loss_joints: 0.0005325305974110961 loss_collision: 0.012752759270370007 loss_jerk: 0.02018001675605774 loss_floor_contact: 0.007401027716696262
[29/100] loss: 0.004742771852761507 loss_joints: 0.0004666969762183726 loss_collision: 0.012835503555834293 loss_jerk: 0.020059796050190926 loss_floor_contact: 0.00986544694751501
[30/100] loss: 0.004527808167040348 loss_joints: 0.0003884130856022239 loss_collision: 0.011355343274772167 loss_jerk: 0.01994997076690197 loss_floor_contact: 0.010088634677231312
[31/100] loss: 0.004546724259853363 loss_joints: 0.0003157453902531415 loss_collision: 0.013247977942228317 loss_jerk: 0.019841035827994347 loss_floor_contact: 0.009220771491527557
[32/100] loss: 0.004396283067762852 loss_joints: 0.0002634829143062234 loss_collision: 0.013306903652846813 loss_jerk: 0.019682684913277626 loss_floor_contact: 0.008338415063917637
[33/100] loss: 0.004336182028055191 loss_joints: 0.00020290352404117584 loss_collision: 0.012974041514098644 loss_jerk: 0.019502580165863037 loss_floor_contact: 0.008856161497533321
[34/100] loss: 0.004093338269740343 loss_joints: 0.0001981655223062262 loss_collision: 0.012736674398183823 loss_jerk: 0.01929771527647972 loss_floor_contact: 0.006917339749634266
[35/100] loss: 0.0040634856559336185 loss_joints: 0.0003037190472241491 loss_collision: 0.01136759202927351 loss_jerk: 0.01909901201725006 loss_floor_contact: 0.0071310605853796005
[36/100] loss: 0.004230121150612831 loss_joints: 0.00035056821070611477 loss_collision: 0.013167266733944416 loss_jerk: 0.01891380548477173 loss_floor_contact: 0.006714460905641317
[37/100] loss: 0.004157303366810083 loss_joints: 0.00030807399889454246 loss_collision: 0.012882182374596596 loss_jerk: 0.018718671053647995 loss_floor_contact: 0.006891439203172922
[38/100] loss: 0.0040705506689846516 loss_joints: 0.00029914104379713535 loss_collision: 0.01288208644837141 loss_jerk: 0.018492145463824272 loss_floor_contact: 0.006339866202324629
[39/100] loss: 0.003905068151652813 loss_joints: 0.0001867174287326634 loss_collision: 0.01272972859442234 loss_jerk: 0.01826917752623558 loss_floor_contact: 0.006184601224958897
[40/100] loss: 0.0036772629246115685 loss_joints: 6.488924555014819e-05 loss_collision: 0.011234801262617111 loss_jerk: 0.01803445816040039 loss_floor_contact: 0.00685447733849287
[41/100] loss: 0.0036823225673288107 loss_joints: 8.160710422089323e-05 loss_collision: 0.01077265478670597 loss_jerk: 0.017839854583144188 loss_floor_contact: 0.007394643034785986
[42/100] loss: 0.0038676178082823753 loss_joints: 0.00012012095976388082 loss_collision: 0.012808133848011494 loss_jerk: 0.017671233043074608 loss_floor_contact: 0.006995602045208216
[43/100] loss: 0.0035982958506792784 loss_joints: 0.00017766252858564258 loss_collision: 0.011486188508570194 loss_jerk: 0.017528561875224113 loss_floor_contact: 0.0051915827207267284
[44/100] loss: 0.003574683563783765 loss_joints: 0.00022841703321319073 loss_collision: 0.011478071101009846 loss_jerk: 0.017329739406704903 loss_floor_contact: 0.0046548559330403805
[45/100] loss: 0.003692886559292674 loss_joints: 0.00022105438983999193 loss_collision: 0.01303835865110159 loss_jerk: 0.017134318128228188 loss_floor_contact: 0.004545643925666809
[46/100] loss: 0.0037264367565512657 loss_joints: 0.00023623932793270797 loss_collision: 0.01354135386645794 loss_jerk: 0.01695234701037407 loss_floor_contact: 0.004408272914588451
[47/100] loss: 0.003455739002674818 loss_joints: 0.00020068643789272755 loss_collision: 0.011687460355460644 loss_jerk: 0.01678016223013401 loss_floor_contact: 0.004082905128598213
[48/100] loss: 0.0035117538645863533 loss_joints: 0.00017532116908114403 loss_collision: 0.01173840556293726 loss_jerk: 0.016622811555862427 loss_floor_contact: 0.0050031086429953575
[49/100] loss: 0.003638042137026787 loss_joints: 0.00016047735698521137 loss_collision: 0.013386026956140995 loss_jerk: 0.01648673787713051 loss_floor_contact: 0.004902883432805538
[50/100] loss: 0.0034278067760169506 loss_joints: 0.00012450451322365552 loss_collision: 0.012601567432284355 loss_jerk: 0.016374042257666588 loss_floor_contact: 0.004057412967085838
[51/100] loss: 0.0035519450902938843 loss_joints: 0.00012161398626631126 loss_collision: 0.013346059247851372 loss_jerk: 0.01658344827592373 loss_floor_contact: 0.004373801872134209
[52/100] loss: 0.0034318198449909687 loss_joints: 0.00012023310409858823 loss_collision: 0.012308425270020962 loss_jerk: 0.01677090860903263 loss_floor_contact: 0.004036534111946821
[53/100] loss: 0.003523513674736023 loss_joints: 8.207494101952761e-05 loss_collision: 0.013657351024448872 loss_jerk: 0.01687121018767357 loss_floor_contact: 0.0038858281914144754
[54/100] loss: 0.003585115307942033 loss_joints: 5.4330259445123374e-05 loss_collision: 0.013715553097426891 loss_jerk: 0.01687214896082878 loss_floor_contact: 0.004720148630440235
[55/100] loss: 0.003809168003499508 loss_joints: 3.8505939301103354e-05 loss_collision: 0.015946045517921448 loss_jerk: 0.016916001215577126 loss_floor_contact: 0.0048445723950862885
[56/100] loss: 0.003654476488009095 loss_joints: 1.6331485312548466e-05 loss_collision: 0.0156811885535717 loss_jerk: 0.016993870958685875 loss_floor_contact: 0.0037063919007778168
[57/100] loss: 0.0035223073791712523 loss_joints: 3.764903885894455e-05 loss_collision: 0.01407230831682682 loss_jerk: 0.01710727997124195 loss_floor_contact: 0.003666995093226433
[58/100] loss: 0.0036122212186455727 loss_joints: 0.0001943732495419681 loss_collision: 0.01395570021122694 loss_jerk: 0.01722676306962967 loss_floor_contact: 0.00299601792357862
[59/100] loss: 0.00401604687795043 loss_joints: 0.00031020952155813575 loss_collision: 0.016262946650385857 loss_jerk: 0.01725679822266102 loss_floor_contact: 0.0035386320669203997
[60/100] loss: 0.004038812126964331 loss_joints: 0.0003169315168634057 loss_collision: 0.01653396524488926 loss_jerk: 0.01723143644630909 loss_floor_contact: 0.0034534060396254063
[61/100] loss: 0.0036025820299983025 loss_joints: 0.00022723198344465345 loss_collision: 0.013732717372477055 loss_jerk: 0.017162226140499115 loss_floor_contact: 0.0028585537802428007
[62/100] loss: 0.0034993630833923817 loss_joints: 9.466506162425503e-05 loss_collision: 0.013573006726801395 loss_jerk: 0.017047688364982605 loss_floor_contact: 0.0034262838307768106
[63/100] loss: 0.0037043129559606314 loss_joints: 6.011006917105988e-06 loss_collision: 0.015584569424390793 loss_jerk: 0.01688619703054428 loss_floor_contact: 0.004512254148721695
[64/100] loss: 0.003741070395335555 loss_joints: 7.800381354172714e-06 loss_collision: 0.016216440126299858 loss_jerk: 0.016761932522058487 loss_floor_contact: 0.004354327451437712
[65/100] loss: 0.0037752592470496893 loss_joints: 1.1881011232617311e-05 loss_collision: 0.01638299971818924 loss_jerk: 0.01668127067387104 loss_floor_contact: 0.00456951092928648
[66/100] loss: 0.0035987533628940582 loss_joints: 3.42697421729099e-06 loss_collision: 0.01450284942984581 loss_jerk: 0.0166289284825325 loss_floor_contact: 0.004821484908461571
[67/100] loss: 0.0035876433830708265 loss_joints: 2.09727295441553e-06 loss_collision: 0.014483974315226078 loss_jerk: 0.01649504154920578 loss_floor_contact: 0.004876445047557354
[68/100] loss: 0.0037133144214749336 loss_joints: 1.208765297633363e-05 loss_collision: 0.015733327716588974 loss_jerk: 0.01631195656955242 loss_floor_contact: 0.004966984037309885
[69/100] loss: 0.003493261057883501 loss_joints: 1.1416357665439136e-05 loss_collision: 0.014057998545467854 loss_jerk: 0.016171636059880257 loss_floor_contact: 0.004588811658322811
[70/100] loss: 0.00346098723821342 loss_joints: 8.27449002827052e-06 loss_collision: 0.014162617735564709 loss_jerk: 0.01608177460730076 loss_floor_contact: 0.004282735753804445
[71/100] loss: 0.0033283603843301535 loss_joints: 3.451228985795751e-05 loss_collision: 0.013023270294070244 loss_jerk: 0.01610846072435379 loss_floor_contact: 0.0038067514542490244
[72/100] loss: 0.0035290319938212633 loss_joints: 6.0414891777327284e-05 loss_collision: 0.014611581340432167 loss_jerk: 0.016129180788993835 loss_floor_contact: 0.003945408388972282
[73/100] loss: 0.0033717905171215534 loss_joints: 6.010910146869719e-05 loss_collision: 0.012676876038312912 loss_jerk: 0.016144098713994026 loss_floor_contact: 0.0042958385311067104
[74/100] loss: 0.003266623243689537 loss_joints: 4.215236913296394e-05 loss_collision: 0.011935950256884098 loss_jerk: 0.016154037788510323 loss_floor_contact: 0.004154720809310675
[75/100] loss: 0.0034394769463688135 loss_joints: 3.166763053741306e-05 loss_collision: 0.01353275217115879 loss_jerk: 0.016159890219569206 loss_floor_contact: 0.004385450389236212
[76/100] loss: 0.0034693467896431684 loss_joints: 5.754167432314716e-05 loss_collision: 0.013064448721706867 loss_jerk: 0.016149841248989105 loss_floor_contact: 0.004903759341686964
[77/100] loss: 0.003554324386641383 loss_joints: 8.026904833968729e-05 loss_collision: 0.013172967359423637 loss_jerk: 0.016140619292855263 loss_floor_contact: 0.005426966119557619
[78/100] loss: 0.003610676620155573 loss_joints: 8.220609015552327e-05 loss_collision: 0.013767819851636887 loss_jerk: 0.01613493077456951 loss_floor_contact: 0.005381954833865166
[79/100] loss: 0.003344388445839286 loss_joints: 6.736363866366446e-05 loss_collision: 0.012285995297133923 loss_jerk: 0.016133317723870277 loss_floor_contact: 0.004350935108959675
[80/100] loss: 0.0032764493953436613 loss_joints: 4.7697933041490614e-05 loss_collision: 0.011634241789579391 loss_jerk: 0.016133036464452744 loss_floor_contact: 0.004520237445831299
[81/100] loss: 0.0034010233357548714 loss_joints: 4.124885890632868e-05 loss_collision: 0.012959565967321396 loss_jerk: 0.016124580055475235 loss_floor_contact: 0.00451359897851944
[82/100] loss: 0.003446766175329685 loss_joints: 3.409533383091912e-05 loss_collision: 0.013931939378380775 loss_jerk: 0.0161195769906044 loss_floor_contact: 0.00407519331201911
[83/100] loss: 0.0034138821065425873 loss_joints: 3.095935971941799e-05 loss_collision: 0.013505359180271626 loss_jerk: 0.016105929389595985 loss_floor_contact: 0.004217938985675573
[84/100] loss: 0.00333550781942904 loss_joints: 2.585676520538982e-05 loss_collision: 0.0132214967161417 loss_jerk: 0.01609036512672901 loss_floor_contact: 0.0037846481427550316
[85/100] loss: 0.003351988270878792 loss_joints: 2.1138552256161347e-05 loss_collision: 0.01322242897003889 loss_jerk: 0.016075007617473602 loss_floor_contact: 0.004011058714240789
[86/100] loss: 0.0033498574048280716 loss_joints: 2.6168758267886005e-05 loss_collision: 0.013232911005616188 loss_jerk: 0.016055580228567123 loss_floor_contact: 0.003948393743485212
[87/100] loss: 0.003529404988512397 loss_joints: 4.7637528041377664e-05 loss_collision: 0.01353523600846529 loss_jerk: 0.01603054255247116 loss_floor_contact: 0.005251897498965263
[88/100] loss: 0.0034808791242539883 loss_joints: 6.327669689198956e-05 loss_collision: 0.012505357153713703 loss_jerk: 0.016011536121368408 loss_floor_contact: 0.005659131333231926
[89/100] loss: 0.0037001410964876413 loss_joints: 6.7503446189221e-05 loss_collision: 0.014528868719935417 loss_jerk: 0.01599854975938797 loss_floor_contact: 0.005798956844955683
[90/100] loss: 0.003669153433293104 loss_joints: 6.151755223982036e-05 loss_collision: 0.014495224691927433 loss_jerk: 0.01599046215415001 loss_floor_contact: 0.0055906702764332294
[91/100] loss: 0.0035578925162553787 loss_joints: 4.980742232874036e-05 loss_collision: 0.013820229098200798 loss_jerk: 0.015986420214176178 loss_floor_contact: 0.005274199414998293
[92/100] loss: 0.0033631313126534224 loss_joints: 3.7077210436109453e-05 loss_collision: 0.012484395876526833 loss_jerk: 0.0159843061119318 loss_floor_contact: 0.004791839048266411
[93/100] loss: 0.003379224333912134 loss_joints: 2.705941369640641e-05 loss_collision: 0.013717107474803925 loss_jerk: 0.015983399003744125 loss_floor_contact: 0.0038211410865187645
[94/100] loss: 0.0033716049510985613 loss_joints: 2.3983757273526862e-05 loss_collision: 0.013637741096317768 loss_jerk: 0.01597960852086544 loss_floor_contact: 0.0038588624447584152
[95/100] loss: 0.0034236323554068804 loss_joints: 2.5203960831277072e-05 loss_collision: 0.01342187449336052 loss_jerk: 0.015974290668964386 loss_floor_contact: 0.004588119685649872
[96/100] loss: 0.00349107151851058 loss_joints: 2.814952313201502e-05 loss_collision: 0.013987409882247448 loss_jerk: 0.015969060361385345 loss_floor_contact: 0.00467274896800518
[97/100] loss: 0.0034155892208218575 loss_joints: 3.086830474785529e-05 loss_collision: 0.013417991809546947 loss_jerk: 0.015963949263095856 loss_floor_contact: 0.004465267062187195
[98/100] loss: 0.003447598312050104 loss_joints: 3.230485526728444e-05 loss_collision: 0.013580478727817535 loss_jerk: 0.015959586948156357 loss_floor_contact: 0.004612869583070278
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-7.png]
[99/100] loss: 0.0034579052589833736 loss_joints: 3.282616671640426e-05 loss_collision: 0.01352593582123518 loss_jerk: 0.015956193208694458 loss_floor_contact: 0.004768660292029381
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path1-walk6-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 238.09663                                                    ║
    ║     rollout = 103.54619                                                    ║
    ║     sdf     = 22.26966                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00345791                                                 ║
    ║     joints    = 0.00003283                                                 ║
    ║     collision = 0.01352594                                                 ║
    ║     jerk      = 0.01595619                                                 ║
    ║     floor     = 0.00476866                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	4m18.667s
user	3m58.561s
sys	0m14.429s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x5832291dfc00] using SAR=1/1
[libx264 @ 0x5832291dfc00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x5832291dfc00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x5832291dfc00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_walk_6.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x5832291ddfc0] video:178kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.641441%
frame=   25 fps=0.0 q=-1.0 Lsize=     179kB time=00:00:02.20 bitrate= 667.0kbits/s speed= 3.2x    
[libx264 @ 0x5832291dfc00] frame I:1     Avg QP:18.47  size: 72160
[libx264 @ 0x5832291dfc00] frame P:8     Avg QP:20.87  size:  9845
[libx264 @ 0x5832291dfc00] frame B:16    Avg QP:21.65  size:  1915
[libx264 @ 0x5832291dfc00] consecutive B-frames:  8.0% 16.0% 12.0% 64.0%
[libx264 @ 0x5832291dfc00] mb I  I16..4:  3.6% 66.3% 30.2%
[libx264 @ 0x5832291dfc00] mb P  I16..4:  0.2%  1.8%  1.4%  P16..4: 10.0%  2.4%  1.5%  0.0%  0.0%    skip:82.7%
[libx264 @ 0x5832291dfc00] mb B  I16..4:  0.1%  0.4%  0.1%  B16..8: 10.4%  0.9%  0.4%  direct: 0.7%  skip:87.0%  L0:51.1% L1:45.6% BI: 3.3%
[libx264 @ 0x5832291dfc00] 8x8 transform intra:63.6% inter:57.7%
[libx264 @ 0x5832291dfc00] coded y,uvDC,uvAC intra: 30.9% 20.3% 19.3% inter: 3.1% 3.4% 1.1%
[libx264 @ 0x5832291dfc00] i16 v,h,dc,p: 51% 30% 19%  0%
[libx264 @ 0x5832291dfc00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 51%  8% 34%  1%  1%  2%  1%  2%  1%
[libx264 @ 0x5832291dfc00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 35% 23% 14%  5%  4%  4%  4%  9%  3%
[libx264 @ 0x5832291dfc00] i8c dc,h,v,p: 89%  2%  7%  3%
[libx264 @ 0x5832291dfc00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x5832291dfc00] ref P L0: 56.4% 14.3% 19.6%  9.7%
[libx264 @ 0x5832291dfc00] ref B L0: 80.7% 17.2%  2.2%
[libx264 @ 0x5832291dfc00] ref B L1: 97.7%  2.3%
[libx264 @ 0x5832291dfc00] kb/s:580.98
[INFO] Video saved as 'bin/result/optim_walk_6.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:13<22:59, 13.94s/it]  2%|▏         | 2/100 [00:18<13:36,  8.33s/it]  3%|▎         | 3/100 [00:23<10:56,  6.77s/it]  4%|▍         | 4/100 [00:27<09:17,  5.81s/it]  5%|▌         | 5/100 [00:32<08:24,  5.31s/it]  6%|▌         | 6/100 [00:36<07:52,  5.02s/it]  7%|▋         | 7/100 [00:40<07:17,  4.71s/it]  8%|▊         | 8/100 [00:44<06:55,  4.52s/it]  9%|▉         | 9/100 [00:48<06:38,  4.38s/it] 10%|█         | 10/100 [00:52<06:21,  4.24s/it] 11%|█         | 11/100 [00:56<06:17,  4.24s/it] 12%|█▏        | 12/100 [01:00<06:08,  4.18s/it] 13%|█▎        | 13/100 [01:05<06:03,  4.18s/it] 14%|█▍        | 14/100 [01:09<05:57,  4.16s/it] 15%|█▌        | 15/100 [01:13<05:51,  4.13s/it] 16%|█▌        | 16/100 [01:17<05:45,  4.11s/it] 17%|█▋        | 17/100 [01:21<05:50,  4.23s/it] 18%|█▊        | 18/100 [01:26<06:03,  4.44s/it] 19%|█▉        | 19/100 [01:31<06:09,  4.56s/it] 20%|██        | 20/100 [01:36<06:15,  4.70s/it] 21%|██        | 21/100 [01:41<06:04,  4.61s/it] 22%|██▏       | 22/100 [01:45<05:52,  4.51s/it] 23%|██▎       | 23/100 [01:49<05:45,  4.49s/it] 24%|██▍       | 24/100 [01:53<05:34,  4.40s/it] 25%|██▌       | 25/100 [01:58<05:29,  4.40s/it] 26%|██▌       | 26/100 [02:02<05:27,  4.42s/it] 27%|██▋       | 27/100 [02:07<05:20,  4.39s/it] 28%|██▊       | 28/100 [02:11<05:16,  4.40s/it] 29%|██▉       | 29/100 [02:15<05:12,  4.40s/it] 30%|███       | 30/100 [02:20<05:09,  4.42s/it] 31%|███       | 31/100 [02:24<05:00,  4.35s/it] 32%|███▏      | 32/100 [02:29<04:56,  4.37s/it] 33%|███▎      | 33/100 [02:33<04:53,  4.38s/it] 34%|███▍      | 34/100 [02:37<04:51,  4.42s/it] 35%|███▌      | 35/100 [02:42<04:47,  4.43s/it] 36%|███▌      | 36/100 [02:46<04:36,  4.33s/it] 37%|███▋      | 37/100 [02:50<04:30,  4.29s/it] 38%|███▊      | 38/100 [02:54<04:22,  4.23s/it] 39%|███▉      | 39/100 [02:58<04:15,  4.18s/it] 40%|████      | 40/100 [03:03<04:11,  4.19s/it] 41%|████      | 41/100 [03:07<04:10,  4.24s/it] 42%|████▏     | 42/100 [03:11<04:07,  4.26s/it] 43%|████▎     | 43/100 [03:16<04:03,  4.26s/it] 44%|████▍     | 44/100 [03:20<03:59,  4.28s/it] 45%|████▌     | 45/100 [03:24<03:54,  4.26s/it] 46%|████▌     | 46/100 [03:28<03:49,  4.25s/it] 47%|████▋     | 47/100 [03:33<03:44,  4.24s/it] 48%|████▊     | 48/100 [03:37<03:43,  4.30s/it] 49%|████▉     | 49/100 [03:41<03:34,  4.21s/it] 50%|█████     | 50/100 [03:45<03:29,  4.19s/it] 51%|█████     | 51/100 [03:49<03:24,  4.18s/it] 52%|█████▏    | 52/100 [03:53<03:21,  4.20s/it] 53%|█████▎    | 53/100 [03:58<03:15,  4.16s/it] 54%|█████▍    | 54/100 [04:02<03:09,  4.12s/it] 55%|█████▌    | 55/100 [04:06<03:08,  4.20s/it] 56%|█████▌    | 56/100 [04:10<03:05,  4.22s/it] 57%|█████▋    | 57/100 [04:14<03:02,  4.23s/it] 58%|█████▊    | 58/100 [04:19<02:55,  4.18s/it] 59%|█████▉    | 59/100 [04:23<02:51,  4.18s/it] 60%|██████    | 60/100 [04:27<02:48,  4.22s/it] 61%|██████    | 61/100 [04:31<02:45,  4.26s/it] 62%|██████▏   | 62/100 [04:36<02:45,  4.34s/it] 63%|██████▎   | 63/100 [04:40<02:39,  4.32s/it] 64%|██████▍   | 64/100 [04:44<02:33,  4.27s/it] 65%|██████▌   | 65/100 [04:49<02:32,  4.37s/it] 66%|██████▌   | 66/100 [04:53<02:29,  4.39s/it] 67%|██████▋   | 67/100 [04:58<02:23,  4.36s/it] 68%|██████▊   | 68/100 [05:02<02:18,  4.33s/it] 69%|██████▉   | 69/100 [05:06<02:16,  4.40s/it] 70%|███████   | 70/100 [05:11<02:11,  4.39s/it] 71%|███████   | 71/100 [05:15<02:06,  4.37s/it] 72%|███████▏  | 72/100 [05:19<02:01,  4.33s/it] 73%|███████▎  | 73/100 [05:24<01:55,  4.27s/it] 74%|███████▍  | 74/100 [05:28<01:50,  4.24s/it] 75%|███████▌  | 75/100 [05:32<01:45,  4.23s/it] 76%|███████▌  | 76/100 [05:37<01:44,  4.35s/it] 77%|███████▋  | 77/100 [05:41<01:40,  4.36s/it] 78%|███████▊  | 78/100 [05:45<01:35,  4.32s/it] 79%|███████▉  | 79/100 [05:50<01:31,  4.34s/it] 80%|████████  | 80/100 [05:54<01:28,  4.45s/it] 81%|████████  | 81/100 [05:59<01:27,  4.61s/it] 82%|████████▏ | 82/100 [06:04<01:23,  4.62s/it] 83%|████████▎ | 83/100 [06:09<01:19,  4.65s/it] 84%|████████▍ | 84/100 [06:13<01:15,  4.71s/it] 85%|████████▌ | 85/100 [06:18<01:09,  4.67s/it] 86%|████████▌ | 86/100 [06:23<01:05,  4.68s/it] 87%|████████▋ | 87/100 [06:27<00:59,  4.57s/it] 88%|████████▊ | 88/100 [06:31<00:53,  4.44s/it] 89%|████████▉ | 89/100 [06:36<00:49,  4.51s/it] 90%|█████████ | 90/100 [06:40<00:44,  4.47s/it] 91%|█████████ | 91/100 [06:45<00:40,  4.50s/it] 92%|█████████▏| 92/100 [06:49<00:35,  4.42s/it] 93%|█████████▎| 93/100 [06:53<00:30,  4.31s/it] 94%|█████████▍| 94/100 [06:58<00:26,  4.36s/it] 95%|█████████▌| 95/100 [07:02<00:21,  4.32s/it] 96%|█████████▌| 96/100 [07:06<00:17,  4.25s/it] 97%|█████████▋| 97/100 [07:10<00:12,  4.27s/it] 98%|█████████▊| 98/100 [07:15<00:08,  4.29s/it] 99%|█████████▉| 99/100 [07:19<00:04,  4.33s/it]100%|██████████| 100/100 [07:32<00:00,  6.89s/it]100%|██████████| 100/100 [07:32<00:00,  4.52s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-13.png]
[0/100] loss: 0.0897027999162674 loss_joints: 0.0838167667388916 loss_collision: 0.039826102554798126 loss_jerk: 0.015773996710777283 loss_floor_contact: 0.0032602481078356504
[1/100] loss: 0.048537276685237885 loss_joints: 0.04404523968696594 loss_collision: 0.02346627414226532 loss_jerk: 0.017557324841618538 loss_floor_contact: 0.0038967698346823454
[2/100] loss: 0.025090700015425682 loss_joints: 0.020257269963622093 loss_collision: 0.02070816233754158 loss_jerk: 0.015956077724695206 loss_floor_contact: 0.011670072562992573
[3/100] loss: 0.015444141812622547 loss_joints: 0.010917200706899166 loss_collision: 0.016483377665281296 loss_jerk: 0.01599443145096302 loss_floor_contact: 0.012791600078344345
[4/100] loss: 0.010585227981209755 loss_joints: 0.00614311546087265 loss_collision: 0.019102519378066063 loss_jerk: 0.01597164198756218 loss_floor_contact: 0.009346963837742805
[5/100] loss: 0.006341991480439901 loss_joints: 0.001697032479569316 loss_collision: 0.0180832426995039 loss_jerk: 0.015955012291669846 loss_floor_contact: 0.012411333620548248
[6/100] loss: 0.004927766975015402 loss_joints: 0.00043917723814956844 loss_collision: 0.018265224993228912 loss_jerk: 0.016561400145292282 loss_floor_contact: 0.010059271939098835
[7/100] loss: 0.005780432838946581 loss_joints: 0.0014518790412694216 loss_collision: 0.017974156886339188 loss_jerk: 0.01594163477420807 loss_floor_contact: 0.00936974585056305
[8/100] loss: 0.006023869384080172 loss_joints: 0.0015846120659261942 loss_collision: 0.019936000928282738 loss_jerk: 0.015941808000206947 loss_floor_contact: 0.0085147675126791
[9/100] loss: 0.005578029900789261 loss_joints: 0.0011013131588697433 loss_collision: 0.01972661167383194 loss_jerk: 0.015967857092618942 loss_floor_contact: 0.009072698652744293
[10/100] loss: 0.004825585056096315 loss_joints: 0.0005055430810898542 loss_collision: 0.01801076903939247 loss_jerk: 0.01600918173789978 loss_floor_contact: 0.009180465713143349
[11/100] loss: 0.004523733630776405 loss_joints: 4.97960536449682e-05 loss_collision: 0.017290983349084854 loss_jerk: 0.01605723798274994 loss_floor_contact: 0.011391151696443558
[12/100] loss: 0.004598898347467184 loss_joints: 7.841286424081773e-05 loss_collision: 0.01631157658994198 loss_jerk: 0.016070835292339325 loss_floor_contact: 0.012822442688047886
[13/100] loss: 0.004580480977892876 loss_joints: 0.00025141879450529814 loss_collision: 0.017411014065146446 loss_jerk: 0.016062188893556595 loss_floor_contact: 0.009817419573664665
[14/100] loss: 0.004763445351272821 loss_joints: 0.0006551340920850635 loss_collision: 0.016887005418539047 loss_jerk: 0.0160372294485569 loss_floor_contact: 0.008158880285918713
[15/100] loss: 0.004493409302085638 loss_joints: 0.00047194032231345773 loss_collision: 0.015145262703299522 loss_jerk: 0.016006479039788246 loss_floor_contact: 0.009062948636710644
[16/100] loss: 0.004433766473084688 loss_joints: 0.000223794108023867 loss_collision: 0.017401492223143578 loss_jerk: 0.01593942567706108 loss_floor_contact: 0.008758804760873318
[17/100] loss: 0.0047488040290772915 loss_joints: 0.00031890609534457326 loss_collision: 0.018161317333579063 loss_jerk: 0.01587771065533161 loss_floor_contact: 0.010259950533509254
[18/100] loss: 0.004809892270714045 loss_joints: 0.0006997807649895549 loss_collision: 0.017785679548978806 loss_jerk: 0.015816746279597282 loss_floor_contact: 0.007498688064515591
[19/100] loss: 0.004630643874406815 loss_joints: 0.0007006897358223796 loss_collision: 0.016016414389014244 loss_jerk: 0.015766149386763573 loss_floor_contact: 0.007516979705542326
[20/100] loss: 0.004415104165673256 loss_joints: 0.000471500214189291 loss_collision: 0.015624281018972397 loss_jerk: 0.01572173461318016 loss_floor_contact: 0.008090022020041943
[21/100] loss: 0.004412657581269741 loss_joints: 0.0004816282307729125 loss_collision: 0.014006467536091805 loss_jerk: 0.01568431220948696 loss_floor_contact: 0.00961951445788145
[22/100] loss: 0.004243767820298672 loss_joints: 0.0002584093890618533 loss_collision: 0.014057395048439503 loss_jerk: 0.015630735084414482 loss_floor_contact: 0.010165451094508171
[23/100] loss: 0.004164521582424641 loss_joints: 8.199455623980612e-05 loss_collision: 0.015045437030494213 loss_jerk: 0.015563920140266418 loss_floor_contact: 0.010215910151600838
[24/100] loss: 0.0038575187791138887 loss_joints: 6.138866865512682e-06 loss_collision: 0.014044057577848434 loss_jerk: 0.015479437075555325 loss_floor_contact: 0.008990306407213211
[25/100] loss: 0.0038654690142720938 loss_joints: 5.9353136748541147e-05 loss_collision: 0.015010877512395382 loss_jerk: 0.01540397573262453 loss_floor_contact: 0.007646304089576006
[26/100] loss: 0.00406865356490016 loss_joints: 0.00013072221190668643 loss_collision: 0.015314826741814613 loss_jerk: 0.015322851948440075 loss_floor_contact: 0.008741635829210281
[27/100] loss: 0.0040229870937764645 loss_joints: 0.0001363480114378035 loss_collision: 0.015301959589123726 loss_jerk: 0.015224961563944817 loss_floor_contact: 0.008339468389749527
[28/100] loss: 0.003930290229618549 loss_joints: 0.00010785169433802366 loss_collision: 0.01474719401448965 loss_jerk: 0.015132925473153591 loss_floor_contact: 0.00834426749497652
[29/100] loss: 0.003902631113305688 loss_joints: 4.5881035475758836e-05 loss_collision: 0.015132772736251354 loss_jerk: 0.01505962572991848 loss_floor_contact: 0.008375102654099464
[30/100] loss: 0.00375251192599535 loss_joints: 1.2600814443430863e-05 loss_collision: 0.015033118426799774 loss_jerk: 0.014982199296355247 loss_floor_contact: 0.007383791729807854
[31/100] loss: 0.0037781926803290844 loss_joints: 2.0199688151478767e-05 loss_collision: 0.014199397526681423 loss_jerk: 0.014911402016878128 loss_floor_contact: 0.008469129912555218
[32/100] loss: 0.004063407424837351 loss_joints: 0.00025862513575702906 loss_collision: 0.013685141690075397 loss_jerk: 0.014931409619748592 loss_floor_contact: 0.009431272745132446
[33/100] loss: 0.004241949412971735 loss_joints: 0.0003194211167283356 loss_collision: 0.014482969418168068 loss_jerk: 0.015347586944699287 loss_floor_contact: 0.009394727647304535
[34/100] loss: 0.0038397377356886864 loss_joints: 0.00020310585387051105 loss_collision: 0.01360723003745079 loss_jerk: 0.014663318172097206 loss_floor_contact: 0.008095767349004745
[35/100] loss: 0.004053286276757717 loss_joints: 0.00024312533787451684 loss_collision: 0.014461450278759003 loss_jerk: 0.015012543648481369 loss_floor_contact: 0.008627613075077534
[36/100] loss: 0.003977037500590086 loss_joints: 0.00015119783347472548 loss_collision: 0.015034805983304977 loss_jerk: 0.014500664547085762 loss_floor_contact: 0.008722927421331406
[37/100] loss: 0.0038426292594522238 loss_joints: 0.00014351526624523103 loss_collision: 0.014403329230844975 loss_jerk: 0.014385933056473732 loss_floor_contact: 0.008201876655220985
[38/100] loss: 0.0037873219698667526 loss_joints: 0.00010492188448552042 loss_collision: 0.015460041351616383 loss_jerk: 0.014254983514547348 loss_floor_contact: 0.007108976133167744
[39/100] loss: 0.003634115681052208 loss_joints: 3.6369623558130115e-05 loss_collision: 0.015451372601091862 loss_jerk: 0.014134814031422138 loss_floor_contact: 0.006391273811459541
[40/100] loss: 0.0036596436984837055 loss_joints: 1.52715620060917e-05 loss_collision: 0.015661107376217842 loss_jerk: 0.014023629948496819 loss_floor_contact: 0.00675898278132081
[41/100] loss: 0.0038206742610782385 loss_joints: 0.00021555315470322967 loss_collision: 0.01514365989714861 loss_jerk: 0.014041750691831112 loss_floor_contact: 0.006865800358355045
[42/100] loss: 0.003904705634340644 loss_joints: 0.0004514874308370054 loss_collision: 0.013756358064711094 loss_jerk: 0.013932684436440468 loss_floor_contact: 0.006843136623501778
[43/100] loss: 0.0039374022744596004 loss_joints: 0.0004422494675964117 loss_collision: 0.014649521559476852 loss_jerk: 0.01368936151266098 loss_floor_contact: 0.006612647324800491
[44/100] loss: 0.0037852765526622534 loss_joints: 0.0002545931492932141 loss_collision: 0.01445130817592144 loss_jerk: 0.013586701825261116 loss_floor_contact: 0.007268824148923159
[45/100] loss: 0.0037029616069048643 loss_joints: 0.00011101704149041325 loss_collision: 0.014151209965348244 loss_jerk: 0.013497117906808853 loss_floor_contact: 0.008271116763353348
[46/100] loss: 0.003476412734016776 loss_joints: 2.9202730729593895e-05 loss_collision: 0.014631598256528378 loss_jerk: 0.0134183494374156 loss_floor_contact: 0.006422150414437056
[47/100] loss: 0.003392842598259449 loss_joints: 6.734410362696508e-07 loss_collision: 0.01382925920188427 loss_jerk: 0.013726791366934776 loss_floor_contact: 0.006365640554577112
[48/100] loss: 0.00329286465421319 loss_joints: 8.100321792881005e-06 loss_collision: 0.013051704503595829 loss_jerk: 0.013941810466349125 loss_floor_contact: 0.005854128394275904
[49/100] loss: 0.003479583188891411 loss_joints: 2.493994907126762e-05 loss_collision: 0.01462799683213234 loss_jerk: 0.013830422423779964 loss_floor_contact: 0.006088010501116514
[50/100] loss: 0.003335505723953247 loss_joints: 1.5071211237227544e-05 loss_collision: 0.013842768967151642 loss_jerk: 0.013725419528782368 loss_floor_contact: 0.005636155605316162
[51/100] loss: 0.0032613512594252825 loss_joints: 3.8141115510370582e-06 loss_collision: 0.013530616648495197 loss_jerk: 0.013596320524811745 loss_floor_contact: 0.005448434501886368
[52/100] loss: 0.003335058456286788 loss_joints: 1.7793225197237916e-05 loss_collision: 0.013378587551414967 loss_jerk: 0.01341012679040432 loss_floor_contact: 0.006383939180523157
[53/100] loss: 0.0031503515783697367 loss_joints: 3.42440398526378e-05 loss_collision: 0.01285255141556263 loss_jerk: 0.01308942586183548 loss_floor_contact: 0.005219096317887306
[54/100] loss: 0.0030857776291668415 loss_joints: 3.816861499217339e-05 loss_collision: 0.012601885013282299 loss_jerk: 0.012969180941581726 loss_floor_contact: 0.0049050250090658665
[55/100] loss: 0.0033083963207900524 loss_joints: 3.724412090377882e-05 loss_collision: 0.01355219166725874 loss_jerk: 0.012924996204674244 loss_floor_contact: 0.006234333850443363
[56/100] loss: 0.0033113223034888506 loss_joints: 2.7041553039452992e-05 loss_collision: 0.013921423815190792 loss_jerk: 0.012876243330538273 loss_floor_contact: 0.006045140326023102
[57/100] loss: 0.0032325549982488155 loss_joints: 4.57554369859281e-06 loss_collision: 0.013417876325547695 loss_jerk: 0.012817081063985825 loss_floor_contact: 0.0060448371805250645
[58/100] loss: 0.003162260865792632 loss_joints: 1.0507766091905069e-05 loss_collision: 0.012717950157821178 loss_jerk: 0.012764002196490765 loss_floor_contact: 0.006035577040165663
[59/100] loss: 0.0032530815806239843 loss_joints: 5.662784678861499e-05 loss_collision: 0.013464928604662418 loss_jerk: 0.01269920077174902 loss_floor_contact: 0.005800405517220497
[60/100] loss: 0.003241757396608591 loss_joints: 5.92823198530823e-05 loss_collision: 0.013398605398833752 loss_jerk: 0.012757479213178158 loss_floor_contact: 0.0056686666794121265
[61/100] loss: 0.0030940615106374025 loss_joints: 2.113610753440298e-05 loss_collision: 0.012759272940456867 loss_jerk: 0.01265592873096466 loss_floor_contact: 0.005314051639288664
[62/100] loss: 0.003150154370814562 loss_joints: 2.5052639102796093e-05 loss_collision: 0.013071123510599136 loss_jerk: 0.012652565725147724 loss_floor_contact: 0.00552732590585947
[63/100] loss: 0.0032135245855897665 loss_joints: 5.3269119234755635e-05 loss_collision: 0.013218043372035027 loss_jerk: 0.012899715453386307 loss_floor_contact: 0.005484796594828367
[64/100] loss: 0.003123378846794367 loss_joints: 4.785660348716192e-05 loss_collision: 0.012249439023435116 loss_jerk: 0.012909390963613987 loss_floor_contact: 0.005596392787992954
[65/100] loss: 0.0032691601663827896 loss_joints: 7.174404163379222e-05 loss_collision: 0.013179592788219452 loss_jerk: 0.012941253371536732 loss_floor_contact: 0.005853314884006977
[66/100] loss: 0.003208387643098831 loss_joints: 4.763258039020002e-05 loss_collision: 0.013105076737701893 loss_jerk: 0.012768500484526157 loss_floor_contact: 0.005733972415328026
[67/100] loss: 0.003185547422617674 loss_joints: 5.04793570144102e-05 loss_collision: 0.012923127971589565 loss_jerk: 0.012764801271259785 loss_floor_contact: 0.005662749987095594
[68/100] loss: 0.003104801755398512 loss_joints: 2.137449882866349e-05 loss_collision: 0.012847469188272953 loss_jerk: 0.012696698307991028 loss_floor_contact: 0.005290104076266289
[69/100] loss: 0.00309551227837801 loss_joints: 8.670922397868708e-06 loss_collision: 0.013346027582883835 loss_jerk: 0.01242804154753685 loss_floor_contact: 0.005094343796372414
[70/100] loss: 0.0031040385365486145 loss_joints: 7.637223461642861e-05 loss_collision: 0.012788968160748482 loss_jerk: 0.012353952042758465 loss_floor_contact: 0.005133743863552809
[71/100] loss: 0.0031223236583173275 loss_joints: 0.00012890758807770908 loss_collision: 0.01291229110211134 loss_jerk: 0.012336707673966885 loss_floor_contact: 0.004685162100940943
[72/100] loss: 0.003103903727605939 loss_joints: 0.00010876034502871335 loss_collision: 0.013207335956394672 loss_jerk: 0.012322400696575642 loss_floor_contact: 0.004421697463840246
[73/100] loss: 0.0030618570744991302 loss_joints: 5.198105645831674e-05 loss_collision: 0.012481817975640297 loss_jerk: 0.012311196886003017 loss_floor_contact: 0.005305745638906956
[74/100] loss: 0.003157021477818489 loss_joints: 1.2040777619404253e-05 loss_collision: 0.013376662507653236 loss_jerk: 0.01239396445453167 loss_floor_contact: 0.0056791785173118114
[75/100] loss: 0.0029584344010800123 loss_joints: 1.5687888662796468e-05 loss_collision: 0.012671205215156078 loss_jerk: 0.012426232919096947 loss_floor_contact: 0.004330025520175695
[76/100] loss: 0.0031585320830345154 loss_joints: 7.546848792117089e-05 loss_collision: 0.013031713664531708 loss_jerk: 0.012393588200211525 loss_floor_contact: 0.005405334755778313
[77/100] loss: 0.003253677859902382 loss_joints: 0.00014478615776170045 loss_collision: 0.013694883324205875 loss_jerk: 0.012299771420657635 loss_floor_contact: 0.00509426137432456
[78/100] loss: 0.003214194905012846 loss_joints: 0.00018591288244351745 loss_collision: 0.013320695608854294 loss_jerk: 0.012295565567910671 loss_floor_contact: 0.0046665603294968605
[79/100] loss: 0.0032459304202347994 loss_joints: 0.00018792308401316404 loss_collision: 0.01350594311952591 loss_jerk: 0.012287956662476063 loss_floor_contact: 0.004786171950399876
[80/100] loss: 0.0031273276545107365 loss_joints: 0.00014865600678604096 loss_collision: 0.012404920533299446 loss_jerk: 0.012275302782654762 loss_floor_contact: 0.00510649336501956
[81/100] loss: 0.003154576290398836 loss_joints: 9.675853652879596e-05 loss_collision: 0.013152829371392727 loss_jerk: 0.012258576229214668 loss_floor_contact: 0.005166773684322834
[82/100] loss: 0.0030540074221789837 loss_joints: 5.312283610692248e-05 loss_collision: 0.01317379530519247 loss_jerk: 0.012240304611623287 loss_floor_contact: 0.004594744183123112
[83/100] loss: 0.003016427159309387 loss_joints: 4.5857170334784314e-05 loss_collision: 0.01296439953148365 loss_jerk: 0.012220043689012527 loss_floor_contact: 0.0045212553814053535
[84/100] loss: 0.0030488830525428057 loss_joints: 5.484985013026744e-05 loss_collision: 0.013110958971083164 loss_jerk: 0.012201455421745777 loss_floor_contact: 0.0046279169619083405
[85/100] loss: 0.0029560786206275225 loss_joints: 7.337823626585305e-05 loss_collision: 0.011630576103925705 loss_jerk: 0.012182443402707577 loss_floor_contact: 0.005013985093683004
[86/100] loss: 0.002965562744066119 loss_joints: 9.280029917135835e-05 loss_collision: 0.011672803200781345 loss_jerk: 0.012165743857622147 loss_floor_contact: 0.004889077041298151
[87/100] loss: 0.0030334133189171553 loss_joints: 0.00010022382775787264 loss_collision: 0.012372709810733795 loss_jerk: 0.012149451300501823 loss_floor_contact: 0.004809734411537647
[88/100] loss: 0.0030305557884275913 loss_joints: 9.110609244089574e-05 loss_collision: 0.012604325078427792 loss_jerk: 0.012134404852986336 loss_floor_contact: 0.0046557653695344925
[89/100] loss: 0.0029872669838368893 loss_joints: 7.377743895631284e-05 loss_collision: 0.012580351904034615 loss_jerk: 0.012131120078265667 loss_floor_contact: 0.004423424601554871
[90/100] loss: 0.0029756014700978994 loss_joints: 7.178145460784435e-05 loss_collision: 0.01238242257386446 loss_jerk: 0.012128762900829315 loss_floor_contact: 0.004527014214545488
[91/100] loss: 0.002969050779938698 loss_joints: 7.862743950681761e-05 loss_collision: 0.012617458589375019 loss_jerk: 0.012106114998459816 loss_floor_contact: 0.004180657211691141
[92/100] loss: 0.002978726988658309 loss_joints: 9.403748845215887e-05 loss_collision: 0.012218385003507137 loss_jerk: 0.012093779630959034 loss_floor_contact: 0.004534728359431028
[93/100] loss: 0.002980978460982442 loss_joints: 9.637161565478891e-05 loss_collision: 0.012353727594017982 loss_jerk: 0.012087828479707241 loss_floor_contact: 0.0044045099057257175
[94/100] loss: 0.00297460681758821 loss_joints: 8.748587424634025e-05 loss_collision: 0.012438330799341202 loss_jerk: 0.01208318118005991 loss_floor_contact: 0.0043496983125805855
[95/100] loss: 0.002931445138528943 loss_joints: 7.37338705221191e-05 loss_collision: 0.012460452504456043 loss_jerk: 0.012079817242920399 loss_floor_contact: 0.0040368433110415936
[96/100] loss: 0.002898580627515912 loss_joints: 6.869946810184047e-05 loss_collision: 0.011938078328967094 loss_jerk: 0.012076680548489094 loss_floor_contact: 0.004284053575247526
[97/100] loss: 0.002955628326162696 loss_joints: 6.27969711786136e-05 loss_collision: 0.012653996236622334 loss_jerk: 0.012073295190930367 loss_floor_contact: 0.004201021045446396
[98/100] loss: 0.0029324046336114407 loss_joints: 6.110875256126747e-05 loss_collision: 0.012297450564801693 loss_jerk: 0.012070725671947002 loss_floor_contact: 0.004344782792031765
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-13.png]
[99/100] loss: 0.002901180647313595 loss_joints: 6.156174640636891e-05 loss_collision: 0.01206439919769764 loss_jerk: 0.012069185264408588 loss_floor_contact: 0.004262604750692844
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path1-walk12-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 452.33232                                                    ║
    ║     rollout = 202.15393                                                    ║
    ║     sdf     = 35.49740                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00290118                                                 ║
    ║     joints    = 0.00006156                                                 ║
    ║     collision = 0.01206440                                                 ║
    ║     jerk      = 0.01206919                                                 ║
    ║     floor     = 0.00426260                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	7m53.277s
user	7m18.054s
sys	0m28.832s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x61df8a92ac00] using SAR=1/1
[libx264 @ 0x61df8a92ac00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x61df8a92ac00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x61df8a92ac00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_walk_12.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x61df8a928fc0] video:167kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.687745%
frame=   25 fps=0.0 q=-1.0 Lsize=     168kB time=00:00:02.20 bitrate= 626.6kbits/s speed=3.28x    
[libx264 @ 0x61df8a92ac00] frame I:1     Avg QP:18.22  size: 73851
[libx264 @ 0x61df8a92ac00] frame P:8     Avg QP:20.50  size:  8934
[libx264 @ 0x61df8a92ac00] frame B:16    Avg QP:22.33  size:  1570
[libx264 @ 0x61df8a92ac00] consecutive B-frames: 12.0%  8.0%  0.0% 80.0%
[libx264 @ 0x61df8a92ac00] mb I  I16..4:  3.9% 65.4% 30.6%
[libx264 @ 0x61df8a92ac00] mb P  I16..4:  0.2%  1.7%  1.7%  P16..4:  8.7%  2.1%  1.2%  0.0%  0.0%    skip:84.4%
[libx264 @ 0x61df8a92ac00] mb B  I16..4:  0.1%  0.3%  0.1%  B16..8:  9.6%  0.8%  0.3%  direct: 0.4%  skip:88.4%  L0:53.0% L1:43.1% BI: 4.0%
[libx264 @ 0x61df8a92ac00] 8x8 transform intra:61.7% inter:57.4%
[libx264 @ 0x61df8a92ac00] coded y,uvDC,uvAC intra: 30.6% 19.3% 18.2% inter: 2.4% 2.6% 0.7%
[libx264 @ 0x61df8a92ac00] i16 v,h,dc,p: 51% 29% 19%  0%
[libx264 @ 0x61df8a92ac00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 54%  8% 33%  1%  1%  1%  1%  1%  1%
[libx264 @ 0x61df8a92ac00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 35% 23% 13%  5%  4%  4%  4%  9%  3%
[libx264 @ 0x61df8a92ac00] i8c dc,h,v,p: 89%  2%  6%  3%
[libx264 @ 0x61df8a92ac00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x61df8a92ac00] ref P L0: 57.8% 19.8% 13.1%  9.3%
[libx264 @ 0x61df8a92ac00] ref B L0: 84.5%  9.4%  6.2%
[libx264 @ 0x61df8a92ac00] ref B L1: 90.0% 10.0%
[libx264 @ 0x61df8a92ac00] kb/s:545.44
[INFO] Video saved as 'bin/result/optim_walk_12.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 26 = (8*3 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:32,  3.97s/it]  2%|▏         | 2/100 [00:04<03:38,  2.23s/it]  3%|▎         | 3/100 [00:06<03:10,  1.97s/it]  4%|▍         | 4/100 [00:07<02:34,  1.61s/it]  5%|▌         | 5/100 [00:08<02:12,  1.39s/it]  6%|▌         | 6/100 [00:09<02:00,  1.29s/it]  7%|▋         | 7/100 [00:10<01:53,  1.22s/it]  8%|▊         | 8/100 [00:11<01:48,  1.17s/it]  9%|▉         | 9/100 [00:13<01:43,  1.14s/it] 10%|█         | 10/100 [00:14<01:40,  1.12s/it] 11%|█         | 11/100 [00:15<01:38,  1.10s/it] 12%|█▏        | 12/100 [00:16<01:42,  1.17s/it] 13%|█▎        | 13/100 [00:17<01:36,  1.11s/it] 14%|█▍        | 14/100 [00:18<01:34,  1.09s/it] 15%|█▌        | 15/100 [00:19<01:32,  1.09s/it] 16%|█▌        | 16/100 [00:20<01:30,  1.07s/it] 17%|█▋        | 17/100 [00:21<01:28,  1.07s/it] 18%|█▊        | 18/100 [00:22<01:27,  1.07s/it] 19%|█▉        | 19/100 [00:23<01:26,  1.07s/it] 20%|██        | 20/100 [00:24<01:24,  1.06s/it] 21%|██        | 21/100 [00:25<01:23,  1.06s/it] 22%|██▏       | 22/100 [00:27<01:23,  1.07s/it] 23%|██▎       | 23/100 [00:28<01:22,  1.07s/it] 24%|██▍       | 24/100 [00:29<01:20,  1.06s/it] 25%|██▌       | 25/100 [00:30<01:19,  1.06s/it] 26%|██▌       | 26/100 [00:31<01:18,  1.06s/it] 27%|██▋       | 27/100 [00:32<01:17,  1.06s/it] 28%|██▊       | 28/100 [00:33<01:17,  1.08s/it] 29%|██▉       | 29/100 [00:34<01:16,  1.07s/it] 30%|███       | 30/100 [00:35<01:16,  1.09s/it] 31%|███       | 31/100 [00:36<01:15,  1.10s/it] 32%|███▏      | 32/100 [00:37<01:14,  1.10s/it] 33%|███▎      | 33/100 [00:38<01:13,  1.09s/it] 34%|███▍      | 34/100 [00:39<01:12,  1.10s/it] 35%|███▌      | 35/100 [00:41<01:11,  1.09s/it] 36%|███▌      | 36/100 [00:42<01:10,  1.10s/it] 37%|███▋      | 37/100 [00:43<01:08,  1.09s/it] 38%|███▊      | 38/100 [00:44<01:07,  1.09s/it] 39%|███▉      | 39/100 [00:45<01:06,  1.09s/it] 40%|████      | 40/100 [00:46<01:05,  1.09s/it] 41%|████      | 41/100 [00:47<01:04,  1.09s/it] 42%|████▏     | 42/100 [00:48<01:03,  1.09s/it] 43%|████▎     | 43/100 [00:49<01:01,  1.08s/it] 44%|████▍     | 44/100 [00:50<00:59,  1.07s/it] 45%|████▌     | 45/100 [00:51<00:59,  1.08s/it] 46%|████▌     | 46/100 [00:53<00:58,  1.08s/it] 47%|████▋     | 47/100 [00:54<00:57,  1.08s/it] 48%|████▊     | 48/100 [00:55<00:56,  1.09s/it] 49%|████▉     | 49/100 [00:56<00:55,  1.09s/it] 50%|█████     | 50/100 [00:57<00:54,  1.09s/it] 51%|█████     | 51/100 [00:58<00:53,  1.09s/it] 52%|█████▏    | 52/100 [00:59<00:52,  1.09s/it] 53%|█████▎    | 53/100 [01:00<00:51,  1.09s/it] 54%|█████▍    | 54/100 [01:01<00:50,  1.11s/it] 55%|█████▌    | 55/100 [01:03<00:52,  1.16s/it] 56%|█████▌    | 56/100 [01:04<00:49,  1.13s/it] 57%|█████▋    | 57/100 [01:05<00:48,  1.12s/it] 58%|█████▊    | 58/100 [01:06<00:46,  1.10s/it] 59%|█████▉    | 59/100 [01:07<00:44,  1.10s/it] 60%|██████    | 60/100 [01:08<00:43,  1.09s/it] 61%|██████    | 61/100 [01:09<00:42,  1.09s/it] 62%|██████▏   | 62/100 [01:10<00:41,  1.08s/it] 63%|██████▎   | 63/100 [01:11<00:40,  1.09s/it] 64%|██████▍   | 64/100 [01:12<00:39,  1.09s/it] 65%|██████▌   | 65/100 [01:13<00:38,  1.09s/it] 66%|██████▌   | 66/100 [01:14<00:36,  1.09s/it] 67%|██████▋   | 67/100 [01:16<00:36,  1.10s/it] 68%|██████▊   | 68/100 [01:17<00:34,  1.09s/it] 69%|██████▉   | 69/100 [01:18<00:33,  1.09s/it] 70%|███████   | 70/100 [01:19<00:32,  1.08s/it] 71%|███████   | 71/100 [01:20<00:31,  1.08s/it] 72%|███████▏  | 72/100 [01:21<00:30,  1.08s/it] 73%|███████▎  | 73/100 [01:22<00:29,  1.08s/it] 74%|███████▍  | 74/100 [01:23<00:27,  1.07s/it] 75%|███████▌  | 75/100 [01:24<00:26,  1.07s/it] 76%|███████▌  | 76/100 [01:25<00:26,  1.09s/it] 77%|███████▋  | 77/100 [01:26<00:25,  1.09s/it] 78%|███████▊  | 78/100 [01:28<00:24,  1.11s/it] 79%|███████▉  | 79/100 [01:29<00:23,  1.11s/it] 80%|████████  | 80/100 [01:30<00:22,  1.11s/it] 81%|████████  | 81/100 [01:31<00:20,  1.10s/it] 82%|████████▏ | 82/100 [01:32<00:19,  1.08s/it] 83%|████████▎ | 83/100 [01:33<00:18,  1.09s/it] 84%|████████▍ | 84/100 [01:34<00:17,  1.09s/it] 85%|████████▌ | 85/100 [01:35<00:16,  1.08s/it] 86%|████████▌ | 86/100 [01:36<00:15,  1.09s/it] 87%|████████▋ | 87/100 [01:37<00:14,  1.08s/it] 88%|████████▊ | 88/100 [01:38<00:12,  1.07s/it] 89%|████████▉ | 89/100 [01:39<00:11,  1.07s/it] 90%|█████████ | 90/100 [01:40<00:10,  1.07s/it] 91%|█████████ | 91/100 [01:42<00:09,  1.08s/it] 92%|█████████▏| 92/100 [01:43<00:08,  1.09s/it] 93%|█████████▎| 93/100 [01:44<00:07,  1.09s/it] 94%|█████████▍| 94/100 [01:45<00:06,  1.08s/it] 95%|█████████▌| 95/100 [01:46<00:05,  1.07s/it] 96%|█████████▌| 96/100 [01:47<00:04,  1.07s/it] 97%|█████████▋| 97/100 [01:48<00:03,  1.07s/it] 98%|█████████▊| 98/100 [01:49<00:02,  1.07s/it] 99%|█████████▉| 99/100 [01:50<00:01,  1.07s/it]100%|██████████| 100/100 [01:54<00:00,  1.87s/it]100%|██████████| 100/100 [01:54<00:00,  1.14s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-4.png]
[0/100] loss: 0.06940323859453201 loss_joints: 0.05728752166032791 loss_collision: 0.06164092198014259 loss_jerk: 0.0485086590051651 loss_floor_contact: 0.011007603257894516
[1/100] loss: 0.055047355592250824 loss_joints: 0.042941801249980927 loss_collision: 0.05861956253647804 loss_jerk: 0.051709990948438644 loss_floor_contact: 0.010726016946136951
[2/100] loss: 0.04622163996100426 loss_joints: 0.03424040600657463 loss_collision: 0.05504574999213219 loss_jerk: 0.054184690117836 loss_floor_contact: 0.010581918992102146
[3/100] loss: 0.03903387486934662 loss_joints: 0.026947923004627228 loss_collision: 0.04733113944530487 loss_jerk: 0.06163384020328522 loss_floor_contact: 0.011894519440829754
[4/100] loss: 0.033381279557943344 loss_joints: 0.019839487969875336 loss_collision: 0.05241890996694565 loss_jerk: 0.06900513917207718 loss_floor_contact: 0.013993850909173489
[5/100] loss: 0.03174025937914848 loss_joints: 0.018113581463694572 loss_collision: 0.05315256118774414 loss_jerk: 0.068599633872509 loss_floor_contact: 0.014514552429318428
[6/100] loss: 0.028979361057281494 loss_joints: 0.015286777168512344 loss_collision: 0.05324147641658783 loss_jerk: 0.06759130954742432 loss_floor_contact: 0.016093045473098755
[7/100] loss: 0.027806172147393227 loss_joints: 0.013954933732748032 loss_collision: 0.054923903197050095 loss_jerk: 0.06634438782930374 loss_floor_contact: 0.01724408194422722
[8/100] loss: 0.026011262089014053 loss_joints: 0.012206044048070908 loss_collision: 0.05563659965991974 loss_jerk: 0.06563465297222137 loss_floor_contact: 0.0167809147387743
[9/100] loss: 0.024014417082071304 loss_joints: 0.010345077142119408 loss_collision: 0.055886391550302505 loss_jerk: 0.0654025748372078 loss_floor_contact: 0.015404426492750645
[10/100] loss: 0.024166082963347435 loss_joints: 0.010187925770878792 loss_collision: 0.058891989290714264 loss_jerk: 0.06493315100669861 loss_floor_contact: 0.01595642976462841
[11/100] loss: 0.024040335789322853 loss_joints: 0.01007003802806139 loss_collision: 0.06051810458302498 loss_jerk: 0.0631910115480423 loss_floor_contact: 0.015993839129805565
[12/100] loss: 0.021858127787709236 loss_joints: 0.008046083152294159 loss_collision: 0.06028054282069206 loss_jerk: 0.06354860961437225 loss_floor_contact: 0.014291287399828434
[13/100] loss: 0.019582577049732208 loss_joints: 0.006234644912183285 loss_collision: 0.056217994540929794 loss_jerk: 0.062018804252147675 loss_floor_contact: 0.015242520719766617
[14/100] loss: 0.018543720245361328 loss_joints: 0.005584173835813999 loss_collision: 0.05312313884496689 loss_jerk: 0.06051471084356308 loss_floor_contact: 0.015957608819007874
[15/100] loss: 0.017964810132980347 loss_joints: 0.005195083096623421 loss_collision: 0.05209334194660187 loss_jerk: 0.059723567217588425 loss_floor_contact: 0.01588035374879837
[16/100] loss: 0.017245877534151077 loss_joints: 0.004552103579044342 loss_collision: 0.05173180624842644 loss_jerk: 0.059215761721134186 loss_floor_contact: 0.015990175306797028
[17/100] loss: 0.01583300344645977 loss_joints: 0.0037082023918628693 loss_collision: 0.046101316809654236 loss_jerk: 0.058859072625637054 loss_floor_contact: 0.016287606209516525
[18/100] loss: 0.014492633752524853 loss_joints: 0.0028364122845232487 loss_collision: 0.041990939527750015 loss_jerk: 0.0580112524330616 loss_floor_contact: 0.016560019925236702
[19/100] loss: 0.014192729257047176 loss_joints: 0.0025184236001223326 loss_collision: 0.04462850093841553 loss_jerk: 0.05632947385311127 loss_floor_contact: 0.01578506827354431
[20/100] loss: 0.013895208947360516 loss_joints: 0.0024141576141119003 loss_collision: 0.045517448335886 loss_jerk: 0.05454814434051514 loss_floor_contact: 0.014744914136826992
[21/100] loss: 0.01316023338586092 loss_joints: 0.0018466783221811056 loss_collision: 0.046551138162612915 loss_jerk: 0.05193699151277542 loss_floor_contact: 0.01464742049574852
[22/100] loss: 0.012480388395488262 loss_joints: 0.000896407465916127 loss_collision: 0.05130999907851219 loss_jerk: 0.04907052591443062 loss_floor_contact: 0.015459282323718071
[23/100] loss: 0.011851223185658455 loss_joints: 0.0003337527741678059 loss_collision: 0.04587874561548233 loss_jerk: 0.04949459433555603 loss_floor_contact: 0.01980135776102543
[24/100] loss: 0.011777026578783989 loss_joints: 0.00022222926781978458 loss_collision: 0.047470442950725555 loss_jerk: 0.04829712212085724 loss_floor_contact: 0.01978040114045143
[25/100] loss: 0.010691817849874496 loss_joints: 0.00020678900182247162 loss_collision: 0.040330179035663605 loss_jerk: 0.04320110008120537 loss_floor_contact: 0.021319003775715828
[26/100] loss: 0.011195342987775803 loss_joints: 0.000155959976837039 loss_collision: 0.041535940021276474 loss_jerk: 0.044129498302936554 loss_floor_contact: 0.02472839131951332
[27/100] loss: 0.01094987615942955 loss_joints: 0.0001377044536639005 loss_collision: 0.03845745325088501 loss_jerk: 0.04441961646080017 loss_floor_contact: 0.02524464577436447
[28/100] loss: 0.01100276317447424 loss_joints: 0.00012981894542463124 loss_collision: 0.04259616136550903 loss_jerk: 0.044132523238658905 loss_floor_contact: 0.02200075052678585
[29/100] loss: 0.010962503962218761 loss_joints: 0.00014799325435888022 loss_collision: 0.04517654329538345 loss_jerk: 0.0435558557510376 loss_floor_contact: 0.019412700086832047
[30/100] loss: 0.011160208843648434 loss_joints: 0.00020467574358917773 loss_collision: 0.04495757818222046 loss_jerk: 0.04436296224594116 loss_floor_contact: 0.020234782248735428
[31/100] loss: 0.011007009074091911 loss_joints: 0.00024743552785366774 loss_collision: 0.043337881565093994 loss_jerk: 0.04395199567079544 loss_floor_contact: 0.02030586265027523
[32/100] loss: 0.010832863859832287 loss_joints: 0.00024256666074506938 loss_collision: 0.04358382895588875 loss_jerk: 0.04334937036037445 loss_floor_contact: 0.018969761207699776
[33/100] loss: 0.010694066062569618 loss_joints: 0.0001906779216369614 loss_collision: 0.04362347349524498 loss_jerk: 0.04386899992823601 loss_floor_contact: 0.01754140481352806
[34/100] loss: 0.010354453697800636 loss_joints: 0.000146685735671781 loss_collision: 0.04048864170908928 loss_jerk: 0.04418208822607994 loss_floor_contact: 0.017406949773430824
[35/100] loss: 0.010483643040060997 loss_joints: 0.00013144247350282967 loss_collision: 0.04189186170697212 loss_jerk: 0.044269926846027374 loss_floor_contact: 0.017360204830765724
[36/100] loss: 0.010507340542972088 loss_joints: 0.00013738822599407285 loss_collision: 0.04279407113790512 loss_jerk: 0.044218819588422775 loss_floor_contact: 0.016686629503965378
[37/100] loss: 0.010347758419811726 loss_joints: 0.0001592139306012541 loss_collision: 0.04230264946818352 loss_jerk: 0.04406771808862686 loss_floor_contact: 0.015515083447098732
[38/100] loss: 0.010117913596332073 loss_joints: 0.00019144316320307553 loss_collision: 0.041354864835739136 loss_jerk: 0.043727900832891464 loss_floor_contact: 0.014181934297084808
[39/100] loss: 0.010081642307341099 loss_joints: 0.00023672023962717503 loss_collision: 0.04148825258016586 loss_jerk: 0.04337046295404434 loss_floor_contact: 0.013590501621365547
[40/100] loss: 0.009904855862259865 loss_joints: 0.0002761893847491592 loss_collision: 0.03981000930070877 loss_jerk: 0.04354555159807205 loss_floor_contact: 0.012931101955473423
[41/100] loss: 0.00996263325214386 loss_joints: 0.00033363676629960537 loss_collision: 0.04009305685758591 loss_jerk: 0.043906524777412415 loss_floor_contact: 0.012290380895137787
[42/100] loss: 0.009738133288919926 loss_joints: 0.00033998250728473067 loss_collision: 0.0380956269800663 loss_jerk: 0.0447838194668293 loss_floor_contact: 0.011102061718702316
[43/100] loss: 0.010239341296255589 loss_joints: 0.0003185454406775534 loss_collision: 0.04160569608211517 loss_jerk: 0.04587094858288765 loss_floor_contact: 0.011731323786079884
[44/100] loss: 0.010322995483875275 loss_joints: 0.0003023113531526178 loss_collision: 0.04148339107632637 loss_jerk: 0.04606996476650238 loss_floor_contact: 0.012653479352593422
[45/100] loss: 0.009759639389812946 loss_joints: 0.0002790269209071994 loss_collision: 0.03741668164730072 loss_jerk: 0.04559947922825813 loss_floor_contact: 0.01178995706140995
[46/100] loss: 0.009571020491421223 loss_joints: 0.0002688454696908593 loss_collision: 0.03816623613238335 loss_jerk: 0.04453321173787117 loss_floor_contact: 0.010322305373847485
[47/100] loss: 0.009556557051837444 loss_joints: 0.00029750584508292377 loss_collision: 0.03816685080528259 loss_jerk: 0.043814558535814285 loss_floor_contact: 0.010609094984829426
[48/100] loss: 0.009825348854064941 loss_joints: 0.000293718563625589 loss_collision: 0.04016406834125519 loss_jerk: 0.04397423937916756 loss_floor_contact: 0.011177996173501015
[49/100] loss: 0.009283569641411304 loss_joints: 0.0002405577979516238 loss_collision: 0.03501109406352043 loss_jerk: 0.04450874775648117 loss_floor_contact: 0.010910277254879475
[50/100] loss: 0.009284663014113903 loss_joints: 0.00015920029545668513 loss_collision: 0.03507208824157715 loss_jerk: 0.04534471407532692 loss_floor_contact: 0.010837828740477562
[51/100] loss: 0.009892161935567856 loss_joints: 0.00012950549717061222 loss_collision: 0.040619250386953354 loss_jerk: 0.04570022597908974 loss_floor_contact: 0.01130708772689104
[52/100] loss: 0.009473960846662521 loss_joints: 0.00013389256491791457 loss_collision: 0.03678101301193237 loss_jerk: 0.04563956707715988 loss_floor_contact: 0.010980094783008099
[53/100] loss: 0.00961153395473957 loss_joints: 0.0001716904080240056 loss_collision: 0.038649316877126694 loss_jerk: 0.04521362856030464 loss_floor_contact: 0.01053548976778984
[54/100] loss: 0.009561539627611637 loss_joints: 0.00024301360826939344 loss_collision: 0.037780486047267914 loss_jerk: 0.04448023438453674 loss_floor_contact: 0.010924536734819412
[55/100] loss: 0.009348016232252121 loss_joints: 0.0003078498994000256 loss_collision: 0.03538335859775543 loss_jerk: 0.04379059746861458 loss_floor_contact: 0.011227710172533989
[56/100] loss: 0.00960129126906395 loss_joints: 0.00031014985870569944 loss_collision: 0.03868672996759415 loss_jerk: 0.04352791979908943 loss_floor_contact: 0.010696765966713428
[57/100] loss: 0.009451333433389664 loss_joints: 0.0002569332136772573 loss_collision: 0.038655299693346024 loss_jerk: 0.043621357530355453 loss_floor_contact: 0.009667354635894299
[58/100] loss: 0.009368717670440674 loss_joints: 0.000173588574398309 loss_collision: 0.03874380514025688 loss_jerk: 0.04400798678398132 loss_floor_contact: 0.009199492633342743
[59/100] loss: 0.009519587270915508 loss_joints: 9.718892397359014e-05 loss_collision: 0.03871733322739601 loss_jerk: 0.04460611194372177 loss_floor_contact: 0.010900530964136124
[60/100] loss: 0.009507761336863041 loss_joints: 7.187768642324954e-05 loss_collision: 0.03709392994642258 loss_jerk: 0.044829513877630234 loss_floor_contact: 0.012435389682650566
[61/100] loss: 0.00968462135642767 loss_joints: 6.904603651491925e-05 loss_collision: 0.038998354226350784 loss_jerk: 0.044764187186956406 loss_floor_contact: 0.01239321380853653
[62/100] loss: 0.009485009126365185 loss_joints: 8.439434168394655e-05 loss_collision: 0.03856004774570465 loss_jerk: 0.04444703087210655 loss_floor_contact: 0.010999067686498165
[63/100] loss: 0.009243553504347801 loss_joints: 0.00012123057240387425 loss_collision: 0.03784850612282753 loss_jerk: 0.04399319365620613 loss_floor_contact: 0.00938152614980936
[64/100] loss: 0.009425747208297253 loss_joints: 0.00018098283908329904 loss_collision: 0.04004649445414543 loss_jerk: 0.04349898919463158 loss_floor_contact: 0.008902154862880707
[65/100] loss: 0.009061400778591633 loss_joints: 0.00021208210091572255 loss_collision: 0.03588709980249405 loss_jerk: 0.04332420602440834 loss_floor_contact: 0.00928187370300293
[66/100] loss: 0.009105333127081394 loss_joints: 0.00020782428327947855 loss_collision: 0.036047570407390594 loss_jerk: 0.04343155771493912 loss_floor_contact: 0.009495963342487812
[67/100] loss: 0.009168384596705437 loss_joints: 0.00017767224926501513 loss_collision: 0.0369131825864315 loss_jerk: 0.04365278035402298 loss_floor_contact: 0.0093411635607481
[68/100] loss: 0.008908628486096859 loss_joints: 0.00013780398876406252 loss_collision: 0.03467004373669624 loss_jerk: 0.04388295114040375 loss_floor_contact: 0.009155241772532463
[69/100] loss: 0.008817417547106743 loss_joints: 0.00011773803271353245 loss_collision: 0.03404361009597778 loss_jerk: 0.0438525415956974 loss_floor_contact: 0.00910064298659563
[70/100] loss: 0.008877363987267017 loss_joints: 0.00011565104068722576 loss_collision: 0.035081975162029266 loss_jerk: 0.043588023632764816 loss_floor_contact: 0.00894713494926691
[71/100] loss: 0.009173909202218056 loss_joints: 0.0001292219094466418 loss_collision: 0.03865550085902214 loss_jerk: 0.04313366487622261 loss_floor_contact: 0.008657709695398808
[72/100] loss: 0.008762340992689133 loss_joints: 0.00012296842760406435 loss_collision: 0.03492848202586174 loss_jerk: 0.04290805011987686 loss_floor_contact: 0.00855720043182373
[73/100] loss: 0.008756665512919426 loss_joints: 0.00010380494495620951 loss_collision: 0.03495893254876137 loss_jerk: 0.04291171953082085 loss_floor_contact: 0.00865794625133276
[74/100] loss: 0.00902693159878254 loss_joints: 8.385529508814216e-05 loss_collision: 0.03752095252275467 loss_jerk: 0.043019894510507584 loss_floor_contact: 0.00888991542160511
[75/100] loss: 0.00869537889957428 loss_joints: 8.209414954762906e-05 loss_collision: 0.03446245566010475 loss_jerk: 0.042918071150779724 loss_floor_contact: 0.008752314373850822
[76/100] loss: 0.0086957523599267 loss_joints: 8.266485383501276e-05 loss_collision: 0.03473501652479172 loss_jerk: 0.042823269963264465 loss_floor_contact: 0.008572590537369251
[77/100] loss: 0.008967635221779346 loss_joints: 9.650300489738584e-05 loss_collision: 0.03775938227772713 loss_jerk: 0.042636144906282425 loss_floor_contact: 0.008315791375935078
[78/100] loss: 0.008653576485812664 loss_joints: 9.77267263806425e-05 loss_collision: 0.03461509943008423 loss_jerk: 0.04264459386467934 loss_floor_contact: 0.008298798464238644
[79/100] loss: 0.008964532054960728 loss_joints: 8.873674960341305e-05 loss_collision: 0.03782988339662552 loss_jerk: 0.04259391501545906 loss_floor_contact: 0.008334153331816196
[80/100] loss: 0.00863846018910408 loss_joints: 8.826663543004543e-05 loss_collision: 0.03467933461070061 loss_jerk: 0.04252300783991814 loss_floor_contact: 0.008299596607685089
[81/100] loss: 0.008856640197336674 loss_joints: 9.420971036888659e-05 loss_collision: 0.036922723054885864 loss_jerk: 0.04248427227139473 loss_floor_contact: 0.008217313326895237
[82/100] loss: 0.00868743285536766 loss_joints: 9.618507465347648e-05 loss_collision: 0.03536204993724823 loss_jerk: 0.04245287925004959 loss_floor_contact: 0.008097544312477112
[83/100] loss: 0.008585530333220959 loss_joints: 9.511844109511003e-05 loss_collision: 0.03462347388267517 loss_jerk: 0.04230985790491104 loss_floor_contact: 0.007970785722136497
[84/100] loss: 0.008891582489013672 loss_joints: 9.24367195693776e-05 loss_collision: 0.03797706961631775 loss_jerk: 0.0421193428337574 loss_floor_contact: 0.007895045913755894
[85/100] loss: 0.00899001955986023 loss_joints: 9.859590500127524e-05 loss_collision: 0.03915238380432129 loss_jerk: 0.04199895262718201 loss_floor_contact: 0.00776289077475667
[86/100] loss: 0.00889497995376587 loss_joints: 9.800364932743832e-05 loss_collision: 0.03821553662419319 loss_jerk: 0.04199526086449623 loss_floor_contact: 0.007758955471217632
[87/100] loss: 0.00893884152173996 loss_joints: 9.82008277787827e-05 loss_collision: 0.0386711023747921 loss_jerk: 0.04199106991291046 loss_floor_contact: 0.007744227536022663
[88/100] loss: 0.008869091980159283 loss_joints: 9.882731683319435e-05 loss_collision: 0.03801732882857323 loss_jerk: 0.04198646545410156 loss_floor_contact: 0.007698854897171259
[89/100] loss: 0.00841474812477827 loss_joints: 9.956308349501342e-05 loss_collision: 0.033526498824357986 loss_jerk: 0.041985947638750076 loss_floor_contact: 0.007639402057975531
[90/100] loss: 0.008772378787398338 loss_joints: 9.963636694010347e-05 loss_collision: 0.037126217037439346 loss_jerk: 0.04200302064418793 loss_floor_contact: 0.0075981831178069115
[91/100] loss: 0.00858998391777277 loss_joints: 0.00010095592006109655 loss_collision: 0.03533618897199631 loss_jerk: 0.041992176324129105 loss_floor_contact: 0.007561920676380396
[92/100] loss: 0.008810840547084808 loss_joints: 0.00010619512613629922 loss_collision: 0.03761325031518936 loss_jerk: 0.04191538691520691 loss_floor_contact: 0.007517815101891756
[93/100] loss: 0.008483796380460262 loss_joints: 0.00011369714047759771 loss_collision: 0.034404583275318146 loss_jerk: 0.0417960062623024 loss_floor_contact: 0.00750040402635932
[94/100] loss: 0.008475585840642452 loss_joints: 0.0001205899752676487 loss_collision: 0.03437286615371704 loss_jerk: 0.041680093854665756 loss_floor_contact: 0.007496997248381376
[95/100] loss: 0.008840098045766354 loss_joints: 0.00012592878192663193 loss_collision: 0.03807321935892105 loss_jerk: 0.04158340394496918 loss_floor_contact: 0.007485068868845701
[96/100] loss: 0.00845927931368351 loss_joints: 0.00012665966642089188 loss_collision: 0.034318022429943085 loss_jerk: 0.04154672101140022 loss_floor_contact: 0.00746144587174058
[97/100] loss: 0.008829358965158463 loss_joints: 0.00012464365863706917 loss_collision: 0.03807029500603676 loss_jerk: 0.04154578968882561 loss_floor_contact: 0.007431060541421175
[98/100] loss: 0.008814152330160141 loss_joints: 0.0001242083526449278 loss_collision: 0.03796669468283653 loss_jerk: 0.04152539372444153 loss_floor_contact: 0.007407351862639189
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-4.png]
[99/100] loss: 0.008544906042516232 loss_joints: 0.0001227013417519629 loss_collision: 0.035306092351675034 loss_jerk: 0.041527219116687775 loss_floor_contact: 0.007388730999082327
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path1-run3-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 114.42334                                                    ║
    ║     rollout = 45.44231                                                     ║
    ║     sdf     = 13.97107                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00854491                                                 ║
    ║     joints    = 0.00012270                                                 ║
    ║     collision = 0.03530609                                                 ║
    ║     jerk      = 0.04152722                                                 ║
    ║     floor     = 0.00738873                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	2m14.874s
user	2m3.713s
sys	0m10.371s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x599c41db9c00] using SAR=1/1
[libx264 @ 0x599c41db9c00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x599c41db9c00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x599c41db9c00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_run_3.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x599c41db7fc0] video:171kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.670621%
frame=   25 fps=0.0 q=-1.0 Lsize=     173kB time=00:00:02.20 bitrate= 642.5kbits/s speed=3.64x    
[libx264 @ 0x599c41db9c00] frame I:1     Avg QP:18.32  size: 73169
[libx264 @ 0x599c41db9c00] frame P:8     Avg QP:19.46  size:  8730
[libx264 @ 0x599c41db9c00] frame B:16    Avg QP:23.00  size:  1988
[libx264 @ 0x599c41db9c00] consecutive B-frames: 12.0%  8.0%  0.0% 80.0%
[libx264 @ 0x599c41db9c00] mb I  I16..4:  3.7% 66.2% 30.1%
[libx264 @ 0x599c41db9c00] mb P  I16..4:  0.2%  1.7%  1.5%  P16..4:  8.7%  2.1%  1.5%  0.0%  0.0%    skip:84.3%
[libx264 @ 0x599c41db9c00] mb B  I16..4:  0.1%  0.5%  0.1%  B16..8: 10.6%  0.8%  0.3%  direct: 0.4%  skip:87.2%  L0:54.1% L1:42.6% BI: 3.4%
[libx264 @ 0x599c41db9c00] 8x8 transform intra:63.4% inter:60.5%
[libx264 @ 0x599c41db9c00] coded y,uvDC,uvAC intra: 30.4% 19.1% 18.1% inter: 2.8% 3.2% 0.9%
[libx264 @ 0x599c41db9c00] i16 v,h,dc,p: 53% 28% 18%  0%
[libx264 @ 0x599c41db9c00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 52%  8% 34%  1%  1%  1%  1%  1%  1%
[libx264 @ 0x599c41db9c00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 36% 22% 13%  5%  4%  4%  4%  9%  3%
[libx264 @ 0x599c41db9c00] i8c dc,h,v,p: 89%  2%  6%  3%
[libx264 @ 0x599c41db9c00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x599c41db9c00] ref P L0: 57.0% 16.7% 16.9%  9.4%
[libx264 @ 0x599c41db9c00] ref B L0: 84.3%  9.6%  6.1%
[libx264 @ 0x599c41db9c00] ref B L1: 90.2%  9.8%
[libx264 @ 0x599c41db9c00] kb/s:559.42
[INFO] Video saved as 'bin/result/optim_run_3.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 50 = (8*6 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:07<11:38,  7.06s/it]  2%|▏         | 2/100 [00:09<06:42,  4.11s/it]  3%|▎         | 3/100 [00:11<05:44,  3.55s/it]  4%|▍         | 4/100 [00:14<04:45,  2.97s/it]  5%|▌         | 5/100 [00:16<04:15,  2.68s/it]  6%|▌         | 6/100 [00:18<03:53,  2.48s/it]  7%|▋         | 7/100 [00:20<03:39,  2.36s/it]  8%|▊         | 8/100 [00:22<03:31,  2.30s/it]  9%|▉         | 9/100 [00:24<03:27,  2.28s/it] 10%|█         | 10/100 [00:27<03:23,  2.26s/it] 11%|█         | 11/100 [00:29<03:23,  2.29s/it] 12%|█▏        | 12/100 [00:31<03:25,  2.34s/it] 13%|█▎        | 13/100 [00:34<03:19,  2.29s/it] 14%|█▍        | 14/100 [00:36<03:17,  2.29s/it] 15%|█▌        | 15/100 [00:38<03:13,  2.27s/it] 16%|█▌        | 16/100 [00:40<03:07,  2.23s/it] 17%|█▋        | 17/100 [00:42<03:04,  2.22s/it] 18%|█▊        | 18/100 [00:45<03:01,  2.22s/it] 19%|█▉        | 19/100 [00:47<02:58,  2.20s/it] 20%|██        | 20/100 [00:49<02:51,  2.15s/it] 21%|██        | 21/100 [00:51<02:50,  2.16s/it] 22%|██▏       | 22/100 [00:53<02:47,  2.15s/it] 23%|██▎       | 23/100 [00:55<02:44,  2.13s/it] 24%|██▍       | 24/100 [00:58<02:47,  2.21s/it] 25%|██▌       | 25/100 [01:00<02:47,  2.24s/it] 26%|██▌       | 26/100 [01:02<02:41,  2.19s/it] 27%|██▋       | 27/100 [01:04<02:36,  2.15s/it] 28%|██▊       | 28/100 [01:06<02:33,  2.13s/it] 29%|██▉       | 29/100 [01:08<02:30,  2.12s/it] 30%|███       | 30/100 [01:10<02:28,  2.11s/it] 31%|███       | 31/100 [01:12<02:25,  2.11s/it] 32%|███▏      | 32/100 [01:15<02:24,  2.12s/it] 33%|███▎      | 33/100 [01:17<02:23,  2.14s/it] 34%|███▍      | 34/100 [01:19<02:22,  2.16s/it] 35%|███▌      | 35/100 [01:21<02:20,  2.16s/it] 36%|███▌      | 36/100 [01:23<02:17,  2.15s/it] 37%|███▋      | 37/100 [01:25<02:16,  2.17s/it] 38%|███▊      | 38/100 [01:28<02:15,  2.19s/it] 39%|███▉      | 39/100 [01:30<02:15,  2.23s/it] 40%|████      | 40/100 [01:32<02:14,  2.24s/it] 41%|████      | 41/100 [01:35<02:14,  2.28s/it] 42%|████▏     | 42/100 [01:37<02:10,  2.26s/it] 43%|████▎     | 43/100 [01:39<02:08,  2.25s/it] 44%|████▍     | 44/100 [01:41<02:04,  2.23s/it] 45%|████▌     | 45/100 [01:44<02:08,  2.34s/it] 46%|████▌     | 46/100 [01:46<02:06,  2.34s/it] 47%|████▋     | 47/100 [01:49<02:07,  2.40s/it] 48%|████▊     | 48/100 [01:51<02:03,  2.38s/it] 49%|████▉     | 49/100 [01:53<01:59,  2.34s/it] 50%|█████     | 50/100 [01:56<01:57,  2.35s/it] 51%|█████     | 51/100 [01:58<01:53,  2.31s/it] 52%|█████▏    | 52/100 [02:00<01:49,  2.29s/it] 53%|█████▎    | 53/100 [02:02<01:47,  2.30s/it] 54%|█████▍    | 54/100 [02:05<01:48,  2.36s/it] 55%|█████▌    | 55/100 [02:07<01:44,  2.33s/it] 56%|█████▌    | 56/100 [02:10<01:41,  2.31s/it] 57%|█████▋    | 57/100 [02:12<01:38,  2.29s/it] 58%|█████▊    | 58/100 [02:14<01:35,  2.28s/it] 59%|█████▉    | 59/100 [02:16<01:33,  2.28s/it] 60%|██████    | 60/100 [02:19<01:33,  2.33s/it] 61%|██████    | 61/100 [02:21<01:30,  2.31s/it] 62%|██████▏   | 62/100 [02:23<01:26,  2.27s/it] 63%|██████▎   | 63/100 [02:25<01:22,  2.23s/it] 64%|██████▍   | 64/100 [02:27<01:19,  2.21s/it] 65%|██████▌   | 65/100 [02:30<01:16,  2.20s/it] 66%|██████▌   | 66/100 [02:32<01:14,  2.18s/it] 67%|██████▋   | 67/100 [02:34<01:12,  2.20s/it] 68%|██████▊   | 68/100 [02:36<01:10,  2.19s/it] 69%|██████▉   | 69/100 [02:38<01:08,  2.21s/it] 70%|███████   | 70/100 [02:41<01:07,  2.24s/it] 71%|███████   | 71/100 [02:43<01:04,  2.21s/it] 72%|███████▏  | 72/100 [02:45<01:02,  2.25s/it] 73%|███████▎  | 73/100 [02:48<01:01,  2.28s/it] 74%|███████▍  | 74/100 [02:50<00:59,  2.31s/it] 75%|███████▌  | 75/100 [02:52<00:56,  2.27s/it] 76%|███████▌  | 76/100 [02:54<00:54,  2.25s/it] 77%|███████▋  | 77/100 [02:57<00:51,  2.24s/it] 78%|███████▊  | 78/100 [02:59<00:49,  2.26s/it] 79%|███████▉  | 79/100 [03:01<00:46,  2.23s/it] 80%|████████  | 80/100 [03:03<00:44,  2.21s/it] 81%|████████  | 81/100 [03:05<00:42,  2.23s/it] 82%|████████▏ | 82/100 [03:08<00:39,  2.21s/it] 83%|████████▎ | 83/100 [03:10<00:37,  2.18s/it] 84%|████████▍ | 84/100 [03:12<00:34,  2.16s/it] 85%|████████▌ | 85/100 [03:14<00:32,  2.15s/it] 86%|████████▌ | 86/100 [03:16<00:30,  2.16s/it] 87%|████████▋ | 87/100 [03:18<00:28,  2.17s/it] 88%|████████▊ | 88/100 [03:21<00:26,  2.20s/it] 89%|████████▉ | 89/100 [03:23<00:24,  2.20s/it] 90%|█████████ | 90/100 [03:25<00:21,  2.19s/it] 91%|█████████ | 91/100 [03:27<00:19,  2.18s/it] 92%|█████████▏| 92/100 [03:29<00:17,  2.17s/it] 93%|█████████▎| 93/100 [03:32<00:15,  2.22s/it] 94%|█████████▍| 94/100 [03:34<00:13,  2.20s/it] 95%|█████████▌| 95/100 [03:36<00:10,  2.19s/it] 96%|█████████▌| 96/100 [03:38<00:08,  2.17s/it] 97%|█████████▋| 97/100 [03:41<00:06,  2.25s/it] 98%|█████████▊| 98/100 [03:43<00:04,  2.21s/it] 99%|█████████▉| 99/100 [03:45<00:02,  2.23s/it]100%|██████████| 100/100 [03:52<00:00,  3.71s/it]100%|██████████| 100/100 [03:52<00:00,  2.33s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-7.png]
[0/100] loss: 0.5686509609222412 loss_joints: 0.5567798614501953 loss_collision: 0.043751467019319534 loss_jerk: 0.05721301957964897 loss_floor_contact: 0.01774619147181511
[1/100] loss: 0.6193675398826599 loss_joints: 0.60638827085495 loss_collision: 0.04545774310827255 loss_jerk: 0.06376656144857407 loss_floor_contact: 0.02056817151606083
[2/100] loss: 0.5584372878074646 loss_joints: 0.5453987121582031 loss_collision: 0.038884200155735016 loss_jerk: 0.07518799602985382 loss_floor_contact: 0.01631293073296547
[3/100] loss: 0.4615839719772339 loss_joints: 0.44773373007774353 loss_collision: 0.060206178575754166 loss_jerk: 0.06716238707304001 loss_floor_contact: 0.011133839376270771
[4/100] loss: 0.44494518637657166 loss_joints: 0.4302695691585541 loss_collision: 0.07476595789194107 loss_jerk: 0.06256764382123947 loss_floor_contact: 0.009422630071640015
[5/100] loss: 0.4136834740638733 loss_joints: 0.4027540683746338 loss_collision: 0.03960409015417099 loss_jerk: 0.060659248381853104 loss_floor_contact: 0.009030643850564957
[6/100] loss: 0.3810090720653534 loss_joints: 0.36938712000846863 loss_collision: 0.047406475991010666 loss_jerk: 0.0599212571978569 loss_floor_contact: 0.008891903795301914
[7/100] loss: 0.34325259923934937 loss_joints: 0.33244588971138 loss_collision: 0.03844911977648735 loss_jerk: 0.05969453230500221 loss_floor_contact: 0.009923364967107773
[8/100] loss: 0.30211466550827026 loss_joints: 0.29126042127609253 loss_collision: 0.037797700613737106 loss_jerk: 0.059188663959503174 loss_floor_contact: 0.011556189507246017
[9/100] loss: 0.2570512890815735 loss_joints: 0.24642989039421082 loss_collision: 0.0356888473033905 loss_jerk: 0.05851679667830467 loss_floor_contact: 0.012008186429738998
[10/100] loss: 0.21398799121379852 loss_joints: 0.2026377171278 loss_collision: 0.042664360255002975 loss_jerk: 0.05654105171561241 loss_floor_contact: 0.01429723296314478
[11/100] loss: 0.17748600244522095 loss_joints: 0.1661364734172821 loss_collision: 0.044933490455150604 loss_jerk: 0.05476720631122589 loss_floor_contact: 0.013794553466141224
[12/100] loss: 0.14990417659282684 loss_joints: 0.13917696475982666 loss_collision: 0.043623827397823334 loss_jerk: 0.05304178223013878 loss_floor_contact: 0.010606528259813786
[13/100] loss: 0.120510995388031 loss_joints: 0.11048077791929245 loss_collision: 0.0380743034183979 loss_jerk: 0.050355806946754456 loss_floor_contact: 0.011872021481394768
[14/100] loss: 0.09154772758483887 loss_joints: 0.08186565339565277 loss_collision: 0.037872351706027985 loss_jerk: 0.04700189083814621 loss_floor_contact: 0.01194645557552576
[15/100] loss: 0.06430018693208694 loss_joints: 0.05561758205294609 loss_collision: 0.03532058745622635 loss_jerk: 0.04341500252485275 loss_floor_contact: 0.008090458810329437
[16/100] loss: 0.042028769850730896 loss_joints: 0.0339244082570076 loss_collision: 0.035487230867147446 loss_jerk: 0.03945278748869896 loss_floor_contact: 0.00610358128324151
[17/100] loss: 0.02529793418943882 loss_joints: 0.0177161768078804 loss_collision: 0.03513539955019951 loss_jerk: 0.035131651908159256 loss_floor_contact: 0.005550525616854429
[18/100] loss: 0.014820250682532787 loss_joints: 0.0074174776673316956 loss_collision: 0.03672391176223755 loss_jerk: 0.034258875995874405 loss_floor_contact: 0.003044944955036044
[19/100] loss: 0.012479557655751705 loss_joints: 0.005077620968222618 loss_collision: 0.03513161465525627 loss_jerk: 0.03404399752616882 loss_floor_contact: 0.004843761213123798
[20/100] loss: 0.01608474925160408 loss_joints: 0.008763741701841354 loss_collision: 0.037681445479393005 loss_jerk: 0.03303399682044983 loss_floor_contact: 0.0024946355260908604
[21/100] loss: 0.020651020109653473 loss_joints: 0.01318561565130949 loss_collision: 0.03916193172335625 loss_jerk: 0.03231613710522652 loss_floor_contact: 0.0031759804114699364
[22/100] loss: 0.022807439789175987 loss_joints: 0.0156937874853611 loss_collision: 0.03639309108257294 loss_jerk: 0.03231269121170044 loss_floor_contact: 0.0024307584390044212
[23/100] loss: 0.022608349099755287 loss_joints: 0.015471592545509338 loss_collision: 0.036171507090330124 loss_jerk: 0.032110489904880524 loss_floor_contact: 0.0030855664517730474
[24/100] loss: 0.020284606143832207 loss_joints: 0.012980770319700241 loss_collision: 0.038574159145355225 loss_jerk: 0.0319710336625576 loss_floor_contact: 0.0024931624066084623
[25/100] loss: 0.01696120575070381 loss_joints: 0.009411169216036797 loss_collision: 0.039641425013542175 loss_jerk: 0.033425409346818924 loss_floor_contact: 0.002433533314615488
[26/100] loss: 0.013217383995652199 loss_joints: 0.005957792978733778 loss_collision: 0.03595740720629692 loss_jerk: 0.03498176485300064 loss_floor_contact: 0.001656733569689095
[27/100] loss: 0.011103599332273006 loss_joints: 0.003482609521597624 loss_collision: 0.03612395003437996 loss_jerk: 0.03659017011523247 loss_floor_contact: 0.003495777491480112
[28/100] loss: 0.010116176679730415 loss_joints: 0.002373720519244671 loss_collision: 0.03743179515004158 loss_jerk: 0.0381430983543396 loss_floor_contact: 0.0018496641423553228
[29/100] loss: 0.010825513862073421 loss_joints: 0.002471307758241892 loss_collision: 0.04028209298849106 loss_jerk: 0.03916269540786743 loss_floor_contact: 0.00409727031365037
[30/100] loss: 0.011141096241772175 loss_joints: 0.002848257776349783 loss_collision: 0.040948886424303055 loss_jerk: 0.039693932980298996 loss_floor_contact: 0.0022855722345411777
[31/100] loss: 0.011334764771163464 loss_joints: 0.0028936394955962896 loss_collision: 0.04199857637286186 loss_jerk: 0.03990766406059265 loss_floor_contact: 0.0025050067342817783
[32/100] loss: 0.011115056462585926 loss_joints: 0.0024863758590072393 loss_collision: 0.042927999049425125 loss_jerk: 0.03988354280591011 loss_floor_contact: 0.003475261852145195
[33/100] loss: 0.010334658436477184 loss_joints: 0.0017877130303531885 loss_collision: 0.04247453436255455 loss_jerk: 0.039662670344114304 loss_floor_contact: 0.0033322477247565985
[34/100] loss: 0.00951189361512661 loss_joints: 0.001103012589737773 loss_collision: 0.041524700820446014 loss_jerk: 0.03925996646285057 loss_floor_contact: 0.0033041357528418303
[35/100] loss: 0.008546705357730389 loss_joints: 0.000804546638391912 loss_collision: 0.03673351928591728 loss_jerk: 0.03861027583479881 loss_floor_contact: 0.0020777881145477295
[36/100] loss: 0.008794497698545456 loss_joints: 0.0008212013053707778 loss_collision: 0.04009836167097092 loss_jerk: 0.038193296641111374 loss_floor_contact: 0.0014413031749427319
[37/100] loss: 0.008709308691322803 loss_joints: 0.000774538959376514 loss_collision: 0.040051378309726715 loss_jerk: 0.037917736917734146 loss_floor_contact: 0.0013785810442641377
[38/100] loss: 0.008371524512767792 loss_joints: 0.0005614088731817901 loss_collision: 0.03811038285493851 loss_jerk: 0.0378054641187191 loss_floor_contact: 0.0021853127982467413
[39/100] loss: 0.007962414994835854 loss_joints: 0.000335869932314381 loss_collision: 0.037335045635700226 loss_jerk: 0.0375354140996933 loss_floor_contact: 0.0013949935091659427
[40/100] loss: 0.007771911099553108 loss_joints: 0.0001861880300566554 loss_collision: 0.03656777739524841 loss_jerk: 0.03739257901906967 loss_floor_contact: 0.001896873232908547
[41/100] loss: 0.007621498312801123 loss_joints: 0.00016077503096312284 loss_collision: 0.035257842391729355 loss_jerk: 0.03697497397661209 loss_floor_contact: 0.002374410629272461
[42/100] loss: 0.007561682723462582 loss_joints: 0.00011940974945900962 loss_collision: 0.03530404716730118 loss_jerk: 0.036343760788440704 loss_floor_contact: 0.0027749198488891125
[43/100] loss: 0.00726232910528779 loss_joints: 5.841849997523241e-05 loss_collision: 0.03482260927557945 loss_jerk: 0.03552866727113724 loss_floor_contact: 0.001687826355919242
[44/100] loss: 0.00744230393320322 loss_joints: 0.00011489859025459737 loss_collision: 0.03595726191997528 loss_jerk: 0.034574639052152634 loss_floor_contact: 0.0027421480044722557
[45/100] loss: 0.007787870243191719 loss_joints: 0.00017915198986884207 loss_collision: 0.039437346160411835 loss_jerk: 0.033855024725198746 loss_floor_contact: 0.002794805448502302
[46/100] loss: 0.007738753221929073 loss_joints: 0.00014014831685926765 loss_collision: 0.03983483463525772 loss_jerk: 0.033414021134376526 loss_floor_contact: 0.0027371933683753014
[47/100] loss: 0.007163777481764555 loss_joints: 4.5729364501312375e-05 loss_collision: 0.036448437720537186 loss_jerk: 0.033152658492326736 loss_floor_contact: 0.0015793830389156938
[48/100] loss: 0.006921825930476189 loss_joints: 4.6771689085289836e-05 loss_collision: 0.033992983400821686 loss_jerk: 0.03310461714863777 loss_floor_contact: 0.0016529369167983532
[49/100] loss: 0.007354035507887602 loss_joints: 0.00029791222186759114 loss_collision: 0.03459644317626953 loss_jerk: 0.03318342566490173 loss_floor_contact: 0.0027813625056296587
[50/100] loss: 0.007330514024943113 loss_joints: 0.0005337967304512858 loss_collision: 0.03305692598223686 loss_jerk: 0.03300353139638901 loss_floor_contact: 0.0019067090470343828
[51/100] loss: 0.007490269839763641 loss_joints: 0.000578785315155983 loss_collision: 0.03430572897195816 loss_jerk: 0.03266562148928642 loss_floor_contact: 0.002143490593880415
[52/100] loss: 0.00718190660700202 loss_joints: 0.0004310775548219681 loss_collision: 0.03294035792350769 loss_jerk: 0.03268640488386154 loss_floor_contact: 0.0018815292278304696
[53/100] loss: 0.007392773870378733 loss_joints: 0.00020001297525595874 loss_collision: 0.036676883697509766 loss_jerk: 0.03270643576979637 loss_floor_contact: 0.0025442892219871283
[54/100] loss: 0.007100908551365137 loss_joints: 0.00010788247163873166 loss_collision: 0.03520916402339935 loss_jerk: 0.03264352306723595 loss_floor_contact: 0.002077571116387844
[55/100] loss: 0.007061378099024296 loss_joints: 4.77989342471119e-05 loss_collision: 0.03599664196372032 loss_jerk: 0.03263748064637184 loss_floor_contact: 0.0015016698744148016
[56/100] loss: 0.0072523425333201885 loss_joints: 5.427475116448477e-05 loss_collision: 0.036970846354961395 loss_jerk: 0.032533545047044754 loss_floor_contact: 0.0024762898683547974
[57/100] loss: 0.007265823893249035 loss_joints: 4.807304867426865e-05 loss_collision: 0.037785232067108154 loss_jerk: 0.032370273023843765 loss_floor_contact: 0.002022005617618561
[58/100] loss: 0.006895518861711025 loss_joints: 5.4530126362806186e-05 loss_collision: 0.03362955152988434 loss_jerk: 0.03213585540652275 loss_floor_contact: 0.002644482534378767
[59/100] loss: 0.007029571104794741 loss_joints: 5.6688018958084285e-05 loss_collision: 0.03506429120898247 loss_jerk: 0.031968437135219574 loss_floor_contact: 0.0026961013209074736
[60/100] loss: 0.007068241946399212 loss_joints: 3.917840513167903e-05 loss_collision: 0.03577006608247757 loss_jerk: 0.031799014657735825 loss_floor_contact: 0.00272155343554914
[61/100] loss: 0.006742935627698898 loss_joints: 3.954797284677625e-05 loss_collision: 0.032886259257793427 loss_jerk: 0.031666070222854614 loss_floor_contact: 0.002481544855982065
[62/100] loss: 0.006819308735430241 loss_joints: 3.7574242014670745e-05 loss_collision: 0.03410087153315544 loss_jerk: 0.03165321424603462 loss_floor_contact: 0.002063262742012739
[63/100] loss: 0.007051417604088783 loss_joints: 4.264348172000609e-05 loss_collision: 0.035887982696294785 loss_jerk: 0.03166823089122772 loss_floor_contact: 0.002531530801206827
[64/100] loss: 0.006938775070011616 loss_joints: 4.399130921228789e-05 loss_collision: 0.03458176180720329 loss_jerk: 0.03167465701699257 loss_floor_contact: 0.0026914181653410196
[65/100] loss: 0.006912263110280037 loss_joints: 3.824479063041508e-05 loss_collision: 0.034820690751075745 loss_jerk: 0.03166570886969566 loss_floor_contact: 0.0022537815384566784
[66/100] loss: 0.006759138777852058 loss_joints: 6.237949128262699e-05 loss_collision: 0.033097393810749054 loss_jerk: 0.031560130417346954 loss_floor_contact: 0.0023100648541003466
[67/100] loss: 0.006756626535207033 loss_joints: 7.932305743452162e-05 loss_collision: 0.033013131469488144 loss_jerk: 0.031665753573179245 loss_floor_contact: 0.0020941474940627813
[68/100] loss: 0.006927270442247391 loss_joints: 0.0001362680341117084 loss_collision: 0.034407585859298706 loss_jerk: 0.03178694099187851 loss_floor_contact: 0.0017154940869659185
[69/100] loss: 0.0068365843035280704 loss_joints: 0.00014314525469671935 loss_collision: 0.03356084227561951 loss_jerk: 0.03174487128853798 loss_floor_contact: 0.0016286734025925398
[70/100] loss: 0.0069215865805745125 loss_joints: 9.973315172828734e-05 loss_collision: 0.03461885452270508 loss_jerk: 0.0315723717212677 loss_floor_contact: 0.0020273029804229736
[71/100] loss: 0.006848948076367378 loss_joints: 4.456759415916167e-05 loss_collision: 0.035122115164995193 loss_jerk: 0.031327590346336365 loss_floor_contact: 0.0015940975863486528
[72/100] loss: 0.0069274092093110085 loss_joints: 3.7737358070444316e-05 loss_collision: 0.03447601571679115 loss_jerk: 0.031298890709877014 loss_floor_contact: 0.0031218104995787144
[73/100] loss: 0.006915216334164143 loss_joints: 0.00013450322148855776 loss_collision: 0.032913580536842346 loss_jerk: 0.031215718016028404 loss_floor_contact: 0.00367782823741436
[74/100] loss: 0.007016968913376331 loss_joints: 0.00024054244568105787 loss_collision: 0.03367386758327484 loss_jerk: 0.031062625348567963 loss_floor_contact: 0.003027769271284342
[75/100] loss: 0.007262914441525936 loss_joints: 0.00033169909147545695 loss_collision: 0.03607024624943733 loss_jerk: 0.03087797202169895 loss_floor_contact: 0.0023639346472918987
[76/100] loss: 0.007260267157107592 loss_joints: 0.0003371303901076317 loss_collision: 0.03601861000061035 loss_jerk: 0.03069315105676651 loss_floor_contact: 0.0025196054484695196
[77/100] loss: 0.007053333800286055 loss_joints: 0.0002681651967577636 loss_collision: 0.034377321600914 loss_jerk: 0.030514240264892578 loss_floor_contact: 0.0029601205606013536
[78/100] loss: 0.0070567661896348 loss_joints: 0.0001671890204306692 loss_collision: 0.035202983766794205 loss_jerk: 0.030659519135951996 loss_floor_contact: 0.0030332698952406645
[79/100] loss: 0.006669805385172367 loss_joints: 6.922115426277742e-05 loss_collision: 0.03222038969397545 loss_jerk: 0.030912717804312706 loss_floor_contact: 0.002872735494747758
[80/100] loss: 0.006754462141543627 loss_joints: 3.7795100070070475e-05 loss_collision: 0.03261525556445122 loss_jerk: 0.03105100989341736 loss_floor_contact: 0.0035004043020308018
[81/100] loss: 0.00689175957813859 loss_joints: 2.3824866730137728e-05 loss_collision: 0.03423202410340309 loss_jerk: 0.031065449118614197 loss_floor_contact: 0.0033818718511611223
[82/100] loss: 0.00704631581902504 loss_joints: 1.8301350792171434e-05 loss_collision: 0.035779740661382675 loss_jerk: 0.030974434688687325 loss_floor_contact: 0.0035259693395346403
[83/100] loss: 0.006815879140049219 loss_joints: 1.7297979866270907e-05 loss_collision: 0.03374803066253662 loss_jerk: 0.03079906478524208 loss_floor_contact: 0.0034387176856398582
[84/100] loss: 0.0068501075729727745 loss_joints: 1.923568925121799e-05 loss_collision: 0.03457958251237869 loss_jerk: 0.030555175617337227 loss_floor_contact: 0.003173955949023366
[85/100] loss: 0.006836460437625647 loss_joints: 2.073607174679637e-05 loss_collision: 0.034377068281173706 loss_jerk: 0.03028012439608574 loss_floor_contact: 0.0035000445786863565
[86/100] loss: 0.006708681117743254 loss_joints: 2.201305323978886e-05 loss_collision: 0.03365441411733627 loss_jerk: 0.03003505803644657 loss_floor_contact: 0.0031772118527442217
[87/100] loss: 0.006832803133875132 loss_joints: 2.3477185095543973e-05 loss_collision: 0.03466623276472092 loss_jerk: 0.030030028894543648 loss_floor_contact: 0.003396995598450303
[88/100] loss: 0.006711285561323166 loss_joints: 2.7941681764787063e-05 loss_collision: 0.033273037523031235 loss_jerk: 0.029985498636960983 loss_floor_contact: 0.0035749005619436502
[89/100] loss: 0.00685682101175189 loss_joints: 3.5407945688348264e-05 loss_collision: 0.03504548221826553 loss_jerk: 0.029913177713751793 loss_floor_contact: 0.003255468560382724
[90/100] loss: 0.006894403137266636 loss_joints: 4.085823820787482e-05 loss_collision: 0.03526969999074936 loss_jerk: 0.029826214537024498 loss_floor_contact: 0.003439530963078141
[91/100] loss: 0.00681726448237896 loss_joints: 4.187051672488451e-05 loss_collision: 0.03485562279820442 loss_jerk: 0.02973744086921215 loss_floor_contact: 0.0031608769204467535
[92/100] loss: 0.006589926313608885 loss_joints: 3.834981544059701e-05 loss_collision: 0.03251965716481209 loss_jerk: 0.02973654866218567 loss_floor_contact: 0.003259561024606228
[93/100] loss: 0.006707330234348774 loss_joints: 3.11061303364113e-05 loss_collision: 0.033946599811315536 loss_jerk: 0.029721109196543694 loss_floor_contact: 0.0030945318285375834
[94/100] loss: 0.006763911806046963 loss_joints: 2.5188199288095348e-05 loss_collision: 0.03463327884674072 loss_jerk: 0.02971539832651615 loss_floor_contact: 0.003038558643311262
[95/100] loss: 0.006709342356771231 loss_joints: 2.2329928469844162e-05 loss_collision: 0.03409935161471367 loss_jerk: 0.029764605686068535 loss_floor_contact: 0.0030061635188758373
[96/100] loss: 0.006637100130319595 loss_joints: 2.1034989913459867e-05 loss_collision: 0.03376717120409012 loss_jerk: 0.029791804030537605 loss_floor_contact: 0.002601672662422061
[97/100] loss: 0.006671119015663862 loss_joints: 2.0527841115836054e-05 loss_collision: 0.03413625806570053 loss_jerk: 0.029799846932291985 loss_floor_contact: 0.0025698074605315924
[98/100] loss: 0.006662148050963879 loss_joints: 2.0443751054699533e-05 loss_collision: 0.03366988152265549 loss_jerk: 0.02980218641459942 loss_floor_contact: 0.002944971900433302
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-7.png]
[99/100] loss: 0.00664912536740303 loss_joints: 2.033650889643468e-05 loss_collision: 0.03393302485346794 loss_jerk: 0.02981501631438732 loss_floor_contact: 0.002539847744628787
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path1-run6-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 232.61288                                                    ║
    ║     rollout = 100.94791                                                    ║
    ║     sdf     = 21.00181                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00664913                                                 ║
    ║     joints    = 0.00002034                                                 ║
    ║     collision = 0.03393302                                                 ║
    ║     jerk      = 0.02981502                                                 ║
    ║     floor     = 0.00253985                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	4m12.243s
user	3m53.755s
sys	0m15.236s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x60da842eec00] using SAR=1/1
[libx264 @ 0x60da842eec00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x60da842eec00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x60da842eec00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_run_6.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x60da842ecfc0] video:172kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.665380%
frame=   25 fps=0.0 q=-1.0 Lsize=     173kB time=00:00:02.20 bitrate= 643.1kbits/s speed=3.54x    
[libx264 @ 0x60da842eec00] frame I:1     Avg QP:18.44  size: 71884
[libx264 @ 0x60da842eec00] frame P:8     Avg QP:19.79  size:  9647
[libx264 @ 0x60da842eec00] frame B:16    Avg QP:22.38  size:  1621
[libx264 @ 0x60da842eec00] consecutive B-frames: 12.0%  8.0%  0.0% 80.0%
[libx264 @ 0x60da842eec00] mb I  I16..4:  6.4% 63.7% 29.9%
[libx264 @ 0x60da842eec00] mb P  I16..4:  0.2%  1.7%  1.6%  P16..4:  9.3%  2.3%  1.5%  0.0%  0.0%    skip:83.4%
[libx264 @ 0x60da842eec00] mb B  I16..4:  0.1%  0.4%  0.1%  B16..8: 10.2%  0.9%  0.3%  direct: 0.4%  skip:87.6%  L0:55.8% L1:40.1% BI: 4.1%
[libx264 @ 0x60da842eec00] 8x8 transform intra:60.9% inter:55.9%
[libx264 @ 0x60da842eec00] coded y,uvDC,uvAC intra: 31.1% 19.6% 18.3% inter: 2.7% 3.0% 0.8%
[libx264 @ 0x60da842eec00] i16 v,h,dc,p: 66% 20% 14%  0%
[libx264 @ 0x60da842eec00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 53%  8% 32%  1%  1%  1%  1%  1%  1%
[libx264 @ 0x60da842eec00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 36% 22% 14%  5%  4%  4%  4%  9%  3%
[libx264 @ 0x60da842eec00] i8c dc,h,v,p: 88%  2%  7%  3%
[libx264 @ 0x60da842eec00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x60da842eec00] ref P L0: 54.0% 16.0% 21.2%  8.8%
[libx264 @ 0x60da842eec00] ref B L0: 73.7% 15.1% 11.1%
[libx264 @ 0x60da842eec00] ref B L1: 90.0% 10.0%
[libx264 @ 0x60da842eec00] kb/s:560.00
[INFO] Video saved as 'bin/result/optim_run_6.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:13<21:54, 13.28s/it]  2%|▏         | 2/100 [00:17<13:01,  7.97s/it]  3%|▎         | 3/100 [00:22<10:39,  6.59s/it]  4%|▍         | 4/100 [00:26<09:11,  5.75s/it]  5%|▌         | 5/100 [00:31<08:16,  5.22s/it]  6%|▌         | 6/100 [00:35<07:48,  4.98s/it]  7%|▋         | 7/100 [00:40<07:26,  4.80s/it]  8%|▊         | 8/100 [00:44<07:09,  4.67s/it]  9%|▉         | 9/100 [00:48<06:53,  4.54s/it] 10%|█         | 10/100 [00:53<06:43,  4.49s/it] 11%|█         | 11/100 [00:57<06:43,  4.54s/it] 12%|█▏        | 12/100 [01:02<06:32,  4.46s/it] 13%|█▎        | 13/100 [01:06<06:29,  4.47s/it] 14%|█▍        | 14/100 [01:11<06:25,  4.48s/it] 15%|█▌        | 15/100 [01:15<06:19,  4.46s/it] 16%|█▌        | 16/100 [01:19<06:11,  4.42s/it] 17%|█▋        | 17/100 [01:24<06:03,  4.38s/it] 18%|█▊        | 18/100 [01:28<06:02,  4.42s/it] 19%|█▉        | 19/100 [01:32<05:55,  4.39s/it] 20%|██        | 20/100 [01:37<05:50,  4.39s/it] 21%|██        | 21/100 [01:41<05:50,  4.44s/it] 22%|██▏       | 22/100 [01:46<05:58,  4.60s/it] 23%|██▎       | 23/100 [01:51<05:50,  4.55s/it] 24%|██▍       | 24/100 [01:55<05:43,  4.52s/it] 25%|██▌       | 25/100 [02:00<05:44,  4.59s/it] 26%|██▌       | 26/100 [02:04<05:34,  4.52s/it] 27%|██▋       | 27/100 [02:09<05:31,  4.55s/it] 28%|██▊       | 28/100 [02:14<05:27,  4.55s/it] 29%|██▉       | 29/100 [02:18<05:21,  4.53s/it] 30%|███       | 30/100 [02:23<05:32,  4.75s/it] 31%|███       | 31/100 [02:28<05:31,  4.81s/it] 32%|███▏      | 32/100 [02:33<05:23,  4.76s/it] 33%|███▎      | 33/100 [02:37<05:15,  4.71s/it] 34%|███▍      | 34/100 [02:42<05:09,  4.69s/it] 35%|███▌      | 35/100 [02:47<05:17,  4.88s/it] 36%|███▌      | 36/100 [02:52<05:14,  4.91s/it] 37%|███▋      | 37/100 [02:57<05:05,  4.85s/it] 38%|███▊      | 38/100 [03:02<04:56,  4.78s/it] 39%|███▉      | 39/100 [03:06<04:48,  4.72s/it] 40%|████      | 40/100 [03:11<04:37,  4.62s/it] 41%|████      | 41/100 [03:16<04:43,  4.81s/it] 42%|████▏     | 42/100 [03:21<04:43,  4.89s/it] 43%|████▎     | 43/100 [03:26<04:36,  4.86s/it] 44%|████▍     | 44/100 [03:31<04:35,  4.92s/it] 45%|████▌     | 45/100 [03:36<04:29,  4.90s/it] 46%|████▌     | 46/100 [03:40<04:21,  4.84s/it] 47%|████▋     | 47/100 [03:45<04:11,  4.75s/it] 48%|████▊     | 48/100 [03:50<04:18,  4.98s/it] 49%|████▉     | 49/100 [03:56<04:23,  5.16s/it] 50%|█████     | 50/100 [04:01<04:10,  5.00s/it] 51%|█████     | 51/100 [04:06<04:13,  5.17s/it] 52%|█████▏    | 52/100 [04:12<04:08,  5.18s/it] 53%|█████▎    | 53/100 [04:17<04:02,  5.15s/it] 54%|█████▍    | 54/100 [04:22<03:55,  5.12s/it] 55%|█████▌    | 55/100 [04:27<03:57,  5.27s/it] 56%|█████▌    | 56/100 [04:32<03:43,  5.09s/it] 57%|█████▋    | 57/100 [04:37<03:41,  5.15s/it] 58%|█████▊    | 58/100 [04:42<03:28,  4.97s/it] 59%|█████▉    | 59/100 [04:47<03:28,  5.10s/it] 60%|██████    | 60/100 [04:53<03:26,  5.17s/it] 61%|██████    | 61/100 [04:57<03:18,  5.10s/it] 62%|██████▏   | 62/100 [05:03<03:14,  5.11s/it] 63%|██████▎   | 63/100 [05:07<03:03,  4.97s/it] 64%|██████▍   | 64/100 [05:12<02:59,  4.98s/it] 65%|██████▌   | 65/100 [05:17<02:54,  4.98s/it] 66%|██████▌   | 66/100 [05:23<02:54,  5.13s/it] 67%|██████▋   | 67/100 [05:27<02:46,  5.03s/it] 68%|██████▊   | 68/100 [05:32<02:35,  4.87s/it] 69%|██████▉   | 69/100 [05:37<02:32,  4.91s/it] 70%|███████   | 70/100 [05:43<02:33,  5.11s/it] 71%|███████   | 71/100 [05:48<02:29,  5.14s/it] 72%|███████▏  | 72/100 [05:53<02:24,  5.17s/it] 73%|███████▎  | 73/100 [05:59<02:22,  5.28s/it] 74%|███████▍  | 74/100 [06:04<02:21,  5.44s/it] 75%|███████▌  | 75/100 [06:10<02:19,  5.56s/it] 76%|███████▌  | 76/100 [06:16<02:15,  5.63s/it] 77%|███████▋  | 77/100 [06:22<02:08,  5.60s/it] 78%|███████▊  | 78/100 [06:27<02:05,  5.69s/it] 79%|███████▉  | 79/100 [06:34<02:03,  5.87s/it] 80%|████████  | 80/100 [06:39<01:54,  5.72s/it] 81%|████████  | 81/100 [06:45<01:48,  5.71s/it] 82%|████████▏ | 82/100 [06:50<01:40,  5.59s/it] 83%|████████▎ | 83/100 [06:55<01:33,  5.52s/it] 84%|████████▍ | 84/100 [07:01<01:30,  5.65s/it] 85%|████████▌ | 85/100 [07:07<01:26,  5.75s/it] 86%|████████▌ | 86/100 [07:13<01:20,  5.75s/it] 87%|████████▋ | 87/100 [07:19<01:16,  5.88s/it] 88%|████████▊ | 88/100 [07:25<01:09,  5.77s/it] 89%|████████▉ | 89/100 [07:31<01:03,  5.79s/it] 90%|█████████ | 90/100 [07:36<00:56,  5.66s/it] 91%|█████████ | 91/100 [07:41<00:50,  5.60s/it] 92%|█████████▏| 92/100 [07:48<00:47,  5.90s/it] 93%|█████████▎| 93/100 [07:54<00:41,  5.91s/it] 94%|█████████▍| 94/100 [07:59<00:34,  5.76s/it] 95%|█████████▌| 95/100 [08:05<00:29,  5.81s/it] 96%|█████████▌| 96/100 [08:11<00:22,  5.67s/it] 97%|█████████▋| 97/100 [08:16<00:16,  5.66s/it] 98%|█████████▊| 98/100 [08:22<00:11,  5.68s/it] 99%|█████████▉| 99/100 [08:28<00:05,  5.67s/it]100%|██████████| 100/100 [08:44<00:00,  8.83s/it]100%|██████████| 100/100 [08:44<00:00,  5.24s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-13.png]
[0/100] loss: 2.9475820064544678 loss_joints: 2.830120086669922 loss_collision: 0.02302686683833599 loss_jerk: 0.08841614425182343 loss_floor_contact: 1.0631771087646484
[1/100] loss: 2.681985855102539 loss_joints: 2.5678188800811768 loss_collision: 0.027226800099015236 loss_jerk: 0.08481729030609131 loss_floor_contact: 1.0296239852905273
[2/100] loss: 2.521723747253418 loss_joints: 2.4254684448242188 loss_collision: 0.015097125433385372 loss_jerk: 0.09072855859994888 loss_floor_contact: 0.8567275404930115
[3/100] loss: 2.307469367980957 loss_joints: 2.229780435562134 loss_collision: 0.01231348142027855 loss_jerk: 0.07360748201608658 loss_floor_contact: 0.6909670233726501
[4/100] loss: 2.102792739868164 loss_joints: 2.0368449687957764 loss_collision: 0.027814365923404694 loss_jerk: 0.06821471452713013 loss_floor_contact: 0.5634493231773376
[5/100] loss: 1.8106515407562256 loss_joints: 1.7577871084213257 loss_collision: 0.08187838643789291 loss_jerk: 0.06546144187450409 loss_floor_contact: 0.38130372762680054
[6/100] loss: 1.6340752840042114 loss_joints: 1.5967566967010498 loss_collision: 0.05007455497980118 loss_jerk: 0.0656895861029625 loss_floor_contact: 0.25742197036743164
[7/100] loss: 1.4429357051849365 loss_joints: 1.4095348119735718 loss_collision: 0.09226617962121964 loss_jerk: 0.064717598259449 loss_floor_contact: 0.1770259141921997
[8/100] loss: 1.268739938735962 loss_joints: 1.2393779754638672 loss_collision: 0.1156996563076973 loss_jerk: 0.06360381841659546 loss_floor_contact: 0.11431589722633362
[9/100] loss: 1.0537201166152954 loss_joints: 1.029586672782898 loss_collision: 0.12069163471460342 loss_jerk: 0.061987560242414474 loss_floor_contact: 0.05865585058927536
[10/100] loss: 0.8627963662147522 loss_joints: 0.8416306376457214 loss_collision: 0.14238961040973663 loss_jerk: 0.059680018573999405 loss_floor_contact: 0.009587859734892845
[11/100] loss: 0.7679980397224426 loss_joints: 0.7392971515655518 loss_collision: 0.22237636148929596 loss_jerk: 0.057596057653427124 loss_floor_contact: 0.00703617837280035
[12/100] loss: 0.6505271792411804 loss_joints: 0.6216794848442078 loss_collision: 0.22682058811187744 loss_jerk: 0.05735024809837341 loss_floor_contact: 0.004306077025830746
[13/100] loss: 0.5320299863815308 loss_joints: 0.4786788821220398 loss_collision: 0.4757915735244751 loss_jerk: 0.053859807550907135 loss_floor_contact: 0.003859363030642271
[14/100] loss: 0.3505295515060425 loss_joints: 0.3394012451171875 loss_collision: 0.051499560475349426 loss_jerk: 0.053957875818014145 loss_floor_contact: 0.005825529340654612
[15/100] loss: 0.2739219665527344 loss_joints: 0.2662087380886078 loss_collision: 0.02463899739086628 loss_jerk: 0.04719869792461395 loss_floor_contact: 0.005294410977512598
[16/100] loss: 0.208835631608963 loss_joints: 0.20142343640327454 loss_collision: 0.02628864347934723 loss_jerk: 0.04305731877684593 loss_floor_contact: 0.0047759865410625935
[17/100] loss: 0.15471702814102173 loss_joints: 0.14683696627616882 loss_collision: 0.027158023789525032 loss_jerk: 0.04700435698032379 loss_floor_contact: 0.004638324491679668
[18/100] loss: 0.10466744005680084 loss_joints: 0.09677745401859283 loss_collision: 0.028225712478160858 loss_jerk: 0.04710393026471138 loss_floor_contact: 0.0035702178720384836
[19/100] loss: 0.06411134451627731 loss_joints: 0.056124262511730194 loss_collision: 0.032294802367687225 loss_jerk: 0.045042984187603 loss_floor_contact: 0.0025330339558422565
[20/100] loss: 0.033297885209321976 loss_joints: 0.025531303137540817 loss_collision: 0.034781407564878464 loss_jerk: 0.04065382480621338 loss_floor_contact: 0.002230606973171234
[21/100] loss: 0.016111569479107857 loss_joints: 0.00735757639631629 loss_collision: 0.039842307567596436 loss_jerk: 0.04680941253900528 loss_floor_contact: 0.0008881994290277362
[22/100] loss: 0.011412287130951881 loss_joints: 0.0016139424405992031 loss_collision: 0.04545101150870323 loss_jerk: 0.05176736041903496 loss_floor_contact: 0.0007650749175809324
[23/100] loss: 0.014073819853365421 loss_joints: 0.004939306527376175 loss_collision: 0.038083143532276154 loss_jerk: 0.052561718970537186 loss_floor_contact: 0.0007002686616033316
[24/100] loss: 0.019057272002100945 loss_joints: 0.010229072533547878 loss_collision: 0.03433854132890701 loss_jerk: 0.052911289036273956 loss_floor_contact: 0.0010321747977286577
[25/100] loss: 0.02223973721265793 loss_joints: 0.013580474071204662 loss_collision: 0.033209145069122314 loss_jerk: 0.052363451570272446 loss_floor_contact: 0.0010200246470049024
[26/100] loss: 0.022204464301466942 loss_joints: 0.013610749505460262 loss_collision: 0.03373780846595764 loss_jerk: 0.05166442692279816 loss_floor_contact: 0.0005349201965145767
[27/100] loss: 0.019426396116614342 loss_joints: 0.01075685303658247 loss_collision: 0.03432459384202957 loss_jerk: 0.05123424157500267 loss_floor_contact: 0.0011366130784153938
[28/100] loss: 0.016096169129014015 loss_joints: 0.0072045582346618176 loss_collision: 0.03710738942027092 loss_jerk: 0.05084747076034546 loss_floor_contact: 0.0009612561552785337
[29/100] loss: 0.012609721161425114 loss_joints: 0.0037547480314970016 loss_collision: 0.037111442536115646 loss_jerk: 0.04989345371723175 loss_floor_contact: 0.001544829225167632
[30/100] loss: 0.009214457124471664 loss_joints: 0.001047331839799881 loss_collision: 0.03287553787231445 loss_jerk: 0.04764926806092262 loss_floor_contact: 0.0011464437702670693
[31/100] loss: 0.008042520843446255 loss_joints: 2.5957144316635095e-05 loss_collision: 0.03224571421742439 loss_jerk: 0.045638442039489746 loss_floor_contact: 0.002281483029946685
[32/100] loss: 0.00919736921787262 loss_joints: 0.0012668940471485257 loss_collision: 0.02920030802488327 loss_jerk: 0.047685056924819946 loss_floor_contact: 0.002419389085844159
[33/100] loss: 0.014278554357588291 loss_joints: 0.0030429826583713293 loss_collision: 0.06024055927991867 loss_jerk: 0.04942594841122627 loss_floor_contact: 0.0026892044115811586
[34/100] loss: 0.015112332999706268 loss_joints: 0.0032898704521358013 loss_collision: 0.0643148347735405 loss_jerk: 0.050869885832071304 loss_floor_contact: 0.0030399069655686617
[35/100] loss: 0.013363287784159184 loss_joints: 0.0023215904366225004 loss_collision: 0.05562867596745491 loss_jerk: 0.0520632304251194 loss_floor_contact: 0.002725070109590888
[36/100] loss: 0.012223859317600727 loss_joints: 0.0014095836086198688 loss_collision: 0.0518728531897068 loss_jerk: 0.05286692827939987 loss_floor_contact: 0.0034029704984277487
[37/100] loss: 0.0109415203332901 loss_joints: 0.000912304618395865 loss_collision: 0.04424845799803734 loss_jerk: 0.053155891597270966 loss_floor_contact: 0.002887809881940484
[38/100] loss: 0.011201544664800167 loss_joints: 0.0013533651363104582 loss_collision: 0.04250055178999901 loss_jerk: 0.05316640064120293 loss_floor_contact: 0.0028148358687758446
[39/100] loss: 0.012203020043671131 loss_joints: 0.0022597527131438255 loss_collision: 0.04291616752743721 loss_jerk: 0.053402528166770935 loss_floor_contact: 0.003113977611064911
[40/100] loss: 0.012209616601467133 loss_joints: 0.0026423782110214233 loss_collision: 0.03943607583642006 loss_jerk: 0.05348716676235199 loss_floor_contact: 0.0027491331566125154
[41/100] loss: 0.011734900996088982 loss_joints: 0.0034945919178426266 loss_collision: 0.026420850306749344 loss_jerk: 0.053405482321977615 loss_floor_contact: 0.0025767523329705
[42/100] loss: 0.011293387971818447 loss_joints: 0.0033691595308482647 loss_collision: 0.023687073960900307 loss_jerk: 0.05277464538812637 loss_floor_contact: 0.0027805687859654427
[43/100] loss: 0.01080155000090599 loss_joints: 0.002581596141681075 loss_collision: 0.027579253539443016 loss_jerk: 0.051967669278383255 loss_floor_contact: 0.0026526094879955053
[44/100] loss: 0.010069051757454872 loss_joints: 0.0016976064071059227 loss_collision: 0.03030223958194256 loss_jerk: 0.051177918910980225 loss_floor_contact: 0.0022342975717037916
[45/100] loss: 0.008928094990551472 loss_joints: 0.0008118799887597561 loss_collision: 0.02782842144370079 loss_jerk: 0.050576113164424896 loss_floor_contact: 0.0027576207648962736
[46/100] loss: 0.008251327089965343 loss_joints: 0.0002562324807513505 loss_collision: 0.02738347463309765 loss_jerk: 0.04994436353445053 loss_floor_contact: 0.002623107982799411
[47/100] loss: 0.007998579181730747 loss_joints: 0.00016740546561777592 loss_collision: 0.026681330054998398 loss_jerk: 0.04907345026731491 loss_floor_contact: 0.0025569554418325424
[48/100] loss: 0.00774151599034667 loss_joints: 0.0004837221640627831 loss_collision: 0.021123016253113747 loss_jerk: 0.04799194261431694 loss_floor_contact: 0.0034629798028618097
[49/100] loss: 0.007990732789039612 loss_joints: 0.0007730951765552163 loss_collision: 0.021647119894623756 loss_jerk: 0.04699166491627693 loss_floor_contact: 0.003537591313943267
[50/100] loss: 0.008049589581787586 loss_joints: 0.0007689743069931865 loss_collision: 0.024245135486125946 loss_jerk: 0.046161580830812454 loss_floor_contact: 0.002399437827989459
[51/100] loss: 0.00827694870531559 loss_joints: 0.0010582874529063702 loss_collision: 0.022865736857056618 loss_jerk: 0.04548502340912819 loss_floor_contact: 0.003835849231109023
[52/100] loss: 0.008380708284676075 loss_joints: 0.0011150637874379754 loss_collision: 0.02323222905397415 loss_jerk: 0.0451955683529377 loss_floor_contact: 0.004228638019412756
[53/100] loss: 0.008466213010251522 loss_joints: 0.0013983709504827857 loss_collision: 0.022130846977233887 loss_jerk: 0.045041415840387344 loss_floor_contact: 0.003506161505356431
[54/100] loss: 0.00828271172940731 loss_joints: 0.0012610687408596277 loss_collision: 0.021871402859687805 loss_jerk: 0.04504751041531563 loss_floor_contact: 0.003297516843304038
[55/100] loss: 0.008175353519618511 loss_joints: 0.0008260100148618221 loss_collision: 0.025309571996331215 loss_jerk: 0.04524790495634079 loss_floor_contact: 0.0029359592590481043
[56/100] loss: 0.008133376017212868 loss_joints: 0.000655616051517427 loss_collision: 0.02694225125014782 loss_jerk: 0.04552391171455383 loss_floor_contact: 0.002311430172994733
[57/100] loss: 0.007863429374992847 loss_joints: 0.0007632823544554412 loss_collision: 0.022428102791309357 loss_jerk: 0.04571143165230751 loss_floor_contact: 0.002861931687220931
[58/100] loss: 0.007760793436318636 loss_joints: 0.0006053411634638906 loss_collision: 0.022994831204414368 loss_jerk: 0.04590471833944321 loss_floor_contact: 0.002654973417520523
[59/100] loss: 0.00794209074229002 loss_joints: 0.00028945086523890495 loss_collision: 0.02773291803896427 loss_jerk: 0.04615942761301994 loss_floor_contact: 0.0026340465992689133
[60/100] loss: 0.007873624563217163 loss_joints: 0.00022008881205692887 loss_collision: 0.02745438553392887 loss_jerk: 0.04634224995970726 loss_floor_contact: 0.002738721203058958
[61/100] loss: 0.007690116297453642 loss_joints: 0.0003086325014010072 loss_collision: 0.024815935641527176 loss_jerk: 0.04644609987735748 loss_floor_contact: 0.002552799880504608
[62/100] loss: 0.007869274355471134 loss_joints: 0.00025272872881032526 loss_collision: 0.026671893894672394 loss_jerk: 0.04652050510048866 loss_floor_contact: 0.0029730491805821657
[63/100] loss: 0.007992644794285297 loss_joints: 0.0001146155409514904 loss_collision: 0.029632721096277237 loss_jerk: 0.0465424619615078 loss_floor_contact: 0.0026051090098917484
[64/100] loss: 0.007869809865951538 loss_joints: 0.0001005642261588946 loss_collision: 0.028894053772091866 loss_jerk: 0.04639837145805359 loss_floor_contact: 0.0024000259581953287
[65/100] loss: 0.007679813075810671 loss_joints: 0.00016580623923800886 loss_collision: 0.02654927596449852 loss_jerk: 0.04608740657567978 loss_floor_contact: 0.0025033883284777403
[66/100] loss: 0.007527466397732496 loss_joints: 0.00021471786021720618 loss_collision: 0.02541438676416874 loss_jerk: 0.04560720920562744 loss_floor_contact: 0.002105887047946453
[67/100] loss: 0.007550240494310856 loss_joints: 0.00015882350271567702 loss_collision: 0.026358826085925102 loss_jerk: 0.04532349482178688 loss_floor_contact: 0.0022318430710583925
[68/100] loss: 0.007486213464289904 loss_joints: 0.00018175991135649383 loss_collision: 0.025705760344862938 loss_jerk: 0.04511852189898491 loss_floor_contact: 0.00222024810500443
[69/100] loss: 0.007649640552699566 loss_joints: 0.0003118239692412317 loss_collision: 0.02527877502143383 loss_jerk: 0.04489750787615776 loss_floor_contact: 0.0032018781639635563
[70/100] loss: 0.007537891156971455 loss_joints: 0.00031907670199871063 loss_collision: 0.024227993562817574 loss_jerk: 0.044718511402606964 loss_floor_contact: 0.0032416407484561205
[71/100] loss: 0.007513365242630243 loss_joints: 0.0002518396358937025 loss_collision: 0.025327282026410103 loss_jerk: 0.04445129260420799 loss_floor_contact: 0.002836679806932807
[72/100] loss: 0.007525405380874872 loss_joints: 0.00012478142161853611 loss_collision: 0.027712585404515266 loss_jerk: 0.04432893544435501 loss_floor_contact: 0.001964715076610446
[73/100] loss: 0.007483366411179304 loss_joints: 9.451633377466351e-05 loss_collision: 0.027619609609246254 loss_jerk: 0.04423060268163681 loss_floor_contact: 0.0020382872316986322
[74/100] loss: 0.007371224462985992 loss_joints: 0.00010915138409473002 loss_collision: 0.026286397129297256 loss_jerk: 0.04417673125863075 loss_floor_contact: 0.002157601062208414
[75/100] loss: 0.007251304108649492 loss_joints: 0.00017907812434714288 loss_collision: 0.02411687932908535 loss_jerk: 0.04414134845137596 loss_floor_contact: 0.0024640292394906282
[76/100] loss: 0.007350836414843798 loss_joints: 0.00019057351164519787 loss_collision: 0.025312382727861404 loss_jerk: 0.0440712571144104 loss_floor_contact: 0.0022189852315932512
[77/100] loss: 0.007353604305535555 loss_joints: 0.00013600231613963842 loss_collision: 0.025894902646541595 loss_jerk: 0.04409448057413101 loss_floor_contact: 0.002186634810641408
[78/100] loss: 0.007291752845048904 loss_joints: 7.006250962149352e-05 loss_collision: 0.026244498789310455 loss_jerk: 0.0440288707613945 loss_floor_contact: 0.0019435306312516332
[79/100] loss: 0.007389127742499113 loss_joints: 3.393462247913703e-05 loss_collision: 0.02758159674704075 loss_jerk: 0.04384864494204521 loss_floor_contact: 0.002121689496561885
[80/100] loss: 0.0072629074566066265 loss_joints: 3.481347084743902e-05 loss_collision: 0.026764485985040665 loss_jerk: 0.04364796727895737 loss_floor_contact: 0.0018684824462980032
[81/100] loss: 0.0072308871895074844 loss_joints: 5.015954957343638e-05 loss_collision: 0.026665179058909416 loss_jerk: 0.04350680112838745 loss_floor_contact: 0.0016352890525013208
[82/100] loss: 0.0072081866674125195 loss_joints: 9.263849642593414e-05 loss_collision: 0.02577519789338112 loss_jerk: 0.043400488793849945 loss_floor_contact: 0.0019797966815531254
[83/100] loss: 0.007314397022128105 loss_joints: 0.0001525014522485435 loss_collision: 0.026414159685373306 loss_jerk: 0.043199796229600906 loss_floor_contact: 0.002004998968914151
[84/100] loss: 0.00730555085465312 loss_joints: 0.00018890922365244478 loss_collision: 0.026292843744158745 loss_jerk: 0.042962271720170975 loss_floor_contact: 0.0019112983718514442
[85/100] loss: 0.007207056507468224 loss_joints: 0.00018146201909985393 loss_collision: 0.02544419653713703 loss_jerk: 0.04283149912953377 loss_floor_contact: 0.001980248373001814
[86/100] loss: 0.007246081717312336 loss_joints: 0.00019045796943828464 loss_collision: 0.025821136310696602 loss_jerk: 0.04276566207408905 loss_floor_contact: 0.001969439210370183
[87/100] loss: 0.007287835236638784 loss_joints: 0.00017662665050011128 loss_collision: 0.02625310607254505 loss_jerk: 0.0427764430642128 loss_floor_contact: 0.002082536229863763
[88/100] loss: 0.0071859885938465595 loss_joints: 0.00014127936447039247 loss_collision: 0.025971032679080963 loss_jerk: 0.04277569055557251 loss_floor_contact: 0.0017003678949549794
[89/100] loss: 0.007066661957651377 loss_joints: 9.908369247568771e-05 loss_collision: 0.025143587961792946 loss_jerk: 0.0428306870162487 loss_floor_contact: 0.0017015080666169524
[90/100] loss: 0.007129270117729902 loss_joints: 5.1673021516762674e-05 loss_collision: 0.026292726397514343 loss_jerk: 0.042888808995485306 loss_floor_contact: 0.001594433793798089
[91/100] loss: 0.0072598946280777454 loss_joints: 3.410547651583329e-05 loss_collision: 0.02763530984520912 loss_jerk: 0.04289467632770538 loss_floor_contact: 0.0017279041931033134
[92/100] loss: 0.007227187976241112 loss_joints: 2.9155044103390537e-05 loss_collision: 0.027241086587309837 loss_jerk: 0.04285401478409767 loss_floor_contact: 0.0018852273933589458
[93/100] loss: 0.007220334839075804 loss_joints: 3.237538840039633e-05 loss_collision: 0.027406515553593636 loss_jerk: 0.042784467339515686 loss_floor_contact: 0.0016886087832972407
[94/100] loss: 0.0070954435504972935 loss_joints: 4.214626824250445e-05 loss_collision: 0.026232467964291573 loss_jerk: 0.042700543999671936 loss_floor_contact: 0.0015999621246010065
[95/100] loss: 0.007053303997963667 loss_joints: 5.421944661065936e-05 loss_collision: 0.02577866055071354 loss_jerk: 0.04260458052158356 loss_floor_contact: 0.0016076015308499336
[96/100] loss: 0.007071536500006914 loss_joints: 6.948001828277484e-05 loss_collision: 0.025867169722914696 loss_jerk: 0.042541734874248505 loss_floor_contact: 0.001611660118214786
[97/100] loss: 0.007097323425114155 loss_joints: 8.728883403819054e-05 loss_collision: 0.025960298255085945 loss_jerk: 0.04249931871891022 loss_floor_contact: 0.0016407311195507646
[98/100] loss: 0.007144093979150057 loss_joints: 9.638781193643808e-05 loss_collision: 0.026284242048859596 loss_jerk: 0.0424613319337368 loss_floor_contact: 0.0017314860597252846
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-13.png]
[99/100] loss: 0.007029793690890074 loss_joints: 0.00010024205403169617 loss_collision: 0.025279251858592033 loss_jerk: 0.04242970794439316 loss_floor_contact: 0.0015865559689700603
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path1-run12-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 524.40665                                                    ║
    ║     rollout = 240.65463                                                    ║
    ║     sdf     = 43.33308                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00702979                                                 ║
    ║     joints    = 0.00010024                                                 ║
    ║     collision = 0.02527925                                                 ║
    ║     jerk      = 0.04242971                                                 ║
    ║     floor     = 0.00158656                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	9m4.488s
user	7m45.041s
sys	0m34.294s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x6066a2f0cc00] using SAR=1/1
[libx264 @ 0x6066a2f0cc00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x6066a2f0cc00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x6066a2f0cc00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_run_12.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x6066a2f0afc0] video:165kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.692585%
frame=   25 fps=0.0 q=-1.0 Lsize=     166kB time=00:00:02.20 bitrate= 618.0kbits/s speed= 3.4x    
[libx264 @ 0x6066a2f0cc00] frame I:1     Avg QP:18.54  size: 72606
[libx264 @ 0x6066a2f0cc00] frame P:8     Avg QP:20.92  size:  9353
[libx264 @ 0x6066a2f0cc00] frame B:16    Avg QP:22.66  size:  1292
[libx264 @ 0x6066a2f0cc00] consecutive B-frames:  8.0% 16.0% 12.0% 64.0%
[libx264 @ 0x6066a2f0cc00] mb I  I16..4:  5.0% 65.3% 29.7%
[libx264 @ 0x6066a2f0cc00] mb P  I16..4:  0.2%  1.7%  1.6%  P16..4:  9.1%  1.7%  1.2%  0.0%  0.0%    skip:84.5%
[libx264 @ 0x6066a2f0cc00] mb B  I16..4:  0.0%  0.4%  0.1%  B16..8:  8.5%  0.8%  0.2%  direct: 0.4%  skip:89.6%  L0:37.2% L1:60.5% BI: 2.3%
[libx264 @ 0x6066a2f0cc00] 8x8 transform intra:62.7% inter:51.8%
[libx264 @ 0x6066a2f0cc00] coded y,uvDC,uvAC intra: 30.8% 19.5% 18.3% inter: 2.0% 2.2% 0.5%
[libx264 @ 0x6066a2f0cc00] i16 v,h,dc,p: 65% 21% 14%  0%
[libx264 @ 0x6066a2f0cc00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 52%  9% 33%  1%  1%  1%  1%  1%  1%
[libx264 @ 0x6066a2f0cc00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 35% 23% 13%  5%  4%  4%  4%  9%  3%
[libx264 @ 0x6066a2f0cc00] i8c dc,h,v,p: 89%  2%  6%  3%
[libx264 @ 0x6066a2f0cc00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x6066a2f0cc00] ref P L0: 63.3% 19.2% 14.0%  3.5%
[libx264 @ 0x6066a2f0cc00] ref B L0: 78.6% 18.0%  3.4%
[libx264 @ 0x6066a2f0cc00] ref B L1: 97.3%  2.7%
[libx264 @ 0x6066a2f0cc00] kb/s:537.92
[INFO] Video saved as 'bin/result/optim_run_12.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 26 = (8*3 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<07:58,  4.83s/it]  2%|▏         | 2/100 [00:06<04:55,  3.01s/it]  3%|▎         | 3/100 [00:08<04:14,  2.63s/it]  4%|▍         | 4/100 [00:10<03:26,  2.15s/it]  5%|▌         | 5/100 [00:11<03:08,  1.98s/it]  6%|▌         | 6/100 [00:13<02:52,  1.84s/it]  7%|▋         | 7/100 [00:14<02:38,  1.71s/it]  8%|▊         | 8/100 [00:16<02:28,  1.61s/it]  9%|▉         | 9/100 [00:17<02:18,  1.53s/it] 10%|█         | 10/100 [00:19<02:16,  1.52s/it] 11%|█         | 11/100 [00:20<02:11,  1.48s/it] 12%|█▏        | 12/100 [00:21<02:11,  1.49s/it] 13%|█▎        | 13/100 [00:23<02:05,  1.44s/it] 14%|█▍        | 14/100 [00:24<02:02,  1.43s/it] 15%|█▌        | 15/100 [00:26<02:05,  1.48s/it] 16%|█▌        | 16/100 [00:27<02:04,  1.48s/it] 17%|█▋        | 17/100 [00:29<02:07,  1.53s/it] 18%|█▊        | 18/100 [00:31<02:07,  1.55s/it] 19%|█▉        | 19/100 [00:32<02:06,  1.56s/it] 20%|██        | 20/100 [00:34<02:00,  1.51s/it] 21%|██        | 21/100 [00:35<01:52,  1.43s/it] 22%|██▏       | 22/100 [00:36<01:49,  1.40s/it] 23%|██▎       | 23/100 [00:38<01:50,  1.43s/it] 24%|██▍       | 24/100 [00:39<01:48,  1.43s/it] 25%|██▌       | 25/100 [00:41<01:49,  1.45s/it] 26%|██▌       | 26/100 [00:42<01:49,  1.48s/it] 27%|██▋       | 27/100 [00:43<01:42,  1.41s/it] 28%|██▊       | 28/100 [00:45<01:40,  1.40s/it] 29%|██▉       | 29/100 [00:46<01:44,  1.47s/it] 30%|███       | 30/100 [00:48<01:42,  1.46s/it] 31%|███       | 31/100 [00:49<01:42,  1.49s/it] 32%|███▏      | 32/100 [00:51<01:37,  1.44s/it] 33%|███▎      | 33/100 [00:52<01:36,  1.43s/it] 34%|███▍      | 34/100 [00:53<01:32,  1.40s/it] 35%|███▌      | 35/100 [00:55<01:32,  1.43s/it] 36%|███▌      | 36/100 [00:57<01:35,  1.49s/it] 37%|███▋      | 37/100 [00:58<01:39,  1.57s/it] 38%|███▊      | 38/100 [01:00<01:44,  1.68s/it] 39%|███▉      | 39/100 [01:02<01:40,  1.66s/it] 40%|████      | 40/100 [01:03<01:35,  1.58s/it] 41%|████      | 41/100 [01:05<01:38,  1.67s/it] 42%|████▏     | 42/100 [01:07<01:38,  1.70s/it] 43%|████▎     | 43/100 [01:09<01:39,  1.75s/it] 44%|████▍     | 44/100 [01:11<01:39,  1.78s/it] 45%|████▌     | 45/100 [01:12<01:32,  1.69s/it] 46%|████▌     | 46/100 [01:14<01:34,  1.75s/it] 47%|████▋     | 47/100 [01:16<01:32,  1.74s/it] 48%|████▊     | 48/100 [01:17<01:27,  1.69s/it] 49%|████▉     | 49/100 [01:19<01:27,  1.71s/it] 50%|█████     | 50/100 [01:21<01:28,  1.77s/it] 51%|█████     | 51/100 [01:23<01:31,  1.87s/it] 52%|█████▏    | 52/100 [01:25<01:25,  1.78s/it] 53%|█████▎    | 53/100 [01:26<01:19,  1.70s/it] 54%|█████▍    | 54/100 [01:28<01:14,  1.62s/it] 55%|█████▌    | 55/100 [01:29<01:11,  1.58s/it] 56%|█████▌    | 56/100 [01:31<01:10,  1.59s/it] 57%|█████▋    | 57/100 [01:32<01:11,  1.67s/it] 58%|█████▊    | 58/100 [01:34<01:10,  1.67s/it] 59%|█████▉    | 59/100 [01:36<01:10,  1.72s/it] 60%|██████    | 60/100 [01:37<01:06,  1.66s/it] 61%|██████    | 61/100 [01:39<01:03,  1.62s/it] 62%|██████▏   | 62/100 [01:40<00:57,  1.51s/it] 63%|██████▎   | 63/100 [01:42<00:56,  1.53s/it] 64%|██████▍   | 64/100 [01:44<00:56,  1.58s/it] 65%|██████▌   | 65/100 [01:45<00:53,  1.53s/it] 66%|██████▌   | 66/100 [01:47<00:53,  1.58s/it] 67%|██████▋   | 67/100 [01:49<00:54,  1.66s/it] 68%|██████▊   | 68/100 [01:50<00:52,  1.63s/it] 69%|██████▉   | 69/100 [01:51<00:47,  1.53s/it] 70%|███████   | 70/100 [01:53<00:45,  1.52s/it] 71%|███████   | 71/100 [01:54<00:43,  1.51s/it] 72%|███████▏  | 72/100 [01:56<00:43,  1.55s/it] 73%|███████▎  | 73/100 [01:58<00:43,  1.60s/it] 74%|███████▍  | 74/100 [01:59<00:39,  1.52s/it] 75%|███████▌  | 75/100 [02:00<00:37,  1.49s/it] 76%|███████▌  | 76/100 [02:02<00:36,  1.50s/it] 77%|███████▋  | 77/100 [02:04<00:36,  1.58s/it] 78%|███████▊  | 78/100 [02:06<00:36,  1.67s/it] 79%|███████▉  | 79/100 [02:07<00:34,  1.65s/it] 80%|████████  | 80/100 [02:09<00:31,  1.59s/it] 81%|████████  | 81/100 [02:10<00:30,  1.60s/it] 82%|████████▏ | 82/100 [02:12<00:27,  1.54s/it] 83%|████████▎ | 83/100 [02:13<00:26,  1.54s/it] 84%|████████▍ | 84/100 [02:15<00:24,  1.55s/it] 85%|████████▌ | 85/100 [02:16<00:23,  1.53s/it] 86%|████████▌ | 86/100 [02:18<00:20,  1.48s/it] 87%|████████▋ | 87/100 [02:19<00:20,  1.57s/it] 88%|████████▊ | 88/100 [02:21<00:19,  1.63s/it] 89%|████████▉ | 89/100 [02:23<00:18,  1.70s/it] 90%|█████████ | 90/100 [02:25<00:16,  1.63s/it] 91%|█████████ | 91/100 [02:26<00:15,  1.67s/it] 92%|█████████▏| 92/100 [02:28<00:13,  1.70s/it] 93%|█████████▎| 93/100 [02:30<00:11,  1.69s/it] 94%|█████████▍| 94/100 [02:31<00:10,  1.70s/it] 95%|█████████▌| 95/100 [02:33<00:08,  1.76s/it] 96%|█████████▌| 96/100 [02:35<00:07,  1.78s/it] 97%|█████████▋| 97/100 [02:37<00:05,  1.74s/it] 98%|█████████▊| 98/100 [02:39<00:03,  1.78s/it] 99%|█████████▉| 99/100 [02:40<00:01,  1.68s/it]100%|██████████| 100/100 [02:45<00:00,  2.49s/it]100%|██████████| 100/100 [02:45<00:00,  1.65s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-4.png]
[0/100] loss: 1.140720248222351 loss_joints: 1.1117140054702759 loss_collision: 0.03557125851511955 loss_jerk: 0.04850900173187256 loss_floor_contact: 0.20598241686820984
[1/100] loss: 1.1472651958465576 loss_joints: 1.1203761100769043 loss_collision: 0.023870177567005157 loss_jerk: 0.04117630422115326 loss_floor_contact: 0.2038438469171524
[2/100] loss: 1.1380505561828613 loss_joints: 1.1109683513641357 loss_collision: 0.024997293949127197 loss_jerk: 0.03918804973363876 loss_floor_contact: 0.20663797855377197
[3/100] loss: 1.1136279106140137 loss_joints: 1.0869060754776 loss_collision: 0.022329650819301605 loss_jerk: 0.031146656721830368 loss_floor_contact: 0.21374176442623138
[4/100] loss: 1.0944750308990479 loss_joints: 1.0702121257781982 loss_collision: 0.006262399256229401 loss_jerk: 0.02612532489001751 loss_floor_contact: 0.21024130284786224
[5/100] loss: 1.0882269144058228 loss_joints: 1.0644340515136719 loss_collision: 0.0 loss_jerk: 0.025669002905488014 loss_floor_contact: 0.21225927770137787
[6/100] loss: 1.0793951749801636 loss_joints: 1.0557200908660889 loss_collision: 0.0 loss_jerk: 0.024202287197113037 loss_floor_contact: 0.2125493288040161
[7/100] loss: 1.069041132926941 loss_joints: 1.0453383922576904 loss_collision: 0.0 loss_jerk: 0.020670795813202858 loss_floor_contact: 0.21635672450065613
[8/100] loss: 1.0576516389846802 loss_joints: 1.0328614711761475 loss_collision: 0.0 loss_jerk: 0.018815720453858376 loss_floor_contact: 0.22908616065979004
[9/100] loss: 1.0454593896865845 loss_joints: 1.019597053527832 loss_collision: 0.0 loss_jerk: 0.01865849271416664 loss_floor_contact: 0.2399652600288391
[10/100] loss: 1.0323289632797241 loss_joints: 1.0056309700012207 loss_collision: 0.0 loss_jerk: 0.01840180903673172 loss_floor_contact: 0.24857740104198456
[11/100] loss: 1.0216509103775024 loss_joints: 0.9941384792327881 loss_collision: 0.0 loss_jerk: 0.018062297254800797 loss_floor_contact: 0.2570613622665405
[12/100] loss: 1.015337347984314 loss_joints: 0.9872202277183533 loss_collision: 0.0 loss_jerk: 0.017718303948640823 loss_floor_contact: 0.26345258951187134
[13/100] loss: 1.0108330249786377 loss_joints: 0.9821316003799438 loss_collision: 0.0 loss_jerk: 0.017430400475859642 loss_floor_contact: 0.26958370208740234
[14/100] loss: 1.007575273513794 loss_joints: 0.9783007502555847 loss_collision: 0.0 loss_jerk: 0.017195846885442734 loss_floor_contact: 0.27554935216903687
[15/100] loss: 1.0048110485076904 loss_joints: 0.9755314588546753 loss_collision: 0.0 loss_jerk: 0.016991708427667618 loss_floor_contact: 0.27580493688583374
[16/100] loss: 1.0027329921722412 loss_joints: 0.9735616445541382 loss_collision: 0.0 loss_jerk: 0.016807522624731064 loss_floor_contact: 0.27490609884262085
[17/100] loss: 1.0009446144104004 loss_joints: 0.9719142317771912 loss_collision: 0.0 loss_jerk: 0.01664244569838047 loss_floor_contact: 0.27366194128990173
[18/100] loss: 0.9993732571601868 loss_joints: 0.9704599380493164 loss_collision: 0.0 loss_jerk: 0.01649857684969902 loss_floor_contact: 0.27263474464416504
[19/100] loss: 0.9979692697525024 loss_joints: 0.9691096544265747 loss_collision: 0.0 loss_jerk: 0.016376953572034836 loss_floor_contact: 0.27221930027008057
[20/100] loss: 0.9968218803405762 loss_joints: 0.9680029153823853 loss_collision: 0.0 loss_jerk: 0.016273677349090576 loss_floor_contact: 0.27191585302352905
[21/100] loss: 0.9957132339477539 loss_joints: 0.9670449495315552 loss_collision: 0.0 loss_jerk: 0.016187502071261406 loss_floor_contact: 0.2704954147338867
[22/100] loss: 0.9948582053184509 loss_joints: 0.9663068652153015 loss_collision: 0.0 loss_jerk: 0.01611710526049137 loss_floor_contact: 0.2693963050842285
[23/100] loss: 0.9938966035842896 loss_joints: 0.9654877185821533 loss_collision: 0.0 loss_jerk: 0.01605927012860775 loss_floor_contact: 0.26802974939346313
[24/100] loss: 0.9930449724197388 loss_joints: 0.9647727012634277 loss_collision: 0.0 loss_jerk: 0.016009395942091942 loss_floor_contact: 0.26671361923217773
[25/100] loss: 0.992326021194458 loss_joints: 0.964171290397644 loss_collision: 0.0 loss_jerk: 0.01596543937921524 loss_floor_contact: 0.26558154821395874
[26/100] loss: 0.9917510151863098 loss_joints: 0.9636887311935425 loss_collision: 0.0 loss_jerk: 0.015927165746688843 loss_floor_contact: 0.2646957039833069
[27/100] loss: 0.991266667842865 loss_joints: 0.9632809162139893 loss_collision: 0.0 loss_jerk: 0.015893908217549324 loss_floor_contact: 0.26396316289901733
[28/100] loss: 0.9908303618431091 loss_joints: 0.9629125595092773 loss_collision: 0.0 loss_jerk: 0.01586584746837616 loss_floor_contact: 0.2633126974105835
[29/100] loss: 0.9904189109802246 loss_joints: 0.9625641703605652 loss_collision: 0.0 loss_jerk: 0.015841610729694366 loss_floor_contact: 0.2627059817314148
[30/100] loss: 0.9900238513946533 loss_joints: 0.9622289538383484 loss_collision: 0.0 loss_jerk: 0.01582036167383194 loss_floor_contact: 0.26212865114212036
[31/100] loss: 0.989647626876831 loss_joints: 0.9619094729423523 loss_collision: 0.0 loss_jerk: 0.015800243243575096 loss_floor_contact: 0.2615813612937927
[32/100] loss: 0.9892963171005249 loss_joints: 0.961611270904541 loss_collision: 0.0 loss_jerk: 0.015780769288539886 loss_floor_contact: 0.26106923818588257
[33/100] loss: 0.9889690279960632 loss_joints: 0.9613337516784668 loss_collision: 0.0 loss_jerk: 0.015761643648147583 loss_floor_contact: 0.2605910897254944
[34/100] loss: 0.9886597990989685 loss_joints: 0.9610714912414551 loss_collision: 0.0 loss_jerk: 0.015742668882012367 loss_floor_contact: 0.2601403594017029
[35/100] loss: 0.9883635640144348 loss_joints: 0.9608201384544373 loss_collision: 0.0 loss_jerk: 0.01572400890290737 loss_floor_contact: 0.25971001386642456
[36/100] loss: 0.9880766868591309 loss_joints: 0.9605766534805298 loss_collision: 0.0 loss_jerk: 0.01570606790482998 loss_floor_contact: 0.2592945694923401
[37/100] loss: 0.9877977967262268 loss_joints: 0.9603397250175476 loss_collision: 0.0 loss_jerk: 0.015689071267843246 loss_floor_contact: 0.2588915228843689
[38/100] loss: 0.9875219464302063 loss_joints: 0.9601089954376221 loss_collision: 0.0 loss_jerk: 0.015672340989112854 loss_floor_contact: 0.2584573030471802
[39/100] loss: 0.987251341342926 loss_joints: 0.9598848223686218 loss_collision: 0.0 loss_jerk: 0.015655428171157837 loss_floor_contact: 0.25800999999046326
[40/100] loss: 0.9869875907897949 loss_joints: 0.9596658945083618 loss_collision: 0.0 loss_jerk: 0.01563795655965805 loss_floor_contact: 0.25757938623428345
[41/100] loss: 0.9867290258407593 loss_joints: 0.959450364112854 loss_collision: 0.0 loss_jerk: 0.015619092620909214 loss_floor_contact: 0.2571679949760437
[42/100] loss: 0.9864734411239624 loss_joints: 0.9592357873916626 loss_collision: 0.0 loss_jerk: 0.015599309466779232 loss_floor_contact: 0.256777286529541
[43/100] loss: 0.9862180948257446 loss_joints: 0.9590193629264832 loss_collision: 0.0 loss_jerk: 0.01557936705648899 loss_floor_contact: 0.25640755891799927
[44/100] loss: 0.985960841178894 loss_joints: 0.9587990641593933 loss_collision: 0.0 loss_jerk: 0.015560834668576717 loss_floor_contact: 0.2560570240020752
[45/100] loss: 0.9857003688812256 loss_joints: 0.9585736989974976 loss_collision: 0.0 loss_jerk: 0.015545043163001537 loss_floor_contact: 0.2557221055030823
[46/100] loss: 0.9854358434677124 loss_joints: 0.9583426713943481 loss_collision: 0.0 loss_jerk: 0.015533136203885078 loss_floor_contact: 0.255398690700531
[47/100] loss: 0.9851674437522888 loss_joints: 0.958106517791748 loss_collision: 0.0 loss_jerk: 0.01552553754299879 loss_floor_contact: 0.2550835609436035
[48/100] loss: 0.9848954677581787 loss_joints: 0.957865834236145 loss_collision: 0.0 loss_jerk: 0.015522083267569542 loss_floor_contact: 0.2547740936279297
[49/100] loss: 0.9846203327178955 loss_joints: 0.9576210379600525 loss_collision: 0.0 loss_jerk: 0.015523184090852737 loss_floor_contact: 0.25446924567222595
[50/100] loss: 0.9843422174453735 loss_joints: 0.9573725461959839 loss_collision: 0.0 loss_jerk: 0.015528376214206219 loss_floor_contact: 0.25416862964630127
[51/100] loss: 0.9840617775917053 loss_joints: 0.9571208953857422 loss_collision: 0.0 loss_jerk: 0.015536499209702015 loss_floor_contact: 0.25387245416641235
[52/100] loss: 0.9837791919708252 loss_joints: 0.9568662047386169 loss_collision: 0.0 loss_jerk: 0.015548300929367542 loss_floor_contact: 0.2535814344882965
[53/100] loss: 0.9834944605827332 loss_joints: 0.9566086530685425 loss_collision: 0.0 loss_jerk: 0.015562291257083416 loss_floor_contact: 0.2532958388328552
[54/100] loss: 0.9832082986831665 loss_joints: 0.9563487768173218 loss_collision: 0.0 loss_jerk: 0.015579132363200188 loss_floor_contact: 0.2530161142349243
[55/100] loss: 0.9829211235046387 loss_joints: 0.9560871124267578 loss_collision: 0.0 loss_jerk: 0.015598209574818611 loss_floor_contact: 0.2527422308921814
[56/100] loss: 0.9826338291168213 loss_joints: 0.9558244943618774 loss_collision: 0.0 loss_jerk: 0.015619398094713688 loss_floor_contact: 0.25247424840927124
[57/100] loss: 0.9823464751243591 loss_joints: 0.9555615782737732 loss_collision: 0.0 loss_jerk: 0.01564290188252926 loss_floor_contact: 0.2522064745426178
[58/100] loss: 0.9820569157600403 loss_joints: 0.955298900604248 loss_collision: 0.0 loss_jerk: 0.01566820964217186 loss_floor_contact: 0.2519117593765259
[59/100] loss: 0.9817690849304199 loss_joints: 0.9550372362136841 loss_collision: 0.0 loss_jerk: 0.015695467591285706 loss_floor_contact: 0.25162273645401
[60/100] loss: 0.9814837574958801 loss_joints: 0.9547774195671082 loss_collision: 0.0 loss_jerk: 0.01572383940219879 loss_floor_contact: 0.25133955478668213
[61/100] loss: 0.9812016487121582 loss_joints: 0.9545199871063232 loss_collision: 0.0 loss_jerk: 0.01575375907123089 loss_floor_contact: 0.25106287002563477
[62/100] loss: 0.980923056602478 loss_joints: 0.954265296459198 loss_collision: 0.0 loss_jerk: 0.015784509479999542 loss_floor_contact: 0.2507930397987366
[63/100] loss: 0.9806488752365112 loss_joints: 0.954014241695404 loss_collision: 0.0 loss_jerk: 0.0158157330006361 loss_floor_contact: 0.2505309283733368
[64/100] loss: 0.9803792238235474 loss_joints: 0.9537668228149414 loss_collision: 0.0 loss_jerk: 0.01584700495004654 loss_floor_contact: 0.25027692317962646
[65/100] loss: 0.980114758014679 loss_joints: 0.9535238146781921 loss_collision: 0.0 loss_jerk: 0.015878161415457726 loss_floor_contact: 0.2500314712524414
[66/100] loss: 0.9798559546470642 loss_joints: 0.9532855749130249 loss_collision: 0.0 loss_jerk: 0.015908651053905487 loss_floor_contact: 0.24979525804519653
[67/100] loss: 0.9796033501625061 loss_joints: 0.9530526399612427 loss_collision: 0.0 loss_jerk: 0.015938306227326393 loss_floor_contact: 0.2495686113834381
[68/100] loss: 0.9793573021888733 loss_joints: 0.9528254270553589 loss_collision: 0.0 loss_jerk: 0.01596716418862343 loss_floor_contact: 0.24935191869735718
[69/100] loss: 0.9791188836097717 loss_joints: 0.9526047706604004 loss_collision: 0.0 loss_jerk: 0.015995027497410774 loss_floor_contact: 0.24914595484733582
[70/100] loss: 0.9788895845413208 loss_joints: 0.9523922204971313 loss_collision: 0.0 loss_jerk: 0.01602182909846306 loss_floor_contact: 0.24895161390304565
[71/100] loss: 0.9786702990531921 loss_joints: 0.9521886706352234 loss_collision: 0.0 loss_jerk: 0.016046954318881035 loss_floor_contact: 0.24876947700977325
[72/100] loss: 0.9784630537033081 loss_joints: 0.951995849609375 loss_collision: 0.0 loss_jerk: 0.01607048697769642 loss_floor_contact: 0.2486013025045395
[73/100] loss: 0.9782692790031433 loss_joints: 0.9518153071403503 loss_collision: 0.0 loss_jerk: 0.016091354191303253 loss_floor_contact: 0.24844813346862793
[74/100] loss: 0.978088915348053 loss_joints: 0.9516470432281494 loss_collision: 0.0 loss_jerk: 0.01610890030860901 loss_floor_contact: 0.24830985069274902
[75/100] loss: 0.9779210090637207 loss_joints: 0.9514903426170349 loss_collision: 0.0 loss_jerk: 0.01612168736755848 loss_floor_contact: 0.24818482995033264
[76/100] loss: 0.9777623414993286 loss_joints: 0.9513425230979919 loss_collision: 0.0 loss_jerk: 0.016129499301314354 loss_floor_contact: 0.2480686604976654
[77/100] loss: 0.9776102304458618 loss_joints: 0.9512013792991638 loss_collision: 0.0 loss_jerk: 0.016131671145558357 loss_floor_contact: 0.2479572743177414
[78/100] loss: 0.9774631857872009 loss_joints: 0.9510654807090759 loss_collision: 0.0 loss_jerk: 0.01612899638712406 loss_floor_contact: 0.24784791469573975
[79/100] loss: 0.9773202538490295 loss_joints: 0.950934112071991 loss_collision: 0.0 loss_jerk: 0.016121767461299896 loss_floor_contact: 0.2477394938468933
[80/100] loss: 0.9771815538406372 loss_joints: 0.9508073329925537 loss_collision: 0.0 loss_jerk: 0.01611064001917839 loss_floor_contact: 0.2476317286491394
[81/100] loss: 0.9770475029945374 loss_joints: 0.9506852626800537 loss_collision: 0.0 loss_jerk: 0.016096947714686394 loss_floor_contact: 0.2475254088640213
[82/100] loss: 0.9769182801246643 loss_joints: 0.9505680799484253 loss_collision: 0.0 loss_jerk: 0.016080748289823532 loss_floor_contact: 0.24742117524147034
[83/100] loss: 0.9767944812774658 loss_joints: 0.9504561424255371 loss_collision: 0.0 loss_jerk: 0.01606336422264576 loss_floor_contact: 0.24731987714767456
[84/100] loss: 0.9766762256622314 loss_joints: 0.9503495097160339 loss_collision: 0.0 loss_jerk: 0.016045041382312775 loss_floor_contact: 0.24722200632095337
[85/100] loss: 0.9765638113021851 loss_joints: 0.9502484202384949 loss_collision: 0.0 loss_jerk: 0.016026198863983154 loss_floor_contact: 0.24712806940078735
[86/100] loss: 0.9764576554298401 loss_joints: 0.9501530528068542 loss_collision: 0.0 loss_jerk: 0.016007771715521812 loss_floor_contact: 0.24703821539878845
[87/100] loss: 0.9763578772544861 loss_joints: 0.9500635862350464 loss_collision: 0.0 loss_jerk: 0.01599002256989479 loss_floor_contact: 0.24695277214050293
[88/100] loss: 0.976264238357544 loss_joints: 0.9499797821044922 loss_collision: 0.0 loss_jerk: 0.015972716733813286 loss_floor_contact: 0.2468719780445099
[89/100] loss: 0.976177453994751 loss_joints: 0.9499021768569946 loss_collision: 0.0 loss_jerk: 0.015956658869981766 loss_floor_contact: 0.24679610133171082
[90/100] loss: 0.9760969877243042 loss_joints: 0.9498302936553955 loss_collision: 0.0 loss_jerk: 0.015941640362143517 loss_floor_contact: 0.2467251867055893
[91/100] loss: 0.9760234951972961 loss_joints: 0.9497647285461426 loss_collision: 0.0 loss_jerk: 0.015928102657198906 loss_floor_contact: 0.246659517288208
[92/100] loss: 0.9759569764137268 loss_joints: 0.9497054815292358 loss_collision: 0.0 loss_jerk: 0.015915734693408012 loss_floor_contact: 0.24659952521324158
[93/100] loss: 0.9758973121643066 loss_joints: 0.9496523141860962 loss_collision: 0.0 loss_jerk: 0.015905136242508888 loss_floor_contact: 0.24654504656791687
[94/100] loss: 0.9758448600769043 loss_joints: 0.9496056437492371 loss_collision: 0.0 loss_jerk: 0.015895597636699677 loss_floor_contact: 0.24649685621261597
[95/100] loss: 0.9757998585700989 loss_joints: 0.9495655298233032 loss_collision: 0.0 loss_jerk: 0.015887921676039696 loss_floor_contact: 0.24645480513572693
[96/100] loss: 0.9757620692253113 loss_joints: 0.9495320320129395 loss_collision: 0.0 loss_jerk: 0.01588120497763157 loss_floor_contact: 0.24641937017440796
[97/100] loss: 0.9757315516471863 loss_joints: 0.9495048522949219 loss_collision: 0.0 loss_jerk: 0.01587636023759842 loss_floor_contact: 0.24639052152633667
[98/100] loss: 0.9757087230682373 loss_joints: 0.9494845867156982 loss_collision: 0.0 loss_jerk: 0.015872575342655182 loss_floor_contact: 0.24636852741241455
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-4.png]
[99/100] loss: 0.97569340467453 loss_joints: 0.9494709968566895 loss_collision: 0.0 loss_jerk: 0.015870247036218643 loss_floor_contact: 0.24635401368141174
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path2-run3-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 165.05198                                                    ║
    ║     rollout = 63.31442                                                     ║
    ║     sdf     = 26.65869                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.97569340                                                 ║
    ║     joints    = 0.94947100                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.01587025                                                 ║
    ║     floor     = 0.24635401                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	3m7.624s
user	2m23.996s
sys	0m11.772s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x57cbf4e8fc00] using SAR=1/1
[libx264 @ 0x57cbf4e8fc00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x57cbf4e8fc00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x57cbf4e8fc00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_walk_3.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x57cbf4e8dfc0] video:189kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.605433%
frame=   25 fps=0.0 q=-1.0 Lsize=     190kB time=00:00:02.20 bitrate= 706.4kbits/s speed=3.11x    
[libx264 @ 0x57cbf4e8fc00] frame I:1     Avg QP:19.00  size: 69419
[libx264 @ 0x57cbf4e8fc00] frame P:9     Avg QP:19.86  size: 10949
[libx264 @ 0x57cbf4e8fc00] frame B:15    Avg QP:21.88  size:  1629
[libx264 @ 0x57cbf4e8fc00] consecutive B-frames: 12.0% 24.0%  0.0% 64.0%
[libx264 @ 0x57cbf4e8fc00] mb I  I16..4:  4.1% 67.5% 28.4%
[libx264 @ 0x57cbf4e8fc00] mb P  I16..4:  0.2%  1.7%  1.6%  P16..4: 10.1%  3.0%  2.1%  0.0%  0.0%    skip:81.4%
[libx264 @ 0x57cbf4e8fc00] mb B  I16..4:  0.1%  0.5%  0.1%  B16..8: 10.7%  1.0%  0.3%  direct: 0.5%  skip:86.9%  L0:44.2% L1:52.3% BI: 3.5%
[libx264 @ 0x57cbf4e8fc00] 8x8 transform intra:63.7% inter:53.9%
[libx264 @ 0x57cbf4e8fc00] coded y,uvDC,uvAC intra: 30.5% 20.0% 19.0% inter: 2.8% 2.4% 0.8%
[libx264 @ 0x57cbf4e8fc00] i16 v,h,dc,p: 55% 24% 21%  0%
[libx264 @ 0x57cbf4e8fc00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 49%  8% 37%  1%  1%  1%  1%  2%  1%
[libx264 @ 0x57cbf4e8fc00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 35% 22% 14%  5%  4%  5%  4%  9%  3%
[libx264 @ 0x57cbf4e8fc00] i8c dc,h,v,p: 89%  2%  6%  2%
[libx264 @ 0x57cbf4e8fc00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x57cbf4e8fc00] ref P L0: 53.6% 10.3% 27.7%  8.4%
[libx264 @ 0x57cbf4e8fc00] ref B L0: 79.0% 18.8%  2.1%
[libx264 @ 0x57cbf4e8fc00] ref B L1: 97.4%  2.6%
[libx264 @ 0x57cbf4e8fc00] kb/s:615.67
[INFO] Video saved as 'bin/result/optim_walk_3.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 50 = (8*6 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:07<13:05,  7.93s/it]  2%|▏         | 2/100 [00:10<07:47,  4.77s/it]  3%|▎         | 3/100 [00:14<07:01,  4.35s/it]  4%|▍         | 4/100 [00:17<06:12,  3.88s/it]  5%|▌         | 5/100 [00:20<05:22,  3.40s/it]  6%|▌         | 6/100 [00:22<04:49,  3.08s/it]  7%|▋         | 7/100 [00:25<04:38,  3.00s/it]  8%|▊         | 8/100 [00:27<04:20,  2.83s/it]  9%|▉         | 9/100 [00:30<04:04,  2.69s/it] 10%|█         | 10/100 [00:32<03:50,  2.56s/it] 11%|█         | 11/100 [00:34<03:40,  2.48s/it] 12%|█▏        | 12/100 [00:36<03:30,  2.39s/it] 13%|█▎        | 13/100 [00:38<03:19,  2.29s/it] 14%|█▍        | 14/100 [00:41<03:18,  2.30s/it] 15%|█▌        | 15/100 [00:43<03:18,  2.34s/it] 16%|█▌        | 16/100 [00:46<03:17,  2.35s/it] 17%|█▋        | 17/100 [00:48<03:14,  2.34s/it] 18%|█▊        | 18/100 [00:50<03:11,  2.34s/it] 19%|█▉        | 19/100 [00:53<03:12,  2.38s/it] 20%|██        | 20/100 [00:55<03:12,  2.41s/it] 21%|██        | 21/100 [00:58<03:08,  2.38s/it] 22%|██▏       | 22/100 [01:00<03:03,  2.36s/it] 23%|██▎       | 23/100 [01:03<03:09,  2.46s/it] 24%|██▍       | 24/100 [01:05<03:05,  2.45s/it] 25%|██▌       | 25/100 [01:08<03:07,  2.49s/it] 26%|██▌       | 26/100 [01:10<03:03,  2.47s/it] 27%|██▋       | 27/100 [01:13<03:02,  2.50s/it] 28%|██▊       | 28/100 [01:15<03:00,  2.51s/it] 29%|██▉       | 29/100 [01:17<02:53,  2.45s/it] 30%|███       | 30/100 [01:20<02:49,  2.42s/it] 31%|███       | 31/100 [01:22<02:44,  2.38s/it] 32%|███▏      | 32/100 [01:24<02:40,  2.36s/it] 33%|███▎      | 33/100 [01:27<02:36,  2.34s/it] 34%|███▍      | 34/100 [01:29<02:31,  2.30s/it] 35%|███▌      | 35/100 [01:31<02:27,  2.27s/it] 36%|███▌      | 36/100 [01:33<02:24,  2.25s/it] 37%|███▋      | 37/100 [01:36<02:22,  2.27s/it] 38%|███▊      | 38/100 [01:38<02:20,  2.27s/it] 39%|███▉      | 39/100 [01:40<02:18,  2.27s/it] 40%|████      | 40/100 [01:42<02:15,  2.26s/it] 41%|████      | 41/100 [01:45<02:15,  2.30s/it] 42%|████▏     | 42/100 [01:47<02:17,  2.37s/it] 43%|████▎     | 43/100 [01:50<02:19,  2.44s/it] 44%|████▍     | 44/100 [01:52<02:17,  2.45s/it] 45%|████▌     | 45/100 [01:55<02:14,  2.44s/it] 46%|████▌     | 46/100 [01:57<02:13,  2.47s/it] 47%|████▋     | 47/100 [02:00<02:10,  2.46s/it] 48%|████▊     | 48/100 [02:02<02:06,  2.44s/it] 49%|████▉     | 49/100 [02:05<02:05,  2.47s/it] 50%|█████     | 50/100 [02:07<02:02,  2.44s/it] 51%|█████     | 51/100 [02:09<01:55,  2.36s/it] 52%|█████▏    | 52/100 [02:11<01:51,  2.33s/it] 53%|█████▎    | 53/100 [02:14<01:48,  2.30s/it] 54%|█████▍    | 54/100 [02:16<01:44,  2.28s/it] 55%|█████▌    | 55/100 [02:18<01:45,  2.35s/it] 56%|█████▌    | 56/100 [02:21<01:43,  2.36s/it] 57%|█████▋    | 57/100 [02:23<01:41,  2.36s/it] 58%|█████▊    | 58/100 [02:25<01:38,  2.34s/it] 59%|█████▉    | 59/100 [02:28<01:39,  2.43s/it] 60%|██████    | 60/100 [02:31<01:38,  2.45s/it] 61%|██████    | 61/100 [02:33<01:34,  2.42s/it] 62%|██████▏   | 62/100 [02:35<01:29,  2.37s/it] 63%|██████▎   | 63/100 [02:38<01:27,  2.36s/it] 64%|██████▍   | 64/100 [02:40<01:26,  2.41s/it] 65%|██████▌   | 65/100 [02:43<01:28,  2.52s/it] 66%|██████▌   | 66/100 [02:45<01:23,  2.45s/it] 67%|██████▋   | 67/100 [02:47<01:18,  2.39s/it] 68%|██████▊   | 68/100 [02:50<01:14,  2.33s/it] 69%|██████▉   | 69/100 [02:52<01:17,  2.49s/it] 70%|███████   | 70/100 [02:55<01:14,  2.48s/it] 71%|███████   | 71/100 [02:57<01:12,  2.49s/it] 72%|███████▏  | 72/100 [03:00<01:08,  2.45s/it] 73%|███████▎  | 73/100 [03:02<01:07,  2.49s/it] 74%|███████▍  | 74/100 [03:05<01:04,  2.47s/it] 75%|███████▌  | 75/100 [03:07<01:01,  2.46s/it] 76%|███████▌  | 76/100 [03:10<01:00,  2.54s/it] 77%|███████▋  | 77/100 [03:12<00:56,  2.45s/it] 78%|███████▊  | 78/100 [03:15<00:54,  2.47s/it] 79%|███████▉  | 79/100 [03:17<00:51,  2.48s/it] 80%|████████  | 80/100 [03:20<00:49,  2.46s/it] 81%|████████  | 81/100 [03:22<00:45,  2.40s/it] 82%|████████▏ | 82/100 [03:24<00:42,  2.36s/it] 83%|████████▎ | 83/100 [03:26<00:40,  2.36s/it] 84%|████████▍ | 84/100 [03:29<00:37,  2.35s/it] 85%|████████▌ | 85/100 [03:31<00:35,  2.34s/it] 86%|████████▌ | 86/100 [03:34<00:33,  2.37s/it] 87%|████████▋ | 87/100 [03:36<00:30,  2.37s/it] 88%|████████▊ | 88/100 [03:38<00:28,  2.38s/it] 89%|████████▉ | 89/100 [03:41<00:27,  2.46s/it] 90%|█████████ | 90/100 [03:43<00:24,  2.43s/it] 91%|█████████ | 91/100 [03:46<00:21,  2.43s/it] 92%|█████████▏| 92/100 [03:48<00:19,  2.48s/it] 93%|█████████▎| 93/100 [03:51<00:17,  2.46s/it] 94%|█████████▍| 94/100 [03:53<00:14,  2.41s/it] 95%|█████████▌| 95/100 [03:55<00:12,  2.40s/it] 96%|█████████▌| 96/100 [03:58<00:09,  2.40s/it] 97%|█████████▋| 97/100 [04:00<00:07,  2.43s/it] 98%|█████████▊| 98/100 [04:03<00:04,  2.44s/it] 99%|█████████▉| 99/100 [04:05<00:02,  2.45s/it]100%|██████████| 100/100 [04:13<00:00,  3.97s/it]100%|██████████| 100/100 [04:13<00:00,  2.53s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-7.png]
[0/100] loss: 1.0402852296829224 loss_joints: 1.0125881433486938 loss_collision: 0.0 loss_jerk: 0.015774166211485863 loss_floor_contact: 0.2611968517303467
[1/100] loss: 1.005294919013977 loss_joints: 0.9796358942985535 loss_collision: 0.0 loss_jerk: 0.015655389055609703 loss_floor_contact: 0.24093559384346008
[2/100] loss: 0.9589881896972656 loss_joints: 0.9328413009643555 loss_collision: 0.0 loss_jerk: 0.016660671681165695 loss_floor_contact: 0.24480804800987244
[3/100] loss: 0.9074540734291077 loss_joints: 0.880561351776123 loss_collision: 0.0 loss_jerk: 0.020672284066677094 loss_floor_contact: 0.2482551485300064
[4/100] loss: 0.877717137336731 loss_joints: 0.851269006729126 loss_collision: 0.0 loss_jerk: 0.022162731736898422 loss_floor_contact: 0.2423185259103775
[5/100] loss: 0.8468795418739319 loss_joints: 0.8214117288589478 loss_collision: 0.0 loss_jerk: 0.02409754879772663 loss_floor_contact: 0.23058068752288818
[6/100] loss: 0.8101762533187866 loss_joints: 0.7861354351043701 loss_collision: 0.0 loss_jerk: 0.027702411636710167 loss_floor_contact: 0.21270571649074554
[7/100] loss: 0.7787197232246399 loss_joints: 0.7554786205291748 loss_collision: 0.005273263435810804 loss_jerk: 0.029995495453476906 loss_floor_contact: 0.1971426159143448
[8/100] loss: 0.7542867064476013 loss_joints: 0.7301835417747498 loss_collision: 0.024578889831900597 loss_jerk: 0.03047104738652706 loss_floor_contact: 0.18598118424415588
[9/100] loss: 0.736300528049469 loss_joints: 0.7111930847167969 loss_collision: 0.04254911094903946 loss_jerk: 0.030302265658974648 loss_floor_contact: 0.17822255194187164
[10/100] loss: 0.7182689905166626 loss_joints: 0.6925420761108398 loss_collision: 0.05644141510128975 loss_jerk: 0.03035067580640316 loss_floor_contact: 0.1704769879579544
[11/100] loss: 0.7027348279953003 loss_joints: 0.674780547618866 loss_collision: 0.07794096320867538 loss_jerk: 0.031212477013468742 loss_floor_contact: 0.17038962244987488
[12/100] loss: 0.690077543258667 loss_joints: 0.6598069667816162 loss_collision: 0.10658339411020279 loss_jerk: 0.032466646283864975 loss_floor_contact: 0.16365569829940796
[13/100] loss: 0.6824299097061157 loss_joints: 0.6479718685150146 loss_collision: 0.15350890159606934 loss_jerk: 0.03236803039908409 loss_floor_contact: 0.1587030589580536
[14/100] loss: 0.6754893064498901 loss_joints: 0.6385337710380554 loss_collision: 0.18404477834701538 loss_jerk: 0.03110187128186226 loss_floor_contact: 0.15440867841243744
[15/100] loss: 0.6714917421340942 loss_joints: 0.631162166595459 loss_collision: 0.2232440710067749 loss_jerk: 0.029388895258307457 loss_floor_contact: 0.1506630927324295
[16/100] loss: 0.6682046055793762 loss_joints: 0.6249493360519409 loss_collision: 0.25738590955734253 loss_jerk: 0.02875090204179287 loss_floor_contact: 0.1464160978794098
[17/100] loss: 0.6642109751701355 loss_joints: 0.6188584566116333 loss_collision: 0.28150248527526855 loss_jerk: 0.02999092824757099 loss_floor_contact: 0.14203183352947235
[18/100] loss: 0.6580226421356201 loss_joints: 0.6117299795150757 loss_collision: 0.29082879424095154 loss_jerk: 0.0329676978290081 loss_floor_contact: 0.13912954926490784
[19/100] loss: 0.6335334181785583 loss_joints: 0.5948786735534668 loss_collision: 0.21587426960468292 loss_jerk: 0.038967862725257874 loss_floor_contact: 0.13170558214187622
[20/100] loss: 0.6112195253372192 loss_joints: 0.5832462310791016 loss_collision: 0.1110050156712532 loss_jerk: 0.042571891099214554 loss_floor_contact: 0.12615561485290527
[21/100] loss: 0.5994208455085754 loss_joints: 0.5765154361724854 loss_collision: 0.06288030743598938 loss_jerk: 0.044025082141160965 loss_floor_contact: 0.12214848399162292
[22/100] loss: 0.5885945558547974 loss_joints: 0.5690693259239197 loss_collision: 0.0336032472550869 loss_jerk: 0.044497016817331314 loss_floor_contact: 0.11715146154165268
[23/100] loss: 0.5829392075538635 loss_joints: 0.5618219375610352 loss_collision: 0.04937153682112694 loss_jerk: 0.04443269968032837 loss_floor_contact: 0.11736820638179779
[24/100] loss: 0.5793807506561279 loss_joints: 0.5549720525741577 loss_collision: 0.0854962021112442 loss_jerk: 0.044018860906362534 loss_floor_contact: 0.1145721971988678
[25/100] loss: 0.5759834051132202 loss_joints: 0.5484532713890076 loss_collision: 0.1190250888466835 loss_jerk: 0.043252088129520416 loss_floor_contact: 0.11302424222230911
[26/100] loss: 0.5730646848678589 loss_joints: 0.5419294238090515 loss_collision: 0.1567344069480896 loss_jerk: 0.04228024184703827 loss_floor_contact: 0.1123383492231369
[27/100] loss: 0.5698553323745728 loss_joints: 0.5355929136276245 loss_collision: 0.18919263780117035 loss_jerk: 0.04099103435873985 loss_floor_contact: 0.11243997514247894
[28/100] loss: 0.5663660764694214 loss_joints: 0.5288108587265015 loss_collision: 0.2231721431016922 loss_jerk: 0.03959154710173607 loss_floor_contact: 0.11278794705867767
[29/100] loss: 0.5619606375694275 loss_joints: 0.5216068029403687 loss_collision: 0.24808061122894287 loss_jerk: 0.042156852781772614 loss_floor_contact: 0.11330147087574005
[30/100] loss: 0.5558722615242004 loss_joints: 0.5131568908691406 loss_collision: 0.2662060558795929 loss_jerk: 0.04705851152539253 loss_floor_contact: 0.11388912796974182
[31/100] loss: 0.5480335354804993 loss_joints: 0.5029900074005127 loss_collision: 0.28530153632164 loss_jerk: 0.05058693885803223 loss_floor_contact: 0.11454666405916214
[32/100] loss: 0.539219081401825 loss_joints: 0.4922966957092285 loss_collision: 0.3031488358974457 loss_jerk: 0.050491493195295334 loss_floor_contact: 0.1155833974480629
[33/100] loss: 0.5301077961921692 loss_joints: 0.4833844304084778 loss_collision: 0.30331000685691833 loss_jerk: 0.04673147201538086 loss_floor_contact: 0.11719206720590591
[34/100] loss: 0.5238251090049744 loss_joints: 0.4765876233577728 loss_collision: 0.3107679784297943 loss_jerk: 0.04309871420264244 loss_floor_contact: 0.11850757151842117
[35/100] loss: 0.5166851878166199 loss_joints: 0.4705350399017334 loss_collision: 0.29940590262413025 loss_jerk: 0.0433514304459095 loss_floor_contact: 0.11874398589134216
[36/100] loss: 0.5065889954566956 loss_joints: 0.46367037296295166 loss_collision: 0.2672670781612396 loss_jerk: 0.043715041130781174 loss_floor_contact: 0.11820415407419205
[37/100] loss: 0.49637722969055176 loss_joints: 0.45593780279159546 loss_collision: 0.24354475736618042 loss_jerk: 0.04416356235742569 loss_floor_contact: 0.11668606102466583
[38/100] loss: 0.48580071330070496 loss_joints: 0.448025107383728 loss_collision: 0.21700257062911987 loss_jerk: 0.04466240108013153 loss_floor_contact: 0.11609095335006714
[39/100] loss: 0.4743221402168274 loss_joints: 0.44043177366256714 loss_collision: 0.17972776293754578 loss_jerk: 0.04518742486834526 loss_floor_contact: 0.11398855596780777
[40/100] loss: 0.4620341956615448 loss_joints: 0.4332471489906311 loss_collision: 0.12972186505794525 loss_jerk: 0.04569573327898979 loss_floor_contact: 0.11245305091142654
[41/100] loss: 0.45003512501716614 loss_joints: 0.42627641558647156 loss_collision: 0.08119121938943863 loss_jerk: 0.046147070825099945 loss_floor_contact: 0.11024858802556992
[42/100] loss: 0.4389496445655823 loss_joints: 0.41920095682144165 loss_collision: 0.04188714548945427 loss_jerk: 0.046554598957300186 loss_floor_contact: 0.10904509574174881
[43/100] loss: 0.43009597063064575 loss_joints: 0.41159647703170776 loss_collision: 0.030043357983231544 loss_jerk: 0.04691965878009796 loss_floor_contact: 0.10803179442882538
[44/100] loss: 0.42032912373542786 loss_joints: 0.40328866243362427 loss_collision: 0.015927834436297417 loss_jerk: 0.04724391549825668 loss_floor_contact: 0.10723286867141724
[45/100] loss: 0.4112887382507324 loss_joints: 0.3945852518081665 loss_collision: 0.012865171767771244 loss_jerk: 0.04750165715813637 loss_floor_contact: 0.10666807740926743
[46/100] loss: 0.4027335047721863 loss_joints: 0.385917991399765 loss_collision: 0.014198355376720428 loss_jerk: 0.047683343291282654 loss_floor_contact: 0.10627342015504837
[47/100] loss: 0.39488697052001953 loss_joints: 0.37791821360588074 loss_collision: 0.016155747696757317 loss_jerk: 0.04768500104546547 loss_floor_contact: 0.10584675520658493
[48/100] loss: 0.3880964517593384 loss_joints: 0.37093788385391235 loss_collision: 0.018686722964048386 loss_jerk: 0.04741375893354416 loss_floor_contact: 0.10548525303602219
[49/100] loss: 0.38216444849967957 loss_joints: 0.36461254954338074 loss_collision: 0.023273689672350883 loss_jerk: 0.0471404492855072 loss_floor_contact: 0.1051047295331955
[50/100] loss: 0.37591850757598877 loss_joints: 0.35805147886276245 loss_collision: 0.026898067444562912 loss_jerk: 0.04706057533621788 loss_floor_contact: 0.10471170395612717
[51/100] loss: 0.3694203495979309 loss_joints: 0.3509581983089447 loss_collision: 0.033250052481889725 loss_jerk: 0.04722384363412857 loss_floor_contact: 0.10414740443229675
[52/100] loss: 0.36269450187683105 loss_joints: 0.34365808963775635 loss_collision: 0.039361707866191864 loss_jerk: 0.047550320625305176 loss_floor_contact: 0.10345222800970078
[53/100] loss: 0.356650173664093 loss_joints: 0.3364415168762207 loss_collision: 0.05148829147219658 loss_jerk: 0.04802028089761734 loss_floor_contact: 0.10257801413536072
[54/100] loss: 0.35138869285583496 loss_joints: 0.3294539749622345 loss_collision: 0.06919459998607635 loss_jerk: 0.048525311052799225 loss_floor_contact: 0.10162720084190369
[55/100] loss: 0.3479562997817993 loss_joints: 0.3227746784687042 loss_collision: 0.10205689072608948 loss_jerk: 0.04891961067914963 loss_floor_contact: 0.10083987563848495
[56/100] loss: 0.34375718235969543 loss_joints: 0.31646138429641724 loss_collision: 0.123419389128685 loss_jerk: 0.0491194948554039 loss_floor_contact: 0.10041879862546921
[57/100] loss: 0.3407718539237976 loss_joints: 0.31042036414146423 loss_collision: 0.15327897667884827 loss_jerk: 0.04920068383216858 loss_floor_contact: 0.10103528946638107
[58/100] loss: 0.3374462425708771 loss_joints: 0.30482834577560425 loss_collision: 0.17701219022274017 loss_jerk: 0.04905214533209801 loss_floor_contact: 0.1001145988702774
[59/100] loss: 0.33372047543525696 loss_joints: 0.2996304929256439 loss_collision: 0.19216226041316986 loss_jerk: 0.0486951544880867 loss_floor_contact: 0.10004215687513351
[60/100] loss: 0.330120325088501 loss_joints: 0.2948780953884125 loss_collision: 0.20426203310489655 loss_jerk: 0.04816589877009392 loss_floor_contact: 0.09999415278434753
[61/100] loss: 0.3274133801460266 loss_joints: 0.29050248861312866 loss_collision: 0.2217358946800232 loss_jerk: 0.04759465903043747 loss_floor_contact: 0.09977833181619644
[62/100] loss: 0.3240598440170288 loss_joints: 0.28595757484436035 loss_collision: 0.234060600399971 loss_jerk: 0.0473388135433197 loss_floor_contact: 0.09962310642004013
[63/100] loss: 0.3196479380130768 loss_joints: 0.2811241149902344 loss_collision: 0.23857620358467102 loss_jerk: 0.0474192313849926 loss_floor_contact: 0.09924255311489105
[64/100] loss: 0.31553611159324646 loss_joints: 0.2761772871017456 loss_collision: 0.24716489017009735 loss_jerk: 0.047714170068502426 loss_floor_contact: 0.09870918840169907
[65/100] loss: 0.3109644055366516 loss_joints: 0.27143552899360657 loss_collision: 0.248422771692276 loss_jerk: 0.04798673838376999 loss_floor_contact: 0.0988788977265358
[66/100] loss: 0.3060925006866455 loss_joints: 0.2667125463485718 loss_collision: 0.24602535367012024 loss_jerk: 0.048424798995256424 loss_floor_contact: 0.09934918582439423
[67/100] loss: 0.30218005180358887 loss_joints: 0.26223912835121155 loss_collision: 0.25174954533576965 loss_jerk: 0.04916873946785927 loss_floor_contact: 0.09849114716053009
[68/100] loss: 0.29852983355522156 loss_joints: 0.25804728269577026 loss_collision: 0.2563386559486389 loss_jerk: 0.05063176900148392 loss_floor_contact: 0.09785517305135727
[69/100] loss: 0.29483872652053833 loss_joints: 0.25395533442497253 loss_collision: 0.25992974638938904 loss_jerk: 0.051398973912000656 loss_floor_contact: 0.09750552475452423
[70/100] loss: 0.29150789976119995 loss_joints: 0.24981355667114258 loss_collision: 0.2678235173225403 loss_jerk: 0.051981210708618164 loss_floor_contact: 0.0971386730670929
[71/100] loss: 0.2878306806087494 loss_joints: 0.24562369287014008 loss_collision: 0.2730761170387268 loss_jerk: 0.05224499851465225 loss_floor_contact: 0.09674874693155289
[72/100] loss: 0.2840700149536133 loss_joints: 0.2414495199918747 loss_collision: 0.2776802182197571 loss_jerk: 0.05235154554247856 loss_floor_contact: 0.09617293626070023
[73/100] loss: 0.28047871589660645 loss_joints: 0.23732423782348633 loss_collision: 0.28331539034843445 loss_jerk: 0.05240892991423607 loss_floor_contact: 0.09582038968801498
[74/100] loss: 0.2763366997241974 loss_joints: 0.23324507474899292 loss_collision: 0.28302156925201416 loss_jerk: 0.05250181257724762 loss_floor_contact: 0.0953928604722023
[75/100] loss: 0.27258437871932983 loss_joints: 0.22920529544353485 loss_collision: 0.28621014952659607 loss_jerk: 0.052686382085084915 loss_floor_contact: 0.09489433467388153
[76/100] loss: 0.2679077088832855 loss_joints: 0.22523656487464905 loss_collision: 0.27937132120132446 loss_jerk: 0.05299247428774834 loss_floor_contact: 0.09434756636619568
[77/100] loss: 0.26365453004837036 loss_joints: 0.2213870733976364 loss_collision: 0.2754698395729065 loss_jerk: 0.053420085459947586 loss_floor_contact: 0.09378452599048615
[78/100] loss: 0.2593935430049896 loss_joints: 0.2176445573568344 loss_collision: 0.270452082157135 loss_jerk: 0.05369973182678223 loss_floor_contact: 0.09333806484937668
[79/100] loss: 0.2553282678127289 loss_joints: 0.21403269469738007 loss_collision: 0.2660268545150757 loss_jerk: 0.05395089462399483 loss_floor_contact: 0.09297817200422287
[80/100] loss: 0.2512044310569763 loss_joints: 0.21053700149059296 loss_collision: 0.2598653733730316 loss_jerk: 0.05412545055150986 loss_floor_contact: 0.09268354624509811
[81/100] loss: 0.24713988602161407 loss_joints: 0.2071341872215271 loss_collision: 0.2534888982772827 loss_jerk: 0.05408098176121712 loss_floor_contact: 0.09248720109462738
[82/100] loss: 0.24347256124019623 loss_joints: 0.20380882918834686 loss_collision: 0.2501455247402191 loss_jerk: 0.05375567823648453 loss_floor_contact: 0.092736154794693
[83/100] loss: 0.23964548110961914 loss_joints: 0.20057129859924316 loss_collision: 0.2449313998222351 loss_jerk: 0.05314572528004646 loss_floor_contact: 0.0926646962761879
[84/100] loss: 0.23554831743240356 loss_joints: 0.19745366275310516 loss_collision: 0.23628205060958862 loss_jerk: 0.05229134485125542 loss_floor_contact: 0.09237318485975266
[85/100] loss: 0.23206835985183716 loss_joints: 0.19449222087860107 loss_collision: 0.23200656473636627 loss_jerk: 0.051344286650419235 loss_floor_contact: 0.09241041541099548
[86/100] loss: 0.22878190875053406 loss_joints: 0.19170741736888885 loss_collision: 0.22797517478466034 loss_jerk: 0.05030752718448639 loss_floor_contact: 0.09246228635311127
[87/100] loss: 0.225532665848732 loss_joints: 0.18910369277000427 loss_collision: 0.22170127928256989 loss_jerk: 0.050107795745134354 loss_floor_contact: 0.09248056262731552
[88/100] loss: 0.22247764468193054 loss_joints: 0.18668121099472046 loss_collision: 0.2154625952243805 loss_jerk: 0.050064511597156525 loss_floor_contact: 0.09243731200695038
[89/100] loss: 0.21967563033103943 loss_joints: 0.18443602323532104 loss_collision: 0.20994018018245697 loss_jerk: 0.05010776221752167 loss_floor_contact: 0.09234816581010818
[90/100] loss: 0.21713484823703766 loss_joints: 0.18237189948558807 loss_collision: 0.20517882704734802 loss_jerk: 0.050230447202920914 loss_floor_contact: 0.09222022444009781
[91/100] loss: 0.21437771618366241 loss_joints: 0.18048536777496338 loss_collision: 0.19646397233009338 loss_jerk: 0.05037739872932434 loss_floor_contact: 0.09208211302757263
[92/100] loss: 0.21228301525115967 loss_joints: 0.17878149449825287 loss_collision: 0.1925354301929474 loss_jerk: 0.050543222576379776 loss_floor_contact: 0.09193652123212814
[93/100] loss: 0.21001796424388885 loss_joints: 0.17728191614151 loss_collision: 0.18483887612819672 loss_jerk: 0.05074256658554077 loss_floor_contact: 0.09177886694669724
[94/100] loss: 0.20866848528385162 loss_joints: 0.17598530650138855 loss_collision: 0.18419890105724335 loss_jerk: 0.05101193115115166 loss_floor_contact: 0.09162092953920364
[95/100] loss: 0.2071538120508194 loss_joints: 0.17488014698028564 loss_collision: 0.1797500103712082 loss_jerk: 0.05148042365908623 loss_floor_contact: 0.09150626510381699
[96/100] loss: 0.20614303648471832 loss_joints: 0.17396149039268494 loss_collision: 0.17862756550312042 loss_jerk: 0.051807697862386703 loss_floor_contact: 0.09138013422489166
[97/100] loss: 0.20506705343723297 loss_joints: 0.173224538564682 loss_collision: 0.17524830996990204 loss_jerk: 0.052034854888916016 loss_floor_contact: 0.0911419689655304
[98/100] loss: 0.20446930825710297 loss_joints: 0.17267218232154846 loss_collision: 0.17481790482997894 loss_jerk: 0.052168555557727814 loss_floor_contact: 0.09098487347364426
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-7.png]
[99/100] loss: 0.20376381278038025 loss_joints: 0.17230087518692017 loss_collision: 0.17149551212787628 loss_jerk: 0.05224788188934326 loss_floor_contact: 0.09088586270809174
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path2-walk6-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 253.31075                                                    ║
    ║     rollout = 108.66851                                                    ║
    ║     sdf     = 24.05575                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.20376381                                                 ║
    ║     joints    = 0.17230088                                                 ║
    ║     collision = 0.17149551                                                 ║
    ║     jerk      = 0.05224788                                                 ║
    ║     floor     = 0.09088586                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	4m37.442s
user	4m7.385s
sys	0m17.070s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x6433cd798c00] using SAR=1/1
[libx264 @ 0x6433cd798c00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x6433cd798c00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x6433cd798c00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_walk_6.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x6433cd796fc0] video:204kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.564314%
frame=   25 fps=0.0 q=-1.0 Lsize=     205kB time=00:00:02.20 bitrate= 762.7kbits/s speed=3.13x    
[libx264 @ 0x6433cd798c00] frame I:1     Avg QP:18.85  size: 68922
[libx264 @ 0x6433cd798c00] frame P:8     Avg QP:19.91  size: 13677
[libx264 @ 0x6433cd798c00] frame B:16    Avg QP:22.47  size:  1847
[libx264 @ 0x6433cd798c00] consecutive B-frames: 12.0%  8.0%  0.0% 80.0%
[libx264 @ 0x6433cd798c00] mb I  I16..4:  6.9% 65.2% 27.8%
[libx264 @ 0x6433cd798c00] mb P  I16..4:  0.2%  1.9%  1.8%  P16..4: 10.5%  3.0%  1.8%  0.0%  0.0%    skip:80.8%
[libx264 @ 0x6433cd798c00] mb B  I16..4:  0.1%  0.3%  0.1%  B16..8: 10.5%  1.4%  0.4%  direct: 0.8%  skip:86.5%  L0:48.1% L1:46.5% BI: 5.4%
[libx264 @ 0x6433cd798c00] 8x8 transform intra:61.4% inter:53.4%
[libx264 @ 0x6433cd798c00] coded y,uvDC,uvAC intra: 31.2% 20.4% 19.2% inter: 3.4% 3.3% 1.7%
[libx264 @ 0x6433cd798c00] i16 v,h,dc,p: 64% 24% 12%  0%
[libx264 @ 0x6433cd798c00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 51%  8% 34%  1%  1%  1%  1%  2%  1%
[libx264 @ 0x6433cd798c00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 36% 22% 15%  4%  4%  4%  4%  9%  3%
[libx264 @ 0x6433cd798c00] i8c dc,h,v,p: 89%  2%  6%  3%
[libx264 @ 0x6433cd798c00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x6433cd798c00] ref P L0: 61.9% 14.4% 15.7%  8.1%
[libx264 @ 0x6433cd798c00] ref B L0: 82.9% 11.2%  5.9%
[libx264 @ 0x6433cd798c00] ref B L1: 87.8% 12.2%
[libx264 @ 0x6433cd798c00] kb/s:665.23
[INFO] Video saved as 'bin/result/optim_walk_6.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:14<23:28, 14.23s/it]  2%|▏         | 2/100 [00:19<14:12,  8.70s/it]  3%|▎         | 3/100 [00:24<11:22,  7.04s/it]  4%|▍         | 4/100 [00:28<09:37,  6.02s/it]  5%|▌         | 5/100 [00:33<08:38,  5.46s/it]  6%|▌         | 6/100 [00:37<08:16,  5.29s/it]  7%|▋         | 7/100 [00:42<07:52,  5.08s/it]  8%|▊         | 8/100 [00:47<07:44,  5.05s/it]  9%|▉         | 9/100 [00:52<07:27,  4.92s/it] 10%|█         | 10/100 [00:57<07:19,  4.88s/it] 11%|█         | 11/100 [01:01<07:11,  4.85s/it] 12%|█▏        | 12/100 [01:06<07:02,  4.80s/it] 13%|█▎        | 13/100 [01:11<07:02,  4.85s/it] 14%|█▍        | 14/100 [01:16<06:52,  4.79s/it] 15%|█▌        | 15/100 [01:20<06:42,  4.73s/it] 16%|█▌        | 16/100 [01:25<06:35,  4.71s/it] 17%|█▋        | 17/100 [01:30<06:31,  4.72s/it] 18%|█▊        | 18/100 [01:34<06:25,  4.70s/it] 19%|█▉        | 19/100 [01:39<06:17,  4.66s/it] 20%|██        | 20/100 [01:44<06:19,  4.75s/it] 21%|██        | 21/100 [01:49<06:14,  4.74s/it] 22%|██▏       | 22/100 [01:53<06:04,  4.68s/it] 23%|██▎       | 23/100 [01:58<05:54,  4.60s/it] 24%|██▍       | 24/100 [02:02<05:45,  4.55s/it] 25%|██▌       | 25/100 [02:06<05:40,  4.54s/it] 26%|██▌       | 26/100 [02:11<05:41,  4.62s/it] 27%|██▋       | 27/100 [02:16<05:45,  4.73s/it] 28%|██▊       | 28/100 [02:21<05:36,  4.67s/it] 29%|██▉       | 29/100 [02:26<05:35,  4.73s/it] 30%|███       | 30/100 [02:30<05:30,  4.72s/it] 31%|███       | 31/100 [02:35<05:29,  4.77s/it] 32%|███▏      | 32/100 [02:40<05:28,  4.83s/it] 33%|███▎      | 33/100 [02:45<05:21,  4.79s/it] 34%|███▍      | 34/100 [02:50<05:14,  4.77s/it] 35%|███▌      | 35/100 [02:54<05:03,  4.67s/it] 36%|███▌      | 36/100 [02:59<05:00,  4.70s/it] 37%|███▋      | 37/100 [03:04<05:05,  4.84s/it] 38%|███▊      | 38/100 [03:09<04:59,  4.83s/it] 39%|███▉      | 39/100 [03:13<04:51,  4.78s/it] 40%|████      | 40/100 [03:18<04:41,  4.69s/it] 41%|████      | 41/100 [03:23<04:41,  4.77s/it] 42%|████▏     | 42/100 [03:28<04:46,  4.95s/it] 43%|████▎     | 43/100 [03:33<04:43,  4.98s/it] 44%|████▍     | 44/100 [03:39<04:44,  5.07s/it] 45%|████▌     | 45/100 [03:44<04:42,  5.13s/it] 46%|████▌     | 46/100 [03:49<04:33,  5.07s/it] 47%|████▋     | 47/100 [03:54<04:37,  5.23s/it] 48%|████▊     | 48/100 [04:00<04:32,  5.25s/it] 49%|████▉     | 49/100 [04:05<04:25,  5.21s/it] 50%|█████     | 50/100 [04:11<04:28,  5.36s/it] 51%|█████     | 51/100 [04:16<04:17,  5.25s/it] 52%|█████▏    | 52/100 [04:21<04:18,  5.38s/it] 53%|█████▎    | 53/100 [04:27<04:14,  5.42s/it] 54%|█████▍    | 54/100 [04:32<04:09,  5.42s/it] 55%|█████▌    | 55/100 [04:37<04:01,  5.38s/it] 56%|█████▌    | 56/100 [04:42<03:52,  5.28s/it] 57%|█████▋    | 57/100 [04:47<03:43,  5.20s/it] 58%|█████▊    | 58/100 [04:52<03:33,  5.08s/it] 59%|█████▉    | 59/100 [04:57<03:26,  5.04s/it] 60%|██████    | 60/100 [05:02<03:18,  4.97s/it] 61%|██████    | 61/100 [05:07<03:08,  4.84s/it] 62%|██████▏   | 62/100 [05:11<03:04,  4.85s/it] 63%|██████▎   | 63/100 [05:16<02:57,  4.80s/it] 64%|██████▍   | 64/100 [05:21<02:51,  4.75s/it] 65%|██████▌   | 65/100 [05:25<02:44,  4.71s/it] 66%|██████▌   | 66/100 [05:30<02:38,  4.65s/it] 67%|██████▋   | 67/100 [05:35<02:35,  4.72s/it] 68%|██████▊   | 68/100 [05:40<02:38,  4.95s/it] 69%|██████▉   | 69/100 [05:45<02:34,  4.98s/it] 70%|███████   | 70/100 [05:50<02:30,  5.01s/it] 71%|███████   | 71/100 [05:55<02:23,  4.95s/it] 72%|███████▏  | 72/100 [06:00<02:19,  4.99s/it] 73%|███████▎  | 73/100 [06:05<02:14,  4.99s/it] 74%|███████▍  | 74/100 [06:10<02:08,  4.92s/it] 75%|███████▌  | 75/100 [06:15<02:00,  4.81s/it] 76%|███████▌  | 76/100 [06:20<01:58,  4.93s/it] 77%|███████▋  | 77/100 [06:25<01:54,  4.98s/it] 78%|███████▊  | 78/100 [06:30<01:49,  4.97s/it] 79%|███████▉  | 79/100 [06:35<01:42,  4.90s/it] 80%|████████  | 80/100 [06:40<01:38,  4.91s/it] 81%|████████  | 81/100 [06:45<01:34,  4.98s/it] 82%|████████▏ | 82/100 [06:50<01:31,  5.08s/it] 83%|████████▎ | 83/100 [06:55<01:26,  5.09s/it] 84%|████████▍ | 84/100 [07:00<01:20,  5.01s/it] 85%|████████▌ | 85/100 [07:05<01:15,  5.05s/it] 86%|████████▌ | 86/100 [07:10<01:09,  4.94s/it] 87%|████████▋ | 87/100 [07:15<01:03,  4.91s/it] 88%|████████▊ | 88/100 [07:20<00:59,  4.95s/it] 89%|████████▉ | 89/100 [07:24<00:53,  4.85s/it] 90%|█████████ | 90/100 [07:29<00:48,  4.87s/it] 91%|█████████ | 91/100 [07:34<00:43,  4.86s/it] 92%|█████████▏| 92/100 [07:39<00:39,  4.97s/it] 93%|█████████▎| 93/100 [07:44<00:35,  5.04s/it] 94%|█████████▍| 94/100 [07:49<00:30,  5.02s/it] 95%|█████████▌| 95/100 [07:54<00:24,  4.99s/it] 96%|█████████▌| 96/100 [07:59<00:19,  4.97s/it] 97%|█████████▋| 97/100 [08:04<00:14,  4.96s/it] 98%|█████████▊| 98/100 [08:09<00:09,  4.99s/it] 99%|█████████▉| 99/100 [08:14<00:04,  4.95s/it]100%|██████████| 100/100 [08:28<00:00,  7.56s/it]100%|██████████| 100/100 [08:28<00:00,  5.08s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-13.png]
[0/100] loss: 1.3695557117462158 loss_joints: 1.3376867771148682 loss_collision: 0.1603255271911621 loss_jerk: 0.015774153172969818 loss_floor_contact: 0.14259038865566254
[1/100] loss: 1.199999213218689 loss_joints: 1.1728156805038452 loss_collision: 0.12607339024543762 loss_jerk: 0.015645118430256844 loss_floor_contact: 0.13011643290519714
[2/100] loss: 0.9687680602073669 loss_joints: 0.9467930793762207 loss_collision: 0.0706847608089447 loss_jerk: 0.01589842140674591 loss_floor_contact: 0.13316717743873596
[3/100] loss: 0.6841598749160767 loss_joints: 0.6579498648643494 loss_collision: 0.1067814975976944 loss_jerk: 0.0208288561552763 loss_floor_contact: 0.13448981940746307
[4/100] loss: 0.5260037183761597 loss_joints: 0.4949275255203247 loss_collision: 0.1565408557653427 loss_jerk: 0.021553803235292435 loss_floor_contact: 0.1326676905155182
[5/100] loss: 0.39020228385925293 loss_joints: 0.3576783537864685 loss_collision: 0.17160913348197937 loss_jerk: 0.023351570591330528 loss_floor_contact: 0.1302783340215683
[6/100] loss: 0.2887157201766968 loss_joints: 0.2618792653083801 loss_collision: 0.11849132180213928 loss_jerk: 0.02583644725382328 loss_floor_contact: 0.12403653562068939
[7/100] loss: 0.2248702049255371 loss_joints: 0.19815212488174438 loss_collision: 0.12245602160692215 loss_jerk: 0.02861778624355793 loss_floor_contact: 0.11610700935125351
[8/100] loss: 0.18716038763523102 loss_joints: 0.1555643379688263 loss_collision: 0.17580607533454895 loss_jerk: 0.030105188488960266 loss_floor_contact: 0.11004912108182907
[9/100] loss: 0.15820951759815216 loss_joints: 0.13465645909309387 loss_collision: 0.10136506706476212 loss_jerk: 0.029907386749982834 loss_floor_contact: 0.104258231818676
[10/100] loss: 0.1376916617155075 loss_joints: 0.11971081793308258 loss_collision: 0.049753326922655106 loss_jerk: 0.030026599764823914 loss_floor_contact: 0.10002855211496353
[11/100] loss: 0.1197398230433464 loss_joints: 0.10210096091032028 loss_collision: 0.04595312476158142 loss_jerk: 0.03281745687127113 loss_floor_contact: 0.09761813282966614
[12/100] loss: 0.10268699377775192 loss_joints: 0.08424277603626251 loss_collision: 0.04767218604683876 loss_jerk: 0.03491044417023659 loss_floor_contact: 0.10185959935188293
[13/100] loss: 0.09760213643312454 loss_joints: 0.07955113798379898 loss_collision: 0.04815971851348877 loss_jerk: 0.03496473282575607 loss_floor_contact: 0.09738551825284958
[14/100] loss: 0.08965382725000381 loss_joints: 0.07083706557750702 loss_collision: 0.0520339198410511 loss_jerk: 0.03481109067797661 loss_floor_contact: 0.10132263600826263
[15/100] loss: 0.07871340960264206 loss_joints: 0.05771864950656891 loss_collision: 0.07594776153564453 loss_jerk: 0.03463735803961754 loss_floor_contact: 0.09936246275901794
[16/100] loss: 0.06898045539855957 loss_joints: 0.04465361684560776 loss_collision: 0.11245391517877579 loss_jerk: 0.03427349030971527 loss_floor_contact: 0.09654099494218826
[17/100] loss: 0.06244327127933502 loss_joints: 0.035829316824674606 loss_collision: 0.1362505704164505 loss_jerk: 0.033920031040906906 loss_floor_contact: 0.09596889466047287
[18/100] loss: 0.05422032251954079 loss_joints: 0.026778697967529297 loss_collision: 0.14670813083648682 loss_jerk: 0.033476512879133224 loss_floor_contact: 0.09423162788152695
[19/100] loss: 0.05120879039168358 loss_joints: 0.02239142172038555 loss_collision: 0.16089974343776703 loss_jerk: 0.032708071172237396 loss_floor_contact: 0.09456586092710495
[20/100] loss: 0.04948228597640991 loss_joints: 0.021031780168414116 loss_collision: 0.15801070630550385 loss_jerk: 0.03220809996128082 loss_floor_contact: 0.0942862331867218
[21/100] loss: 0.045011598616838455 loss_joints: 0.01688412018120289 loss_collision: 0.15441353619098663 loss_jerk: 0.032840292900800705 loss_floor_contact: 0.09402094781398773
[22/100] loss: 0.03967299312353134 loss_joints: 0.01299850083887577 loss_collision: 0.1402043253183365 loss_jerk: 0.03454362973570824 loss_floor_contact: 0.09199696034193039
[23/100] loss: 0.038470495492219925 loss_joints: 0.013512549921870232 loss_collision: 0.12476347386837006 loss_jerk: 0.033883970230817795 loss_floor_contact: 0.09093201160430908
[24/100] loss: 0.036838121712207794 loss_joints: 0.014223860576748848 loss_collision: 0.10132797062397003 loss_jerk: 0.032082077115774155 loss_floor_contact: 0.09273257851600647
[25/100] loss: 0.036195412278175354 loss_joints: 0.015242859721183777 loss_collision: 0.08537749201059341 loss_jerk: 0.032068755477666855 loss_floor_contact: 0.09207925945520401
[26/100] loss: 0.036255281418561935 loss_joints: 0.01680089719593525 loss_collision: 0.06946853548288345 loss_jerk: 0.032138675451278687 loss_floor_contact: 0.09293661266565323
[27/100] loss: 0.03561759740114212 loss_joints: 0.01783740147948265 loss_collision: 0.05336666852235794 loss_jerk: 0.03189295902848244 loss_floor_contact: 0.09254234284162521
[28/100] loss: 0.034087106585502625 loss_joints: 0.017911948263645172 loss_collision: 0.039345670491456985 loss_jerk: 0.03122335858643055 loss_floor_contact: 0.09118253737688065
[29/100] loss: 0.03359902277588844 loss_joints: 0.017920268699526787 loss_collision: 0.03703976795077324 loss_jerk: 0.030421504750847816 loss_floor_contact: 0.08932626247406006
[30/100] loss: 0.03359813243150711 loss_joints: 0.0178989265114069 loss_collision: 0.03677607700228691 loss_jerk: 0.032143812626600266 loss_floor_contact: 0.08807215839624405
[31/100] loss: 0.03326759859919548 loss_joints: 0.017591560259461403 loss_collision: 0.03545340150594711 loss_jerk: 0.034152667969465256 loss_floor_contact: 0.08715430647134781
[32/100] loss: 0.0323030948638916 loss_joints: 0.016914749518036842 loss_collision: 0.03246085345745087 loss_jerk: 0.035349734127521515 loss_floor_contact: 0.08607285469770432
[33/100] loss: 0.031603530049324036 loss_joints: 0.016076233237981796 loss_collision: 0.032796408981084824 loss_jerk: 0.035656146705150604 loss_floor_contact: 0.08682041615247726
[34/100] loss: 0.03072492964565754 loss_joints: 0.015266835689544678 loss_collision: 0.032773640006780624 loss_jerk: 0.03539036586880684 loss_floor_contact: 0.08641693741083145
[35/100] loss: 0.029539596289396286 loss_joints: 0.014267632737755775 loss_collision: 0.03207046911120415 loss_jerk: 0.03474077582359314 loss_floor_contact: 0.08590839803218842
[36/100] loss: 0.028098206967115402 loss_joints: 0.013113429769873619 loss_collision: 0.03176533058285713 loss_jerk: 0.033905576914548874 loss_floor_contact: 0.08417685329914093
[37/100] loss: 0.027103478088974953 loss_joints: 0.01246933825314045 loss_collision: 0.028926052153110504 loss_jerk: 0.032864004373550415 loss_floor_contact: 0.08455134928226471
[38/100] loss: 0.02724767103791237 loss_joints: 0.01220705360174179 loss_collision: 0.03214928135275841 loss_jerk: 0.031812235713005066 loss_floor_contact: 0.08644465357065201
[39/100] loss: 0.02679651603102684 loss_joints: 0.011810434982180595 loss_collision: 0.03287392482161522 loss_jerk: 0.03020016849040985 loss_floor_contact: 0.08678669482469559
[40/100] loss: 0.026999954134225845 loss_joints: 0.011645945720374584 loss_collision: 0.03774457797408104 loss_jerk: 0.029212383553385735 loss_floor_contact: 0.08658312261104584
[41/100] loss: 0.02735023945569992 loss_joints: 0.012014880776405334 loss_collision: 0.0380246639251709 loss_jerk: 0.029324518516659737 loss_floor_contact: 0.08600439876317978
[42/100] loss: 0.027170713990926743 loss_joints: 0.012209607288241386 loss_collision: 0.03454451635479927 loss_jerk: 0.029261089861392975 loss_floor_contact: 0.08580545336008072
[43/100] loss: 0.02665654942393303 loss_joints: 0.012018161825835705 loss_collision: 0.03158745542168617 loss_jerk: 0.029070280492305756 loss_floor_contact: 0.08572614192962646
[44/100] loss: 0.026225078850984573 loss_joints: 0.011513501405715942 loss_collision: 0.03198082372546196 loss_jerk: 0.029209384694695473 loss_floor_contact: 0.08592555671930313
[45/100] loss: 0.02585270069539547 loss_joints: 0.011281671933829784 loss_collision: 0.03088737092912197 loss_jerk: 0.029185205698013306 loss_floor_contact: 0.08563771843910217
[46/100] loss: 0.025531409308314323 loss_joints: 0.011281583458185196 loss_collision: 0.027644695714116096 loss_jerk: 0.028568357229232788 loss_floor_contact: 0.08628518879413605
[47/100] loss: 0.025296874344348907 loss_joints: 0.011059662327170372 loss_collision: 0.02790199965238571 loss_jerk: 0.028483504429459572 loss_floor_contact: 0.08598661422729492
[48/100] loss: 0.025304336100816727 loss_joints: 0.010738389566540718 loss_collision: 0.032023221254348755 loss_jerk: 0.028454458341002464 loss_floor_contact: 0.08518178761005402
[49/100] loss: 0.02524455636739731 loss_joints: 0.01065763458609581 loss_collision: 0.03246006369590759 loss_jerk: 0.02873499132692814 loss_floor_contact: 0.08467414230108261
[50/100] loss: 0.024997862055897713 loss_joints: 0.010520994663238525 loss_collision: 0.03085470013320446 loss_jerk: 0.028929056599736214 loss_floor_contact: 0.0849849134683609
[51/100] loss: 0.024834129959344864 loss_joints: 0.01030272152274847 loss_collision: 0.030060475692152977 loss_jerk: 0.02902241423726082 loss_floor_contact: 0.08623117953538895
[52/100] loss: 0.0249275341629982 loss_joints: 0.010304232127964497 loss_collision: 0.029991548508405685 loss_jerk: 0.02899959869682789 loss_floor_contact: 0.08724186569452286
[53/100] loss: 0.02474379353225231 loss_joints: 0.010216283611953259 loss_collision: 0.028778329491615295 loss_jerk: 0.029064130038022995 loss_floor_contact: 0.08743263781070709
[54/100] loss: 0.024374477565288544 loss_joints: 0.009898598305881023 loss_collision: 0.028274543583393097 loss_jerk: 0.029188992455601692 loss_floor_contact: 0.08729523420333862
[55/100] loss: 0.024225715547800064 loss_joints: 0.00977753009647131 loss_collision: 0.02748901955783367 loss_jerk: 0.029342247173190117 loss_floor_contact: 0.0876505970954895
[56/100] loss: 0.024213220924139023 loss_joints: 0.00983016099780798 loss_collision: 0.026017380878329277 loss_jerk: 0.029529960826039314 loss_floor_contact: 0.0882832482457161
[57/100] loss: 0.02400144375860691 loss_joints: 0.009637664072215557 loss_collision: 0.026063228026032448 loss_jerk: 0.029544571414589882 loss_floor_contact: 0.08802999556064606
[58/100] loss: 0.02340436913073063 loss_joints: 0.009273650124669075 loss_collision: 0.02444419637322426 loss_jerk: 0.029366610571742058 loss_floor_contact: 0.08749637752771378
[59/100] loss: 0.023360177874565125 loss_joints: 0.009266693145036697 loss_collision: 0.02449263073503971 loss_jerk: 0.028969403356313705 loss_floor_contact: 0.0874728187918663
[60/100] loss: 0.02335549332201481 loss_joints: 0.009291842579841614 loss_collision: 0.02450275421142578 loss_jerk: 0.028780464082956314 loss_floor_contact: 0.08735328912734985
[61/100] loss: 0.023022890090942383 loss_joints: 0.008987544104456902 loss_collision: 0.024739274755120277 loss_jerk: 0.028772741556167603 loss_floor_contact: 0.08684141933917999
[62/100] loss: 0.022713202983140945 loss_joints: 0.008711786940693855 loss_collision: 0.02441643364727497 loss_jerk: 0.02891932800412178 loss_floor_contact: 0.0866784080862999
[63/100] loss: 0.022820264101028442 loss_joints: 0.008643262088298798 loss_collision: 0.02634892240166664 loss_jerk: 0.02881707064807415 loss_floor_contact: 0.08660401403903961
[64/100] loss: 0.02257535234093666 loss_joints: 0.008470503613352776 loss_collision: 0.026350203901529312 loss_jerk: 0.02852112427353859 loss_floor_contact: 0.08617716282606125
[65/100] loss: 0.022484224289655685 loss_joints: 0.00854906439781189 loss_collision: 0.025563711300492287 loss_jerk: 0.028056465089321136 loss_floor_contact: 0.08573142439126968
[66/100] loss: 0.02245117537677288 loss_joints: 0.00854402408003807 loss_collision: 0.02570470981299877 loss_jerk: 0.027796408161520958 loss_floor_contact: 0.08557039499282837
[67/100] loss: 0.02222701907157898 loss_joints: 0.00826711393892765 loss_collision: 0.026409700512886047 loss_jerk: 0.027711406350135803 loss_floor_contact: 0.08547793328762054
[68/100] loss: 0.022109653800725937 loss_joints: 0.008018309250473976 loss_collision: 0.02742648310959339 loss_jerk: 0.027766559273004532 loss_floor_contact: 0.08572041243314743
[69/100] loss: 0.02212255820631981 loss_joints: 0.007949938997626305 loss_collision: 0.027993135154247284 loss_jerk: 0.027703672647476196 loss_floor_contact: 0.08602938055992126
[70/100] loss: 0.021924469619989395 loss_joints: 0.007817731238901615 loss_collision: 0.027483591809868813 loss_jerk: 0.02748192474246025 loss_floor_contact: 0.08610187470912933
[71/100] loss: 0.021873660385608673 loss_joints: 0.007835472002625465 loss_collision: 0.027002381160855293 loss_jerk: 0.027122143656015396 loss_floor_contact: 0.08625736087560654
[72/100] loss: 0.021925587207078934 loss_joints: 0.007826153188943863 loss_collision: 0.027580425143241882 loss_jerk: 0.027024539187550545 loss_floor_contact: 0.08638937771320343
[73/100] loss: 0.02169743925333023 loss_joints: 0.007648104801774025 loss_collision: 0.027008099481463432 loss_jerk: 0.02690439112484455 loss_floor_contact: 0.08658085018396378
[74/100] loss: 0.021600063890218735 loss_joints: 0.007505647838115692 loss_collision: 0.027231985703110695 loss_jerk: 0.02696121111512184 loss_floor_contact: 0.08675097674131393
[75/100] loss: 0.021609626710414886 loss_joints: 0.007444845512509346 loss_collision: 0.027997983619570732 loss_jerk: 0.026857350021600723 loss_floor_contact: 0.0867924839258194
[76/100] loss: 0.021514426916837692 loss_joints: 0.007374051492661238 loss_collision: 0.028049299493432045 loss_jerk: 0.026748258620500565 loss_floor_contact: 0.0866062119603157
[77/100] loss: 0.021618645638227463 loss_joints: 0.007440987043082714 loss_collision: 0.028421971946954727 loss_jerk: 0.026921972632408142 loss_floor_contact: 0.08643263578414917
[78/100] loss: 0.02161727100610733 loss_joints: 0.007444802206009626 loss_collision: 0.02826317958533764 loss_jerk: 0.02692093327641487 loss_floor_contact: 0.0865405723452568
[79/100] loss: 0.0214659683406353 loss_joints: 0.007309434469789267 loss_collision: 0.02812493033707142 loss_jerk: 0.026795024052262306 loss_floor_contact: 0.08664538711309433
[80/100] loss: 0.021278608590364456 loss_joints: 0.007176041603088379 loss_collision: 0.027391480281949043 loss_jerk: 0.026628345251083374 loss_floor_contact: 0.08700583875179291
[81/100] loss: 0.021278074011206627 loss_joints: 0.007142532151192427 loss_collision: 0.027610013261437416 loss_jerk: 0.02654457278549671 loss_floor_contact: 0.087200827896595
[82/100] loss: 0.021201830357313156 loss_joints: 0.007096305023878813 loss_collision: 0.02723400481045246 loss_jerk: 0.02649148367345333 loss_floor_contact: 0.08732977509498596
[83/100] loss: 0.02114238403737545 loss_joints: 0.007105974480509758 loss_collision: 0.02648354507982731 loss_jerk: 0.026548029854893684 loss_floor_contact: 0.08733251690864563
[84/100] loss: 0.02117762714624405 loss_joints: 0.007107446901500225 loss_collision: 0.026806868612766266 loss_jerk: 0.026545289903879166 loss_floor_contact: 0.08734963834285736
[85/100] loss: 0.021028783172369003 loss_joints: 0.007040231488645077 loss_collision: 0.02592608518898487 loss_jerk: 0.026448296383023262 loss_floor_contact: 0.08751113712787628
[86/100] loss: 0.02092887833714485 loss_joints: 0.006974507123231888 loss_collision: 0.025363825261592865 loss_jerk: 0.02648545429110527 loss_floor_contact: 0.0876944288611412
[87/100] loss: 0.020934859290719032 loss_joints: 0.006949794478714466 loss_collision: 0.02557896263897419 loss_jerk: 0.026507826521992683 loss_floor_contact: 0.08776386082172394
[88/100] loss: 0.02086668834090233 loss_joints: 0.006928608752787113 loss_collision: 0.025136196985840797 loss_jerk: 0.026487018913030624 loss_floor_contact: 0.08775758743286133
[89/100] loss: 0.02087421528995037 loss_joints: 0.006945756729692221 loss_collision: 0.025140874087810516 loss_jerk: 0.02652388997375965 loss_floor_contact: 0.08761981874704361
[90/100] loss: 0.020832085981965065 loss_joints: 0.006939555983990431 loss_collision: 0.02480151131749153 loss_jerk: 0.02650507725775242 loss_floor_contact: 0.08761870115995407
[91/100] loss: 0.02083582431077957 loss_joints: 0.006893172860145569 loss_collision: 0.025212164968252182 loss_jerk: 0.02646181359887123 loss_floor_contact: 0.08775252848863602
[92/100] loss: 0.020801283419132233 loss_joints: 0.0068353321403265 loss_collision: 0.025348005816340446 loss_jerk: 0.0263980682939291 loss_floor_contact: 0.08791342377662659
[93/100] loss: 0.020784202963113785 loss_joints: 0.006809202488511801 loss_collision: 0.025391902774572372 loss_jerk: 0.026403097435832024 loss_floor_contact: 0.08795501291751862
[94/100] loss: 0.020739521831274033 loss_joints: 0.006792367435991764 loss_collision: 0.025118716061115265 loss_jerk: 0.026375213637948036 loss_floor_contact: 0.08797759562730789
[95/100] loss: 0.020707519724965096 loss_joints: 0.006788989529013634 loss_collision: 0.024893123656511307 loss_jerk: 0.026328934356570244 loss_floor_contact: 0.08796323835849762
[96/100] loss: 0.020737726241350174 loss_joints: 0.006779206916689873 loss_collision: 0.025313319638371468 loss_jerk: 0.026324233040213585 loss_floor_contact: 0.08794763684272766
[97/100] loss: 0.020721174776554108 loss_joints: 0.006764599122107029 loss_collision: 0.025297151878476143 loss_jerk: 0.02630503661930561 loss_floor_contact: 0.08796357363462448
[98/100] loss: 0.020686492323875427 loss_joints: 0.00674916198477149 loss_collision: 0.025070326402783394 loss_jerk: 0.026309140026569366 loss_floor_contact: 0.08799383044242859
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-13.png]
[99/100] loss: 0.020697101950645447 loss_joints: 0.006738760508596897 loss_collision: 0.025234783068299294 loss_jerk: 0.02632211148738861 loss_floor_contact: 0.0880265086889267
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path2-walk12-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 508.28658                                                    ║
    ║     rollout = 231.33353                                                    ║
    ║     sdf     = 40.53475                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.02069710                                                 ║
    ║     joints    = 0.00673876                                                 ║
    ║     collision = 0.02523478                                                 ║
    ║     jerk      = 0.02632211                                                 ║
    ║     floor     = 0.08802651                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	8m50.113s
user	7m39.040s
sys	0m28.532s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x5a6d1785ec00] using SAR=1/1
[libx264 @ 0x5a6d1785ec00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x5a6d1785ec00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x5a6d1785ec00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_walk_12.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x5a6d1785cfc0] video:214kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.533983%
frame=   25 fps=0.0 q=-1.0 Lsize=     215kB time=00:00:02.20 bitrate= 800.3kbits/s speed=3.12x    
[libx264 @ 0x5a6d1785ec00] frame I:1     Avg QP:18.73  size: 69529
[libx264 @ 0x5a6d1785ec00] frame P:8     Avg QP:19.79  size: 14286
[libx264 @ 0x5a6d1785ec00] frame B:16    Avg QP:22.26  size:  2151
[libx264 @ 0x5a6d1785ec00] consecutive B-frames:  8.0% 16.0% 12.0% 64.0%
[libx264 @ 0x5a6d1785ec00] mb I  I16..4:  7.0% 65.1% 27.9%
[libx264 @ 0x5a6d1785ec00] mb P  I16..4:  0.2%  2.1%  1.9%  P16..4:  9.7%  3.1%  2.2%  0.0%  0.0%    skip:80.8%
[libx264 @ 0x5a6d1785ec00] mb B  I16..4:  0.1%  0.3%  0.1%  B16..8: 11.6%  1.4%  0.5%  direct: 1.0%  skip:85.1%  L0:52.0% L1:43.2% BI: 4.8%
[libx264 @ 0x5a6d1785ec00] 8x8 transform intra:61.4% inter:55.0%
[libx264 @ 0x5a6d1785ec00] coded y,uvDC,uvAC intra: 31.5% 20.7% 19.7% inter: 3.9% 4.1% 1.8%
[libx264 @ 0x5a6d1785ec00] i16 v,h,dc,p: 64% 23% 13%  0%
[libx264 @ 0x5a6d1785ec00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 50%  9% 34%  1%  1%  2%  1%  2%  1%
[libx264 @ 0x5a6d1785ec00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 35% 22% 14%  4%  4%  5%  4%  9%  3%
[libx264 @ 0x5a6d1785ec00] i8c dc,h,v,p: 88%  2%  7%  3%
[libx264 @ 0x5a6d1785ec00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x5a6d1785ec00] ref P L0: 64.6% 15.3% 11.3%  8.8%
[libx264 @ 0x5a6d1785ec00] ref B L0: 80.7% 12.6%  6.8%
[libx264 @ 0x5a6d1785ec00] ref B L1: 91.5%  8.5%
[libx264 @ 0x5a6d1785ec00] kb/s:698.34
[INFO] Video saved as 'bin/result/optim_walk_12.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 26 = (8*3 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<07:14,  4.39s/it]  2%|▏         | 2/100 [00:05<04:04,  2.49s/it]  3%|▎         | 3/100 [00:07<03:35,  2.22s/it]  4%|▍         | 4/100 [00:08<02:56,  1.84s/it]  5%|▌         | 5/100 [00:09<02:35,  1.64s/it]  6%|▌         | 6/100 [00:11<02:21,  1.51s/it]  7%|▋         | 7/100 [00:12<02:09,  1.39s/it]  8%|▊         | 8/100 [00:13<02:01,  1.32s/it]  9%|▉         | 9/100 [00:14<01:57,  1.29s/it] 10%|█         | 10/100 [00:16<01:54,  1.28s/it] 11%|█         | 11/100 [00:17<01:52,  1.27s/it] 12%|█▏        | 12/100 [00:18<01:55,  1.31s/it] 13%|█▎        | 13/100 [00:19<01:49,  1.26s/it] 14%|█▍        | 14/100 [00:21<01:48,  1.27s/it] 15%|█▌        | 15/100 [00:22<01:45,  1.24s/it] 16%|█▌        | 16/100 [00:23<01:43,  1.24s/it] 17%|█▋        | 17/100 [00:24<01:41,  1.23s/it] 18%|█▊        | 18/100 [00:25<01:40,  1.23s/it] 19%|█▉        | 19/100 [00:27<01:44,  1.29s/it] 20%|██        | 20/100 [00:28<01:41,  1.27s/it] 21%|██        | 21/100 [00:29<01:38,  1.24s/it] 22%|██▏       | 22/100 [00:31<01:37,  1.24s/it] 23%|██▎       | 23/100 [00:32<01:35,  1.24s/it] 24%|██▍       | 24/100 [00:33<01:38,  1.29s/it] 25%|██▌       | 25/100 [00:35<01:38,  1.31s/it] 26%|██▌       | 26/100 [00:36<01:37,  1.31s/it] 27%|██▋       | 27/100 [00:37<01:36,  1.32s/it] 28%|██▊       | 28/100 [00:38<01:32,  1.29s/it] 29%|██▉       | 29/100 [00:40<01:32,  1.30s/it] 30%|███       | 30/100 [00:41<01:32,  1.32s/it] 31%|███       | 31/100 [00:42<01:29,  1.30s/it] 32%|███▏      | 32/100 [00:44<01:28,  1.30s/it] 33%|███▎      | 33/100 [00:45<01:27,  1.31s/it] 34%|███▍      | 34/100 [00:46<01:23,  1.27s/it] 35%|███▌      | 35/100 [00:48<01:24,  1.30s/it] 36%|███▌      | 36/100 [00:49<01:23,  1.31s/it] 37%|███▋      | 37/100 [00:50<01:21,  1.30s/it] 38%|███▊      | 38/100 [00:51<01:19,  1.28s/it] 39%|███▉      | 39/100 [00:53<01:19,  1.30s/it] 40%|████      | 40/100 [00:54<01:16,  1.27s/it] 41%|████      | 41/100 [00:56<01:20,  1.37s/it] 42%|████▏     | 42/100 [00:57<01:16,  1.32s/it] 43%|████▎     | 43/100 [00:58<01:17,  1.35s/it] 44%|████▍     | 44/100 [01:00<01:17,  1.38s/it] 45%|████▌     | 45/100 [01:01<01:14,  1.35s/it] 46%|████▌     | 46/100 [01:02<01:09,  1.29s/it] 47%|████▋     | 47/100 [01:03<01:05,  1.23s/it] 48%|████▊     | 48/100 [01:04<01:03,  1.22s/it] 49%|████▉     | 49/100 [01:06<01:02,  1.22s/it] 50%|█████     | 50/100 [01:07<01:01,  1.22s/it] 51%|█████     | 51/100 [01:08<00:59,  1.21s/it] 52%|█████▏    | 52/100 [01:09<00:57,  1.20s/it] 53%|█████▎    | 53/100 [01:10<00:55,  1.19s/it] 54%|█████▍    | 54/100 [01:11<00:54,  1.18s/it] 55%|█████▌    | 55/100 [01:13<00:55,  1.23s/it] 56%|█████▌    | 56/100 [01:14<00:54,  1.25s/it] 57%|█████▋    | 57/100 [01:15<00:52,  1.23s/it] 58%|█████▊    | 58/100 [01:17<00:52,  1.24s/it] 59%|█████▉    | 59/100 [01:18<00:49,  1.21s/it] 60%|██████    | 60/100 [01:19<00:47,  1.19s/it] 61%|██████    | 61/100 [01:20<00:46,  1.20s/it] 62%|██████▏   | 62/100 [01:21<00:45,  1.21s/it] 63%|██████▎   | 63/100 [01:22<00:44,  1.20s/it] 64%|██████▍   | 64/100 [01:24<00:43,  1.20s/it] 65%|██████▌   | 65/100 [01:25<00:42,  1.20s/it] 66%|██████▌   | 66/100 [01:26<00:41,  1.21s/it] 67%|██████▋   | 67/100 [01:27<00:39,  1.21s/it] 68%|██████▊   | 68/100 [01:29<00:40,  1.27s/it] 69%|██████▉   | 69/100 [01:30<00:38,  1.25s/it] 70%|███████   | 70/100 [01:31<00:38,  1.28s/it] 71%|███████   | 71/100 [01:33<00:37,  1.29s/it] 72%|███████▏  | 72/100 [01:34<00:35,  1.27s/it] 73%|███████▎  | 73/100 [01:35<00:33,  1.26s/it] 74%|███████▍  | 74/100 [01:36<00:32,  1.25s/it] 75%|███████▌  | 75/100 [01:37<00:30,  1.21s/it] 76%|███████▌  | 76/100 [01:39<00:29,  1.23s/it] 77%|███████▋  | 77/100 [01:40<00:28,  1.23s/it] 78%|███████▊  | 78/100 [01:41<00:26,  1.22s/it] 79%|███████▉  | 79/100 [01:42<00:26,  1.25s/it] 80%|████████  | 80/100 [01:44<00:25,  1.26s/it] 81%|████████  | 81/100 [01:45<00:24,  1.30s/it] 82%|████████▏ | 82/100 [01:46<00:23,  1.33s/it] 83%|████████▎ | 83/100 [01:48<00:22,  1.32s/it] 84%|████████▍ | 84/100 [01:49<00:20,  1.28s/it] 85%|████████▌ | 85/100 [01:50<00:18,  1.25s/it] 86%|████████▌ | 86/100 [01:51<00:17,  1.22s/it] 87%|████████▋ | 87/100 [01:52<00:15,  1.21s/it] 88%|████████▊ | 88/100 [01:54<00:15,  1.26s/it] 89%|████████▉ | 89/100 [01:55<00:13,  1.26s/it] 90%|█████████ | 90/100 [01:56<00:12,  1.26s/it] 91%|█████████ | 91/100 [01:58<00:11,  1.28s/it] 92%|█████████▏| 92/100 [01:59<00:10,  1.30s/it] 93%|█████████▎| 93/100 [02:00<00:09,  1.34s/it] 94%|█████████▍| 94/100 [02:02<00:07,  1.30s/it] 95%|█████████▌| 95/100 [02:03<00:06,  1.29s/it] 96%|█████████▌| 96/100 [02:04<00:05,  1.27s/it] 97%|█████████▋| 97/100 [02:05<00:03,  1.25s/it] 98%|█████████▊| 98/100 [02:07<00:02,  1.26s/it] 99%|█████████▉| 99/100 [02:08<00:01,  1.25s/it]100%|██████████| 100/100 [02:12<00:00,  2.06s/it]100%|██████████| 100/100 [02:12<00:00,  1.32s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-4.png]
[0/100] loss: 0.9688167572021484 loss_joints: 0.9412404298782349 loss_collision: 0.0 loss_jerk: 0.015774117782711983 loss_floor_contact: 0.2599889934062958
[1/100] loss: 0.9606330990791321 loss_joints: 0.9329252243041992 loss_collision: 0.0 loss_jerk: 0.015643686056137085 loss_floor_contact: 0.2614351212978363
[2/100] loss: 0.9521123170852661 loss_joints: 0.9246382713317871 loss_collision: 0.0 loss_jerk: 0.01569328084588051 loss_floor_contact: 0.2590474486351013
[3/100] loss: 0.9431225657463074 loss_joints: 0.916024923324585 loss_collision: 0.0 loss_jerk: 0.01577606424689293 loss_floor_contact: 0.2552003860473633
[4/100] loss: 0.9361735582351685 loss_joints: 0.9093513488769531 loss_collision: 0.0 loss_jerk: 0.01582907699048519 loss_floor_contact: 0.25239312648773193
[5/100] loss: 0.9274872541427612 loss_joints: 0.900770902633667 loss_collision: 0.0 loss_jerk: 0.01590876653790474 loss_floor_contact: 0.25125476717948914
[6/100] loss: 0.9191068410873413 loss_joints: 0.8924131393432617 loss_collision: 0.0 loss_jerk: 0.016122858971357346 loss_floor_contact: 0.2508140206336975
[7/100] loss: 0.9125247597694397 loss_joints: 0.885966956615448 loss_collision: 0.0 loss_jerk: 0.01678595319390297 loss_floor_contact: 0.2487919181585312
[8/100] loss: 0.9081242084503174 loss_joints: 0.8818134665489197 loss_collision: 0.0 loss_jerk: 0.01697542332112789 loss_floor_contact: 0.24613210558891296
[9/100] loss: 0.903841495513916 loss_joints: 0.8778033256530762 loss_collision: 0.0 loss_jerk: 0.01761782355606556 loss_floor_contact: 0.242763489484787
[10/100] loss: 0.8992137312889099 loss_joints: 0.8733328580856323 loss_collision: 0.0 loss_jerk: 0.01930633932352066 loss_floor_contact: 0.23950240015983582
[11/100] loss: 0.895210862159729 loss_joints: 0.8696238398551941 loss_collision: 0.0 loss_jerk: 0.019648581743240356 loss_floor_contact: 0.23622176051139832
[12/100] loss: 0.892138659954071 loss_joints: 0.8669122457504272 loss_collision: 0.0 loss_jerk: 0.019946947693824768 loss_floor_contact: 0.23231744766235352
[13/100] loss: 0.8892125487327576 loss_joints: 0.8643020987510681 loss_collision: 0.0 loss_jerk: 0.021245112642645836 loss_floor_contact: 0.22785982489585876
[14/100] loss: 0.8860708475112915 loss_joints: 0.8614423274993896 loss_collision: 0.0 loss_jerk: 0.023161323741078377 loss_floor_contact: 0.22312387824058533
[15/100] loss: 0.8829781413078308 loss_joints: 0.858641505241394 loss_collision: 0.0 loss_jerk: 0.024956801906228065 loss_floor_contact: 0.21840950846672058
[16/100] loss: 0.88019198179245 loss_joints: 0.8561655879020691 loss_collision: 0.0 loss_jerk: 0.026025766506791115 loss_floor_contact: 0.2142382115125656
[17/100] loss: 0.8774964809417725 loss_joints: 0.8537895083427429 loss_collision: 0.0 loss_jerk: 0.026599330827593803 loss_floor_contact: 0.21047067642211914
[18/100] loss: 0.8748476505279541 loss_joints: 0.8514529466629028 loss_collision: 0.0 loss_jerk: 0.02693037874996662 loss_floor_contact: 0.20701627433300018
[19/100] loss: 0.8723082542419434 loss_joints: 0.8492070436477661 loss_collision: 0.0 loss_jerk: 0.027162590995430946 loss_floor_contact: 0.20384979248046875
[20/100] loss: 0.8698156476020813 loss_joints: 0.8469846248626709 loss_collision: 0.0 loss_jerk: 0.027408553287386894 loss_floor_contact: 0.20090171694755554
[21/100] loss: 0.8671860694885254 loss_joints: 0.8446037769317627 loss_collision: 0.0 loss_jerk: 0.027764327824115753 loss_floor_contact: 0.1980583518743515
[22/100] loss: 0.8640203475952148 loss_joints: 0.8416919112205505 loss_collision: 0.0 loss_jerk: 0.02828669361770153 loss_floor_contact: 0.1949976682662964
[23/100] loss: 0.8587607741355896 loss_joints: 0.8367034792900085 loss_collision: 0.0 loss_jerk: 0.028680851683020592 loss_floor_contact: 0.19189238548278809
[24/100] loss: 0.8529242277145386 loss_joints: 0.8311492800712585 loss_collision: 0.0 loss_jerk: 0.02780693955719471 loss_floor_contact: 0.18994256854057312
[25/100] loss: 0.8474546074867249 loss_joints: 0.8258828520774841 loss_collision: 0.0 loss_jerk: 0.027522018179297447 loss_floor_contact: 0.18819588422775269
[26/100] loss: 0.8443625569343567 loss_joints: 0.8228620290756226 loss_collision: 0.0 loss_jerk: 0.028309332206845284 loss_floor_contact: 0.18669602274894714
[27/100] loss: 0.8422157168388367 loss_joints: 0.8208038210868835 loss_collision: 0.0 loss_jerk: 0.02882727049291134 loss_floor_contact: 0.18529188632965088
[28/100] loss: 0.8397098183631897 loss_joints: 0.8184374570846558 loss_collision: 0.0 loss_jerk: 0.029154129326343536 loss_floor_contact: 0.18356925249099731
[29/100] loss: 0.8367902040481567 loss_joints: 0.8157036304473877 loss_collision: 0.0 loss_jerk: 0.02928328514099121 loss_floor_contact: 0.18158268928527832
[30/100] loss: 0.8337269425392151 loss_joints: 0.812859058380127 loss_collision: 0.0 loss_jerk: 0.02927514538168907 loss_floor_contact: 0.17940330505371094
[31/100] loss: 0.8307249546051025 loss_joints: 0.8101255893707275 loss_collision: 0.0 loss_jerk: 0.029155908152461052 loss_floor_contact: 0.17683833837509155
[32/100] loss: 0.8279508352279663 loss_joints: 0.8076440691947937 loss_collision: 0.0 loss_jerk: 0.02908376418054104 loss_floor_contact: 0.17398443818092346
[33/100] loss: 0.8254554271697998 loss_joints: 0.8054103255271912 loss_collision: 0.0 loss_jerk: 0.02909037657082081 loss_floor_contact: 0.1713600754737854
[34/100] loss: 0.8232011198997498 loss_joints: 0.8032805919647217 loss_collision: 0.0 loss_jerk: 0.030154995620250702 loss_floor_contact: 0.1690502166748047
[35/100] loss: 0.820909857749939 loss_joints: 0.8011305332183838 loss_collision: 0.0 loss_jerk: 0.03076632134616375 loss_floor_contact: 0.16702701151371002
[36/100] loss: 0.8185523152351379 loss_joints: 0.798933744430542 loss_collision: 0.0 loss_jerk: 0.03097580559551716 loss_floor_contact: 0.1652097851037979
[37/100] loss: 0.8161205053329468 loss_joints: 0.7966804504394531 loss_collision: 0.0 loss_jerk: 0.03083573654294014 loss_floor_contact: 0.16356490552425385
[38/100] loss: 0.8134369850158691 loss_joints: 0.7942203283309937 loss_collision: 0.0 loss_jerk: 0.030462181195616722 loss_floor_contact: 0.1617041379213333
[39/100] loss: 0.8104898929595947 loss_joints: 0.7915443778038025 loss_collision: 0.0 loss_jerk: 0.029947668313980103 loss_floor_contact: 0.15950721502304077
[40/100] loss: 0.8075397610664368 loss_joints: 0.7888849973678589 loss_collision: 0.0 loss_jerk: 0.029365958645939827 loss_floor_contact: 0.15718171000480652
[41/100] loss: 0.8044556975364685 loss_joints: 0.7861316204071045 loss_collision: 0.0 loss_jerk: 0.029223471879959106 loss_floor_contact: 0.15401709079742432
[42/100] loss: 0.8014279007911682 loss_joints: 0.7833911776542664 loss_collision: 0.0 loss_jerk: 0.02938421629369259 loss_floor_contact: 0.15098261833190918
[43/100] loss: 0.7991927862167358 loss_joints: 0.7808665037155151 loss_collision: 0.0 loss_jerk: 0.029540160670876503 loss_floor_contact: 0.15372270345687866
[44/100] loss: 0.7967533469200134 loss_joints: 0.7785344123840332 loss_collision: 0.0 loss_jerk: 0.02982226014137268 loss_floor_contact: 0.15236720442771912
[45/100] loss: 0.7941837310791016 loss_joints: 0.7763985395431519 loss_collision: 0.0 loss_jerk: 0.030112985521554947 loss_floor_contact: 0.14773911237716675
[46/100] loss: 0.7921465635299683 loss_joints: 0.7743674516677856 loss_collision: 0.0 loss_jerk: 0.03039265051484108 loss_floor_contact: 0.14739885926246643
[47/100] loss: 0.7900766134262085 loss_joints: 0.7723109722137451 loss_collision: 0.0 loss_jerk: 0.030745161697268486 loss_floor_contact: 0.1469114124774933
[48/100] loss: 0.788011908531189 loss_joints: 0.7703098058700562 loss_collision: 0.0 loss_jerk: 0.031104594469070435 loss_floor_contact: 0.14591607451438904
[49/100] loss: 0.7861096858978271 loss_joints: 0.7683783769607544 loss_collision: 0.0 loss_jerk: 0.03144007921218872 loss_floor_contact: 0.14587290585041046
[50/100] loss: 0.7842133045196533 loss_joints: 0.7665148973464966 loss_collision: 0.0 loss_jerk: 0.03174620121717453 loss_floor_contact: 0.14523795247077942
[51/100] loss: 0.7823125123977661 loss_joints: 0.7646974325180054 loss_collision: 0.0 loss_jerk: 0.03202731907367706 loss_floor_contact: 0.14412325620651245
[52/100] loss: 0.7804245352745056 loss_joints: 0.7629127502441406 loss_collision: 0.0 loss_jerk: 0.03229081258177757 loss_floor_contact: 0.1428268849849701
[53/100] loss: 0.7786306142807007 loss_joints: 0.7611284255981445 loss_collision: 0.0 loss_jerk: 0.03254402428865433 loss_floor_contact: 0.14247781038284302
[54/100] loss: 0.7767473459243774 loss_joints: 0.7593373656272888 loss_collision: 0.0 loss_jerk: 0.0327911451458931 loss_floor_contact: 0.14130918681621552
[55/100] loss: 0.7748531103134155 loss_joints: 0.757525622844696 loss_collision: 0.0 loss_jerk: 0.033041324466466904 loss_floor_contact: 0.14023341238498688
[56/100] loss: 0.7730289697647095 loss_joints: 0.7556936144828796 loss_collision: 0.0 loss_jerk: 0.033298395574092865 loss_floor_contact: 0.14005546271800995
[57/100] loss: 0.7711842656135559 loss_joints: 0.7538577318191528 loss_collision: 0.0 loss_jerk: 0.03357132896780968 loss_floor_contact: 0.139694482088089
[58/100] loss: 0.7692824006080627 loss_joints: 0.7520066499710083 loss_collision: 0.0007653646171092987 loss_jerk: 0.03385510668158531 loss_floor_contact: 0.13813753426074982
[59/100] loss: 0.7676231861114502 loss_joints: 0.7501470446586609 loss_collision: 0.003100670874118805 loss_jerk: 0.03414634242653847 loss_floor_contact: 0.13751474022865295
[60/100] loss: 0.7659080028533936 loss_joints: 0.7483049631118774 loss_collision: 0.004681404680013657 loss_jerk: 0.03444315120577812 loss_floor_contact: 0.13690587878227234
[61/100] loss: 0.7640553712844849 loss_joints: 0.7464890480041504 loss_collision: 0.004607260227203369 loss_jerk: 0.0347350612282753 loss_floor_contact: 0.13632053136825562
[62/100] loss: 0.7622253894805908 loss_joints: 0.7447082996368408 loss_collision: 0.004380285739898682 loss_jerk: 0.035012032836675644 loss_floor_contact: 0.13577890396118164
[63/100] loss: 0.7604630589485168 loss_joints: 0.7429656386375427 loss_collision: 0.004410210996866226 loss_jerk: 0.03527165949344635 loss_floor_contact: 0.13529260456562042
[64/100] loss: 0.7587440013885498 loss_joints: 0.741258978843689 loss_collision: 0.004467476159334183 loss_jerk: 0.035520147532224655 loss_floor_contact: 0.13486289978027344
[65/100] loss: 0.757026195526123 loss_joints: 0.739585816860199 loss_collision: 0.00414680689573288 loss_jerk: 0.03576476871967316 loss_floor_contact: 0.13449233770370483
[66/100] loss: 0.755370020866394 loss_joints: 0.7379624247550964 loss_collision: 0.0038920119404792786 loss_jerk: 0.036009516566991806 loss_floor_contact: 0.13417431712150574
[67/100] loss: 0.7538226246833801 loss_joints: 0.73639976978302 loss_collision: 0.004076313227415085 loss_jerk: 0.03625033050775528 loss_floor_contact: 0.1339016556739807
[68/100] loss: 0.7522493004798889 loss_joints: 0.7349056005477905 loss_collision: 0.00332077220082283 loss_jerk: 0.03648950532078743 loss_floor_contact: 0.13362720608711243
[69/100] loss: 0.7511883974075317 loss_joints: 0.7334800958633423 loss_collision: 0.007033199071884155 loss_jerk: 0.03672054782509804 loss_floor_contact: 0.13332873582839966
[70/100] loss: 0.7502086758613586 loss_joints: 0.7320970892906189 loss_collision: 0.011093389242887497 loss_jerk: 0.03696142137050629 loss_floor_contact: 0.1330607384443283
[71/100] loss: 0.7489413022994995 loss_joints: 0.7307533621788025 loss_collision: 0.011786486953496933 loss_jerk: 0.0372040793299675 loss_floor_contact: 0.13288944959640503
[72/100] loss: 0.7479349374771118 loss_joints: 0.7294484972953796 loss_collision: 0.014608804136514664 loss_jerk: 0.03743594139814377 loss_floor_contact: 0.13281947374343872
[73/100] loss: 0.7469133734703064 loss_joints: 0.7281808257102966 loss_collision: 0.01690695434808731 loss_jerk: 0.0376659519970417 loss_floor_contact: 0.13275283575057983
[74/100] loss: 0.7457951307296753 loss_joints: 0.7269444465637207 loss_collision: 0.017932891845703125 loss_jerk: 0.03788980469107628 loss_floor_contact: 0.13268402218818665
[75/100] loss: 0.7444566488265991 loss_joints: 0.7257355451583862 loss_collision: 0.016468223184347153 loss_jerk: 0.03810017183423042 loss_floor_contact: 0.132642924785614
[76/100] loss: 0.7435561418533325 loss_joints: 0.7245523929595947 loss_collision: 0.01911095157265663 loss_jerk: 0.03829728811979294 loss_floor_contact: 0.13262903690338135
[77/100] loss: 0.742572546005249 loss_joints: 0.723395586013794 loss_collision: 0.02063141018152237 loss_jerk: 0.03848029673099518 loss_floor_contact: 0.13265816867351532
[78/100] loss: 0.7414150834083557 loss_joints: 0.7222685813903809 loss_collision: 0.020085874944925308 loss_jerk: 0.03864908963441849 loss_floor_contact: 0.13273024559020996
[79/100] loss: 0.7403466701507568 loss_joints: 0.7211707830429077 loss_collision: 0.02011691778898239 loss_jerk: 0.038802843540906906 loss_floor_contact: 0.13283921778202057
[80/100] loss: 0.7392349243164062 loss_joints: 0.7201080322265625 loss_collision: 0.019340526312589645 loss_jerk: 0.03894104063510895 loss_floor_contact: 0.1329873502254486
[81/100] loss: 0.7381291389465332 loss_joints: 0.7190823554992676 loss_collision: 0.01822945848107338 loss_jerk: 0.039066132158041 loss_floor_contact: 0.13317197561264038
[82/100] loss: 0.7371938228607178 loss_joints: 0.7180997729301453 loss_collision: 0.01837335154414177 loss_jerk: 0.03917727619409561 loss_floor_contact: 0.13338975608348846
[83/100] loss: 0.7361955642700195 loss_joints: 0.7171616554260254 loss_collision: 0.017429307103157043 loss_jerk: 0.03927713632583618 loss_floor_contact: 0.13363267481327057
[84/100] loss: 0.7352215051651001 loss_joints: 0.7162703275680542 loss_collision: 0.016273438930511475 loss_jerk: 0.039366621524095535 loss_floor_contact: 0.1338721066713333
[85/100] loss: 0.7344914674758911 loss_joints: 0.7154281139373779 loss_collision: 0.01710248738527298 loss_jerk: 0.039447683840990067 loss_floor_contact: 0.13408371806144714
[86/100] loss: 0.7337476015090942 loss_joints: 0.7146363258361816 loss_collision: 0.017318200320005417 loss_jerk: 0.03952072933316231 loss_floor_contact: 0.13427385687828064
[87/100] loss: 0.7329931259155273 loss_joints: 0.7138978242874146 loss_collision: 0.01692364364862442 loss_jerk: 0.03958750516176224 loss_floor_contact: 0.1344420164823532
[88/100] loss: 0.7324031591415405 loss_joints: 0.713212251663208 loss_collision: 0.017668142914772034 loss_jerk: 0.03964810445904732 loss_floor_contact: 0.13459309935569763
[89/100] loss: 0.7318465113639832 loss_joints: 0.7125794291496277 loss_collision: 0.018241100013256073 loss_jerk: 0.03970133140683174 loss_floor_contact: 0.134728342294693
[90/100] loss: 0.7312564253807068 loss_joints: 0.7120003700256348 loss_collision: 0.01796269416809082 loss_jerk: 0.03974537551403046 loss_floor_contact: 0.13485252857208252
[91/100] loss: 0.7309776544570923 loss_joints: 0.7114741206169128 loss_collision: 0.020286209881305695 loss_jerk: 0.03978188708424568 loss_floor_contact: 0.1349669247865677
[92/100] loss: 0.7306072115898132 loss_joints: 0.7110053300857544 loss_collision: 0.021164171397686005 loss_jerk: 0.03981706500053406 loss_floor_contact: 0.13503743708133698
[93/100] loss: 0.730227530002594 loss_joints: 0.7105933427810669 loss_collision: 0.021420225501060486 loss_jerk: 0.03984884172677994 loss_floor_contact: 0.13507293164730072
[94/100] loss: 0.7298823595046997 loss_joints: 0.7102344036102295 loss_collision: 0.021579783409833908 loss_jerk: 0.03987563028931618 loss_floor_contact: 0.13502414524555206
[95/100] loss: 0.7295960783958435 loss_joints: 0.7099283933639526 loss_collision: 0.02184351533651352 loss_jerk: 0.03989669680595398 loss_floor_contact: 0.1349363625049591
[96/100] loss: 0.7293689250946045 loss_joints: 0.7096750140190125 loss_collision: 0.02217099443078041 loss_jerk: 0.03991182520985603 loss_floor_contact: 0.13485592603683472
[97/100] loss: 0.7291577458381653 loss_joints: 0.7094731330871582 loss_collision: 0.022138260304927826 loss_jerk: 0.039922524243593216 loss_floor_contact: 0.1347852647304535
[98/100] loss: 0.728926956653595 loss_joints: 0.7093236446380615 loss_collision: 0.021375637501478195 loss_jerk: 0.039929576218128204 loss_floor_contact: 0.13472791016101837
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-4.png]
[99/100] loss: 0.728850781917572 loss_joints: 0.7092244029045105 loss_collision: 0.021642640233039856 loss_jerk: 0.03993378207087517 loss_floor_contact: 0.13468743860721588
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path2-walk3-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 132.28507                                                    ║
    ║     rollout = 51.25768                                                     ║
    ║     sdf     = 18.84594                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.72885078                                                 ║
    ║     joints    = 0.70922440                                                 ║
    ║     collision = 0.02164264                                                 ║
    ║     jerk      = 0.03993378                                                 ║
    ║     floor     = 0.13468744                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	2m33.434s
user	2m11.759s
sys	0m9.761s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x644a62b61c00] using SAR=1/1
[libx264 @ 0x644a62b61c00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x644a62b61c00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x644a62b61c00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_run_3.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x644a62b5ffc0] video:215kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.529820%
frame=   25 fps=0.0 q=-1.0 Lsize=     217kB time=00:00:02.20 bitrate= 806.6kbits/s speed=3.25x    
[libx264 @ 0x644a62b61c00] frame I:1     Avg QP:18.85  size: 68680
[libx264 @ 0x644a62b61c00] frame P:9     Avg QP:19.57  size: 13119
[libx264 @ 0x644a62b61c00] frame B:15    Avg QP:21.75  size:  2213
[libx264 @ 0x644a62b61c00] consecutive B-frames:  8.0% 32.0% 12.0% 48.0%
[libx264 @ 0x644a62b61c00] mb I  I16..4:  5.2% 66.3% 28.5%
[libx264 @ 0x644a62b61c00] mb P  I16..4:  0.2%  1.8%  1.7%  P16..4: 10.0%  2.9%  2.0%  0.0%  0.0%    skip:81.3%
[libx264 @ 0x644a62b61c00] mb B  I16..4:  0.1%  0.3%  0.1%  B16..8: 11.1%  1.5%  0.5%  direct: 0.8%  skip:85.6%  L0:50.6% L1:43.4% BI: 6.0%
[libx264 @ 0x644a62b61c00] 8x8 transform intra:61.6% inter:58.5%
[libx264 @ 0x644a62b61c00] coded y,uvDC,uvAC intra: 31.1% 20.7% 19.6% inter: 4.0% 4.3% 2.1%
[libx264 @ 0x644a62b61c00] i16 v,h,dc,p: 59% 26% 15%  0%
[libx264 @ 0x644a62b61c00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 52%  8% 33%  1%  1%  1%  1%  2%  1%
[libx264 @ 0x644a62b61c00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 36% 22% 15%  5%  4%  5%  4%  9%  3%
[libx264 @ 0x644a62b61c00] i8c dc,h,v,p: 88%  2%  7%  3%
[libx264 @ 0x644a62b61c00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x644a62b61c00] ref P L0: 60.9% 16.1% 13.3%  9.7%
[libx264 @ 0x644a62b61c00] ref B L0: 77.2% 17.2%  5.6%
[libx264 @ 0x644a62b61c00] ref B L1: 91.2%  8.8%
[libx264 @ 0x644a62b61c00] kb/s:703.85
[INFO] Video saved as 'bin/result/optim_run_3.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 50 = (8*6 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:07<12:10,  7.37s/it]  2%|▏         | 2/100 [00:09<07:13,  4.43s/it]  3%|▎         | 3/100 [00:13<06:39,  4.12s/it]  4%|▍         | 4/100 [00:15<05:31,  3.46s/it]  5%|▌         | 5/100 [00:18<04:48,  3.03s/it]  6%|▌         | 6/100 [00:20<04:26,  2.83s/it]  7%|▋         | 7/100 [00:22<04:07,  2.66s/it]  8%|▊         | 8/100 [00:25<03:56,  2.58s/it]  9%|▉         | 9/100 [00:28<03:58,  2.62s/it] 10%|█         | 10/100 [00:30<03:48,  2.54s/it] 11%|█         | 11/100 [00:32<03:40,  2.48s/it] 12%|█▏        | 12/100 [00:35<03:33,  2.42s/it] 13%|█▎        | 13/100 [00:37<03:27,  2.38s/it] 14%|█▍        | 14/100 [00:39<03:30,  2.44s/it] 15%|█▌        | 15/100 [00:42<03:27,  2.44s/it] 16%|█▌        | 16/100 [00:44<03:23,  2.43s/it] 17%|█▋        | 17/100 [00:47<03:19,  2.40s/it] 18%|█▊        | 18/100 [00:49<03:20,  2.44s/it] 19%|█▉        | 19/100 [00:52<03:22,  2.50s/it] 20%|██        | 20/100 [00:54<03:21,  2.51s/it] 21%|██        | 21/100 [00:57<03:15,  2.48s/it] 22%|██▏       | 22/100 [00:59<03:10,  2.45s/it] 23%|██▎       | 23/100 [01:02<03:10,  2.47s/it] 24%|██▍       | 24/100 [01:05<03:17,  2.59s/it] 25%|██▌       | 25/100 [01:07<03:10,  2.54s/it] 26%|██▌       | 26/100 [01:10<03:10,  2.57s/it] 27%|██▋       | 27/100 [01:12<03:03,  2.51s/it] 28%|██▊       | 28/100 [01:14<02:58,  2.48s/it] 29%|██▉       | 29/100 [01:17<02:59,  2.52s/it] 30%|███       | 30/100 [01:19<02:50,  2.44s/it] 31%|███       | 31/100 [01:22<02:57,  2.57s/it] 32%|███▏      | 32/100 [01:25<02:53,  2.55s/it] 33%|███▎      | 33/100 [01:27<02:48,  2.51s/it] 34%|███▍      | 34/100 [01:29<02:41,  2.45s/it] 35%|███▌      | 35/100 [01:32<02:39,  2.46s/it] 36%|███▌      | 36/100 [01:34<02:35,  2.43s/it] 37%|███▋      | 37/100 [01:37<02:31,  2.41s/it] 38%|███▊      | 38/100 [01:39<02:27,  2.38s/it] 39%|███▉      | 39/100 [01:42<02:34,  2.53s/it] 40%|████      | 40/100 [01:44<02:36,  2.60s/it] 41%|████      | 41/100 [01:47<02:31,  2.56s/it] 42%|████▏     | 42/100 [01:50<02:29,  2.58s/it] 43%|████▎     | 43/100 [01:52<02:30,  2.64s/it] 44%|████▍     | 44/100 [01:55<02:30,  2.69s/it] 45%|████▌     | 45/100 [01:58<02:23,  2.61s/it] 46%|████▌     | 46/100 [02:00<02:18,  2.57s/it] 47%|████▋     | 47/100 [02:03<02:19,  2.64s/it] 48%|████▊     | 48/100 [02:05<02:12,  2.54s/it] 49%|████▉     | 49/100 [02:08<02:12,  2.59s/it] 50%|█████     | 50/100 [02:11<02:10,  2.62s/it] 51%|█████     | 51/100 [02:13<02:08,  2.61s/it] 52%|█████▏    | 52/100 [02:16<02:09,  2.70s/it] 53%|█████▎    | 53/100 [02:19<02:03,  2.63s/it] 54%|█████▍    | 54/100 [02:21<01:57,  2.55s/it] 55%|█████▌    | 55/100 [02:23<01:53,  2.52s/it] 56%|█████▌    | 56/100 [02:26<01:51,  2.54s/it] 57%|█████▋    | 57/100 [02:29<01:49,  2.55s/it] 58%|█████▊    | 58/100 [02:31<01:48,  2.57s/it] 59%|█████▉    | 59/100 [02:34<01:47,  2.62s/it] 60%|██████    | 60/100 [02:36<01:44,  2.62s/it] 61%|██████    | 61/100 [02:39<01:41,  2.59s/it] 62%|██████▏   | 62/100 [02:42<01:38,  2.60s/it] 63%|██████▎   | 63/100 [02:44<01:37,  2.64s/it] 64%|██████▍   | 64/100 [02:47<01:32,  2.58s/it] 65%|██████▌   | 65/100 [02:49<01:30,  2.60s/it] 66%|██████▌   | 66/100 [02:52<01:28,  2.60s/it] 67%|██████▋   | 67/100 [02:55<01:24,  2.56s/it] 68%|██████▊   | 68/100 [02:57<01:19,  2.50s/it] 69%|██████▉   | 69/100 [02:59<01:18,  2.52s/it] 70%|███████   | 70/100 [03:02<01:17,  2.59s/it] 71%|███████   | 71/100 [03:05<01:17,  2.69s/it] 72%|███████▏  | 72/100 [03:08<01:14,  2.64s/it] 73%|███████▎  | 73/100 [03:10<01:10,  2.62s/it] 74%|███████▍  | 74/100 [03:13<01:07,  2.59s/it] 75%|███████▌  | 75/100 [03:15<01:04,  2.56s/it] 76%|███████▌  | 76/100 [03:18<01:02,  2.59s/it] 77%|███████▋  | 77/100 [03:21<01:00,  2.62s/it] 78%|███████▊  | 78/100 [03:23<00:57,  2.61s/it] 79%|███████▉  | 79/100 [03:26<00:54,  2.61s/it] 80%|████████  | 80/100 [03:28<00:51,  2.56s/it] 81%|████████  | 81/100 [03:31<00:49,  2.62s/it] 82%|████████▏ | 82/100 [03:34<00:47,  2.64s/it] 83%|████████▎ | 83/100 [03:36<00:44,  2.61s/it] 84%|████████▍ | 84/100 [03:39<00:41,  2.57s/it] 85%|████████▌ | 85/100 [03:41<00:38,  2.58s/it] 86%|████████▌ | 86/100 [03:44<00:35,  2.53s/it] 87%|████████▋ | 87/100 [03:46<00:32,  2.49s/it] 88%|████████▊ | 88/100 [03:49<00:30,  2.56s/it] 89%|████████▉ | 89/100 [03:51<00:27,  2.52s/it] 90%|█████████ | 90/100 [03:54<00:24,  2.49s/it] 91%|█████████ | 91/100 [03:56<00:22,  2.46s/it] 92%|█████████▏| 92/100 [03:58<00:19,  2.43s/it] 93%|█████████▎| 93/100 [04:01<00:17,  2.54s/it] 94%|█████████▍| 94/100 [04:04<00:14,  2.50s/it] 95%|█████████▌| 95/100 [04:06<00:12,  2.43s/it] 96%|█████████▌| 96/100 [04:08<00:09,  2.44s/it] 97%|█████████▋| 97/100 [04:11<00:07,  2.41s/it] 98%|█████████▊| 98/100 [04:13<00:04,  2.37s/it] 99%|█████████▉| 99/100 [04:16<00:02,  2.44s/it]100%|██████████| 100/100 [04:23<00:00,  3.96s/it]100%|██████████| 100/100 [04:23<00:00,  2.64s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-7.png]
[0/100] loss: 2.0462405681610107 loss_joints: 2.0006790161132812 loss_collision: 0.1843377947807312 loss_jerk: 0.05721307918429375 loss_floor_contact: 0.2140631377696991
[1/100] loss: 2.03822922706604 loss_joints: 1.9905986785888672 loss_collision: 0.20207887887954712 loss_jerk: 0.06161990016698837 loss_floor_contact: 0.2126067727804184
[2/100] loss: 2.066419839859009 loss_joints: 2.017086982727051 loss_collision: 0.21887221932411194 loss_jerk: 0.07360675185918808 loss_floor_contact: 0.2008483111858368
[3/100] loss: 2.0338516235351562 loss_joints: 1.9873350858688354 loss_collision: 0.2039724886417389 loss_jerk: 0.06992173939943314 loss_floor_contact: 0.19127246737480164
[4/100] loss: 1.9861944913864136 loss_joints: 1.9444196224212646 loss_collision: 0.17696669697761536 loss_jerk: 0.06608517467975616 loss_floor_contact: 0.174697145819664
[5/100] loss: 1.9530199766159058 loss_joints: 1.914510726928711 loss_collision: 0.16190676391124725 loss_jerk: 0.06234933063387871 loss_floor_contact: 0.16083727777004242
[6/100] loss: 1.9188964366912842 loss_joints: 1.8818883895874023 loss_collision: 0.16061609983444214 loss_jerk: 0.06030706688761711 loss_floor_contact: 0.14915692806243896
[7/100] loss: 1.879967212677002 loss_joints: 1.8421367406845093 loss_collision: 0.1779802143573761 loss_jerk: 0.059060610830783844 loss_floor_contact: 0.14126251637935638
[8/100] loss: 1.8362767696380615 loss_joints: 1.7993125915527344 loss_collision: 0.1772371083498001 loss_jerk: 0.0580047070980072 loss_floor_contact: 0.13440033793449402
[9/100] loss: 1.799921989440918 loss_joints: 1.7594112157821655 loss_collision: 0.2192421853542328 loss_jerk: 0.058046337217092514 loss_floor_contact: 0.1278182864189148
[10/100] loss: 1.7677158117294312 loss_joints: 1.7246031761169434 loss_collision: 0.24941317737102509 loss_jerk: 0.05824543535709381 loss_floor_contact: 0.12346770614385605
[11/100] loss: 1.7300972938537598 loss_joints: 1.6838033199310303 loss_collision: 0.28689712285995483 loss_jerk: 0.058543868362903595 loss_floor_contact: 0.11749883741140366
[12/100] loss: 1.6813069581985474 loss_joints: 1.6383676528930664 loss_collision: 0.260692298412323 loss_jerk: 0.049125101417303085 loss_floor_contact: 0.11957582831382751
[13/100] loss: 1.6030279397964478 loss_joints: 1.5610599517822266 loss_collision: 0.24549810588359833 loss_jerk: 0.046441592276096344 loss_floor_contact: 0.12773969769477844
[14/100] loss: 1.6225544214248657 loss_joints: 1.5697848796844482 loss_collision: 0.33444228768348694 loss_jerk: 0.06383121758699417 loss_floor_contact: 0.12942050397396088
[15/100] loss: 1.604759931564331 loss_joints: 1.5525277853012085 loss_collision: 0.33888131380081177 loss_jerk: 0.06048138439655304 loss_floor_contact: 0.12295909225940704
[16/100] loss: 1.5743848085403442 loss_joints: 1.5256872177124023 loss_collision: 0.30100640654563904 loss_jerk: 0.061744898557662964 loss_floor_contact: 0.1242259219288826
[17/100] loss: 1.5344983339309692 loss_joints: 1.489431381225586 loss_collision: 0.2684571146965027 loss_jerk: 0.059872131794691086 loss_floor_contact: 0.12234137207269669
[18/100] loss: 1.4563919305801392 loss_joints: 1.4178589582443237 loss_collision: 0.2151649445295334 loss_jerk: 0.04668488726019859 loss_floor_contact: 0.12348049879074097
[19/100] loss: 1.4606850147247314 loss_joints: 1.4168542623519897 loss_collision: 0.26712703704833984 loss_jerk: 0.04189836606383324 loss_floor_contact: 0.12928304076194763
[20/100] loss: 1.4352054595947266 loss_joints: 1.392082929611206 loss_collision: 0.2580532133579254 loss_jerk: 0.04580764099955559 loss_floor_contact: 0.12736444175243378
[21/100] loss: 1.3930044174194336 loss_joints: 1.3499152660369873 loss_collision: 0.2555379569530487 loss_jerk: 0.050238411873579025 loss_floor_contact: 0.12511448562145233
[22/100] loss: 1.3719055652618408 loss_joints: 1.327683925628662 loss_collision: 0.26288530230522156 loss_jerk: 0.05324426665902138 loss_floor_contact: 0.1260860413312912
[23/100] loss: 1.3410223722457886 loss_joints: 1.2987427711486816 loss_collision: 0.2437768429517746 loss_jerk: 0.05110826715826988 loss_floor_contact: 0.12791010737419128
[24/100] loss: 1.3105970621109009 loss_joints: 1.2688462734222412 loss_collision: 0.23132756352424622 loss_jerk: 0.056353919208049774 loss_floor_contact: 0.12982627749443054
[25/100] loss: 1.2808862924575806 loss_joints: 1.2395131587982178 loss_collision: 0.22351452708244324 loss_jerk: 0.06407254934310913 loss_floor_contact: 0.12614360451698303
[26/100] loss: 1.2562311887741089 loss_joints: 1.2172203063964844 loss_collision: 0.19365529716014862 loss_jerk: 0.06679382175207138 loss_floor_contact: 0.12965914607048035
[27/100] loss: 1.232214093208313 loss_joints: 1.1928997039794922 loss_collision: 0.1930350959300995 loss_jerk: 0.06469269841909409 loss_floor_contact: 0.13541579246520996
[28/100] loss: 1.2081878185272217 loss_joints: 1.1698575019836426 loss_collision: 0.1826600730419159 loss_jerk: 0.06314951926469803 loss_floor_contact: 0.1374935507774353
[29/100] loss: 1.1822357177734375 loss_joints: 1.1444807052612305 loss_collision: 0.16993315517902374 loss_jerk: 0.06748984754085541 loss_floor_contact: 0.14012745022773743
[30/100] loss: 1.1561442613601685 loss_joints: 1.1208961009979248 loss_collision: 0.1396484076976776 loss_jerk: 0.07230386883020401 loss_floor_contact: 0.14052926003932953
[31/100] loss: 1.1314518451690674 loss_joints: 1.0966894626617432 loss_collision: 0.1352970451116562 loss_jerk: 0.0742923840880394 loss_floor_contact: 0.1380351483821869
[32/100] loss: 1.1049095392227173 loss_joints: 1.0704071521759033 loss_collision: 0.13407529890537262 loss_jerk: 0.07516510784626007 loss_floor_contact: 0.13578277826309204
[33/100] loss: 1.0798317193984985 loss_joints: 1.0453299283981323 loss_collision: 0.1374617964029312 loss_jerk: 0.0739850252866745 loss_floor_contact: 0.13357210159301758
[34/100] loss: 1.0534993410110474 loss_joints: 1.0197709798812866 loss_collision: 0.1309559941291809 loss_jerk: 0.07252711802721024 loss_floor_contact: 0.13380050659179688
[35/100] loss: 1.0263583660125732 loss_joints: 0.9937850832939148 loss_collision: 0.12224850058555603 loss_jerk: 0.07020796090364456 loss_floor_contact: 0.13327555358409882
[36/100] loss: 1.0010277032852173 loss_joints: 0.9692100286483765 loss_collision: 0.11449123173952103 loss_jerk: 0.06962940841913223 loss_floor_contact: 0.13405665755271912
[37/100] loss: 0.9778850078582764 loss_joints: 0.9462666511535645 loss_collision: 0.11604895442724228 loss_jerk: 0.07009763270616531 loss_floor_contact: 0.13003692030906677
[38/100] loss: 0.9552157521247864 loss_joints: 0.9231624007225037 loss_collision: 0.11834326386451721 loss_jerk: 0.07025856524705887 loss_floor_contact: 0.13193190097808838
[39/100] loss: 0.931104838848114 loss_joints: 0.8987252116203308 loss_collision: 0.12084115296602249 loss_jerk: 0.07101362198591232 loss_floor_contact: 0.13194136321544647
[40/100] loss: 0.908642053604126 loss_joints: 0.8743645548820496 loss_collision: 0.13162179291248322 loss_jerk: 0.08108195662498474 loss_floor_contact: 0.13007090985774994
[41/100] loss: 0.888338029384613 loss_joints: 0.852974534034729 loss_collision: 0.13437393307685852 loss_jerk: 0.08910372108221054 loss_floor_contact: 0.13015729188919067
[42/100] loss: 0.868979275226593 loss_joints: 0.8332924842834473 loss_collision: 0.13456711173057556 loss_jerk: 0.09177812188863754 loss_floor_contact: 0.13052311539649963
[43/100] loss: 0.8474801182746887 loss_joints: 0.8111051321029663 loss_collision: 0.13945959508419037 loss_jerk: 0.09326646476984024 loss_floor_contact: 0.13102440536022186
[44/100] loss: 0.8264825940132141 loss_joints: 0.7895175814628601 loss_collision: 0.14682146906852722 loss_jerk: 0.09126564115285873 loss_floor_contact: 0.13156287372112274
[45/100] loss: 0.8062393069267273 loss_joints: 0.7703129649162292 loss_collision: 0.1381843537092209 loss_jerk: 0.08891014754772186 loss_floor_contact: 0.13216900825500488
[46/100] loss: 0.7846509218215942 loss_joints: 0.749729335308075 loss_collision: 0.1256837099790573 loss_jerk: 0.09073750674724579 loss_floor_contact: 0.13279475271701813
[47/100] loss: 0.7634705901145935 loss_joints: 0.7277400493621826 loss_collision: 0.12850067019462585 loss_jerk: 0.09532985091209412 loss_floor_contact: 0.13347505033016205
[48/100] loss: 0.7425512671470642 loss_joints: 0.7065552473068237 loss_collision: 0.12715692818164825 loss_jerk: 0.09921348094940186 loss_floor_contact: 0.13358962535858154
[49/100] loss: 0.7206838726997375 loss_joints: 0.6863397359848022 loss_collision: 0.10914993286132812 loss_jerk: 0.10069096833467484 loss_floor_contact: 0.13360066711902618
[50/100] loss: 0.6988801956176758 loss_joints: 0.6659768223762512 loss_collision: 0.09281983226537704 loss_jerk: 0.10137461125850677 loss_floor_contact: 0.1348395198583603
[51/100] loss: 0.678849995136261 loss_joints: 0.6467866897583008 loss_collision: 0.08466552942991257 loss_jerk: 0.10063879191875458 loss_floor_contact: 0.13532905280590057
[52/100] loss: 0.6590932011604309 loss_joints: 0.6282739639282227 loss_collision: 0.0738128125667572 loss_jerk: 0.0995836928486824 loss_floor_contact: 0.1347959041595459
[53/100] loss: 0.6391730904579163 loss_joints: 0.6091904640197754 loss_collision: 0.06403763592243195 loss_jerk: 0.10020578652620316 loss_floor_contact: 0.13558323681354523
[54/100] loss: 0.6194760203361511 loss_joints: 0.589417576789856 loss_collision: 0.06244652718305588 loss_jerk: 0.10261769592761993 loss_floor_contact: 0.13552027940750122
[55/100] loss: 0.6022832989692688 loss_joints: 0.5699459910392761 loss_collision: 0.07909151166677475 loss_jerk: 0.10517627000808716 loss_floor_contact: 0.1391046792268753
[56/100] loss: 0.5854687094688416 loss_joints: 0.551759660243988 loss_collision: 0.0878230482339859 loss_jerk: 0.10705378651618958 loss_floor_contact: 0.14221355319023132
[57/100] loss: 0.5683037638664246 loss_joints: 0.5342575311660767 loss_collision: 0.0853499248623848 loss_jerk: 0.10792859643697739 loss_floor_contact: 0.1471838653087616
[58/100] loss: 0.5510194301605225 loss_joints: 0.5180447101593018 loss_collision: 0.07372616231441498 loss_jerk: 0.10692134499549866 loss_floor_contact: 0.14910003542900085
[59/100] loss: 0.5343013405799866 loss_joints: 0.502875804901123 loss_collision: 0.05951644852757454 loss_jerk: 0.10557515174150467 loss_floor_contact: 0.14916381239891052
[60/100] loss: 0.518553614616394 loss_joints: 0.48726969957351685 loss_collision: 0.05629922077059746 loss_jerk: 0.10638829320669174 loss_floor_contact: 0.15015166997909546
[61/100] loss: 0.5033872723579407 loss_joints: 0.471377432346344 loss_collision: 0.060611527413129807 loss_jerk: 0.10893083363771439 loss_floor_contact: 0.15055623650550842
[62/100] loss: 0.48856884241104126 loss_joints: 0.45604366064071655 loss_collision: 0.06307860463857651 loss_jerk: 0.11135907471179962 loss_floor_contact: 0.150814026594162
[63/100] loss: 0.4740111231803894 loss_joints: 0.44133421778678894 loss_collision: 0.06438904255628586 loss_jerk: 0.11232849210500717 loss_floor_contact: 0.15005135536193848
[64/100] loss: 0.45950621366500854 loss_joints: 0.42696380615234375 loss_collision: 0.0625753179192543 loss_jerk: 0.11241395771503448 loss_floor_contact: 0.15043458342552185
[65/100] loss: 0.44487297534942627 loss_joints: 0.4130210876464844 loss_collision: 0.05485644191503525 loss_jerk: 0.11184637993574142 loss_floor_contact: 0.15181592106819153
[66/100] loss: 0.4304412007331848 loss_joints: 0.39951038360595703 loss_collision: 0.04632192105054855 loss_jerk: 0.11088776588439941 loss_floor_contact: 0.15209834277629852
[67/100] loss: 0.416931688785553 loss_joints: 0.38643479347229004 loss_collision: 0.043515440076589584 loss_jerk: 0.1096927747130394 loss_floor_contact: 0.15176057815551758
[68/100] loss: 0.40477317571640015 loss_joints: 0.37365397810935974 loss_collision: 0.049517687410116196 loss_jerk: 0.10877420008182526 loss_floor_contact: 0.15289998054504395
[69/100] loss: 0.3924848437309265 loss_joints: 0.3611047863960266 loss_collision: 0.05115588381886482 loss_jerk: 0.10841310769319534 loss_floor_contact: 0.1542315036058426
[70/100] loss: 0.3805478811264038 loss_joints: 0.34889423847198486 loss_collision: 0.0532183013856411 loss_jerk: 0.1090487465262413 loss_floor_contact: 0.15426933765411377
[71/100] loss: 0.368458092212677 loss_joints: 0.3370668292045593 loss_collision: 0.050433170050382614 loss_jerk: 0.11014258861541748 loss_floor_contact: 0.15333692729473114
[72/100] loss: 0.3571186661720276 loss_joints: 0.3257753849029541 loss_collision: 0.048912305384874344 loss_jerk: 0.11141914874315262 loss_floor_contact: 0.15310153365135193
[73/100] loss: 0.34569594264030457 loss_joints: 0.3151547908782959 loss_collision: 0.039147183299064636 loss_jerk: 0.11252406984567642 loss_floor_contact: 0.15374021232128143
[74/100] loss: 0.33591359853744507 loss_joints: 0.3052019774913788 loss_collision: 0.03903396800160408 loss_jerk: 0.11336497217416763 loss_floor_contact: 0.15471738576889038
[75/100] loss: 0.326631635427475 loss_joints: 0.29581549763679504 loss_collision: 0.03874175250530243 loss_jerk: 0.11369998753070831 loss_floor_contact: 0.15571938455104828
[76/100] loss: 0.31780776381492615 loss_joints: 0.2869664430618286 loss_collision: 0.03829474747180939 loss_jerk: 0.11382359266281128 loss_floor_contact: 0.156294584274292
[77/100] loss: 0.3095243573188782 loss_joints: 0.2786470055580139 loss_collision: 0.03923223912715912 loss_jerk: 0.11380589008331299 loss_floor_contact: 0.15573540329933167
[78/100] loss: 0.302016019821167 loss_joints: 0.27088069915771484 loss_collision: 0.0419100746512413 loss_jerk: 0.11353157460689545 loss_floor_contact: 0.1559114009141922
[79/100] loss: 0.2946799099445343 loss_joints: 0.26354461908340454 loss_collision: 0.04128413647413254 loss_jerk: 0.1135181114077568 loss_floor_contact: 0.15655040740966797
[80/100] loss: 0.28789955377578735 loss_joints: 0.2565785050392151 loss_collision: 0.042128559201955795 loss_jerk: 0.11376015096902847 loss_floor_contact: 0.15732166171073914
[81/100] loss: 0.281260222196579 loss_joints: 0.2499772012233734 loss_collision: 0.04050435870885849 loss_jerk: 0.1142682284116745 loss_floor_contact: 0.15805739164352417
[82/100] loss: 0.27473506331443787 loss_joints: 0.2437753677368164 loss_collision: 0.03676670789718628 loss_jerk: 0.11493660509586334 loss_floor_contact: 0.15789371728897095
[83/100] loss: 0.26888105273246765 loss_joints: 0.23799967765808105 loss_collision: 0.03678537532687187 loss_jerk: 0.11544639617204666 loss_floor_contact: 0.15658211708068848
[84/100] loss: 0.26381057500839233 loss_joints: 0.2326372116804123 loss_collision: 0.04053486883640289 loss_jerk: 0.11570511013269424 loss_floor_contact: 0.1554936021566391
[85/100] loss: 0.25873836874961853 loss_joints: 0.22766637802124023 loss_collision: 0.04012921079993248 loss_jerk: 0.11576560884714127 loss_floor_contact: 0.15482497215270996
[86/100] loss: 0.2539426386356354 loss_joints: 0.22306494414806366 loss_collision: 0.03866725414991379 loss_jerk: 0.1157156378030777 loss_floor_contact: 0.15439391136169434
[87/100] loss: 0.249716117978096 loss_joints: 0.21882906556129456 loss_collision: 0.039137765765190125 loss_jerk: 0.11559233069419861 loss_floor_contact: 0.154140442609787
[88/100] loss: 0.24578705430030823 loss_joints: 0.21495942771434784 loss_collision: 0.03882388025522232 loss_jerk: 0.11542188376188278 loss_floor_contact: 0.15403051674365997
[89/100] loss: 0.2420390397310257 loss_joints: 0.2114204615354538 loss_collision: 0.036923427134752274 loss_jerk: 0.11524856835603714 loss_floor_contact: 0.1540137380361557
[90/100] loss: 0.23864200711250305 loss_joints: 0.2081921547651291 loss_collision: 0.03533383831381798 loss_jerk: 0.11515697836875916 loss_floor_contact: 0.15400777757167816
[91/100] loss: 0.23553135991096497 loss_joints: 0.20526793599128723 loss_collision: 0.03351910784840584 loss_jerk: 0.11514110118150711 loss_floor_contact: 0.1539740264415741
[92/100] loss: 0.23278382420539856 loss_joints: 0.2026602029800415 loss_collision: 0.032856229692697525 loss_jerk: 0.11513522267341614 loss_floor_contact: 0.15324492752552032
[93/100] loss: 0.23063619434833527 loss_joints: 0.20035776495933533 loss_collision: 0.035121817141771317 loss_jerk: 0.11509229242801666 loss_floor_contact: 0.1525701880455017
[94/100] loss: 0.2284192442893982 loss_joints: 0.1983530968427658 loss_collision: 0.033603012561798096 loss_jerk: 0.11502517759799957 loss_floor_contact: 0.152033269405365
[95/100] loss: 0.22674810886383057 loss_joints: 0.1966347098350525 loss_collision: 0.03454821556806564 loss_jerk: 0.11496083438396454 loss_floor_contact: 0.15162499248981476
[96/100] loss: 0.22524482011795044 loss_joints: 0.19520032405853271 loss_collision: 0.0342317596077919 loss_jerk: 0.11488604545593262 loss_floor_contact: 0.15132728219032288
[97/100] loss: 0.22399958968162537 loss_joints: 0.19405309855937958 loss_collision: 0.03353060409426689 loss_jerk: 0.11481384187936783 loss_floor_contact: 0.15112042427062988
[98/100] loss: 0.22328750789165497 loss_joints: 0.1931931972503662 loss_collision: 0.03521197661757469 loss_jerk: 0.11474136263132095 loss_floor_contact: 0.15098974108695984
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-7.png]
[99/100] loss: 0.2227550745010376 loss_joints: 0.19261810183525085 loss_collision: 0.035769738256931305 loss_jerk: 0.11468175798654556 loss_floor_contact: 0.1509181559085846
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path2-run6-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 263.59039                                                    ║
    ║     rollout = 117.75421                                                    ║
    ║     sdf     = 24.35210                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.22275507                                                 ║
    ║     joints    = 0.19261810                                                 ║
    ║     collision = 0.03576974                                                 ║
    ║     jerk      = 0.11468176                                                 ║
    ║     floor     = 0.15091816                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	4m44.845s
user	4m8.401s
sys	0m15.760s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x616c04435c00] using SAR=1/1
[libx264 @ 0x616c04435c00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x616c04435c00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x616c04435c00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_run_6.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x616c04433fc0] video:212kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.537669%
frame=   25 fps=0.0 q=-1.0 Lsize=     213kB time=00:00:02.20 bitrate= 794.9kbits/s speed=3.15x    
[libx264 @ 0x616c04435c00] frame I:1     Avg QP:19.12  size: 68057
[libx264 @ 0x616c04435c00] frame P:8     Avg QP:20.67  size: 13465
[libx264 @ 0x616c04435c00] frame B:16    Avg QP:22.30  size:  2559
[libx264 @ 0x616c04435c00] consecutive B-frames: 12.0%  8.0%  0.0% 80.0%
[libx264 @ 0x616c04435c00] mb I  I16..4:  3.3% 68.4% 28.3%
[libx264 @ 0x616c04435c00] mb P  I16..4:  0.2%  2.0%  2.0%  P16..4:  9.6%  3.4%  2.1%  0.0%  0.0%    skip:80.7%
[libx264 @ 0x616c04435c00] mb B  I16..4:  0.1%  0.4%  0.1%  B16..8: 11.8%  1.6%  0.6%  direct: 1.5%  skip:83.9%  L0:38.2% L1:56.3% BI: 5.6%
[libx264 @ 0x616c04435c00] 8x8 transform intra:63.8% inter:57.6%
[libx264 @ 0x616c04435c00] coded y,uvDC,uvAC intra: 31.7% 20.4% 19.5% inter: 4.2% 4.6% 1.8%
[libx264 @ 0x616c04435c00] i16 v,h,dc,p: 48% 31% 21%  0%
[libx264 @ 0x616c04435c00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 51%  9% 33%  1%  1%  2%  1%  2%  1%
[libx264 @ 0x616c04435c00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 35% 24% 14%  4%  4%  4%  3%  8%  3%
[libx264 @ 0x616c04435c00] i8c dc,h,v,p: 89%  2%  7%  3%
[libx264 @ 0x616c04435c00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x616c04435c00] ref P L0: 65.0%  9.4% 17.4%  8.2%
[libx264 @ 0x616c04435c00] ref B L0: 68.0% 29.7%  2.3%
[libx264 @ 0x616c04435c00] ref B L1: 89.4% 10.6%
[libx264 @ 0x616c04435c00] kb/s:693.54
[INFO] Video saved as 'bin/result/optim_run_6.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:13<23:01, 13.95s/it]  2%|▏         | 2/100 [00:18<14:08,  8.66s/it]  3%|▎         | 3/100 [00:24<11:47,  7.30s/it]  4%|▍         | 4/100 [00:29<10:05,  6.31s/it]  5%|▌         | 5/100 [00:34<09:19,  5.89s/it]  6%|▌         | 6/100 [00:39<08:44,  5.57s/it]  7%|▋         | 7/100 [00:44<08:12,  5.29s/it]  8%|▊         | 8/100 [00:49<07:55,  5.17s/it]  9%|▉         | 9/100 [00:53<07:39,  5.05s/it] 10%|█         | 10/100 [00:58<07:30,  5.00s/it] 11%|█         | 11/100 [01:03<07:15,  4.90s/it] 12%|█▏        | 12/100 [01:08<07:12,  4.91s/it] 13%|█▎        | 13/100 [01:13<07:18,  5.04s/it] 14%|█▍        | 14/100 [01:18<07:10,  5.00s/it] 15%|█▌        | 15/100 [01:23<06:58,  4.93s/it] 16%|█▌        | 16/100 [01:28<06:46,  4.84s/it] 17%|█▋        | 17/100 [01:32<06:36,  4.77s/it] 18%|█▊        | 18/100 [01:37<06:32,  4.79s/it] 19%|█▉        | 19/100 [01:42<06:22,  4.73s/it] 20%|██        | 20/100 [01:47<06:28,  4.86s/it] 21%|██        | 21/100 [01:52<06:35,  5.00s/it] 22%|██▏       | 22/100 [01:57<06:35,  5.07s/it] 23%|██▎       | 23/100 [02:02<06:32,  5.09s/it] 24%|██▍       | 24/100 [02:08<06:27,  5.10s/it] 25%|██▌       | 25/100 [02:13<06:20,  5.07s/it] 26%|██▌       | 26/100 [02:18<06:24,  5.20s/it] 27%|██▋       | 27/100 [02:23<06:18,  5.19s/it] 28%|██▊       | 28/100 [02:28<06:10,  5.15s/it] 29%|██▉       | 29/100 [02:33<06:06,  5.16s/it] 30%|███       | 30/100 [02:38<05:57,  5.11s/it] 31%|███       | 31/100 [02:44<05:53,  5.12s/it] 32%|███▏      | 32/100 [02:49<05:44,  5.06s/it] 33%|███▎      | 33/100 [02:53<05:35,  5.01s/it] 34%|███▍      | 34/100 [02:59<05:35,  5.08s/it] 35%|███▌      | 35/100 [03:03<05:23,  4.97s/it] 36%|███▌      | 36/100 [03:09<05:26,  5.11s/it] 37%|███▋      | 37/100 [03:14<05:25,  5.16s/it] 38%|███▊      | 38/100 [03:19<05:21,  5.19s/it] 39%|███▉      | 39/100 [03:25<05:17,  5.20s/it] 40%|████      | 40/100 [03:30<05:09,  5.17s/it] 41%|████      | 41/100 [03:35<05:10,  5.26s/it] 42%|████▏     | 42/100 [03:40<05:00,  5.19s/it] 43%|████▎     | 43/100 [03:45<04:56,  5.20s/it] 44%|████▍     | 44/100 [03:50<04:46,  5.12s/it] 45%|████▌     | 45/100 [03:55<04:38,  5.07s/it] 46%|████▌     | 46/100 [04:00<04:33,  5.07s/it] 47%|████▋     | 47/100 [04:05<04:29,  5.09s/it] 48%|████▊     | 48/100 [04:11<04:27,  5.14s/it] 49%|████▉     | 49/100 [04:16<04:24,  5.18s/it] 50%|█████     | 50/100 [04:21<04:19,  5.18s/it] 51%|█████     | 51/100 [04:26<04:14,  5.19s/it] 52%|█████▏    | 52/100 [04:32<04:10,  5.23s/it] 53%|█████▎    | 53/100 [04:37<04:03,  5.18s/it] 54%|█████▍    | 54/100 [04:42<03:56,  5.13s/it] 55%|█████▌    | 55/100 [04:47<03:51,  5.15s/it] 56%|█████▌    | 56/100 [04:52<03:42,  5.06s/it] 57%|█████▋    | 57/100 [04:57<03:41,  5.16s/it] 58%|█████▊    | 58/100 [05:02<03:34,  5.10s/it] 59%|█████▉    | 59/100 [05:08<03:32,  5.19s/it] 60%|██████    | 60/100 [05:13<03:28,  5.20s/it] 61%|██████    | 61/100 [05:18<03:19,  5.11s/it] 62%|██████▏   | 62/100 [05:23<03:13,  5.09s/it] 63%|██████▎   | 63/100 [05:28<03:05,  5.01s/it] 64%|██████▍   | 64/100 [05:33<02:59,  4.99s/it] 65%|██████▌   | 65/100 [05:38<02:55,  5.00s/it] 66%|██████▌   | 66/100 [05:42<02:48,  4.96s/it] 67%|██████▋   | 67/100 [05:47<02:44,  4.99s/it] 68%|██████▊   | 68/100 [05:53<02:40,  5.03s/it] 69%|██████▉   | 69/100 [05:58<02:37,  5.08s/it] 70%|███████   | 70/100 [06:02<02:28,  4.96s/it] 71%|███████   | 71/100 [06:07<02:24,  4.97s/it] 72%|███████▏  | 72/100 [06:12<02:17,  4.90s/it] 73%|███████▎  | 73/100 [06:17<02:11,  4.89s/it] 74%|███████▍  | 74/100 [06:22<02:08,  4.95s/it] 75%|███████▌  | 75/100 [06:27<02:02,  4.91s/it] 76%|███████▌  | 76/100 [06:32<01:58,  4.92s/it] 77%|███████▋  | 77/100 [06:37<01:54,  4.99s/it] 78%|███████▊  | 78/100 [06:42<01:48,  4.93s/it] 79%|███████▉  | 79/100 [06:47<01:42,  4.88s/it] 80%|████████  | 80/100 [06:51<01:37,  4.87s/it] 81%|████████  | 81/100 [06:57<01:33,  4.94s/it] 82%|████████▏ | 82/100 [07:02<01:29,  5.00s/it] 83%|████████▎ | 83/100 [07:07<01:26,  5.09s/it] 84%|████████▍ | 84/100 [07:12<01:22,  5.15s/it] 85%|████████▌ | 85/100 [07:18<01:17,  5.17s/it] 86%|████████▌ | 86/100 [07:23<01:12,  5.15s/it] 87%|████████▋ | 87/100 [07:28<01:07,  5.18s/it] 88%|████████▊ | 88/100 [07:33<01:01,  5.13s/it] 89%|████████▉ | 89/100 [07:38<00:55,  5.09s/it] 90%|█████████ | 90/100 [07:43<00:50,  5.07s/it] 91%|█████████ | 91/100 [07:48<00:45,  5.03s/it] 92%|█████████▏| 92/100 [07:53<00:39,  4.99s/it] 93%|█████████▎| 93/100 [07:58<00:34,  4.95s/it] 94%|█████████▍| 94/100 [08:02<00:29,  4.89s/it] 95%|█████████▌| 95/100 [08:08<00:24,  4.98s/it] 96%|█████████▌| 96/100 [08:13<00:20,  5.11s/it] 97%|█████████▋| 97/100 [08:18<00:15,  5.23s/it] 98%|█████████▊| 98/100 [08:24<00:10,  5.26s/it] 99%|█████████▉| 99/100 [08:29<00:05,  5.19s/it]100%|██████████| 100/100 [08:44<00:00,  8.07s/it]100%|██████████| 100/100 [08:44<00:00,  5.24s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-13.png]
[0/100] loss: 3.939148187637329 loss_joints: 3.7257649898529053 loss_collision: 0.09987177699804306 loss_jerk: 0.08841601014137268 loss_floor_contact: 1.945544958114624
[1/100] loss: 3.874022960662842 loss_joints: 3.653320074081421 loss_collision: 0.10910248011350632 loss_jerk: 0.09657306969165802 loss_floor_contact: 2.0013527870178223
[2/100] loss: 3.6557931900024414 loss_joints: 3.4432268142700195 loss_collision: 0.10610868781805038 loss_jerk: 0.1010299101471901 loss_floor_contact: 1.9185255765914917
[3/100] loss: 3.324697256088257 loss_joints: 3.1214852333068848 loss_collision: 0.10376082360744476 loss_jerk: 0.0940072312951088 loss_floor_contact: 1.834354043006897
[4/100] loss: 3.2285103797912598 loss_joints: 3.029691696166992 loss_collision: 0.1164349764585495 loss_jerk: 0.08637374639511108 loss_floor_contact: 1.7853772640228271
[5/100] loss: 3.156466245651245 loss_joints: 2.963845729827881 loss_collision: 0.12087947130203247 loss_jerk: 0.09001123160123825 loss_floor_contact: 1.7153147459030151
[6/100] loss: 3.094961166381836 loss_joints: 2.904611349105835 loss_collision: 0.12756787240505219 loss_jerk: 0.08669112622737885 loss_floor_contact: 1.6892391443252563
[7/100] loss: 3.007359504699707 loss_joints: 2.8243703842163086 loss_collision: 0.13815779983997345 loss_jerk: 0.07083018869161606 loss_floor_contact: 1.6209025382995605
[8/100] loss: 2.896869421005249 loss_joints: 2.7228994369506836 loss_collision: 0.13267068564891815 loss_jerk: 0.07340776920318604 loss_floor_contact: 1.5336220264434814
[9/100] loss: 2.7285172939300537 loss_joints: 2.563307762145996 loss_collision: 0.1395215541124344 loss_jerk: 0.07783396542072296 loss_floor_contact: 1.4347387552261353
[10/100] loss: 2.531336545944214 loss_joints: 2.3753747940063477 loss_collision: 0.14842712879180908 loss_jerk: 0.06928441673517227 loss_floor_contact: 1.3419058322906494
[11/100] loss: 2.4352922439575195 loss_joints: 2.2880442142486572 loss_collision: 0.14768102765083313 loss_jerk: 0.06815753877162933 loss_floor_contact: 1.256643533706665
[12/100] loss: 2.3083677291870117 loss_joints: 2.1698379516601562 loss_collision: 0.14988775551319122 loss_jerk: 0.06720075756311417 loss_floor_contact: 1.168209433555603
[13/100] loss: 2.1553986072540283 loss_joints: 2.028628349304199 loss_collision: 0.1325220763683319 loss_jerk: 0.06478462368249893 loss_floor_contact: 1.0703935623168945
[14/100] loss: 2.038397789001465 loss_joints: 1.92178475856781 loss_collision: 0.11122077703475952 loss_jerk: 0.06574196368455887 loss_floor_contact: 0.9891674518585205
[15/100] loss: 1.943658471107483 loss_joints: 1.8352718353271484 loss_collision: 0.10831751674413681 loss_jerk: 0.06779374182224274 loss_floor_contact: 0.9077547192573547
[16/100] loss: 1.8638216257095337 loss_joints: 1.7626821994781494 loss_collision: 0.10923837870359421 loss_jerk: 0.06693801283836365 loss_floor_contact: 0.8352168202400208
[17/100] loss: 1.8125566244125366 loss_joints: 1.718923568725586 loss_collision: 0.10425514727830887 loss_jerk: 0.06656979024410248 loss_floor_contact: 0.7655050158500671
[18/100] loss: 1.6831889152526855 loss_joints: 1.6051502227783203 loss_collision: 0.040415048599243164 loss_jerk: 0.05510619655251503 loss_floor_contact: 0.6848657131195068
[19/100] loss: 1.8195568323135376 loss_joints: 1.7399848699569702 loss_collision: 0.024708455428481102 loss_jerk: 0.058109790086746216 loss_floor_contact: 0.7129010558128357
[20/100] loss: 1.77614164352417 loss_joints: 1.6999424695968628 loss_collision: 0.021917786449193954 loss_jerk: 0.06060973182320595 loss_floor_contact: 0.6794649362564087
[21/100] loss: 1.6433031558990479 loss_joints: 1.5739049911499023 loss_collision: 0.020919183269143105 loss_jerk: 0.05183961242437363 loss_floor_contact: 0.6212236881256104
[22/100] loss: 1.6052953004837036 loss_joints: 1.538827896118164 loss_collision: 0.015968408435583115 loss_jerk: 0.080011285841465 loss_floor_contact: 0.5686945915222168
[23/100] loss: 1.399319052696228 loss_joints: 1.3409889936447144 loss_collision: 0.01656945049762726 loss_jerk: 0.0700884684920311 loss_floor_contact: 0.4966432452201843
[24/100] loss: 1.3816395998001099 loss_joints: 1.3296974897384644 loss_collision: 0.028137732297182083 loss_jerk: 0.05622547119855881 loss_floor_contact: 0.4350575804710388
[25/100] loss: 1.3740997314453125 loss_joints: 1.3225157260894775 loss_collision: 0.03481988236308098 loss_jerk: 0.0652165338397026 loss_floor_contact: 0.415803462266922
[26/100] loss: 1.3262674808502197 loss_joints: 1.2777109146118164 loss_collision: 0.03793828561902046 loss_jerk: 0.0669766440987587 loss_floor_contact: 0.38065043091773987
[27/100] loss: 1.2562990188598633 loss_joints: 1.2106353044509888 loss_collision: 0.04835139214992523 loss_jerk: 0.06812946498394012 loss_floor_contact: 0.3401569426059723
[28/100] loss: 1.19227135181427 loss_joints: 1.1466513872146606 loss_collision: 0.06254664808511734 loss_jerk: 0.07122277468442917 loss_floor_contact: 0.3224296569824219
[29/100] loss: 1.1527000665664673 loss_joints: 1.1059679985046387 loss_collision: 0.07780511677265167 loss_jerk: 0.06576584279537201 loss_floor_contact: 0.32374992966651917
[30/100] loss: 1.1605006456375122 loss_joints: 1.106130838394165 loss_collision: 0.08752728998661041 loss_jerk: 0.07583394646644592 loss_floor_contact: 0.3803376257419586
[31/100] loss: 1.0893054008483887 loss_joints: 1.0357555150985718 loss_collision: 0.09290347993373871 loss_jerk: 0.0745176449418068 loss_floor_contact: 0.36807820200920105
[32/100] loss: 1.2329630851745605 loss_joints: 1.1763441562652588 loss_collision: 0.10009659081697464 loss_jerk: 0.09663359075784683 loss_floor_contact: 0.3694591522216797
[33/100] loss: 1.094866394996643 loss_joints: 1.0507926940917969 loss_collision: 0.08994600176811218 loss_jerk: 0.05706029757857323 loss_floor_contact: 0.29373103380203247
[34/100] loss: 1.0510859489440918 loss_joints: 1.0137499570846558 loss_collision: 0.07698654383420944 loss_jerk: 0.05618198215961456 loss_floor_contact: 0.24019171297550201
[35/100] loss: 1.0241141319274902 loss_joints: 0.9885660409927368 loss_collision: 0.07272655516862869 loss_jerk: 0.05541328713297844 loss_floor_contact: 0.2273406833410263
[36/100] loss: 0.9337260723114014 loss_joints: 0.897945761680603 loss_collision: 0.07231411337852478 loss_jerk: 0.05384374037384987 loss_floor_contact: 0.2316451221704483
[37/100] loss: 0.7692364454269409 loss_joints: 0.7355877757072449 loss_collision: 0.07569369673728943 loss_jerk: 0.05654977262020111 loss_floor_contact: 0.20424313843250275
[38/100] loss: 0.6356697082519531 loss_joints: 0.6030659675598145 loss_collision: 0.08261661976575851 loss_jerk: 0.06422211229801178 loss_floor_contact: 0.1791984587907791
[39/100] loss: 0.5394569039344788 loss_joints: 0.5056114792823792 loss_collision: 0.09307584166526794 loss_jerk: 0.07501798868179321 loss_floor_contact: 0.17036060988903046
[40/100] loss: 0.45614874362945557 loss_joints: 0.4192517399787903 loss_collision: 0.10057248920202255 loss_jerk: 0.07464978843927383 loss_floor_contact: 0.19374802708625793
[41/100] loss: 0.20211906731128693 loss_joints: 0.16014766693115234 loss_collision: 0.12034488469362259 loss_jerk: 0.11346685886383057 loss_floor_contact: 0.18590226769447327
[42/100] loss: 0.686301589012146 loss_joints: 0.6294366121292114 loss_collision: 0.11614497005939484 loss_jerk: 0.11808240413665771 loss_floor_contact: 0.33442240953445435
[43/100] loss: 0.715676486492157 loss_joints: 0.6594473123550415 loss_collision: 0.12277466058731079 loss_jerk: 0.10940774530172348 loss_floor_contact: 0.33010897040367126
[44/100] loss: 0.6972805261611938 loss_joints: 0.6420416235923767 loss_collision: 0.12088815867900848 loss_jerk: 0.10603827238082886 loss_floor_contact: 0.3254621922969818
[45/100] loss: 0.6321969032287598 loss_joints: 0.5783113241195679 loss_collision: 0.11901991069316864 loss_jerk: 0.11136828362941742 loss_floor_contact: 0.3084675967693329
[46/100] loss: 0.5257982611656189 loss_joints: 0.47403329610824585 loss_collision: 0.11076971888542175 loss_jerk: 0.12031856924295425 loss_floor_contact: 0.28656116127967834
[47/100] loss: 0.30985185503959656 loss_joints: 0.2670345604419708 loss_collision: 0.11917398124933243 loss_jerk: 0.08290522545576096 loss_floor_contact: 0.22609342634677887
[48/100] loss: 0.0641060397028923 loss_joints: 0.01675594225525856 loss_collision: 0.2195109724998474 loss_jerk: 0.12097502499818802 loss_floor_contact: 0.13301494717597961
[49/100] loss: 0.15091712772846222 loss_joints: 0.10999840497970581 loss_collision: 0.1340615451335907 loss_jerk: 0.11998628079891205 loss_floor_contact: 0.15513943135738373
[50/100] loss: 0.1397678703069687 loss_joints: 0.10095234960317612 loss_collision: 0.17376063764095306 loss_jerk: 0.08377670496702194 loss_floor_contact: 0.1306179016828537
[51/100] loss: 0.12667761743068695 loss_joints: 0.08624257147312164 loss_collision: 0.1981886476278305 loss_jerk: 0.08724429458379745 loss_floor_contact: 0.1189175620675087
[52/100] loss: 0.1108539029955864 loss_joints: 0.06841503083705902 loss_collision: 0.22267170250415802 loss_jerk: 0.0872240662574768 loss_floor_contact: 0.11449294537305832
[53/100] loss: 0.09358512610197067 loss_joints: 0.0477290004491806 loss_collision: 0.26120391488075256 loss_jerk: 0.08354311436414719 loss_floor_contact: 0.11381417512893677
[54/100] loss: 0.07250519841909409 loss_joints: 0.01862732321023941 loss_collision: 0.3072967231273651 loss_jerk: 0.11619395017623901 loss_floor_contact: 0.11528805643320084
[55/100] loss: 0.0654202476143837 loss_joints: 0.009105024859309196 loss_collision: 0.33669495582580566 loss_jerk: 0.11333531141281128 loss_floor_contact: 0.11312195658683777
[56/100] loss: 0.07599818706512451 loss_joints: 0.02389778196811676 loss_collision: 0.29755619168281555 loss_jerk: 0.11043617129325867 loss_floor_contact: 0.1130116879940033
[57/100] loss: 0.0788642093539238 loss_joints: 0.027774620801210403 loss_collision: 0.28955328464508057 loss_jerk: 0.11099418252706528 loss_floor_contact: 0.11034835875034332
[58/100] loss: 0.07245036959648132 loss_joints: 0.024042226374149323 loss_collision: 0.27558743953704834 loss_jerk: 0.10312504321336746 loss_floor_contact: 0.10536891967058182
[59/100] loss: 0.05980101600289345 loss_joints: 0.014559296891093254 loss_collision: 0.2528235912322998 loss_jerk: 0.08905331790447235 loss_floor_contact: 0.11054026335477829
[60/100] loss: 0.05558100342750549 loss_joints: 0.015188525430858135 loss_collision: 0.21835650503635406 loss_jerk: 0.0824941024184227 loss_floor_contact: 0.10307417064905167
[61/100] loss: 0.05205418914556503 loss_joints: 0.01360047422349453 loss_collision: 0.20345477759838104 loss_jerk: 0.07936070114374161 loss_floor_contact: 0.10172167420387268
[62/100] loss: 0.049171801656484604 loss_joints: 0.012483656406402588 loss_collision: 0.18484477698802948 loss_jerk: 0.08415022492408752 loss_floor_contact: 0.09788643568754196
[63/100] loss: 0.04682031646370888 loss_joints: 0.010925758630037308 loss_collision: 0.176815927028656 loss_jerk: 0.08490319550037384 loss_floor_contact: 0.09722647070884705
[64/100] loss: 0.04363490641117096 loss_joints: 0.00851211603730917 loss_collision: 0.1713186651468277 loss_jerk: 0.08236458897590637 loss_floor_contact: 0.09754464030265808
[65/100] loss: 0.039893738925457 loss_joints: 0.006014587357640266 loss_collision: 0.16375350952148438 loss_jerk: 0.07698393613100052 loss_floor_contact: 0.09805404394865036
[66/100] loss: 0.03663267567753792 loss_joints: 0.00397764565423131 loss_collision: 0.15104378759860992 loss_jerk: 0.07537784427404404 loss_floor_contact: 0.100128673017025
[67/100] loss: 0.0357150100171566 loss_joints: 0.003240731079131365 loss_collision: 0.14330555498600006 loss_jerk: 0.07702606916427612 loss_floor_contact: 0.10441114008426666
[68/100] loss: 0.03847469761967659 loss_joints: 0.004954848904162645 loss_collision: 0.1420256644487381 loss_jerk: 0.08250745385885239 loss_floor_contact: 0.11066537350416183
[69/100] loss: 0.038574784994125366 loss_joints: 0.005634667351841927 loss_collision: 0.13363945484161377 loss_jerk: 0.08502764999866486 loss_floor_contact: 0.11073408275842667
[70/100] loss: 0.03438473492860794 loss_joints: 0.004127540625631809 loss_collision: 0.11875982582569122 loss_jerk: 0.07731875777244568 loss_floor_contact: 0.10649337619543076
[71/100] loss: 0.0322234183549881 loss_joints: 0.003219079691916704 loss_collision: 0.11559411883354187 loss_jerk: 0.07521475106477737 loss_floor_contact: 0.09923452883958817
[72/100] loss: 0.03140204772353172 loss_joints: 0.0034749116748571396 loss_collision: 0.10711318254470825 loss_jerk: 0.07338659465312958 loss_floor_contact: 0.0987715870141983
[73/100] loss: 0.03113234043121338 loss_joints: 0.003741300432011485 loss_collision: 0.1034560576081276 loss_jerk: 0.07215628027915955 loss_floor_contact: 0.0982980728149414
[74/100] loss: 0.03070799633860588 loss_joints: 0.003755585988983512 loss_collision: 0.10064513981342316 loss_jerk: 0.07169025391340256 loss_floor_contact: 0.09718870371580124
[75/100] loss: 0.02975057251751423 loss_joints: 0.003662279574200511 loss_collision: 0.09378340095281601 loss_jerk: 0.0717710331082344 loss_floor_contact: 0.09532848000526428
[76/100] loss: 0.02878795750439167 loss_joints: 0.0035151250194758177 loss_collision: 0.08474766463041306 loss_jerk: 0.07149732112884521 loss_floor_contact: 0.09648334234952927
[77/100] loss: 0.02804868295788765 loss_joints: 0.0034843215253204107 loss_collision: 0.07731037586927414 loss_jerk: 0.07108358293771744 loss_floor_contact: 0.09724965691566467
[78/100] loss: 0.02759706974029541 loss_joints: 0.003567776409909129 loss_collision: 0.07161445915699005 loss_jerk: 0.071073979139328 loss_floor_contact: 0.09760449081659317
[79/100] loss: 0.02737666293978691 loss_joints: 0.003597620874643326 loss_collision: 0.0688052773475647 loss_jerk: 0.07170622050762177 loss_floor_contact: 0.0972789078950882
[80/100] loss: 0.027158338576555252 loss_joints: 0.0035721014719456434 loss_collision: 0.06648274511098862 loss_jerk: 0.0718337744474411 loss_floor_contact: 0.09754583984613419
[81/100] loss: 0.02705552615225315 loss_joints: 0.003499752376228571 loss_collision: 0.06624144315719604 loss_jerk: 0.07171767204999924 loss_floor_contact: 0.0975986197590828
[82/100] loss: 0.0270075686275959 loss_joints: 0.003442094661295414 loss_collision: 0.06651729345321655 loss_jerk: 0.07082658261060715 loss_floor_contact: 0.09831086546182632
[83/100] loss: 0.026681236922740936 loss_joints: 0.0034084958024322987 loss_collision: 0.0624387301504612 loss_jerk: 0.07098153978586197 loss_floor_contact: 0.09930715709924698
[84/100] loss: 0.026246696710586548 loss_joints: 0.003451637690886855 loss_collision: 0.05623430386185646 loss_jerk: 0.07161085307598114 loss_floor_contact: 0.10010544210672379
[85/100] loss: 0.026029685512185097 loss_joints: 0.0036174473352730274 loss_collision: 0.051095087081193924 loss_jerk: 0.07223019748926163 loss_floor_contact: 0.10079709440469742
[86/100] loss: 0.02596435509622097 loss_joints: 0.0038326680660247803 loss_collision: 0.04740988463163376 loss_jerk: 0.07268452644348145 loss_floor_contact: 0.1012224480509758
[87/100] loss: 0.025808144360780716 loss_joints: 0.003854825859889388 loss_collision: 0.04565257579088211 loss_jerk: 0.07282570749521255 loss_floor_contact: 0.10105489939451218
[88/100] loss: 0.025415051728487015 loss_joints: 0.003701559267938137 loss_collision: 0.04366905242204666 loss_jerk: 0.07270023971796036 loss_floor_contact: 0.10076562315225601
[89/100] loss: 0.02516559511423111 loss_joints: 0.0034770341590046883 loss_collision: 0.04403674602508545 loss_jerk: 0.07235101610422134 loss_floor_contact: 0.10049785673618317
[90/100] loss: 0.024944283068180084 loss_joints: 0.00331780593842268 loss_collision: 0.0441848561167717 loss_jerk: 0.0719100832939148 loss_floor_contact: 0.1001698449254036
[91/100] loss: 0.024823632091283798 loss_joints: 0.0032365168444812298 loss_collision: 0.044401273131370544 loss_jerk: 0.07234680652618408 loss_floor_contact: 0.09912307560443878
[92/100] loss: 0.0248781219124794 loss_joints: 0.003241933649405837 loss_collision: 0.04442482814192772 loss_jerk: 0.07309755682945251 loss_floor_contact: 0.09883950650691986
[93/100] loss: 0.02497849613428116 loss_joints: 0.0032549004536122084 loss_collision: 0.0449516661465168 loss_jerk: 0.07351506501436234 loss_floor_contact: 0.09876922518014908
[94/100] loss: 0.024866845458745956 loss_joints: 0.003242391161620617 loss_collision: 0.04380811005830765 loss_jerk: 0.07367522269487381 loss_floor_contact: 0.09876121580600739
[95/100] loss: 0.024699993431568146 loss_joints: 0.0032155027147382498 loss_collision: 0.04239444434642792 loss_jerk: 0.07363919913768768 loss_floor_contact: 0.09881124645471573
[96/100] loss: 0.024710994213819504 loss_joints: 0.0032040528021752834 loss_collision: 0.042666010558605194 loss_jerk: 0.07357626408338547 loss_floor_contact: 0.09882713854312897
[97/100] loss: 0.024615615606307983 loss_joints: 0.0031925325747579336 loss_collision: 0.04194599390029907 loss_jerk: 0.07343477755784988 loss_floor_contact: 0.09885004907846451
[98/100] loss: 0.024383286014199257 loss_joints: 0.003188736503943801 loss_collision: 0.03977685049176216 loss_jerk: 0.07327118515968323 loss_floor_contact: 0.09889745712280273
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-13.png]
[99/100] loss: 0.024244707077741623 loss_joints: 0.0031928166281431913 loss_collision: 0.03843232989311218 loss_jerk: 0.07313589006662369 loss_floor_contact: 0.09895067662000656
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path2-run12-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 524.11988                                                    ║
    ║     rollout = 243.70344                                                    ║
    ║     sdf     = 41.32172                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.02424471                                                 ║
    ║     joints    = 0.00319282                                                 ║
    ║     collision = 0.03843233                                                 ║
    ║     jerk      = 0.07313589                                                 ║
    ║     floor     = 0.09895068                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	9m4.363s
user	7m57.409s
sys	0m23.424s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x59eb40d38c00] using SAR=1/1
[libx264 @ 0x59eb40d38c00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x59eb40d38c00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x59eb40d38c00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_run_12.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x59eb40d36fc0] video:220kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.518841%
frame=   25 fps=0.0 q=-1.0 Lsize=     221kB time=00:00:02.20 bitrate= 823.6kbits/s speed=3.01x    
[libx264 @ 0x59eb40d38c00] frame I:1     Avg QP:18.66  size: 67787
[libx264 @ 0x59eb40d38c00] frame P:8     Avg QP:20.64  size: 14156
[libx264 @ 0x59eb40d38c00] frame B:16    Avg QP:21.13  size:  2724
[libx264 @ 0x59eb40d38c00] consecutive B-frames:  8.0% 16.0% 12.0% 64.0%
[libx264 @ 0x59eb40d38c00] mb I  I16..4:  3.8% 68.2% 28.0%
[libx264 @ 0x59eb40d38c00] mb P  I16..4:  0.3%  2.3%  1.8%  P16..4: 10.5%  3.8%  2.4%  0.0%  0.0%    skip:79.0%
[libx264 @ 0x59eb40d38c00] mb B  I16..4:  0.1%  0.4%  0.1%  B16..8: 12.3%  1.5%  0.5%  direct: 1.6%  skip:83.5%  L0:50.9% L1:40.3% BI: 8.8%
[libx264 @ 0x59eb40d38c00] 8x8 transform intra:63.7% inter:54.3%
[libx264 @ 0x59eb40d38c00] coded y,uvDC,uvAC intra: 33.4% 23.6% 22.4% inter: 4.0% 4.3% 1.9%
[libx264 @ 0x59eb40d38c00] i16 v,h,dc,p: 58% 23% 19%  0%
[libx264 @ 0x59eb40d38c00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 49%  8% 33%  1%  2%  2%  1%  2%  1%
[libx264 @ 0x59eb40d38c00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 35% 23% 13%  5%  4%  4%  4%  9%  3%
[libx264 @ 0x59eb40d38c00] i8c dc,h,v,p: 89%  2%  6%  3%
[libx264 @ 0x59eb40d38c00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x59eb40d38c00] ref P L0: 61.5%  8.0% 17.5% 13.0%
[libx264 @ 0x59eb40d38c00] ref B L0: 83.5% 15.0%  1.5%
[libx264 @ 0x59eb40d38c00] ref B L1: 96.2%  3.8%
[libx264 @ 0x59eb40d38c00] kb/s:718.79
[INFO] Video saved as 'bin/result/optim_run_12.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 26 = (8*3 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<07:29,  4.54s/it]  2%|▏         | 2/100 [00:05<04:21,  2.67s/it]  3%|▎         | 3/100 [00:07<03:45,  2.33s/it]  4%|▍         | 4/100 [00:09<03:04,  1.93s/it]  5%|▌         | 5/100 [00:10<02:38,  1.67s/it]  6%|▌         | 6/100 [00:11<02:25,  1.55s/it]  7%|▋         | 7/100 [00:12<02:16,  1.47s/it]  8%|▊         | 8/100 [00:14<02:12,  1.44s/it]  9%|▉         | 9/100 [00:15<02:04,  1.36s/it] 10%|█         | 10/100 [00:16<02:01,  1.35s/it] 11%|█         | 11/100 [00:18<02:02,  1.37s/it] 12%|█▏        | 12/100 [00:19<02:06,  1.44s/it] 13%|█▎        | 13/100 [00:21<02:09,  1.48s/it] 14%|█▍        | 14/100 [00:22<02:08,  1.50s/it] 15%|█▌        | 15/100 [00:24<02:09,  1.53s/it] 16%|█▌        | 16/100 [00:25<02:04,  1.48s/it] 17%|█▋        | 17/100 [00:27<02:00,  1.45s/it] 18%|█▊        | 18/100 [00:28<01:55,  1.41s/it] 19%|█▉        | 19/100 [00:30<01:55,  1.43s/it] 20%|██        | 20/100 [00:31<01:49,  1.37s/it] 21%|██        | 21/100 [00:32<01:47,  1.36s/it] 22%|██▏       | 22/100 [00:33<01:44,  1.34s/it] 23%|██▎       | 23/100 [00:35<01:45,  1.37s/it] 24%|██▍       | 24/100 [00:36<01:47,  1.41s/it] 25%|██▌       | 25/100 [00:38<01:44,  1.39s/it] 26%|██▌       | 26/100 [00:39<01:43,  1.39s/it] 27%|██▋       | 27/100 [00:40<01:39,  1.36s/it] 28%|██▊       | 28/100 [00:42<01:35,  1.32s/it] 29%|██▉       | 29/100 [00:43<01:33,  1.32s/it] 30%|███       | 30/100 [00:44<01:33,  1.33s/it] 31%|███       | 31/100 [00:46<01:29,  1.29s/it] 32%|███▏      | 32/100 [00:47<01:33,  1.38s/it] 33%|███▎      | 33/100 [00:48<01:29,  1.33s/it] 34%|███▍      | 34/100 [00:50<01:26,  1.32s/it] 35%|███▌      | 35/100 [00:51<01:27,  1.34s/it] 36%|███▌      | 36/100 [00:52<01:26,  1.35s/it] 37%|███▋      | 37/100 [00:54<01:24,  1.34s/it] 38%|███▊      | 38/100 [00:55<01:21,  1.31s/it] 39%|███▉      | 39/100 [00:56<01:18,  1.29s/it] 40%|████      | 40/100 [00:58<01:17,  1.29s/it] 41%|████      | 41/100 [00:59<01:16,  1.30s/it] 42%|████▏     | 42/100 [01:00<01:14,  1.28s/it] 43%|████▎     | 43/100 [01:01<01:12,  1.28s/it] 44%|████▍     | 44/100 [01:03<01:13,  1.31s/it] 45%|████▌     | 45/100 [01:04<01:10,  1.28s/it] 46%|████▌     | 46/100 [01:05<01:10,  1.30s/it] 47%|████▋     | 47/100 [01:07<01:11,  1.34s/it] 48%|████▊     | 48/100 [01:08<01:10,  1.35s/it] 49%|████▉     | 49/100 [01:10<01:10,  1.39s/it] 50%|█████     | 50/100 [01:11<01:10,  1.40s/it] 51%|█████     | 51/100 [01:12<01:08,  1.39s/it] 52%|█████▏    | 52/100 [01:14<01:06,  1.39s/it] 53%|█████▎    | 53/100 [01:15<01:03,  1.36s/it] 54%|█████▍    | 54/100 [01:16<01:02,  1.35s/it] 55%|█████▌    | 55/100 [01:18<00:59,  1.33s/it] 56%|█████▌    | 56/100 [01:19<00:58,  1.34s/it] 57%|█████▋    | 57/100 [01:20<00:57,  1.34s/it] 58%|█████▊    | 58/100 [01:22<00:55,  1.32s/it] 59%|█████▉    | 59/100 [01:23<00:53,  1.31s/it] 60%|██████    | 60/100 [01:24<00:53,  1.34s/it] 61%|██████    | 61/100 [01:26<00:52,  1.34s/it] 62%|██████▏   | 62/100 [01:27<00:51,  1.36s/it] 63%|██████▎   | 63/100 [01:28<00:49,  1.33s/it] 64%|██████▍   | 64/100 [01:30<00:47,  1.32s/it] 65%|██████▌   | 65/100 [01:31<00:45,  1.30s/it] 66%|██████▌   | 66/100 [01:32<00:45,  1.35s/it] 67%|██████▋   | 67/100 [01:34<00:43,  1.32s/it] 68%|██████▊   | 68/100 [01:35<00:41,  1.30s/it] 69%|██████▉   | 69/100 [01:36<00:39,  1.27s/it] 70%|███████   | 70/100 [01:37<00:38,  1.29s/it] 71%|███████   | 71/100 [01:39<00:38,  1.31s/it] 72%|███████▏  | 72/100 [01:40<00:39,  1.42s/it] 73%|███████▎  | 73/100 [01:42<00:37,  1.39s/it] 74%|███████▍  | 74/100 [01:43<00:35,  1.35s/it] 75%|███████▌  | 75/100 [01:44<00:32,  1.31s/it] 76%|███████▌  | 76/100 [01:46<00:31,  1.31s/it] 77%|███████▋  | 77/100 [01:47<00:30,  1.34s/it] 78%|███████▊  | 78/100 [01:48<00:28,  1.30s/it] 79%|███████▉  | 79/100 [01:49<00:27,  1.29s/it] 80%|████████  | 80/100 [01:51<00:25,  1.26s/it] 81%|████████  | 81/100 [01:52<00:23,  1.25s/it] 82%|████████▏ | 82/100 [01:53<00:22,  1.26s/it] 83%|████████▎ | 83/100 [01:54<00:21,  1.29s/it] 84%|████████▍ | 84/100 [01:56<00:20,  1.30s/it] 85%|████████▌ | 85/100 [01:57<00:18,  1.26s/it] 86%|████████▌ | 86/100 [01:58<00:17,  1.26s/it] 87%|████████▋ | 87/100 [01:59<00:16,  1.25s/it] 88%|████████▊ | 88/100 [02:01<00:14,  1.24s/it] 89%|████████▉ | 89/100 [02:02<00:13,  1.25s/it] 90%|█████████ | 90/100 [02:03<00:12,  1.25s/it] 91%|█████████ | 91/100 [02:05<00:11,  1.29s/it] 92%|█████████▏| 92/100 [02:06<00:10,  1.27s/it] 93%|█████████▎| 93/100 [02:07<00:08,  1.27s/it] 94%|█████████▍| 94/100 [02:08<00:07,  1.30s/it] 95%|█████████▌| 95/100 [02:10<00:06,  1.35s/it] 96%|█████████▌| 96/100 [02:11<00:05,  1.40s/it] 97%|█████████▋| 97/100 [02:13<00:04,  1.39s/it] 98%|█████████▊| 98/100 [02:14<00:02,  1.38s/it] 99%|█████████▉| 99/100 [02:15<00:01,  1.34s/it]100%|██████████| 100/100 [02:20<00:00,  2.20s/it]100%|██████████| 100/100 [02:20<00:00,  1.40s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-4.png]
[0/100] loss: 0.4261976480484009 loss_joints: 0.4240574836730957 loss_collision: 0.0 loss_jerk: 0.015773946419358253 loss_floor_contact: 0.005627430975437164
[1/100] loss: 0.41881826519966125 loss_joints: 0.4166625440120697 loss_collision: 0.0 loss_jerk: 0.015566321089863777 loss_floor_contact: 0.005990907549858093
[2/100] loss: 0.4090256989002228 loss_joints: 0.4069056212902069 loss_collision: 0.0 loss_jerk: 0.015320809558033943 loss_floor_contact: 0.005879975855350494
[3/100] loss: 0.3970569670200348 loss_joints: 0.39487820863723755 loss_collision: 0.0 loss_jerk: 0.015850603580474854 loss_floor_contact: 0.005937002599239349
[4/100] loss: 0.3861663043498993 loss_joints: 0.3838971257209778 loss_collision: 0.0 loss_jerk: 0.016434745863080025 loss_floor_contact: 0.006256960332393646
[5/100] loss: 0.37283584475517273 loss_joints: 0.3708125054836273 loss_collision: 0.0 loss_jerk: 0.01618390716612339 loss_floor_contact: 0.004049524664878845
[6/100] loss: 0.3604353666305542 loss_joints: 0.35832569003105164 loss_collision: 0.0 loss_jerk: 0.016292503103613853 loss_floor_contact: 0.004804233089089394
[7/100] loss: 0.3525051772594452 loss_joints: 0.35041317343711853 loss_collision: 0.0 loss_jerk: 0.016679394990205765 loss_floor_contact: 0.004240578040480614
[8/100] loss: 0.34530511498451233 loss_joints: 0.3431349992752075 loss_collision: 0.0015203170478343964 loss_jerk: 0.01725555583834648 loss_floor_contact: 0.002925282344222069
[9/100] loss: 0.3342684209346771 loss_joints: 0.33203786611557007 loss_collision: 0.0018423572182655334 loss_jerk: 0.01777643896639347 loss_floor_contact: 0.002686740830540657
[10/100] loss: 0.3254866600036621 loss_joints: 0.32318657636642456 loss_collision: 0.00047000497579574585 loss_jerk: 0.018302947282791138 loss_floor_contact: 0.004227783530950546
[11/100] loss: 0.3189961314201355 loss_joints: 0.3165808320045471 loss_collision: 0.00033442676067352295 loss_jerk: 0.018749931827187538 loss_floor_contact: 0.005068831145763397
[12/100] loss: 0.31265342235565186 loss_joints: 0.3103328347206116 loss_collision: 0.0 loss_jerk: 0.019134199246764183 loss_floor_contact: 0.004071459174156189
[13/100] loss: 0.3064931035041809 loss_joints: 0.30402901768684387 loss_collision: 0.0 loss_jerk: 0.019480455666780472 loss_floor_contact: 0.005160287022590637
[14/100] loss: 0.29937663674354553 loss_joints: 0.2969415485858917 loss_collision: 0.0 loss_jerk: 0.01987035758793354 loss_floor_contact: 0.004480574280023575
[15/100] loss: 0.2914714217185974 loss_joints: 0.2890811562538147 loss_collision: 0.0 loss_jerk: 0.02026463858783245 loss_floor_contact: 0.003637969493865967
[16/100] loss: 0.28376850485801697 loss_joints: 0.28136202692985535 loss_collision: 0.0 loss_jerk: 0.020572761073708534 loss_floor_contact: 0.0034920498728752136
[17/100] loss: 0.2769796550273895 loss_joints: 0.2743178606033325 loss_collision: 0.0 loss_jerk: 0.020784659311175346 loss_floor_contact: 0.005833331495523453
[18/100] loss: 0.27055343985557556 loss_joints: 0.26795417070388794 loss_collision: 0.0 loss_jerk: 0.020925376564264297 loss_floor_contact: 0.005067162215709686
[19/100] loss: 0.2646941542625427 loss_joints: 0.26208552718162537 loss_collision: 0.0 loss_jerk: 0.02101903036236763 loss_floor_contact: 0.005067206919193268
[20/100] loss: 0.2589187026023865 loss_joints: 0.25651469826698303 loss_collision: 0.0 loss_jerk: 0.02108115144073963 loss_floor_contact: 0.00295865535736084
[21/100] loss: 0.25351473689079285 loss_joints: 0.2511099576950073 loss_collision: 0.0 loss_jerk: 0.021119536831974983 loss_floor_contact: 0.0029285242781043053
[22/100] loss: 0.24838346242904663 loss_joints: 0.24579471349716187 loss_collision: 0.0 loss_jerk: 0.021138805896043777 loss_floor_contact: 0.004748702049255371
[23/100] loss: 0.24317128956317902 loss_joints: 0.24055522680282593 loss_collision: 0.0 loss_jerk: 0.0211426243185997 loss_floor_contact: 0.005018023774027824
[24/100] loss: 0.23811757564544678 loss_joints: 0.23542720079421997 loss_collision: 0.0 loss_jerk: 0.021131983026862144 loss_floor_contact: 0.0057718176394701
[25/100] loss: 0.23291338980197906 loss_joints: 0.23042458295822144 loss_collision: 0.0 loss_jerk: 0.02111032046377659 loss_floor_contact: 0.0037777945399284363
[26/100] loss: 0.22799107432365417 loss_joints: 0.22547142207622528 loss_collision: 0.0 loss_jerk: 0.021082201972603798 loss_floor_contact: 0.004114370793104172
[27/100] loss: 0.22304019331932068 loss_joints: 0.22047081589698792 loss_collision: 0.0 loss_jerk: 0.02153054252266884 loss_floor_contact: 0.0041632987558841705
[28/100] loss: 0.21796445548534393 loss_joints: 0.21541282534599304 loss_collision: 0.0 loss_jerk: 0.02226584404706955 loss_floor_contact: 0.0032503902912139893
[29/100] loss: 0.21318456530570984 loss_joints: 0.21042633056640625 loss_collision: 0.0 loss_jerk: 0.024167373776435852 loss_floor_contact: 0.0034150034189224243
[30/100] loss: 0.208511620759964 loss_joints: 0.20570459961891174 loss_collision: 0.0 loss_jerk: 0.02571963146328926 loss_floor_contact: 0.0023505277931690216
[31/100] loss: 0.20425868034362793 loss_joints: 0.2012738585472107 loss_collision: 0.0 loss_jerk: 0.026840930804610252 loss_floor_contact: 0.003007352352142334
[32/100] loss: 0.20017331838607788 loss_joints: 0.19697943329811096 loss_collision: 0.0 loss_jerk: 0.0276230089366436 loss_floor_contact: 0.0043157488107681274
[33/100] loss: 0.19594821333885193 loss_joints: 0.19275560975074768 loss_collision: 0.0 loss_jerk: 0.028044387698173523 loss_floor_contact: 0.003881677985191345
[34/100] loss: 0.1917695701122284 loss_joints: 0.18857631087303162 loss_collision: 0.0 loss_jerk: 0.028093552216887474 loss_floor_contact: 0.0038390569388866425
[35/100] loss: 0.18763233721256256 loss_joints: 0.18440686166286469 loss_collision: 0.0 loss_jerk: 0.027763355523347855 loss_floor_contact: 0.0044914111495018005
[36/100] loss: 0.18358424305915833 loss_joints: 0.1802244484424591 loss_collision: 0.0 loss_jerk: 0.02713531255722046 loss_floor_contact: 0.0064626093953847885
[37/100] loss: 0.17929023504257202 loss_joints: 0.17598824203014374 loss_collision: 0.0 loss_jerk: 0.02630539983510971 loss_floor_contact: 0.006714534014463425
[38/100] loss: 0.17495954036712646 loss_joints: 0.17165938019752502 loss_collision: 0.0 loss_jerk: 0.025326907634735107 loss_floor_contact: 0.007674688473343849
[39/100] loss: 0.1703900694847107 loss_joints: 0.1672552078962326 loss_collision: 0.0 loss_jerk: 0.024311425164341927 loss_floor_contact: 0.007037177681922913
[40/100] loss: 0.1659448891878128 loss_joints: 0.16280879080295563 loss_collision: 0.0 loss_jerk: 0.02443981170654297 loss_floor_contact: 0.006921157240867615
[41/100] loss: 0.16148987412452698 loss_joints: 0.15835852921009064 loss_collision: 0.0 loss_jerk: 0.024613739922642708 loss_floor_contact: 0.006699699908494949
[42/100] loss: 0.15718768537044525 loss_joints: 0.15402387082576752 loss_collision: 0.0007163062691688538 loss_jerk: 0.024806655943393707 loss_floor_contact: 0.006115201860666275
[43/100] loss: 0.15297971665859222 loss_joints: 0.1498078852891922 loss_collision: 0.0006989464163780212 loss_jerk: 0.025027086958289146 loss_floor_contact: 0.005992193706333637
[44/100] loss: 0.1487889140844345 loss_joints: 0.14568021893501282 loss_collision: 0.001023910939693451 loss_jerk: 0.025279156863689423 loss_floor_contact: 0.004783931188285351
[45/100] loss: 0.14489106833934784 loss_joints: 0.14163780212402344 loss_collision: 0.001130625605583191 loss_jerk: 0.025565505027770996 loss_floor_contact: 0.005836427211761475
[46/100] loss: 0.1410556584596634 loss_joints: 0.13772259652614594 loss_collision: 0.001481909304857254 loss_jerk: 0.025859622284770012 loss_floor_contact: 0.005989048629999161
[47/100] loss: 0.13722558319568634 loss_joints: 0.13397681713104248 loss_collision: 0.0015107020735740662 loss_jerk: 0.026144063100218773 loss_floor_contact: 0.004832819569855928
[48/100] loss: 0.13373731076717377 loss_joints: 0.13040603697299957 loss_collision: 0.0012520067393779755 loss_jerk: 0.02640427276492119 loss_floor_contact: 0.005656477063894272
[49/100] loss: 0.13033251464366913 loss_joints: 0.12698641419410706 loss_collision: 0.001145489513874054 loss_jerk: 0.026642831042408943 loss_floor_contact: 0.005672741681337357
[50/100] loss: 0.12706129252910614 loss_joints: 0.12366094440221786 loss_collision: 0.0010825581848621368 loss_jerk: 0.02687092125415802 loss_floor_contact: 0.006049953401088715
[51/100] loss: 0.12381938099861145 loss_joints: 0.12038880586624146 loss_collision: 0.001289471983909607 loss_jerk: 0.027090176939964294 loss_floor_contact: 0.005926154553890228
[52/100] loss: 0.12059072405099869 loss_joints: 0.11714395135641098 loss_collision: 0.0010879933834075928 loss_jerk: 0.02730507403612137 loss_floor_contact: 0.006074689328670502
[53/100] loss: 0.11738164722919464 loss_joints: 0.11389413475990295 loss_collision: 0.0032732971012592316 loss_jerk: 0.027508987113833427 loss_floor_contact: 0.0040928954258561134
[54/100] loss: 0.11434457451105118 loss_joints: 0.11057796329259872 loss_collision: 0.004057802259922028 loss_jerk: 0.027703886851668358 loss_floor_contact: 0.0059044212102890015
[55/100] loss: 0.11076487600803375 loss_joints: 0.1070791482925415 loss_collision: 0.004359718412160873 loss_jerk: 0.02785421535372734 loss_floor_contact: 0.004643365740776062
[56/100] loss: 0.10703367739915848 loss_joints: 0.10321581363677979 loss_collision: 0.004670321941375732 loss_jerk: 0.028043700382113457 loss_floor_contact: 0.005464609712362289
[57/100] loss: 0.10255634784698486 loss_joints: 0.09913753718137741 loss_collision: 0.003647197037935257 loss_jerk: 0.02821950986981392 loss_floor_contact: 0.0023214146494865417
[58/100] loss: 0.09888743609189987 loss_joints: 0.09541463106870651 loss_collision: 0.0036337338387966156 loss_jerk: 0.028437474742531776 loss_floor_contact: 0.0026568882167339325
[59/100] loss: 0.09555670619010925 loss_joints: 0.09216635674238205 loss_collision: 0.003885626792907715 loss_jerk: 0.028627395629882812 loss_floor_contact: 0.0013904832303524017
[60/100] loss: 0.09229299426078796 loss_joints: 0.08892592042684555 loss_collision: 0.002907000482082367 loss_jerk: 0.02876746840775013 loss_floor_contact: 0.001996319741010666
[61/100] loss: 0.08898737281560898 loss_joints: 0.08549772202968597 loss_collision: 0.002497456967830658 loss_jerk: 0.028872286900877953 loss_floor_contact: 0.003526780754327774
[62/100] loss: 0.08542153239250183 loss_joints: 0.08188927173614502 loss_collision: 0.0028287582099437714 loss_jerk: 0.02890882082283497 loss_floor_contact: 0.0035850144922733307
[63/100] loss: 0.08163140714168549 loss_joints: 0.07811440527439117 loss_collision: 0.0025506876409053802 loss_jerk: 0.02886868827044964 loss_floor_contact: 0.0037505924701690674
[64/100] loss: 0.07768560200929642 loss_joints: 0.07416629046201706 loss_collision: 0.002589017152786255 loss_jerk: 0.028734518215060234 loss_floor_contact: 0.003869585692882538
[65/100] loss: 0.07328716665506363 loss_joints: 0.07004504650831223 loss_collision: 0.0 loss_jerk: 0.028482643887400627 loss_floor_contact: 0.003938555717468262
[66/100] loss: 0.06903256475925446 loss_joints: 0.06579002737998962 loss_collision: 0.0 loss_jerk: 0.028101298958063126 loss_floor_contact: 0.004324126988649368
[67/100] loss: 0.06481818109750748 loss_joints: 0.06146109104156494 loss_collision: 0.0 loss_jerk: 0.027523381635546684 loss_floor_contact: 0.0060474928468465805
[68/100] loss: 0.060293685644865036 loss_joints: 0.05708172917366028 loss_collision: 0.0 loss_jerk: 0.026782583445310593 loss_floor_contact: 0.00533696636557579
[69/100] loss: 0.05602964758872986 loss_joints: 0.052702646702528 loss_collision: 0.0 loss_jerk: 0.02711244486272335 loss_floor_contact: 0.006157558411359787
[70/100] loss: 0.051961641758680344 loss_joints: 0.04842261224985123 loss_collision: 0.0 loss_jerk: 0.02918124385178089 loss_floor_contact: 0.0062090493738651276
[71/100] loss: 0.048159051686525345 loss_joints: 0.04433953016996384 loss_collision: 0.0 loss_jerk: 0.03148522973060608 loss_floor_contact: 0.006710004061460495
[72/100] loss: 0.04457207769155502 loss_joints: 0.04051504656672478 loss_collision: 0.0 loss_jerk: 0.0340309776365757 loss_floor_contact: 0.00653933547437191
[73/100] loss: 0.041365571320056915 loss_joints: 0.03701514005661011 loss_collision: 0.0 loss_jerk: 0.03682761266827583 loss_floor_contact: 0.006676696240901947
[74/100] loss: 0.03840984031558037 loss_joints: 0.0339171439409256 loss_collision: 0.0 loss_jerk: 0.0398089699447155 loss_floor_contact: 0.005118001252412796
[75/100] loss: 0.03616005927324295 loss_joints: 0.031239880248904228 loss_collision: 0.0 loss_jerk: 0.042858220636844635 loss_floor_contact: 0.006343554705381393
[76/100] loss: 0.03415737301111221 loss_joints: 0.02893736958503723 loss_collision: 0.0 loss_jerk: 0.04580814018845558 loss_floor_contact: 0.006391872651875019
[77/100] loss: 0.03245605528354645 loss_joints: 0.02702692709863186 loss_collision: 0.0 loss_jerk: 0.04853137210011482 loss_floor_contact: 0.0057598864659667015
[78/100] loss: 0.03109218366444111 loss_joints: 0.025483442470431328 loss_collision: 0.0 loss_jerk: 0.0509524866938591 loss_floor_contact: 0.005134915933012962
[79/100] loss: 0.029969917610287666 loss_joints: 0.024242889136075974 loss_collision: 0.0 loss_jerk: 0.05297084152698517 loss_floor_contact: 0.004299448803067207
[80/100] loss: 0.029008805751800537 loss_joints: 0.023216642439365387 loss_collision: 0.0 loss_jerk: 0.05448121204972267 loss_floor_contact: 0.0034404098987579346
[81/100] loss: 0.028211796656250954 loss_joints: 0.022327516227960587 loss_collision: 0.0 loss_jerk: 0.05561154708266258 loss_floor_contact: 0.0032312534749507904
[82/100] loss: 0.027529092505574226 loss_joints: 0.02153724990785122 loss_collision: 0.0 loss_jerk: 0.05637837573885918 loss_floor_contact: 0.0035400427877902985
[83/100] loss: 0.026790793985128403 loss_joints: 0.020814500749111176 loss_collision: 0.0 loss_jerk: 0.056879155337810516 loss_floor_contact: 0.0028837919235229492
[84/100] loss: 0.02610391192138195 loss_joints: 0.02013605833053589 loss_collision: 0.0 loss_jerk: 0.057090453803539276 loss_floor_contact: 0.002588089555501938
[85/100] loss: 0.025490107014775276 loss_joints: 0.019489867612719536 loss_collision: 0.0 loss_jerk: 0.05703308805823326 loss_floor_contact: 0.0029692985117435455
[86/100] loss: 0.024797869846224785 loss_joints: 0.018864277750253677 loss_collision: 0.0 loss_jerk: 0.056691721081733704 loss_floor_contact: 0.002644199877977371
[87/100] loss: 0.024143734946846962 loss_joints: 0.018255244940519333 loss_collision: 0.0 loss_jerk: 0.056058481335639954 loss_floor_contact: 0.0028264112770557404
[88/100] loss: 0.023532550781965256 loss_joints: 0.017661666497588158 loss_collision: 0.0 loss_jerk: 0.0551404170691967 loss_floor_contact: 0.003568410873413086
[89/100] loss: 0.022691473364830017 loss_joints: 0.017088375985622406 loss_collision: 0.0 loss_jerk: 0.053919125348329544 loss_floor_contact: 0.00211184099316597
[90/100] loss: 0.022019807249307632 loss_joints: 0.016540735960006714 loss_collision: 0.0 loss_jerk: 0.05249730497598648 loss_floor_contact: 0.002293400466442108
[91/100] loss: 0.021540332585573196 loss_joints: 0.01602552831172943 loss_collision: 0.0 loss_jerk: 0.050973959267139435 loss_floor_contact: 0.004174068570137024
[92/100] loss: 0.020807884633541107 loss_joints: 0.01555434800684452 loss_collision: 0.0 loss_jerk: 0.04931642860174179 loss_floor_contact: 0.0032189302146434784
[93/100] loss: 0.02005309984087944 loss_joints: 0.015139883384108543 loss_collision: 0.0 loss_jerk: 0.0475994311273098 loss_floor_contact: 0.0015327297151088715
[94/100] loss: 0.019779622554779053 loss_joints: 0.01479106955230236 loss_collision: 0.0 loss_jerk: 0.045910656452178955 loss_floor_contact: 0.00397486612200737
[95/100] loss: 0.01955571584403515 loss_joints: 0.014508001506328583 loss_collision: 0.0014361031353473663 loss_jerk: 0.04436756670475006 loss_floor_contact: 0.004673466086387634
[96/100] loss: 0.019154157489538193 loss_joints: 0.014291070401668549 loss_collision: 0.0006078779697418213 loss_jerk: 0.042993977665901184 loss_floor_contact: 0.005029002204537392
[97/100] loss: 0.018863867968320847 loss_joints: 0.014131076633930206 loss_collision: 0.0002079792320728302 loss_jerk: 0.041862718760967255 loss_floor_contact: 0.00525720976293087
[98/100] loss: 0.018701821565628052 loss_joints: 0.014019872061908245 loss_collision: 0.0001617632806301117 loss_jerk: 0.04099845141172409 loss_floor_contact: 0.005659277550876141
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-4.png]
[99/100] loss: 0.018625859171152115 loss_joints: 0.013949069194495678 loss_collision: 0.00026495009660720825 loss_jerk: 0.04042241349816322 loss_floor_contact: 0.0060805343091487885
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path3-walk3-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 140.10546                                                    ║
    ║     rollout = 54.67050                                                     ║
    ║     sdf     = 19.17593                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.01862586                                                 ║
    ║     joints    = 0.01394907                                                 ║
    ║     collision = 0.00026495                                                 ║
    ║     jerk      = 0.04042241                                                 ║
    ║     floor     = 0.00608053                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	2m42.226s
user	2m19.114s
sys	0m10.691s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x5cda13683c00] using SAR=1/1
[libx264 @ 0x5cda13683c00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x5cda13683c00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x5cda13683c00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_walk_3.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x5cda13681fc0] video:214kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.534031%
frame=   25 fps=0.0 q=-1.0 Lsize=     215kB time=00:00:02.20 bitrate= 800.3kbits/s speed=2.99x    
[libx264 @ 0x5cda13683c00] frame I:1     Avg QP:17.48  size: 63959
[libx264 @ 0x5cda13683c00] frame P:8     Avg QP:19.70  size: 14002
[libx264 @ 0x5cda13683c00] frame B:16    Avg QP:22.09  size:  2640
[libx264 @ 0x5cda13683c00] consecutive B-frames:  8.0% 16.0% 12.0% 64.0%
[libx264 @ 0x5cda13683c00] mb I  I16..4: 11.6% 61.0% 27.5%
[libx264 @ 0x5cda13683c00] mb P  I16..4:  0.2%  2.4%  2.0%  P16..4: 10.8%  3.2%  1.9%  0.0%  0.0%    skip:79.5%
[libx264 @ 0x5cda13683c00] mb B  I16..4:  0.0%  0.4%  0.2%  B16..8: 12.0%  1.2%  0.4%  direct: 1.7%  skip:84.0%  L0:49.6% L1:44.9% BI: 5.6%
[libx264 @ 0x5cda13683c00] 8x8 transform intra:58.7% inter:60.9%
[libx264 @ 0x5cda13683c00] coded y,uvDC,uvAC intra: 34.2% 23.9% 22.8% inter: 4.0% 4.5% 1.8%
[libx264 @ 0x5cda13683c00] i16 v,h,dc,p: 79% 13%  8%  0%
[libx264 @ 0x5cda13683c00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 45%  9% 36%  1%  2%  2%  1%  3%  1%
[libx264 @ 0x5cda13683c00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 34% 23% 15%  5%  4%  5%  4%  9%  3%
[libx264 @ 0x5cda13683c00] i8c dc,h,v,p: 88%  2%  6%  3%
[libx264 @ 0x5cda13683c00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x5cda13683c00] ref P L0: 52.1%  8.1% 25.3% 14.5%
[libx264 @ 0x5cda13683c00] ref B L0: 81.4% 16.5%  2.1%
[libx264 @ 0x5cda13683c00] ref B L1: 96.6%  3.4%
[libx264 @ 0x5cda13683c00] kb/s:698.28
[INFO] Video saved as 'bin/result/optim_walk_3.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 50 = (8*6 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:07<12:36,  7.64s/it]  2%|▏         | 2/100 [00:09<07:23,  4.53s/it]  3%|▎         | 3/100 [00:13<06:31,  4.03s/it]  4%|▍         | 4/100 [00:15<05:27,  3.41s/it]  5%|▌         | 5/100 [00:18<04:43,  2.99s/it]  6%|▌         | 6/100 [00:20<04:19,  2.77s/it]  7%|▋         | 7/100 [00:22<04:02,  2.61s/it]  8%|▊         | 8/100 [00:25<03:58,  2.59s/it]  9%|▉         | 9/100 [00:27<03:47,  2.50s/it] 10%|█         | 10/100 [00:29<03:42,  2.47s/it] 11%|█         | 11/100 [00:32<03:36,  2.44s/it] 12%|█▏        | 12/100 [00:35<03:46,  2.57s/it] 13%|█▎        | 13/100 [00:37<03:45,  2.59s/it] 14%|█▍        | 14/100 [00:40<03:43,  2.60s/it] 15%|█▌        | 15/100 [00:42<03:35,  2.54s/it] 16%|█▌        | 16/100 [00:45<03:26,  2.46s/it] 17%|█▋        | 17/100 [00:47<03:20,  2.42s/it] 18%|█▊        | 18/100 [00:50<03:22,  2.47s/it] 19%|█▉        | 19/100 [00:52<03:17,  2.44s/it] 20%|██        | 20/100 [00:54<03:13,  2.42s/it] 21%|██        | 21/100 [00:57<03:09,  2.40s/it] 22%|██▏       | 22/100 [00:59<03:05,  2.38s/it] 23%|██▎       | 23/100 [01:01<03:04,  2.40s/it] 24%|██▍       | 24/100 [01:04<03:06,  2.46s/it] 25%|██▌       | 25/100 [01:06<03:02,  2.43s/it] 26%|██▌       | 26/100 [01:09<02:58,  2.42s/it] 27%|██▋       | 27/100 [01:11<02:59,  2.46s/it] 28%|██▊       | 28/100 [01:14<02:55,  2.44s/it] 29%|██▉       | 29/100 [01:16<02:53,  2.44s/it] 30%|███       | 30/100 [01:19<02:50,  2.43s/it] 31%|███       | 31/100 [01:21<02:49,  2.45s/it] 32%|███▏      | 32/100 [01:23<02:44,  2.41s/it] 33%|███▎      | 33/100 [01:26<02:41,  2.41s/it] 34%|███▍      | 34/100 [01:28<02:41,  2.45s/it] 35%|███▌      | 35/100 [01:31<02:43,  2.52s/it] 36%|███▌      | 36/100 [01:34<02:42,  2.54s/it] 37%|███▋      | 37/100 [01:36<02:40,  2.55s/it] 38%|███▊      | 38/100 [01:39<02:37,  2.53s/it] 39%|███▉      | 39/100 [01:41<02:33,  2.51s/it] 40%|████      | 40/100 [01:44<02:28,  2.48s/it] 41%|████      | 41/100 [01:46<02:30,  2.54s/it] 42%|████▏     | 42/100 [01:49<02:27,  2.55s/it] 43%|████▎     | 43/100 [01:51<02:23,  2.52s/it] 44%|████▍     | 44/100 [01:54<02:19,  2.50s/it] 45%|████▌     | 45/100 [01:56<02:16,  2.48s/it] 46%|████▌     | 46/100 [01:59<02:11,  2.44s/it] 47%|████▋     | 47/100 [02:01<02:15,  2.56s/it] 48%|████▊     | 48/100 [02:04<02:12,  2.54s/it] 49%|████▉     | 49/100 [02:06<02:08,  2.52s/it] 50%|█████     | 50/100 [02:09<02:03,  2.47s/it] 51%|█████     | 51/100 [02:11<02:00,  2.47s/it] 52%|█████▏    | 52/100 [02:14<01:58,  2.48s/it] 53%|█████▎    | 53/100 [02:16<01:58,  2.51s/it] 54%|█████▍    | 54/100 [02:19<01:57,  2.56s/it] 55%|█████▌    | 55/100 [02:22<01:57,  2.61s/it] 56%|█████▌    | 56/100 [02:24<01:52,  2.55s/it] 57%|█████▋    | 57/100 [02:27<01:49,  2.54s/it] 58%|█████▊    | 58/100 [02:29<01:47,  2.56s/it] 59%|█████▉    | 59/100 [02:32<01:45,  2.57s/it] 60%|██████    | 60/100 [02:35<01:45,  2.65s/it] 61%|██████    | 61/100 [02:37<01:40,  2.58s/it] 62%|██████▏   | 62/100 [02:39<01:35,  2.52s/it] 63%|██████▎   | 63/100 [02:42<01:32,  2.49s/it] 64%|██████▍   | 64/100 [02:44<01:31,  2.54s/it] 65%|██████▌   | 65/100 [02:47<01:29,  2.57s/it] 66%|██████▌   | 66/100 [02:50<01:25,  2.53s/it] 67%|██████▋   | 67/100 [02:52<01:21,  2.48s/it] 68%|██████▊   | 68/100 [02:54<01:19,  2.48s/it] 69%|██████▉   | 69/100 [02:57<01:17,  2.50s/it] 70%|███████   | 70/100 [02:59<01:15,  2.50s/it] 71%|███████   | 71/100 [03:02<01:12,  2.51s/it] 72%|███████▏  | 72/100 [03:04<01:09,  2.47s/it] 73%|███████▎  | 73/100 [03:07<01:09,  2.56s/it] 74%|███████▍  | 74/100 [03:10<01:06,  2.55s/it] 75%|███████▌  | 75/100 [03:12<01:02,  2.51s/it] 76%|███████▌  | 76/100 [03:15<01:00,  2.52s/it] 77%|███████▋  | 77/100 [03:17<00:57,  2.48s/it] 78%|███████▊  | 78/100 [03:20<00:57,  2.60s/it] 79%|███████▉  | 79/100 [03:23<00:55,  2.64s/it] 80%|████████  | 80/100 [03:25<00:53,  2.65s/it] 81%|████████  | 81/100 [03:28<00:49,  2.62s/it] 82%|████████▏ | 82/100 [03:30<00:46,  2.60s/it] 83%|████████▎ | 83/100 [03:33<00:43,  2.56s/it] 84%|████████▍ | 84/100 [03:36<00:41,  2.61s/it] 85%|████████▌ | 85/100 [03:38<00:38,  2.58s/it] 86%|████████▌ | 86/100 [03:41<00:36,  2.58s/it] 87%|████████▋ | 87/100 [03:43<00:33,  2.59s/it] 88%|████████▊ | 88/100 [03:46<00:30,  2.56s/it] 89%|████████▉ | 89/100 [03:48<00:27,  2.53s/it] 90%|█████████ | 90/100 [03:51<00:25,  2.53s/it] 91%|█████████ | 91/100 [03:54<00:23,  2.62s/it] 92%|█████████▏| 92/100 [03:56<00:21,  2.66s/it] 93%|█████████▎| 93/100 [03:59<00:18,  2.69s/it] 94%|█████████▍| 94/100 [04:02<00:16,  2.67s/it] 95%|█████████▌| 95/100 [04:04<00:13,  2.67s/it] 96%|█████████▌| 96/100 [04:07<00:10,  2.72s/it] 97%|█████████▋| 97/100 [04:10<00:08,  2.79s/it] 98%|█████████▊| 98/100 [04:13<00:05,  2.71s/it] 99%|█████████▉| 99/100 [04:15<00:02,  2.63s/it]100%|██████████| 100/100 [04:23<00:00,  4.05s/it]100%|██████████| 100/100 [04:23<00:00,  2.63s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-7.png]
[0/100] loss: 0.2722621560096741 loss_joints: 0.27017927169799805 loss_collision: 0.0 loss_jerk: 0.015773862600326538 loss_floor_contact: 0.005055042915046215
[1/100] loss: 0.2563002109527588 loss_joints: 0.2543833255767822 loss_collision: 0.0 loss_jerk: 0.015574986115098 loss_floor_contact: 0.0035937707871198654
[2/100] loss: 0.23338006436824799 loss_joints: 0.2314920425415039 loss_collision: 0.0 loss_jerk: 0.01531517505645752 loss_floor_contact: 0.0035651710350066423
[3/100] loss: 0.20396994054317474 loss_joints: 0.20190094411373138 loss_collision: 0.0 loss_jerk: 0.01571059040725231 loss_floor_contact: 0.00497940368950367
[4/100] loss: 0.18262550234794617 loss_joints: 0.18049590289592743 loss_collision: 0.0 loss_jerk: 0.016573823988437653 loss_floor_contact: 0.004722139798104763
[5/100] loss: 0.169131338596344 loss_joints: 0.16708587110042572 loss_collision: 0.0 loss_jerk: 0.016469638794660568 loss_floor_contact: 0.00398502591997385
[6/100] loss: 0.15905383229255676 loss_joints: 0.15697959065437317 loss_collision: 0.0 loss_jerk: 0.01626976951956749 loss_floor_contact: 0.004472528584301472
[7/100] loss: 0.14801961183547974 loss_joints: 0.14590011537075043 loss_collision: 0.0013877643505111337 loss_jerk: 0.016531290486454964 loss_floor_contact: 0.003275916213169694
[8/100] loss: 0.13581693172454834 loss_joints: 0.1338740587234497 loss_collision: 0.0 loss_jerk: 0.016916194930672646 loss_floor_contact: 0.002512522041797638
[9/100] loss: 0.12207118421792984 loss_joints: 0.1199597418308258 loss_collision: 0.0006302552646957338 loss_jerk: 0.017393553629517555 loss_floor_contact: 0.0030906128231436014
[10/100] loss: 0.10946439206600189 loss_joints: 0.10712256282567978 loss_collision: 0.0008698382880538702 loss_jerk: 0.0179014690220356 loss_floor_contact: 0.004647033289074898
[11/100] loss: 0.09754975140094757 loss_joints: 0.09525304287672043 loss_collision: 0.0 loss_jerk: 0.01833651401102543 loss_floor_contact: 0.004630545619875193
[12/100] loss: 0.08587712794542313 loss_joints: 0.08333885669708252 loss_collision: 0.0 loss_jerk: 0.019632641226053238 loss_floor_contact: 0.00575007451698184
[13/100] loss: 0.0754023939371109 loss_joints: 0.07285675406455994 loss_collision: 0.0008697531302459538 loss_jerk: 0.019715066999197006 loss_floor_contact: 0.0048715900629758835
[14/100] loss: 0.0661725327372551 loss_joints: 0.06350822746753693 loss_collision: 0.0009535466087982059 loss_jerk: 0.019518516957759857 loss_floor_contact: 0.006171043496578932
[15/100] loss: 0.05821438133716583 loss_joints: 0.05581028014421463 loss_collision: 0.0007339375442825258 loss_jerk: 0.01980281062424183 loss_floor_contact: 0.0035042583476752043
[16/100] loss: 0.0516585037112236 loss_joints: 0.04916403442621231 loss_collision: 0.0004999127122573555 loss_jerk: 0.020030323415994644 loss_floor_contact: 0.004414478316903114
[17/100] loss: 0.04588625580072403 loss_joints: 0.04328548535704613 loss_collision: 0.0 loss_jerk: 0.02019631862640381 loss_floor_contact: 0.005811375565826893
[18/100] loss: 0.04063842073082924 loss_joints: 0.03816778585314751 loss_collision: 0.0 loss_jerk: 0.020301980897784233 loss_floor_contact: 0.004404355771839619
[19/100] loss: 0.036057304590940475 loss_joints: 0.03348968178033829 loss_collision: 0.00015348622400779277 loss_jerk: 0.020384235307574272 loss_floor_contact: 0.00513851922005415
[20/100] loss: 0.031808171421289444 loss_joints: 0.029333120211958885 loss_collision: 0.0 loss_jerk: 0.020456446334719658 loss_floor_contact: 0.004294050857424736
[21/100] loss: 0.028061650693416595 loss_joints: 0.025425169616937637 loss_collision: 0.0 loss_jerk: 0.02049723081290722 loss_floor_contact: 0.0058675771579146385
[22/100] loss: 0.02439442090690136 loss_joints: 0.02162162959575653 loss_collision: 0.0 loss_jerk: 0.020641937851905823 loss_floor_contact: 0.007085970137268305
[23/100] loss: 0.021080732345581055 loss_joints: 0.01836157776415348 loss_collision: 0.0 loss_jerk: 0.02058444917201996 loss_floor_contact: 0.006607094779610634
[24/100] loss: 0.018132833763957024 loss_joints: 0.015444397926330566 loss_collision: 0.0 loss_jerk: 0.020329201593995094 loss_floor_contact: 0.006555147003382444
[25/100] loss: 0.015622936189174652 loss_joints: 0.01286396011710167 loss_collision: 0.0 loss_jerk: 0.020234087482094765 loss_floor_contact: 0.0073556676506996155
[26/100] loss: 0.013170011341571808 loss_joints: 0.010578218847513199 loss_collision: 0.0 loss_jerk: 0.02011849358677864 loss_floor_contact: 0.005799432285130024
[27/100] loss: 0.011255916208028793 loss_joints: 0.008611820638179779 loss_collision: 0.0 loss_jerk: 0.020002564415335655 loss_floor_contact: 0.006438395008444786
[28/100] loss: 0.009608081541955471 loss_joints: 0.007068495266139507 loss_collision: 0.0004258283879607916 loss_jerk: 0.019898416474461555 loss_floor_contact: 0.005071616265922785
[29/100] loss: 0.00843285582959652 loss_joints: 0.005982791073620319 loss_collision: 0.0005406567361205816 loss_jerk: 0.019784918054938316 loss_floor_contact: 0.004175073467195034
[30/100] loss: 0.007937366142868996 loss_joints: 0.005391903221607208 loss_collision: 0.0 loss_jerk: 0.019698111340403557 loss_floor_contact: 0.005756515543907881
[31/100] loss: 0.007475003134459257 loss_joints: 0.005082639399915934 loss_collision: 0.0 loss_jerk: 0.019599543884396553 loss_floor_contact: 0.004324093461036682
[32/100] loss: 0.007380165159702301 loss_joints: 0.004924910143017769 loss_collision: 0.0012820534175261855 loss_jerk: 0.019520331174135208 loss_floor_contact: 0.003750164294615388
[33/100] loss: 0.00731329619884491 loss_joints: 0.004855860024690628 loss_collision: 0.00024679090711288154 loss_jerk: 0.01955026388168335 loss_floor_contact: 0.004777304362505674
[34/100] loss: 0.007271931506693363 loss_joints: 0.004829014651477337 loss_collision: 0.0 loss_jerk: 0.01951356790959835 loss_floor_contact: 0.004915599711239338
[35/100] loss: 0.007441244553774595 loss_joints: 0.004791388288140297 loss_collision: 0.0015512321842834353 loss_jerk: 0.019438324496150017 loss_floor_contact: 0.005509002134203911
[36/100] loss: 0.007410317659378052 loss_joints: 0.004735472146421671 loss_collision: 0.0017177356639876962 loss_jerk: 0.01936318725347519 loss_floor_contact: 0.0056675332598388195
[37/100] loss: 0.0074624414555728436 loss_joints: 0.004606320057064295 loss_collision: 0.0019508175319060683 loss_jerk: 0.020205607637763023 loss_floor_contact: 0.006404784973710775
[38/100] loss: 0.007482731249183416 loss_joints: 0.004523268900811672 loss_collision: 0.0021725106053054333 loss_jerk: 0.02063085325062275 loss_floor_contact: 0.006791260093450546
[39/100] loss: 0.007271560840308666 loss_joints: 0.004466325044631958 loss_collision: 0.002179105533286929 loss_jerk: 0.019951745867729187 loss_floor_contact: 0.005921508651226759
[40/100] loss: 0.0072133541107177734 loss_joints: 0.004431536421179771 loss_collision: 0.0027045714668929577 loss_jerk: 0.019195063039660454 loss_floor_contact: 0.005918546114116907
[41/100] loss: 0.007217400707304478 loss_joints: 0.004310475196689367 loss_collision: 0.0032970565371215343 loss_jerk: 0.019158165901899338 loss_floor_contact: 0.006614031735807657
[42/100] loss: 0.006928813643753529 loss_joints: 0.004127604886889458 loss_collision: 0.0032852741423994303 loss_jerk: 0.019101090729236603 loss_floor_contact: 0.0056257229298353195
[43/100] loss: 0.006881543900817633 loss_joints: 0.0039887698367238045 loss_collision: 0.0035249507054686546 loss_jerk: 0.019062872976064682 loss_floor_contact: 0.006339916028082371
[44/100] loss: 0.006716122850775719 loss_joints: 0.0038698797579854727 loss_collision: 0.003024122677743435 loss_jerk: 0.019038474187254906 loss_floor_contact: 0.006399835459887981
[45/100] loss: 0.006648136768490076 loss_joints: 0.0037670228630304337 loss_collision: 0.003363317809998989 loss_jerk: 0.0189992543309927 loss_floor_contact: 0.006448565050959587
[46/100] loss: 0.006495895329862833 loss_joints: 0.003680316498503089 loss_collision: 0.0029037022031843662 loss_jerk: 0.0189397893846035 loss_floor_contact: 0.00631229393184185
[47/100] loss: 0.0064050015062093735 loss_joints: 0.0036262976936995983 loss_collision: 0.0027741685044020414 loss_jerk: 0.018877601251006126 loss_floor_contact: 0.006135268602520227
[48/100] loss: 0.006383721251040697 loss_joints: 0.003590830136090517 loss_collision: 0.002950129797682166 loss_jerk: 0.0188278965651989 loss_floor_contact: 0.006150886882096529
[49/100] loss: 0.006393822375684977 loss_joints: 0.0035476123448461294 loss_collision: 0.003538600169122219 loss_jerk: 0.018777035176753998 loss_floor_contact: 0.006146462634205818
[50/100] loss: 0.00626086862757802 loss_joints: 0.0035126390866935253 loss_collision: 0.0018571318360045552 loss_jerk: 0.018744003027677536 loss_floor_contact: 0.006881160195916891
[51/100] loss: 0.00609989557415247 loss_joints: 0.0034559189807623625 loss_collision: 0.0008629114017821848 loss_jerk: 0.01870199292898178 loss_floor_contact: 0.006874857936054468
[52/100] loss: 0.006039031315594912 loss_joints: 0.0033921259455382824 loss_collision: 0.0006421868456527591 loss_jerk: 0.01875508949160576 loss_floor_contact: 0.007071777246892452
[53/100] loss: 0.005971276666969061 loss_joints: 0.003327607875689864 loss_collision: 0.0 loss_jerk: 0.018763506785035133 loss_floor_contact: 0.007673180662095547
[54/100] loss: 0.005919044371694326 loss_joints: 0.003260793862864375 loss_collision: 0.0 loss_jerk: 0.01873841881752014 loss_floor_contact: 0.007844088599085808
[55/100] loss: 0.005842533893883228 loss_joints: 0.0031866137869656086 loss_collision: 0.0 loss_jerk: 0.018705949187278748 loss_floor_contact: 0.0078532500192523
[56/100] loss: 0.005727927666157484 loss_joints: 0.003115065163001418 loss_collision: 0.0 loss_jerk: 0.018651828169822693 loss_floor_contact: 0.007476797793060541
[57/100] loss: 0.005783545318990946 loss_joints: 0.003064132062718272 loss_collision: 0.001090899109840393 loss_jerk: 0.018574079498648643 loss_floor_contact: 0.007529151625931263
[58/100] loss: 0.005688115954399109 loss_joints: 0.0030138399451971054 loss_collision: 0.0008895184728316963 loss_jerk: 0.018461449071764946 loss_floor_contact: 0.0073917945846915245
[59/100] loss: 0.005817238241434097 loss_joints: 0.002986469306051731 loss_collision: 0.0017787304241210222 loss_jerk: 0.01945437118411064 loss_floor_contact: 0.007074585650116205
[60/100] loss: 0.005813553463667631 loss_joints: 0.0029578653629869223 loss_collision: 0.0018757986836135387 loss_jerk: 0.01975676603615284 loss_floor_contact: 0.006924312561750412
[61/100] loss: 0.005746918730437756 loss_joints: 0.0029190033674240112 loss_collision: 0.0018131159013137221 loss_jerk: 0.019535191357135773 loss_floor_contact: 0.006930844392627478
[62/100] loss: 0.005611098371446133 loss_joints: 0.002870929194614291 loss_collision: 0.0016893191495910287 loss_jerk: 0.018872303888201714 loss_floor_contact: 0.006840069312602282
[63/100] loss: 0.00548399006947875 loss_joints: 0.0028203832916915417 loss_collision: 0.0014736078446730971 loss_jerk: 0.018435118719935417 loss_floor_contact: 0.006727338302880526
[64/100] loss: 0.005389345344156027 loss_joints: 0.002770117949694395 loss_collision: 0.0015848450129851699 loss_jerk: 0.01844911091029644 loss_floor_contact: 0.0061583202332258224
[65/100] loss: 0.005367117002606392 loss_joints: 0.002738457638770342 loss_collision: 0.0018922389717772603 loss_jerk: 0.018446149304509163 loss_floor_contact: 0.005948209203779697
[66/100] loss: 0.005340671166777611 loss_joints: 0.002712532412260771 loss_collision: 0.0017677397700026631 loss_jerk: 0.018434759229421616 loss_floor_contact: 0.006078893318772316
[67/100] loss: 0.005279856268316507 loss_joints: 0.002689434215426445 loss_collision: 0.001668908866122365 loss_jerk: 0.0184186864644289 loss_floor_contact: 0.005816626828163862
[68/100] loss: 0.005259344354271889 loss_joints: 0.0026714252308011055 loss_collision: 0.0016283307923004031 loss_jerk: 0.01839664950966835 loss_floor_contact: 0.005854212213307619
[69/100] loss: 0.005277258809655905 loss_joints: 0.002659485675394535 loss_collision: 0.0016720189014449716 loss_jerk: 0.018365856260061264 loss_floor_contact: 0.006139855366200209
[70/100] loss: 0.005275989882647991 loss_joints: 0.002633177675306797 loss_collision: 0.0017927609151229262 loss_jerk: 0.018333008512854576 loss_floor_contact: 0.006302354857325554
[71/100] loss: 0.0052621029317379 loss_joints: 0.002589333336800337 loss_collision: 0.0018502325983718038 loss_jerk: 0.01861722208559513 loss_floor_contact: 0.006260237656533718
[72/100] loss: 0.005245252046734095 loss_joints: 0.0025466294027864933 loss_collision: 0.0018566102953627706 loss_jerk: 0.01863388903439045 loss_floor_contact: 0.006495727226138115
[73/100] loss: 0.005097127985209227 loss_joints: 0.0025058561004698277 loss_collision: 0.0016646492294967175 loss_jerk: 0.018294863402843475 loss_floor_contact: 0.0059532057493925095
[74/100] loss: 0.005012841429561377 loss_joints: 0.0024646571837365627 loss_collision: 0.0019261965062469244 loss_jerk: 0.01825241558253765 loss_floor_contact: 0.005303230602294207
[75/100] loss: 0.004986617248505354 loss_joints: 0.002425666432827711 loss_collision: 0.0020084530115127563 loss_jerk: 0.018241984769701958 loss_floor_contact: 0.005359068978577852
[76/100] loss: 0.00499638170003891 loss_joints: 0.0024012462235987186 loss_collision: 0.0024040001444518566 loss_jerk: 0.018230624496936798 loss_floor_contact: 0.005316727329045534
[77/100] loss: 0.004987179301679134 loss_joints: 0.0023818640038371086 loss_collision: 0.0026057236827909946 loss_jerk: 0.01821853034198284 loss_floor_contact: 0.0052288975566625595
[78/100] loss: 0.004935369826853275 loss_joints: 0.0023656568955630064 loss_collision: 0.002147167921066284 loss_jerk: 0.01820557191967964 loss_floor_contact: 0.005344392266124487
[79/100] loss: 0.004854482598602772 loss_joints: 0.002355832839384675 loss_collision: 0.0017512632766738534 loss_jerk: 0.01819363236427307 loss_floor_contact: 0.005041603930294514
[80/100] loss: 0.004827246069908142 loss_joints: 0.002342626452445984 loss_collision: 0.001953563652932644 loss_jerk: 0.018179820850491524 loss_floor_contact: 0.004712815862149
[81/100] loss: 0.0047835614532232285 loss_joints: 0.00232502818107605 loss_collision: 0.0018494066316634417 loss_jerk: 0.01816515065729618 loss_floor_contact: 0.004570771940052509
[82/100] loss: 0.0048247394151985645 loss_joints: 0.0023053931072354317 loss_collision: 0.0020250254310667515 loss_jerk: 0.01814952678978443 loss_floor_contact: 0.005018909461796284
[83/100] loss: 0.004795089364051819 loss_joints: 0.0022916938178241253 loss_collision: 0.0020389684941619635 loss_jerk: 0.018136028200387955 loss_floor_contact: 0.004858961328864098
[84/100] loss: 0.004769613966345787 loss_joints: 0.002281929599121213 loss_collision: 0.0018111532554030418 loss_jerk: 0.018124688416719437 loss_floor_contact: 0.004941000137478113
[85/100] loss: 0.004742974881082773 loss_joints: 0.0022763963788747787 loss_collision: 0.0017298141028732061 loss_jerk: 0.018114278092980385 loss_floor_contact: 0.004821691196411848
[86/100] loss: 0.004736678209155798 loss_joints: 0.00226794951595366 loss_collision: 0.0017746133962646127 loss_jerk: 0.01810462214052677 loss_floor_contact: 0.004808048717677593
[87/100] loss: 0.004708297085016966 loss_joints: 0.0022565042600035667 loss_collision: 0.001869665808044374 loss_jerk: 0.018095269799232483 loss_floor_contact: 0.004552993457764387
[88/100] loss: 0.004684236831963062 loss_joints: 0.0022435139399021864 loss_collision: 0.00165276019833982 loss_jerk: 0.018087638542056084 loss_floor_contact: 0.004666829481720924
[89/100] loss: 0.004705047234892845 loss_joints: 0.0022308710031211376 loss_collision: 0.002017442835494876 loss_jerk: 0.01808260753750801 loss_floor_contact: 0.004641711711883545
[90/100] loss: 0.004636422265321016 loss_joints: 0.002221906092017889 loss_collision: 0.0005138154956512153 loss_jerk: 0.018093472346663475 loss_floor_contact: 0.005537872668355703
[91/100] loss: 0.004636453930288553 loss_joints: 0.0022149160504341125 loss_collision: 0.000535647792275995 loss_jerk: 0.018099717795848846 loss_floor_contact: 0.0055800145491957664
[92/100] loss: 0.004699901677668095 loss_joints: 0.0022094985470175743 loss_collision: 0.00205230712890625 loss_jerk: 0.018103070557117462 loss_floor_contact: 0.00474865548312664
[93/100] loss: 0.0046434407122433186 loss_joints: 0.0022058780305087566 loss_collision: 0.0018557077273726463 loss_jerk: 0.018106095492839813 loss_floor_contact: 0.00441382173448801
[94/100] loss: 0.004620084539055824 loss_joints: 0.00220414693467319 loss_collision: 0.0017208330100402236 loss_jerk: 0.018109824508428574 loss_floor_contact: 0.004328716546297073
[95/100] loss: 0.004569340031594038 loss_joints: 0.0022014242131263018 loss_collision: 0.00011595445539569482 loss_jerk: 0.018113449215888977 loss_floor_contact: 0.005449754185974598
[96/100] loss: 0.004565907642245293 loss_joints: 0.0021978504955768585 loss_collision: 1.5420573618030176e-05 loss_jerk: 0.018114427104592323 loss_floor_contact: 0.00555072259157896
[97/100] loss: 0.004547870717942715 loss_joints: 0.002194681903347373 loss_collision: 0.00017524191935081035 loss_jerk: 0.018109917640686035 loss_floor_contact: 0.005246727727353573
[98/100] loss: 0.004574399441480637 loss_joints: 0.002191614592447877 loss_collision: 0.0013602334074676037 loss_jerk: 0.01810544729232788 loss_floor_contact: 0.004362165462225676
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-7.png]
[99/100] loss: 0.004535929299890995 loss_joints: 0.002189153805375099 loss_collision: 3.3636180887697265e-05 loss_jerk: 0.018103783950209618 loss_floor_contact: 0.005330333020538092
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path3-walk6-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 263.00762                                                    ║
    ║     rollout = 114.91323                                                    ║
    ║     sdf     = 23.95159                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00453593                                                 ║
    ║     joints    = 0.00218915                                                 ║
    ║     collision = 0.00003364                                                 ║
    ║     jerk      = 0.01810378                                                 ║
    ║     floor     = 0.00533033                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	4m43.831s
user	4m6.942s
sys	0m15.301s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x5b382c3cec00] using SAR=1/1
[libx264 @ 0x5b382c3cec00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x5b382c3cec00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x5b382c3cec00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_walk_6.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x5b382c3ccfc0] video:184kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.621901%
frame=   25 fps=0.0 q=-1.0 Lsize=     185kB time=00:00:02.20 bitrate= 687.8kbits/s speed=3.34x    
[libx264 @ 0x5b382c3cec00] frame I:1     Avg QP:17.78  size: 68351
[libx264 @ 0x5b382c3cec00] frame P:8     Avg QP:20.86  size: 10287
[libx264 @ 0x5b382c3cec00] frame B:16    Avg QP:21.91  size:  2290
[libx264 @ 0x5b382c3cec00] consecutive B-frames:  8.0% 16.0% 12.0% 64.0%
[libx264 @ 0x5b382c3cec00] mb I  I16..4:  5.7% 65.9% 28.4%
[libx264 @ 0x5b382c3cec00] mb P  I16..4:  0.2%  1.8%  1.7%  P16..4: 10.4%  2.2%  1.6%  0.0%  0.0%    skip:82.2%
[libx264 @ 0x5b382c3cec00] mb B  I16..4:  0.1%  0.5%  0.2%  B16..8: 10.1%  1.0%  0.3%  direct: 1.1%  skip:86.7%  L0:49.2% L1:46.5% BI: 4.3%
[libx264 @ 0x5b382c3cec00] 8x8 transform intra:62.2% inter:60.8%
[libx264 @ 0x5b382c3cec00] coded y,uvDC,uvAC intra: 31.2% 20.6% 19.4% inter: 3.5% 4.0% 1.4%
[libx264 @ 0x5b382c3cec00] i16 v,h,dc,p: 65% 19% 16%  0%
[libx264 @ 0x5b382c3cec00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 49%  9% 35%  1%  1%  2%  1%  2%  1%
[libx264 @ 0x5b382c3cec00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 34% 23% 14%  5%  4%  4%  4%  9%  3%
[libx264 @ 0x5b382c3cec00] i8c dc,h,v,p: 89%  3%  6%  2%
[libx264 @ 0x5b382c3cec00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x5b382c3cec00] ref P L0: 51.4%  9.2% 25.5% 13.9%
[libx264 @ 0x5b382c3cec00] ref B L0: 75.9% 19.2%  4.9%
[libx264 @ 0x5b382c3cec00] ref B L1: 97.4%  2.6%
[libx264 @ 0x5b382c3cec00] kb/s:599.31
[INFO] Video saved as 'bin/result/optim_walk_6.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:14<23:55, 14.50s/it]  2%|▏         | 2/100 [00:19<14:32,  8.91s/it]  3%|▎         | 3/100 [00:25<11:58,  7.41s/it]  4%|▍         | 4/100 [00:29<09:59,  6.25s/it]  5%|▌         | 5/100 [00:34<09:05,  5.74s/it]  6%|▌         | 6/100 [00:39<08:33,  5.46s/it]  7%|▋         | 7/100 [00:44<08:03,  5.20s/it]  8%|▊         | 8/100 [00:48<07:45,  5.06s/it]  9%|▉         | 9/100 [00:53<07:41,  5.07s/it] 10%|█         | 10/100 [00:58<07:35,  5.06s/it] 11%|█         | 11/100 [01:03<07:24,  5.00s/it] 12%|█▏        | 12/100 [01:08<07:11,  4.91s/it] 13%|█▎        | 13/100 [01:13<07:03,  4.86s/it] 14%|█▍        | 14/100 [01:17<06:55,  4.83s/it] 15%|█▌        | 15/100 [01:22<06:47,  4.80s/it] 16%|█▌        | 16/100 [01:27<06:38,  4.74s/it] 17%|█▋        | 17/100 [01:32<06:43,  4.86s/it] 18%|█▊        | 18/100 [01:37<06:35,  4.82s/it] 19%|█▉        | 19/100 [01:41<06:26,  4.77s/it] 20%|██        | 20/100 [01:46<06:25,  4.81s/it] 21%|██        | 21/100 [01:51<06:18,  4.79s/it] 22%|██▏       | 22/100 [01:56<06:12,  4.78s/it] 23%|██▎       | 23/100 [02:01<06:08,  4.78s/it] 24%|██▍       | 24/100 [02:06<06:13,  4.92s/it] 25%|██▌       | 25/100 [02:10<06:00,  4.81s/it] 26%|██▌       | 26/100 [02:15<05:52,  4.77s/it] 27%|██▋       | 27/100 [02:20<05:57,  4.89s/it] 28%|██▊       | 28/100 [02:25<05:48,  4.84s/it] 29%|██▉       | 29/100 [02:30<05:42,  4.82s/it] 30%|███       | 30/100 [02:35<05:50,  5.01s/it] 31%|███       | 31/100 [02:40<05:35,  4.86s/it] 32%|███▏      | 32/100 [02:44<05:24,  4.78s/it] 33%|███▎      | 33/100 [02:49<05:29,  4.92s/it] 34%|███▍      | 34/100 [02:55<05:28,  4.98s/it] 35%|███▌      | 35/100 [03:00<05:25,  5.01s/it] 36%|███▌      | 36/100 [03:05<05:21,  5.02s/it] 37%|███▋      | 37/100 [03:09<05:09,  4.91s/it] 38%|███▊      | 38/100 [03:14<04:58,  4.81s/it] 39%|███▉      | 39/100 [03:19<04:57,  4.88s/it] 40%|████      | 40/100 [03:24<04:59,  4.99s/it] 41%|████      | 41/100 [03:29<04:51,  4.94s/it] 42%|████▏     | 42/100 [03:34<04:45,  4.92s/it] 43%|████▎     | 43/100 [03:39<04:36,  4.86s/it] 44%|████▍     | 44/100 [03:43<04:26,  4.76s/it] 45%|████▌     | 45/100 [03:48<04:18,  4.69s/it] 46%|████▌     | 46/100 [03:53<04:20,  4.83s/it] 47%|████▋     | 47/100 [03:57<04:12,  4.76s/it] 48%|████▊     | 48/100 [04:02<04:09,  4.80s/it] 49%|████▉     | 49/100 [04:08<04:15,  5.01s/it] 50%|█████     | 50/100 [04:12<04:02,  4.85s/it] 51%|█████     | 51/100 [04:17<03:56,  4.84s/it] 52%|█████▏    | 52/100 [04:22<03:55,  4.91s/it] 53%|█████▎    | 53/100 [04:27<03:48,  4.86s/it] 54%|█████▍    | 54/100 [04:32<03:45,  4.90s/it] 55%|█████▌    | 55/100 [04:37<03:44,  4.99s/it] 56%|█████▌    | 56/100 [04:42<03:38,  4.96s/it] 57%|█████▋    | 57/100 [04:47<03:34,  4.98s/it] 58%|█████▊    | 58/100 [04:53<03:42,  5.29s/it] 59%|█████▉    | 59/100 [04:58<03:31,  5.16s/it] 60%|██████    | 60/100 [05:03<03:19,  5.00s/it] 61%|██████    | 61/100 [05:07<03:13,  4.95s/it] 62%|██████▏   | 62/100 [05:12<03:05,  4.87s/it] 63%|██████▎   | 63/100 [05:17<03:00,  4.87s/it] 64%|██████▍   | 64/100 [05:22<02:57,  4.94s/it] 65%|██████▌   | 65/100 [05:27<02:48,  4.82s/it] 66%|██████▌   | 66/100 [05:31<02:44,  4.83s/it] 67%|██████▋   | 67/100 [05:36<02:38,  4.80s/it] 68%|██████▊   | 68/100 [05:41<02:34,  4.82s/it] 69%|██████▉   | 69/100 [05:46<02:30,  4.87s/it] 70%|███████   | 70/100 [05:51<02:23,  4.77s/it] 71%|███████   | 71/100 [05:55<02:17,  4.75s/it] 72%|███████▏  | 72/100 [06:00<02:11,  4.70s/it] 73%|███████▎  | 73/100 [06:05<02:07,  4.71s/it] 74%|███████▍  | 74/100 [06:09<02:01,  4.69s/it] 75%|███████▌  | 75/100 [06:14<01:56,  4.65s/it] 76%|███████▌  | 76/100 [06:19<01:56,  4.85s/it] 77%|███████▋  | 77/100 [06:24<01:53,  4.91s/it] 78%|███████▊  | 78/100 [06:29<01:48,  4.94s/it] 79%|███████▉  | 79/100 [06:34<01:44,  4.96s/it] 80%|████████  | 80/100 [06:39<01:38,  4.93s/it] 81%|████████  | 81/100 [06:44<01:32,  4.89s/it] 82%|████████▏ | 82/100 [06:48<01:26,  4.83s/it] 83%|████████▎ | 83/100 [06:53<01:21,  4.77s/it] 84%|████████▍ | 84/100 [06:58<01:16,  4.79s/it] 85%|████████▌ | 85/100 [07:03<01:11,  4.77s/it] 86%|████████▌ | 86/100 [07:07<01:06,  4.77s/it] 87%|████████▋ | 87/100 [07:13<01:03,  4.86s/it] 88%|████████▊ | 88/100 [07:17<00:57,  4.82s/it] 89%|████████▉ | 89/100 [07:22<00:53,  4.89s/it] 90%|█████████ | 90/100 [07:27<00:48,  4.88s/it] 91%|█████████ | 91/100 [07:32<00:44,  4.91s/it] 92%|█████████▏| 92/100 [07:37<00:39,  4.89s/it] 93%|█████████▎| 93/100 [07:42<00:33,  4.85s/it] 94%|█████████▍| 94/100 [07:47<00:29,  4.91s/it] 95%|█████████▌| 95/100 [07:52<00:24,  4.97s/it] 96%|█████████▌| 96/100 [07:57<00:19,  4.87s/it] 97%|█████████▋| 97/100 [08:02<00:14,  4.91s/it] 98%|█████████▊| 98/100 [08:06<00:09,  4.82s/it] 99%|█████████▉| 99/100 [08:11<00:04,  4.70s/it]100%|██████████| 100/100 [08:25<00:00,  7.54s/it]100%|██████████| 100/100 [08:25<00:00,  5.05s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-13.png]
[0/100] loss: 0.01922011561691761 loss_joints: 0.017129262909293175 loss_collision: 0.0 loss_jerk: 0.015773849561810493 loss_floor_contact: 0.0051346877589821815
[1/100] loss: 0.010162485763430595 loss_joints: 0.007943658158183098 loss_collision: 0.0011321615893393755 loss_jerk: 0.016344983130693436 loss_floor_contact: 0.00471113296225667
[2/100] loss: 0.008453992195427418 loss_joints: 0.006391001399606466 loss_collision: 0.00013426519581116736 loss_jerk: 0.01582108996808529 loss_floor_contact: 0.004674549680203199
[3/100] loss: 0.00715536717325449 loss_joints: 0.005066037643700838 loss_collision: 0.0 loss_jerk: 0.015735747292637825 loss_floor_contact: 0.005157546605914831
[4/100] loss: 0.007021606899797916 loss_joints: 0.004921230487525463 loss_collision: 0.0 loss_jerk: 0.015681980177760124 loss_floor_contact: 0.005321783944964409
[5/100] loss: 0.006741269491612911 loss_joints: 0.004642906598746777 loss_collision: 0.00011820976942544803 loss_jerk: 0.015649547800421715 loss_floor_contact: 0.005215873476117849
[6/100] loss: 0.006581095978617668 loss_joints: 0.004489116370677948 loss_collision: 3.0149634767440148e-05 loss_jerk: 0.015602443367242813 loss_floor_contact: 0.0052872016094625
[7/100] loss: 0.006263602990657091 loss_joints: 0.004290821496397257 loss_collision: 0.0 loss_jerk: 0.01554921269416809 loss_floor_contact: 0.004178603179752827
[8/100] loss: 0.0060370201244950294 loss_joints: 0.004049902781844139 loss_collision: 0.0002514433581382036 loss_jerk: 0.01550094224512577 loss_floor_contact: 0.004118788056075573
[9/100] loss: 0.00619620643556118 loss_joints: 0.004114854149520397 loss_collision: 0.0002750204293988645 loss_jerk: 0.016282638534903526 loss_floor_contact: 0.004255867097526789
[10/100] loss: 0.005907607730478048 loss_joints: 0.003773678559809923 loss_collision: 0.0005698789027519524 loss_jerk: 0.016268249601125717 loss_floor_contact: 0.004501160699874163
[11/100] loss: 0.005993238650262356 loss_joints: 0.004037484526634216 loss_collision: 0.0 loss_jerk: 0.0153784966096282 loss_floor_contact: 0.004179046954959631
[12/100] loss: 0.005943527910858393 loss_joints: 0.004097404424101114 loss_collision: 0.0 loss_jerk: 0.015348805114626884 loss_floor_contact: 0.003112426958978176
[13/100] loss: 0.0054520731791853905 loss_joints: 0.0035281158052384853 loss_collision: 0.0 loss_jerk: 0.015340350568294525 loss_floor_contact: 0.0038992236368358135
[14/100] loss: 0.005608062259852886 loss_joints: 0.0036245430819690228 loss_collision: 0.0 loss_jerk: 0.015343481674790382 loss_floor_contact: 0.00449170870706439
[15/100] loss: 0.005895189009606838 loss_joints: 0.0039000220131129026 loss_collision: 0.0 loss_jerk: 0.015328950248658657 loss_floor_contact: 0.004622721113264561
[16/100] loss: 0.005482410080730915 loss_joints: 0.0035411061253398657 loss_collision: 0.0 loss_jerk: 0.015301832929253578 loss_floor_contact: 0.00411120755597949
[17/100] loss: 0.005314810201525688 loss_joints: 0.0032880729995667934 loss_collision: 0.000655605283100158 loss_jerk: 0.015262721106410027 loss_floor_contact: 0.004349042661488056
[18/100] loss: 0.0053366851061582565 loss_joints: 0.003385885152965784 loss_collision: 0.00060431775636971 loss_jerk: 0.015237037092447281 loss_floor_contact: 0.0036666463129222393
[19/100] loss: 0.0050782011821866035 loss_joints: 0.003176318248733878 loss_collision: 0.0 loss_jerk: 0.01522126141935587 loss_floor_contact: 0.0037975714076310396
[20/100] loss: 0.005193665623664856 loss_joints: 0.003274161834269762 loss_collision: 0.0 loss_jerk: 0.015215703286230564 loss_floor_contact: 0.003979334607720375
[21/100] loss: 0.005237990990281105 loss_joints: 0.0033567564096301794 loss_collision: 0.0 loss_jerk: 0.015197074972093105 loss_floor_contact: 0.003615274094045162
[22/100] loss: 0.005096485838294029 loss_joints: 0.0031124732922762632 loss_collision: 0.0 loss_jerk: 0.015401958487927914 loss_floor_contact: 0.004438165575265884
[23/100] loss: 0.005173834040760994 loss_joints: 0.00313530839048326 loss_collision: 0.0005329354899004102 loss_jerk: 0.015508737415075302 loss_floor_contact: 0.0043435851112008095
[24/100] loss: 0.005268366076052189 loss_joints: 0.003207516623660922 loss_collision: 0.0 loss_jerk: 0.015351193957030773 loss_floor_contact: 0.0052573042921721935
[25/100] loss: 0.004941150080412626 loss_joints: 0.002978087402880192 loss_collision: 0.0 loss_jerk: 0.015092294663190842 loss_floor_contact: 0.004538330715149641
[26/100] loss: 0.0047779264859855175 loss_joints: 0.0029077341314405203 loss_collision: 0.0 loss_jerk: 0.015082103200256824 loss_floor_contact: 0.003619823371991515
[27/100] loss: 0.0048171840608119965 loss_joints: 0.002935667522251606 loss_collision: 0.0 loss_jerk: 0.015060595236718655 loss_floor_contact: 0.0037545734085142612
[28/100] loss: 0.00486769201233983 loss_joints: 0.002864902839064598 loss_collision: 0.0 loss_jerk: 0.015029247850179672 loss_floor_contact: 0.004998643882572651
[29/100] loss: 0.004868163261562586 loss_joints: 0.0028897025622427464 loss_collision: 0.0 loss_jerk: 0.014988118782639503 loss_floor_contact: 0.004796488676220179
[30/100] loss: 0.004883524030447006 loss_joints: 0.0028949244879186153 loss_collision: 0.0 loss_jerk: 0.014959110878407955 loss_floor_contact: 0.004926883615553379
[31/100] loss: 0.004681890830397606 loss_joints: 0.002749632578343153 loss_collision: 0.0 loss_jerk: 0.014941374771296978 loss_floor_contact: 0.00438120448961854
[32/100] loss: 0.00466845091432333 loss_joints: 0.002770189894363284 loss_collision: 0.0 loss_jerk: 0.014928457327187061 loss_floor_contact: 0.004054151941090822
[33/100] loss: 0.0048016514629125595 loss_joints: 0.002813231199979782 loss_collision: 0.0 loss_jerk: 0.014903978444635868 loss_floor_contact: 0.004980223253369331
[34/100] loss: 0.00463135726749897 loss_joints: 0.0026692429091781378 loss_collision: 0.0 loss_jerk: 0.014972526580095291 loss_floor_contact: 0.004648617003113031
[35/100] loss: 0.004554294049739838 loss_joints: 0.0025762170553207397 loss_collision: 0.0 loss_jerk: 0.015232855454087257 loss_floor_contact: 0.0045479158870875835
[36/100] loss: 0.004585476126521826 loss_joints: 0.0025781102012842894 loss_collision: 0.0 loss_jerk: 0.015141735784709454 loss_floor_contact: 0.004931926727294922
[37/100] loss: 0.004498481284826994 loss_joints: 0.002514324150979519 loss_collision: 0.0 loss_jerk: 0.014794377610087395 loss_floor_contact: 0.005047193728387356
[38/100] loss: 0.0044397469609975815 loss_joints: 0.002485601231455803 loss_collision: 0.0 loss_jerk: 0.014769612811505795 loss_floor_contact: 0.004771843086928129
[39/100] loss: 0.0044929576106369495 loss_joints: 0.0024729599244892597 loss_collision: 0.0 loss_jerk: 0.014750366099178791 loss_floor_contact: 0.005449609365314245
[40/100] loss: 0.004408069886267185 loss_joints: 0.0024339533410966396 loss_collision: 0.0 loss_jerk: 0.014722141437232494 loss_floor_contact: 0.005019025411456823
[41/100] loss: 0.00443293945863843 loss_joints: 0.002408816944807768 loss_collision: 0.0 loss_jerk: 0.014680069871246815 loss_floor_contact: 0.005561157129704952
[42/100] loss: 0.0044240765273571014 loss_joints: 0.002372926566749811 loss_collision: 0.0 loss_jerk: 0.014648116193711758 loss_floor_contact: 0.0058633857406675816
[43/100] loss: 0.004308316856622696 loss_joints: 0.002318751299753785 loss_collision: 0.0 loss_jerk: 0.014625264331698418 loss_floor_contact: 0.0052703930996358395
[44/100] loss: 0.004292968660593033 loss_joints: 0.002279960550367832 loss_collision: 0.0 loss_jerk: 0.014594960026443005 loss_floor_contact: 0.005535120144486427
[45/100] loss: 0.004287385381758213 loss_joints: 0.00227344105951488 loss_collision: 0.0 loss_jerk: 0.014555975794792175 loss_floor_contact: 0.005583465099334717
[46/100] loss: 0.004324156325310469 loss_joints: 0.0022839843295514584 loss_collision: 0.0 loss_jerk: 0.0146023565903306 loss_floor_contact: 0.005799362435936928
[47/100] loss: 0.004278780892491341 loss_joints: 0.002215222455561161 loss_collision: 0.0 loss_jerk: 0.014564153738319874 loss_floor_contact: 0.0060714296996593475
[48/100] loss: 0.004181576427072287 loss_joints: 0.0021610783878713846 loss_collision: 0.0 loss_jerk: 0.014471130445599556 loss_floor_contact: 0.0057338522747159
[49/100] loss: 0.004231331869959831 loss_joints: 0.0021478307899087667 loss_collision: 0.0 loss_jerk: 0.0144467419013381 loss_floor_contact: 0.006388265639543533
[50/100] loss: 0.0041090683080255985 loss_joints: 0.002099828328937292 loss_collision: 0.0 loss_jerk: 0.014416659250855446 loss_floor_contact: 0.005675742402672768
[51/100] loss: 0.0041689821518957615 loss_joints: 0.0020739196334034204 loss_collision: 0.0 loss_jerk: 0.01446642354130745 loss_floor_contact: 0.00648420350626111
[52/100] loss: 0.00407404312863946 loss_joints: 0.0020342892967164516 loss_collision: 0.0 loss_jerk: 0.014576882123947144 loss_floor_contact: 0.005820656195282936
[53/100] loss: 0.004121377598494291 loss_joints: 0.002036229008808732 loss_collision: 0.0 loss_jerk: 0.014593688771128654 loss_floor_contact: 0.0062577985227108
[54/100] loss: 0.0041075702756643295 loss_joints: 0.0020463326945900917 loss_collision: 0.0 loss_jerk: 0.014645128510892391 loss_floor_contact: 0.005967248696833849
[55/100] loss: 0.004097455646842718 loss_joints: 0.001988279866054654 loss_collision: 0.0 loss_jerk: 0.01469267439097166 loss_floor_contact: 0.006399083416908979
[56/100] loss: 0.004064623732119799 loss_joints: 0.0019487915560603142 loss_collision: 0.0 loss_jerk: 0.014879445545375347 loss_floor_contact: 0.0062788729555904865
[57/100] loss: 0.004144907463341951 loss_joints: 0.002092956565320492 loss_collision: 0.0 loss_jerk: 0.014948207885026932 loss_floor_contact: 0.005571300163865089
[58/100] loss: 0.004334650933742523 loss_joints: 0.0022039636969566345 loss_collision: 0.0 loss_jerk: 0.01489456370472908 loss_floor_contact: 0.00641231145709753
[59/100] loss: 0.004243032541126013 loss_joints: 0.0021474258974194527 loss_collision: 0.0 loss_jerk: 0.014838345348834991 loss_floor_contact: 0.006117720156908035
[60/100] loss: 0.004036729224026203 loss_joints: 0.0019813282415270805 loss_collision: 0.0 loss_jerk: 0.014823012053966522 loss_floor_contact: 0.005730998236685991
[61/100] loss: 0.0038844002410769463 loss_joints: 0.001867080805823207 loss_collision: 0.0 loss_jerk: 0.014768877997994423 loss_floor_contact: 0.005404316820204258
[62/100] loss: 0.0041626994498074055 loss_joints: 0.0020020899828523397 loss_collision: 0.0 loss_jerk: 0.014676126651465893 loss_floor_contact: 0.006929965689778328
[63/100] loss: 0.00421665795147419 loss_joints: 0.0021969196386635303 loss_collision: 0.0 loss_jerk: 0.014556408859789371 loss_floor_contact: 0.0056409756653010845
[64/100] loss: 0.004564961418509483 loss_joints: 0.0024062751326709986 loss_collision: 0.0 loss_jerk: 0.014563611708581448 loss_floor_contact: 0.007023252081125975
[65/100] loss: 0.004528944380581379 loss_joints: 0.002408653497695923 loss_collision: 0.0 loss_jerk: 0.014563790522515774 loss_floor_contact: 0.006639120168983936
[66/100] loss: 0.004329331684857607 loss_joints: 0.0022415220737457275 loss_collision: 0.0 loss_jerk: 0.014558851718902588 loss_floor_contact: 0.006319240666925907
[67/100] loss: 0.004076029174029827 loss_joints: 0.0020256713032722473 loss_collision: 0.0 loss_jerk: 0.014526369981467724 loss_floor_contact: 0.0059772091917693615
[68/100] loss: 0.003921528812497854 loss_joints: 0.0019057083409279585 loss_collision: 0.0 loss_jerk: 0.014476536773145199 loss_floor_contact: 0.005681667476892471
[69/100] loss: 0.003973160870373249 loss_joints: 0.0019420043099671602 loss_collision: 0.0 loss_jerk: 0.014250023290514946 loss_floor_contact: 0.006061538588255644
[70/100] loss: 0.0041564591228961945 loss_joints: 0.002055729739367962 loss_collision: 0.0 loss_jerk: 0.014208911918103695 loss_floor_contact: 0.006798378191888332
[71/100] loss: 0.004196817986667156 loss_joints: 0.002079706871882081 loss_collision: 0.0 loss_jerk: 0.014199796132743359 loss_floor_contact: 0.006971315015107393
[72/100] loss: 0.004053422249853611 loss_joints: 0.002001421758905053 loss_collision: 0.0 loss_jerk: 0.01417320966720581 loss_floor_contact: 0.006346798036247492
[73/100] loss: 0.0039432658813893795 loss_joints: 0.0018785821739584208 loss_collision: 0.0 loss_jerk: 0.014172129333019257 loss_floor_contact: 0.006474708206951618
[74/100] loss: 0.0038692117668688297 loss_joints: 0.00179301667958498 loss_collision: 0.0 loss_jerk: 0.014172139577567577 loss_floor_contact: 0.006589809898287058
[75/100] loss: 0.0038504714611917734 loss_joints: 0.00182667700573802 loss_collision: 0.0 loss_jerk: 0.014173384755849838 loss_floor_contact: 0.006064561195671558
[76/100] loss: 0.0038531499449163675 loss_joints: 0.0018983159679919481 loss_collision: 0.0 loss_jerk: 0.014170532114803791 loss_floor_contact: 0.005377808585762978
[77/100] loss: 0.003970055840909481 loss_joints: 0.00192844623234123 loss_collision: 0.0 loss_jerk: 0.01416383869946003 loss_floor_contact: 0.006252258084714413
[78/100] loss: 0.004008852411061525 loss_joints: 0.001944985706359148 loss_collision: 0.0 loss_jerk: 0.014158835634589195 loss_floor_contact: 0.006479831878095865
[79/100] loss: 0.0039043494034558535 loss_joints: 0.0019488940015435219 loss_collision: 0.0 loss_jerk: 0.01415441744029522 loss_floor_contact: 0.005400137044489384
[80/100] loss: 0.003989737015217543 loss_joints: 0.001955304993316531 loss_collision: 0.0 loss_jerk: 0.014151503331959248 loss_floor_contact: 0.00619281642138958
[81/100] loss: 0.003976536449044943 loss_joints: 0.0019017322920262814 loss_collision: 0.0 loss_jerk: 0.014144495129585266 loss_floor_contact: 0.006603545509278774
[82/100] loss: 0.003889084793627262 loss_joints: 0.0018238702323287725 loss_collision: 0.0 loss_jerk: 0.01413405779749155 loss_floor_contact: 0.006518089212477207
[83/100] loss: 0.0038213704247027636 loss_joints: 0.001762734609656036 loss_collision: 0.0 loss_jerk: 0.01412036083638668 loss_floor_contact: 0.006465997081249952
[84/100] loss: 0.003889655228704214 loss_joints: 0.0017472654581069946 loss_collision: 0.0 loss_jerk: 0.014103143475949764 loss_floor_contact: 0.007320755161345005
[85/100] loss: 0.003808568464592099 loss_joints: 0.0017883384134620428 loss_collision: 0.0 loss_jerk: 0.01409255899488926 loss_floor_contact: 0.0061097415164113045
[86/100] loss: 0.0038461205549538136 loss_joints: 0.0018330806633457541 loss_collision: 0.0 loss_jerk: 0.014109443873167038 loss_floor_contact: 0.006020954344421625
[87/100] loss: 0.0038905709516257048 loss_joints: 0.001846217317506671 loss_collision: 0.0 loss_jerk: 0.01410983968526125 loss_floor_contact: 0.006333695724606514
[88/100] loss: 0.003840543096885085 loss_joints: 0.0018251261208206415 loss_collision: 0.0 loss_jerk: 0.014097440987825394 loss_floor_contact: 0.006056727841496468
[89/100] loss: 0.0037832583766430616 loss_joints: 0.0017823544330894947 loss_collision: 0.0 loss_jerk: 0.014090397395193577 loss_floor_contact: 0.005918641109019518
[90/100] loss: 0.0037223268300294876 loss_joints: 0.0017369950655847788 loss_collision: 0.0 loss_jerk: 0.014062467031180859 loss_floor_contact: 0.005790851078927517
[91/100] loss: 0.003715438535436988 loss_joints: 0.0017082113772630692 loss_collision: 0.0 loss_jerk: 0.014050773344933987 loss_floor_contact: 0.006021495908498764
[92/100] loss: 0.0036918786354362965 loss_joints: 0.0016956216422840953 loss_collision: 0.0 loss_jerk: 0.014050871133804321 loss_floor_contact: 0.005911698564887047
[93/100] loss: 0.0036384635604918003 loss_joints: 0.0016994087491184473 loss_collision: 0.0 loss_jerk: 0.014052429236471653 loss_floor_contact: 0.005338117014616728
[94/100] loss: 0.0036441239062696695 loss_joints: 0.0017214312683790922 loss_collision: 0.0 loss_jerk: 0.014053376391530037 loss_floor_contact: 0.0051735504530370235
[95/100] loss: 0.0036723106168210506 loss_joints: 0.0017420356161892414 loss_collision: 0.0 loss_jerk: 0.014053387567400932 loss_floor_contact: 0.005249363370239735
[96/100] loss: 0.003800560487434268 loss_joints: 0.0017536473460495472 loss_collision: 0.0 loss_jerk: 0.014052962884306908 loss_floor_contact: 0.006416167598217726
[97/100] loss: 0.003726425115019083 loss_joints: 0.0017568129114806652 loss_collision: 0.0 loss_jerk: 0.014052051119506359 loss_floor_contact: 0.005644071847200394
[98/100] loss: 0.0036672973074018955 loss_joints: 0.0017545728478580713 loss_collision: 0.0 loss_jerk: 0.014050457626581192 loss_floor_contact: 0.00507678696885705
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-13.png]
[99/100] loss: 0.003682198701426387 loss_joints: 0.001751709496602416 loss_collision: 0.0 loss_jerk: 0.01404985785484314 loss_floor_contact: 0.005255033727735281
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path3-walk12-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 505.23329                                                    ║
    ║     rollout = 232.11099                                                    ║
    ║     sdf     = 43.74380                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00368220                                                 ║
    ║     joints    = 0.00175171                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.01404986                                                 ║
    ║     floor     = 0.00525503                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	8m46.903s
user	7m27.773s
sys	0m22.770s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x5db045293c00] using SAR=1/1
[libx264 @ 0x5db045293c00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x5db045293c00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x5db045293c00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_walk_12.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x5db045291fc0] video:169kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.679997%
frame=   25 fps=0.0 q=-1.0 Lsize=     170kB time=00:00:02.20 bitrate= 633.7kbits/s speed= 3.2x    
[libx264 @ 0x5db045293c00] frame I:1     Avg QP:17.66  size: 71250
[libx264 @ 0x5db045293c00] frame P:9     Avg QP:20.38  size:  8699
[libx264 @ 0x5db045293c00] frame B:15    Avg QP:20.73  size:  1524
[libx264 @ 0x5db045293c00] consecutive B-frames: 12.0% 24.0%  0.0% 64.0%
[libx264 @ 0x5db045293c00] mb I  I16..4:  6.6% 64.4% 29.0%
[libx264 @ 0x5db045293c00] mb P  I16..4:  0.1%  1.6%  1.4%  P16..4:  9.3%  2.0%  1.5%  0.0%  0.0%    skip:84.2%
[libx264 @ 0x5db045293c00] mb B  I16..4:  0.1%  0.4%  0.1%  B16..8:  9.6%  0.9%  0.3%  direct: 0.4%  skip:88.2%  L0:49.3% L1:46.7% BI: 4.0%
[libx264 @ 0x5db045293c00] 8x8 transform intra:62.0% inter:56.2%
[libx264 @ 0x5db045293c00] coded y,uvDC,uvAC intra: 30.4% 19.5% 18.6% inter: 2.7% 2.8% 1.0%
[libx264 @ 0x5db045293c00] i16 v,h,dc,p: 67% 20% 12%  0%
[libx264 @ 0x5db045293c00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 52%  8% 33%  1%  1%  2%  1%  2%  1%
[libx264 @ 0x5db045293c00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 36% 23% 14%  5%  4%  4%  3%  9%  3%
[libx264 @ 0x5db045293c00] i8c dc,h,v,p: 89%  2%  6%  2%
[libx264 @ 0x5db045293c00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x5db045293c00] ref P L0: 59.7% 15.1% 15.5%  9.7%
[libx264 @ 0x5db045293c00] ref B L0: 82.4% 16.0%  1.7%
[libx264 @ 0x5db045293c00] ref B L1: 97.1%  2.9%
[libx264 @ 0x5db045293c00] kb/s:551.68
[INFO] Video saved as 'bin/result/optim_walk_12.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 26 = (8*3 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<07:14,  4.39s/it]  2%|▏         | 2/100 [00:05<04:11,  2.56s/it]  3%|▎         | 3/100 [00:07<03:55,  2.43s/it]  4%|▍         | 4/100 [00:09<03:20,  2.09s/it]  5%|▌         | 5/100 [00:10<02:57,  1.86s/it]  6%|▌         | 6/100 [00:12<02:42,  1.73s/it]  7%|▋         | 7/100 [00:13<02:28,  1.60s/it]  8%|▊         | 8/100 [00:15<02:19,  1.52s/it]  9%|▉         | 9/100 [00:16<02:07,  1.40s/it] 10%|█         | 10/100 [00:17<02:06,  1.41s/it] 11%|█         | 11/100 [00:19<02:04,  1.39s/it] 12%|█▏        | 12/100 [00:20<01:59,  1.36s/it] 13%|█▎        | 13/100 [00:21<01:54,  1.32s/it] 14%|█▍        | 14/100 [00:23<01:56,  1.36s/it] 15%|█▌        | 15/100 [00:24<01:59,  1.41s/it] 16%|█▌        | 16/100 [00:25<01:59,  1.43s/it] 17%|█▋        | 17/100 [00:27<02:05,  1.51s/it] 18%|█▊        | 18/100 [00:29<02:07,  1.56s/it] 19%|█▉        | 19/100 [00:30<02:05,  1.55s/it] 20%|██        | 20/100 [00:32<02:04,  1.55s/it] 21%|██        | 21/100 [00:34<02:03,  1.57s/it] 22%|██▏       | 22/100 [00:35<02:00,  1.54s/it] 23%|██▎       | 23/100 [00:36<01:54,  1.48s/it] 24%|██▍       | 24/100 [00:38<01:50,  1.45s/it] 25%|██▌       | 25/100 [00:39<01:48,  1.44s/it] 26%|██▌       | 26/100 [00:41<01:46,  1.44s/it] 27%|██▋       | 27/100 [00:42<01:51,  1.52s/it] 28%|██▊       | 28/100 [00:44<01:49,  1.52s/it] 29%|██▉       | 29/100 [00:45<01:42,  1.44s/it] 30%|███       | 30/100 [00:46<01:36,  1.38s/it] 31%|███       | 31/100 [00:48<01:33,  1.35s/it] 32%|███▏      | 32/100 [00:49<01:32,  1.37s/it] 33%|███▎      | 33/100 [00:50<01:32,  1.37s/it] 34%|███▍      | 34/100 [00:52<01:31,  1.39s/it] 35%|███▌      | 35/100 [00:53<01:32,  1.42s/it] 36%|███▌      | 36/100 [00:55<01:29,  1.39s/it] 37%|███▋      | 37/100 [00:56<01:24,  1.34s/it] 38%|███▊      | 38/100 [00:57<01:22,  1.33s/it] 39%|███▉      | 39/100 [00:59<01:20,  1.32s/it] 40%|████      | 40/100 [01:00<01:17,  1.28s/it] 41%|████      | 41/100 [01:01<01:17,  1.31s/it] 42%|████▏     | 42/100 [01:02<01:13,  1.27s/it] 43%|████▎     | 43/100 [01:03<01:11,  1.25s/it] 44%|████▍     | 44/100 [01:05<01:07,  1.21s/it] 45%|████▌     | 45/100 [01:06<01:07,  1.22s/it] 46%|████▌     | 46/100 [01:07<01:05,  1.21s/it] 47%|████▋     | 47/100 [01:08<01:03,  1.21s/it] 48%|████▊     | 48/100 [01:10<01:05,  1.25s/it] 49%|████▉     | 49/100 [01:11<01:04,  1.27s/it] 50%|█████     | 50/100 [01:12<01:03,  1.28s/it] 51%|█████     | 51/100 [01:13<01:02,  1.27s/it] 52%|█████▏    | 52/100 [01:15<01:02,  1.31s/it] 53%|█████▎    | 53/100 [01:16<01:02,  1.33s/it] 54%|█████▍    | 54/100 [01:17<00:59,  1.29s/it] 55%|█████▌    | 55/100 [01:19<00:59,  1.32s/it] 56%|█████▌    | 56/100 [01:20<00:55,  1.27s/it] 57%|█████▋    | 57/100 [01:21<00:55,  1.30s/it] 58%|█████▊    | 58/100 [01:23<00:55,  1.31s/it] 59%|█████▉    | 59/100 [01:24<00:53,  1.29s/it] 60%|██████    | 60/100 [01:25<00:51,  1.28s/it] 61%|██████    | 61/100 [01:26<00:49,  1.27s/it] 62%|██████▏   | 62/100 [01:28<00:47,  1.25s/it] 63%|██████▎   | 63/100 [01:29<00:45,  1.24s/it] 64%|██████▍   | 64/100 [01:30<00:46,  1.29s/it] 65%|██████▌   | 65/100 [01:31<00:45,  1.29s/it] 66%|██████▌   | 66/100 [01:33<00:46,  1.38s/it] 67%|██████▋   | 67/100 [01:34<00:44,  1.35s/it] 68%|██████▊   | 68/100 [01:36<00:42,  1.33s/it] 69%|██████▉   | 69/100 [01:37<00:41,  1.35s/it] 70%|███████   | 70/100 [01:38<00:39,  1.33s/it] 71%|███████   | 71/100 [01:40<00:38,  1.34s/it] 72%|███████▏  | 72/100 [01:41<00:37,  1.35s/it] 73%|███████▎  | 73/100 [01:43<00:37,  1.38s/it] 74%|███████▍  | 74/100 [01:44<00:34,  1.32s/it] 75%|███████▌  | 75/100 [01:45<00:31,  1.28s/it] 76%|███████▌  | 76/100 [01:46<00:29,  1.24s/it] 77%|███████▋  | 77/100 [01:47<00:28,  1.24s/it] 78%|███████▊  | 78/100 [01:48<00:26,  1.22s/it] 79%|███████▉  | 79/100 [01:50<00:25,  1.20s/it] 80%|████████  | 80/100 [01:51<00:23,  1.19s/it] 81%|████████  | 81/100 [01:52<00:22,  1.17s/it] 82%|████████▏ | 82/100 [01:53<00:21,  1.17s/it] 83%|████████▎ | 83/100 [01:54<00:19,  1.16s/it] 84%|████████▍ | 84/100 [01:55<00:18,  1.15s/it] 85%|████████▌ | 85/100 [01:56<00:17,  1.14s/it] 86%|████████▌ | 86/100 [01:58<00:16,  1.15s/it] 87%|████████▋ | 87/100 [01:59<00:15,  1.17s/it] 88%|████████▊ | 88/100 [02:00<00:14,  1.21s/it] 89%|████████▉ | 89/100 [02:01<00:13,  1.22s/it] 90%|█████████ | 90/100 [02:03<00:12,  1.20s/it] 91%|█████████ | 91/100 [02:04<00:10,  1.22s/it] 92%|█████████▏| 92/100 [02:05<00:09,  1.23s/it] 93%|█████████▎| 93/100 [02:06<00:08,  1.26s/it] 94%|█████████▍| 94/100 [02:08<00:07,  1.26s/it] 95%|█████████▌| 95/100 [02:09<00:06,  1.29s/it] 96%|█████████▌| 96/100 [02:10<00:05,  1.28s/it] 97%|█████████▋| 97/100 [02:12<00:03,  1.30s/it] 98%|█████████▊| 98/100 [02:13<00:02,  1.30s/it] 99%|█████████▉| 99/100 [02:14<00:01,  1.30s/it]100%|██████████| 100/100 [02:18<00:00,  2.11s/it]100%|██████████| 100/100 [02:18<00:00,  1.39s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-4.png]
[0/100] loss: 0.23822367191314697 loss_joints: 0.2320978343486786 loss_collision: 0.001509256660938263 loss_jerk: 0.04850863292813301 loss_floor_contact: 0.01124059408903122
[1/100] loss: 0.21119698882102966 loss_joints: 0.2049139440059662 loss_collision: 0.0 loss_jerk: 0.05206305533647537 loss_floor_contact: 0.010767372325062752
[2/100] loss: 0.19280880689620972 loss_joints: 0.1861152946949005 loss_collision: 0.0 loss_jerk: 0.05513639375567436 loss_floor_contact: 0.011798683553934097
[3/100] loss: 0.17634376883506775 loss_joints: 0.16853806376457214 loss_collision: 0.0 loss_jerk: 0.06260518729686737 loss_floor_contact: 0.015451900660991669
[4/100] loss: 0.15788410604000092 loss_joints: 0.14919927716255188 loss_collision: 0.0 loss_jerk: 0.06971103698015213 loss_floor_contact: 0.01713721640408039
[5/100] loss: 0.1603168100118637 loss_joints: 0.15208232402801514 loss_collision: 0.0 loss_jerk: 0.06521811336278915 loss_floor_contact: 0.017126737162470818
[6/100] loss: 0.15297214686870575 loss_joints: 0.14475135505199432 loss_collision: 0.0 loss_jerk: 0.06634483486413956 loss_floor_contact: 0.015863075852394104
[7/100] loss: 0.13897745311260223 loss_joints: 0.13051503896713257 loss_collision: 0.0 loss_jerk: 0.06881256401538849 loss_floor_contact: 0.015811555087566376
[8/100] loss: 0.13601738214492798 loss_joints: 0.1274840533733368 loss_collision: 0.0 loss_jerk: 0.0678161084651947 loss_floor_contact: 0.01751716062426567
[9/100] loss: 0.13195942342281342 loss_joints: 0.12344415485858917 loss_collision: 0.0 loss_jerk: 0.06740832328796387 loss_floor_contact: 0.017744287848472595
[10/100] loss: 0.12636755406856537 loss_joints: 0.11771838366985321 loss_collision: 0.0 loss_jerk: 0.06768569350242615 loss_floor_contact: 0.018805958330631256
[11/100] loss: 0.12044122815132141 loss_joints: 0.11173181235790253 loss_collision: 0.0 loss_jerk: 0.06862470507621765 loss_floor_contact: 0.018469471484422684
[12/100] loss: 0.11862928420305252 loss_joints: 0.1098928302526474 loss_collision: 0.0 loss_jerk: 0.06916483491659164 loss_floor_contact: 0.018199695274233818
[13/100] loss: 0.11685117334127426 loss_joints: 0.10821040719747543 loss_collision: 0.0 loss_jerk: 0.06844744086265564 loss_floor_contact: 0.017960235476493835
[14/100] loss: 0.1110495775938034 loss_joints: 0.10249646753072739 loss_collision: 0.0 loss_jerk: 0.06950922310352325 loss_floor_contact: 0.01602189615368843
[15/100] loss: 0.10490866750478745 loss_joints: 0.0961461290717125 loss_collision: 0.0 loss_jerk: 0.07021906226873398 loss_floor_contact: 0.017406370490789413
[16/100] loss: 0.10116519033908844 loss_joints: 0.09248944371938705 loss_collision: 0.0 loss_jerk: 0.07065290957689285 loss_floor_contact: 0.016104599460959435
[17/100] loss: 0.09864455461502075 loss_joints: 0.08984740823507309 loss_collision: 0.0 loss_jerk: 0.07089830935001373 loss_floor_contact: 0.01707315258681774
[18/100] loss: 0.09503920376300812 loss_joints: 0.08615604043006897 loss_collision: 0.0 loss_jerk: 0.07117552310228348 loss_floor_contact: 0.017656058073043823
[19/100] loss: 0.09055451303720474 loss_joints: 0.08147582411766052 loss_collision: 0.0 loss_jerk: 0.07159539312124252 loss_floor_contact: 0.019191499799489975
[20/100] loss: 0.08583152294158936 loss_joints: 0.07662295550107956 loss_collision: 0.0 loss_jerk: 0.07168347388505936 loss_floor_contact: 0.020402241498231888
[21/100] loss: 0.08316010981798172 loss_joints: 0.0744514912366867 loss_collision: 0.0 loss_jerk: 0.07019110023975372 loss_floor_contact: 0.016895104199647903
[22/100] loss: 0.08046364784240723 loss_joints: 0.07173161208629608 loss_collision: 0.0 loss_jerk: 0.06863655894994736 loss_floor_contact: 0.018683839589357376
[23/100] loss: 0.07594739645719528 loss_joints: 0.06755898892879486 loss_collision: 0.0 loss_jerk: 0.06876827776432037 loss_floor_contact: 0.015115807764232159
[24/100] loss: 0.07129278779029846 loss_joints: 0.06220758706331253 loss_collision: 0.0 loss_jerk: 0.06989636272192001 loss_floor_contact: 0.020955629646778107
[25/100] loss: 0.06817790865898132 loss_joints: 0.05960802361369133 loss_collision: 0.0 loss_jerk: 0.07035639137029648 loss_floor_contact: 0.0153424721211195
[26/100] loss: 0.06626266986131668 loss_joints: 0.05771402269601822 loss_collision: 0.0 loss_jerk: 0.07011445611715317 loss_floor_contact: 0.01537202950567007
[27/100] loss: 0.06425631046295166 loss_joints: 0.05558544397354126 loss_collision: 0.0 loss_jerk: 0.06977301836013794 loss_floor_contact: 0.016935627907514572
[28/100] loss: 0.06193886697292328 loss_joints: 0.05337962135672569 loss_collision: 0.0 loss_jerk: 0.06894617527723312 loss_floor_contact: 0.01664627715945244
[29/100] loss: 0.0602274127304554 loss_joints: 0.05143829807639122 loss_collision: 0.0 loss_jerk: 0.06749032437801361 loss_floor_contact: 0.020400816574692726
[30/100] loss: 0.05824199691414833 loss_joints: 0.049684107303619385 loss_collision: 0.0 loss_jerk: 0.06577029079198837 loss_floor_contact: 0.019808586686849594
[31/100] loss: 0.05611167103052139 loss_joints: 0.047497253865003586 loss_collision: 0.0 loss_jerk: 0.06456344574689865 loss_floor_contact: 0.021580712869763374
[32/100] loss: 0.0537886768579483 loss_joints: 0.045157067477703094 loss_collision: 0.0 loss_jerk: 0.06394501775503159 loss_floor_contact: 0.0223710760474205
[33/100] loss: 0.05158744379878044 loss_joints: 0.042912557721138 loss_collision: 0.0 loss_jerk: 0.06302984803915024 loss_floor_contact: 0.023718982934951782
[34/100] loss: 0.0491851381957531 loss_joints: 0.04058223217725754 loss_collision: 0.0 loss_jerk: 0.06202689930796623 loss_floor_contact: 0.02400216832756996
[35/100] loss: 0.046943262219429016 loss_joints: 0.03821137547492981 loss_collision: 0.0 loss_jerk: 0.061345621943473816 loss_floor_contact: 0.02597324177622795
[36/100] loss: 0.044719137251377106 loss_joints: 0.03588540479540825 loss_collision: 0.0 loss_jerk: 0.06185787171125412 loss_floor_contact: 0.026479432359337807
[37/100] loss: 0.042588960379362106 loss_joints: 0.03376396372914314 loss_collision: 0.0 loss_jerk: 0.06364420056343079 loss_floor_contact: 0.024605777114629745
[38/100] loss: 0.04101726785302162 loss_joints: 0.032023608684539795 loss_collision: 0.0 loss_jerk: 0.06449338048696518 loss_floor_contact: 0.025443218648433685
[39/100] loss: 0.03971828520298004 loss_joints: 0.03068270906805992 loss_collision: 0.0 loss_jerk: 0.06382206827402115 loss_floor_contact: 0.026533663272857666
[40/100] loss: 0.03847033157944679 loss_joints: 0.02943667769432068 loss_collision: 0.0 loss_jerk: 0.06238603964447975 loss_floor_contact: 0.027950502932071686
[41/100] loss: 0.03711039200425148 loss_joints: 0.028300117701292038 loss_collision: 0.0 loss_jerk: 0.06003012880682945 loss_floor_contact: 0.02807263657450676
[42/100] loss: 0.03565379977226257 loss_joints: 0.027365704998373985 loss_collision: 0.0 loss_jerk: 0.055979400873184204 loss_floor_contact: 0.026901543140411377
[43/100] loss: 0.03463366627693176 loss_joints: 0.026685303077101707 loss_collision: 0.0 loss_jerk: 0.052502717822790146 loss_floor_contact: 0.02698088064789772
[44/100] loss: 0.033882468938827515 loss_joints: 0.026040565222501755 loss_collision: 0.0 loss_jerk: 0.05122904106974602 loss_floor_contact: 0.027190018445253372
[45/100] loss: 0.033181093633174896 loss_joints: 0.025381920859217644 loss_collision: 0.0 loss_jerk: 0.051127780228853226 loss_floor_contact: 0.026863954961299896
[46/100] loss: 0.03238792344927788 loss_joints: 0.024588024243712425 loss_collision: 0.0 loss_jerk: 0.05141516774892807 loss_floor_contact: 0.02658381126821041
[47/100] loss: 0.031451448798179626 loss_joints: 0.023658018559217453 loss_collision: 0.0 loss_jerk: 0.05139288306236267 loss_floor_contact: 0.026541443541646004
[48/100] loss: 0.030408579856157303 loss_joints: 0.022659514099359512 loss_collision: 0.0 loss_jerk: 0.05100554600358009 loss_floor_contact: 0.026485100388526917
[49/100] loss: 0.02964894287288189 loss_joints: 0.021735265851020813 loss_collision: 0.0 loss_jerk: 0.05191202089190483 loss_floor_contact: 0.027224740013480186
[50/100] loss: 0.02912135049700737 loss_joints: 0.02093277871608734 loss_collision: 0.0 loss_jerk: 0.05413180962204933 loss_floor_contact: 0.02775389701128006
[51/100] loss: 0.02830970659852028 loss_joints: 0.02019081637263298 loss_collision: 0.0 loss_jerk: 0.05465235188603401 loss_floor_contact: 0.026536554098129272
[52/100] loss: 0.027433566749095917 loss_joints: 0.019499583169817924 loss_collision: 0.0 loss_jerk: 0.05380745604634285 loss_floor_contact: 0.025532370433211327
[53/100] loss: 0.026603149250149727 loss_joints: 0.018870573490858078 loss_collision: 0.0 loss_jerk: 0.05248231440782547 loss_floor_contact: 0.024843446910381317
[54/100] loss: 0.02617560513317585 loss_joints: 0.0182177871465683 loss_collision: 0.0 loss_jerk: 0.0522756353020668 loss_floor_contact: 0.027302535250782967
[55/100] loss: 0.025565680116415024 loss_joints: 0.01755053550004959 loss_collision: 0.0 loss_jerk: 0.05222101882100105 loss_floor_contact: 0.02793041616678238
[56/100] loss: 0.024811439216136932 loss_joints: 0.016899412497878075 loss_collision: 0.0 loss_jerk: 0.0522102527320385 loss_floor_contact: 0.02691000886261463
[57/100] loss: 0.024067701771855354 loss_joints: 0.01620260439813137 loss_collision: 0.0 loss_jerk: 0.052420929074287415 loss_floor_contact: 0.02623005211353302
[58/100] loss: 0.023303408175706863 loss_joints: 0.015456533059477806 loss_collision: 0.0 loss_jerk: 0.05258464813232422 loss_floor_contact: 0.02588409185409546
[59/100] loss: 0.02249840833246708 loss_joints: 0.014679273590445518 loss_collision: 0.0 loss_jerk: 0.052653148770332336 loss_floor_contact: 0.025538183748722076
[60/100] loss: 0.021750811487436295 loss_joints: 0.013878507539629936 loss_collision: 0.0 loss_jerk: 0.05268821865320206 loss_floor_contact: 0.026034826412796974
[61/100] loss: 0.021220969036221504 loss_joints: 0.01310768723487854 loss_collision: 0.0 loss_jerk: 0.054131802171468735 loss_floor_contact: 0.02700100839138031
[62/100] loss: 0.020660897716879845 loss_joints: 0.01240092795342207 loss_collision: 0.0 loss_jerk: 0.054699692875146866 loss_floor_contact: 0.027900002896785736
[63/100] loss: 0.01993115246295929 loss_joints: 0.011808453127741814 loss_collision: 0.0 loss_jerk: 0.05422735586762428 loss_floor_contact: 0.026999646797776222
[64/100] loss: 0.01941540464758873 loss_joints: 0.011366295628249645 loss_collision: 0.0 loss_jerk: 0.05443671718239784 loss_floor_contact: 0.02605437859892845
[65/100] loss: 0.018983019515872 loss_joints: 0.010896896943449974 loss_collision: 0.0 loss_jerk: 0.055274032056331635 loss_floor_contact: 0.02558719739317894
[66/100] loss: 0.018534304574131966 loss_joints: 0.010356128215789795 loss_collision: 0.0 loss_jerk: 0.05548658221960068 loss_floor_contact: 0.026295188814401627
[67/100] loss: 0.018115367740392685 loss_joints: 0.009749941527843475 loss_collision: 0.0 loss_jerk: 0.05518585816025734 loss_floor_contact: 0.028468413278460503
[68/100] loss: 0.01760319620370865 loss_joints: 0.009139414876699448 loss_collision: 0.0 loss_jerk: 0.054744940251111984 loss_floor_contact: 0.02989286556839943
[69/100] loss: 0.0168586578220129 loss_joints: 0.008518625050783157 loss_collision: 0.0 loss_jerk: 0.05616974085569382 loss_floor_contact: 0.027230583131313324
[70/100] loss: 0.016508156433701515 loss_joints: 0.007948765531182289 loss_collision: 0.0 loss_jerk: 0.05820649489760399 loss_floor_contact: 0.027387410402297974
[71/100] loss: 0.016214540228247643 loss_joints: 0.007511465810239315 loss_collision: 0.0 loss_jerk: 0.059069130569696426 loss_floor_contact: 0.027961622923612595
[72/100] loss: 0.015688147395849228 loss_joints: 0.007079986855387688 loss_collision: 0.0 loss_jerk: 0.06050543487071991 loss_floor_contact: 0.025576170533895493
[73/100] loss: 0.015385039150714874 loss_joints: 0.006700763013213873 loss_collision: 0.0 loss_jerk: 0.06095609813928604 loss_floor_contact: 0.0258866548538208
[74/100] loss: 0.014978992752730846 loss_joints: 0.00638432614505291 loss_collision: 0.0 loss_jerk: 0.06029423326253891 loss_floor_contact: 0.025652434676885605
[75/100] loss: 0.01456869300454855 loss_joints: 0.0061448970809578896 loss_collision: 0.0 loss_jerk: 0.05869738757610321 loss_floor_contact: 0.025540567934513092
[76/100] loss: 0.01427624560892582 loss_joints: 0.005999452900141478 loss_collision: 0.0 loss_jerk: 0.0564594641327858 loss_floor_contact: 0.026308460161089897
[77/100] loss: 0.01432701013982296 loss_joints: 0.005844005849212408 loss_collision: 0.0 loss_jerk: 0.05736866220831871 loss_floor_contact: 0.027461379766464233
[78/100] loss: 0.014110072515904903 loss_joints: 0.005655935034155846 loss_collision: 0.0 loss_jerk: 0.057904329150915146 loss_floor_contact: 0.026637043803930283
[79/100] loss: 0.013846363872289658 loss_joints: 0.005438902880996466 loss_collision: 0.0 loss_jerk: 0.05759749189019203 loss_floor_contact: 0.026477118954062462
[80/100] loss: 0.01366962119936943 loss_joints: 0.005218755453824997 loss_collision: 0.0 loss_jerk: 0.05719675496220589 loss_floor_contact: 0.027311895042657852
[81/100] loss: 0.013727792538702488 loss_joints: 0.005080327391624451 loss_collision: 0.0 loss_jerk: 0.05768919363617897 loss_floor_contact: 0.028785455971956253
[82/100] loss: 0.013592571020126343 loss_joints: 0.004996856674551964 loss_collision: 0.0 loss_jerk: 0.05732346698641777 loss_floor_contact: 0.028633680194616318
[83/100] loss: 0.013516748324036598 loss_joints: 0.004963260143995285 loss_collision: 0.0 loss_jerk: 0.05785679072141647 loss_floor_contact: 0.027678081765770912
[84/100] loss: 0.013445395044982433 loss_joints: 0.004907451570034027 loss_collision: 0.0 loss_jerk: 0.05824118107557297 loss_floor_contact: 0.0271382424980402
[85/100] loss: 0.013428722508251667 loss_joints: 0.004828804638236761 loss_collision: 0.0 loss_jerk: 0.05800880864262581 loss_floor_contact: 0.027990367263555527
[86/100] loss: 0.013352387584745884 loss_joints: 0.004738851450383663 loss_collision: 0.0 loss_jerk: 0.05735631287097931 loss_floor_contact: 0.0287790484726429
[87/100] loss: 0.01335154939442873 loss_joints: 0.004690561909228563 loss_collision: 0.0 loss_jerk: 0.057158805429935455 loss_floor_contact: 0.029451072216033936
[88/100] loss: 0.013335500843822956 loss_joints: 0.0046747843734920025 loss_collision: 0.0 loss_jerk: 0.057345643639564514 loss_floor_contact: 0.029261523857712746
[89/100] loss: 0.013223545625805855 loss_joints: 0.004655946046113968 loss_collision: 0.0 loss_jerk: 0.05733086168766022 loss_floor_contact: 0.02834513410925865
[90/100] loss: 0.013159617781639099 loss_joints: 0.004622895270586014 loss_collision: 0.0 loss_jerk: 0.05695437267422676 loss_floor_contact: 0.028412841260433197
[91/100] loss: 0.01319103967398405 loss_joints: 0.004582135938107967 loss_collision: 0.0 loss_jerk: 0.05686172842979431 loss_floor_contact: 0.02922731637954712
[92/100] loss: 0.013102125376462936 loss_joints: 0.00456694420427084 loss_collision: 0.0 loss_jerk: 0.0568440705537796 loss_floor_contact: 0.028507743030786514
[93/100] loss: 0.013073262758553028 loss_joints: 0.0045700701884925365 loss_collision: 0.0 loss_jerk: 0.056490007787942886 loss_floor_contact: 0.028541918843984604
[94/100] loss: 0.013017239049077034 loss_joints: 0.004588380455970764 loss_collision: 0.0 loss_jerk: 0.05678171664476395 loss_floor_contact: 0.027506869286298752
[95/100] loss: 0.013041317462921143 loss_joints: 0.004592603072524071 loss_collision: 0.0 loss_jerk: 0.056960489600896835 loss_floor_contact: 0.027526652440428734
[96/100] loss: 0.012979217804968357 loss_joints: 0.004584142472594976 loss_collision: 0.0 loss_jerk: 0.056905876845121384 loss_floor_contact: 0.0270448736846447
[97/100] loss: 0.012995423749089241 loss_joints: 0.004568593576550484 loss_collision: 0.0 loss_jerk: 0.05671378970146179 loss_floor_contact: 0.027554504573345184
[98/100] loss: 0.012967441231012344 loss_joints: 0.00455127190798521 loss_collision: 0.0 loss_jerk: 0.05647144839167595 loss_floor_contact: 0.027690254151821136
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-4.png]
[99/100] loss: 0.012966295704245567 loss_joints: 0.004536667838692665 loss_collision: 0.0 loss_jerk: 0.05626089498400688 loss_floor_contact: 0.02803538367152214
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path3-run3-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 138.69286                                                    ║
    ║     rollout = 54.91400                                                     ║
    ║     sdf     = 18.56831                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.01296630                                                 ║
    ║     joints    = 0.00453667                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.05626089                                                 ║
    ║     floor     = 0.02803538                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	2m54.175s
user	2m19.280s
sys	0m11.567s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x5ddd68a14c00] using SAR=1/1
[libx264 @ 0x5ddd68a14c00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x5ddd68a14c00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x5ddd68a14c00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_run_3.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x5ddd68a12fc0] video:179kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.640736%
frame=   25 fps=0.0 q=-1.0 Lsize=     181kB time=00:00:02.20 bitrate= 672.3kbits/s speed=3.41x    
[libx264 @ 0x5ddd68a14c00] frame I:1     Avg QP:17.09  size: 70333
[libx264 @ 0x5ddd68a14c00] frame P:9     Avg QP:20.12  size:  8645
[libx264 @ 0x5ddd68a14c00] frame B:15    Avg QP:22.77  size:  2324
[libx264 @ 0x5ddd68a14c00] consecutive B-frames: 12.0% 24.0%  0.0% 64.0%
[libx264 @ 0x5ddd68a14c00] mb I  I16..4:  6.9% 64.3% 28.8%
[libx264 @ 0x5ddd68a14c00] mb P  I16..4:  0.1%  1.6%  1.3%  P16..4:  9.5%  2.0%  1.4%  0.0%  0.0%    skip:84.0%
[libx264 @ 0x5ddd68a14c00] mb B  I16..4:  0.1%  0.5%  0.1%  B16..8: 11.4%  1.3%  0.5%  direct: 0.6%  skip:85.4%  L0:46.6% L1:49.3% BI: 4.0%
[libx264 @ 0x5ddd68a14c00] 8x8 transform intra:62.3% inter:59.4%
[libx264 @ 0x5ddd68a14c00] coded y,uvDC,uvAC intra: 30.4% 19.6% 18.6% inter: 3.3% 3.4% 1.2%
[libx264 @ 0x5ddd68a14c00] i16 v,h,dc,p: 72% 14% 14%  0%
[libx264 @ 0x5ddd68a14c00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 50%  9% 34%  1%  1%  2%  1%  2%  1%
[libx264 @ 0x5ddd68a14c00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 35% 24% 14%  4%  4%  4%  3%  8%  3%
[libx264 @ 0x5ddd68a14c00] i8c dc,h,v,p: 90%  2%  6%  2%
[libx264 @ 0x5ddd68a14c00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x5ddd68a14c00] ref P L0: 57.8% 15.7% 16.0% 10.4%
[libx264 @ 0x5ddd68a14c00] ref B L0: 83.0% 15.1%  1.8%
[libx264 @ 0x5ddd68a14c00] ref B L1: 97.0%  3.0%
[libx264 @ 0x5ddd68a14c00] kb/s:585.62
[INFO] Video saved as 'bin/result/optim_run_3.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 50 = (8*6 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:08<13:59,  8.48s/it]  2%|▏         | 2/100 [00:10<07:55,  4.85s/it]  3%|▎         | 3/100 [00:14<06:41,  4.14s/it]  4%|▍         | 4/100 [00:16<05:30,  3.44s/it]  5%|▌         | 5/100 [00:18<04:49,  3.05s/it]  6%|▌         | 6/100 [00:21<04:30,  2.88s/it]  7%|▋         | 7/100 [00:23<04:14,  2.74s/it]  8%|▊         | 8/100 [00:26<03:57,  2.58s/it]  9%|▉         | 9/100 [00:28<03:48,  2.52s/it] 10%|█         | 10/100 [00:30<03:46,  2.51s/it] 11%|█         | 11/100 [00:33<03:38,  2.45s/it] 12%|█▏        | 12/100 [00:35<03:37,  2.48s/it] 13%|█▎        | 13/100 [00:38<03:33,  2.46s/it] 14%|█▍        | 14/100 [00:40<03:27,  2.41s/it] 15%|█▌        | 15/100 [00:42<03:25,  2.42s/it] 16%|█▌        | 16/100 [00:45<03:29,  2.49s/it] 17%|█▋        | 17/100 [00:47<03:22,  2.44s/it] 18%|█▊        | 18/100 [00:50<03:22,  2.47s/it] 19%|█▉        | 19/100 [00:53<03:23,  2.51s/it] 20%|██        | 20/100 [00:55<03:15,  2.45s/it] 21%|██        | 21/100 [00:57<03:12,  2.44s/it] 22%|██▏       | 22/100 [01:00<03:09,  2.43s/it] 23%|██▎       | 23/100 [01:02<03:04,  2.40s/it] 24%|██▍       | 24/100 [01:05<03:06,  2.46s/it] 25%|██▌       | 25/100 [01:07<03:00,  2.40s/it] 26%|██▌       | 26/100 [01:09<02:57,  2.40s/it] 27%|██▋       | 27/100 [01:12<02:55,  2.41s/it] 28%|██▊       | 28/100 [01:14<02:54,  2.42s/it] 29%|██▉       | 29/100 [01:17<02:56,  2.49s/it] 30%|███       | 30/100 [01:19<02:56,  2.52s/it] 31%|███       | 31/100 [01:22<02:51,  2.48s/it] 32%|███▏      | 32/100 [01:24<02:45,  2.43s/it] 33%|███▎      | 33/100 [01:27<02:45,  2.46s/it] 34%|███▍      | 34/100 [01:29<02:41,  2.44s/it] 35%|███▌      | 35/100 [01:32<02:39,  2.46s/it] 36%|███▌      | 36/100 [01:34<02:37,  2.46s/it] 37%|███▋      | 37/100 [01:37<02:37,  2.49s/it] 38%|███▊      | 38/100 [01:39<02:34,  2.50s/it] 39%|███▉      | 39/100 [01:41<02:31,  2.48s/it] 40%|████      | 40/100 [01:44<02:31,  2.53s/it] 41%|████      | 41/100 [01:47<02:28,  2.51s/it] 42%|████▏     | 42/100 [01:49<02:31,  2.60s/it] 43%|████▎     | 43/100 [01:52<02:26,  2.56s/it] 44%|████▍     | 44/100 [01:54<02:20,  2.51s/it] 45%|████▌     | 45/100 [01:57<02:14,  2.45s/it] 46%|████▌     | 46/100 [01:59<02:13,  2.46s/it] 47%|████▋     | 47/100 [02:02<02:12,  2.50s/it] 48%|████▊     | 48/100 [02:04<02:09,  2.50s/it] 49%|████▉     | 49/100 [02:07<02:07,  2.50s/it] 50%|█████     | 50/100 [02:09<02:04,  2.49s/it] 51%|█████     | 51/100 [02:12<02:02,  2.50s/it] 52%|█████▏    | 52/100 [02:14<01:59,  2.49s/it] 53%|█████▎    | 53/100 [02:17<01:58,  2.52s/it] 54%|█████▍    | 54/100 [02:20<02:01,  2.64s/it] 55%|█████▌    | 55/100 [02:22<01:56,  2.59s/it] 56%|█████▌    | 56/100 [02:25<01:54,  2.60s/it] 57%|█████▋    | 57/100 [02:27<01:49,  2.55s/it] 58%|█████▊    | 58/100 [02:29<01:44,  2.48s/it] 59%|█████▉    | 59/100 [02:32<01:40,  2.46s/it] 60%|██████    | 60/100 [02:34<01:39,  2.48s/it] 61%|██████    | 61/100 [02:37<01:36,  2.49s/it] 62%|██████▏   | 62/100 [02:39<01:33,  2.46s/it] 63%|██████▎   | 63/100 [02:42<01:30,  2.45s/it] 64%|██████▍   | 64/100 [02:44<01:27,  2.42s/it] 65%|██████▌   | 65/100 [02:46<01:24,  2.42s/it] 66%|██████▌   | 66/100 [02:49<01:20,  2.35s/it] 67%|██████▋   | 67/100 [02:51<01:18,  2.38s/it] 68%|██████▊   | 68/100 [02:53<01:15,  2.37s/it] 69%|██████▉   | 69/100 [02:56<01:13,  2.37s/it] 70%|███████   | 70/100 [02:59<01:15,  2.51s/it] 71%|███████   | 71/100 [03:01<01:12,  2.50s/it] 72%|███████▏  | 72/100 [03:04<01:08,  2.46s/it] 73%|███████▎  | 73/100 [03:06<01:05,  2.43s/it] 74%|███████▍  | 74/100 [03:08<01:02,  2.41s/it] 75%|███████▌  | 75/100 [03:11<01:01,  2.46s/it] 76%|███████▌  | 76/100 [03:13<00:59,  2.48s/it] 77%|███████▋  | 77/100 [03:16<00:57,  2.49s/it] 78%|███████▊  | 78/100 [03:18<00:54,  2.47s/it] 79%|███████▉  | 79/100 [03:21<00:51,  2.44s/it] 80%|████████  | 80/100 [03:23<00:48,  2.40s/it] 81%|████████  | 81/100 [03:25<00:45,  2.39s/it] 82%|████████▏ | 82/100 [03:28<00:43,  2.44s/it] 83%|████████▎ | 83/100 [03:30<00:40,  2.40s/it] 84%|████████▍ | 84/100 [03:33<00:38,  2.41s/it] 85%|████████▌ | 85/100 [03:35<00:36,  2.44s/it] 86%|████████▌ | 86/100 [03:38<00:34,  2.46s/it] 87%|████████▋ | 87/100 [03:40<00:32,  2.47s/it] 88%|████████▊ | 88/100 [03:43<00:30,  2.55s/it] 89%|████████▉ | 89/100 [03:45<00:27,  2.55s/it] 90%|█████████ | 90/100 [03:48<00:25,  2.53s/it] 91%|█████████ | 91/100 [03:50<00:22,  2.53s/it] 92%|█████████▏| 92/100 [03:53<00:20,  2.50s/it] 93%|█████████▎| 93/100 [03:56<00:18,  2.58s/it] 94%|█████████▍| 94/100 [03:58<00:15,  2.62s/it] 95%|█████████▌| 95/100 [04:01<00:13,  2.60s/it] 96%|█████████▌| 96/100 [04:04<00:10,  2.72s/it] 97%|█████████▋| 97/100 [04:07<00:08,  2.71s/it] 98%|█████████▊| 98/100 [04:09<00:05,  2.63s/it] 99%|█████████▉| 99/100 [04:12<00:02,  2.64s/it]100%|██████████| 100/100 [04:19<00:00,  3.99s/it]100%|██████████| 100/100 [04:19<00:00,  2.59s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-7.png]
[0/100] loss: 0.3795080780982971 loss_joints: 0.3708110749721527 loss_collision: 0.000838586303871125 loss_jerk: 0.05721306428313255 loss_floor_contact: 0.028918268159031868
[1/100] loss: 0.4236125946044922 loss_joints: 0.414569228887558 loss_collision: 0.001546438317745924 loss_jerk: 0.06366746872663498 loss_floor_contact: 0.025219615548849106
[2/100] loss: 0.3769020736217499 loss_joints: 0.36678454279899597 loss_collision: 0.0 loss_jerk: 0.07514001429080963 loss_floor_contact: 0.02603524550795555
[3/100] loss: 0.2868504524230957 loss_joints: 0.276963472366333 loss_collision: 0.0 loss_jerk: 0.06721014529466629 loss_floor_contact: 0.03165949881076813
[4/100] loss: 0.27152276039123535 loss_joints: 0.2624143362045288 loss_collision: 0.0 loss_jerk: 0.0623307041823864 loss_floor_contact: 0.028753584250807762
[5/100] loss: 0.24389664828777313 loss_joints: 0.23536044359207153 loss_collision: 0.0003899506409652531 loss_jerk: 0.0603594109416008 loss_floor_contact: 0.024612700566649437
[6/100] loss: 0.21076823770999908 loss_joints: 0.202523335814476 loss_collision: 0.0010192437330260873 loss_jerk: 0.05952298641204834 loss_floor_contact: 0.021906832233071327
[7/100] loss: 0.1765316128730774 loss_joints: 0.16816771030426025 loss_collision: 0.0012651490978896618 loss_jerk: 0.059215039014816284 loss_floor_contact: 0.023158876225352287
[8/100] loss: 0.1438254714012146 loss_joints: 0.13450759649276733 loss_collision: 0.0011257934384047985 loss_jerk: 0.058670442551374435 loss_floor_contact: 0.03338247165083885
[9/100] loss: 0.11169615387916565 loss_joints: 0.10232856869697571 loss_collision: 0.0010229605250060558 loss_jerk: 0.05806450545787811 loss_floor_contact: 0.03458838537335396
[10/100] loss: 0.08227718621492386 loss_joints: 0.07434948533773422 loss_collision: 2.633248186612036e-05 loss_jerk: 0.05624481290578842 loss_floor_contact: 0.023005938157439232
[11/100] loss: 0.06127680838108063 loss_joints: 0.05408956855535507 loss_collision: 0.0 loss_jerk: 0.054114919155836105 loss_floor_contact: 0.017757508903741837
[12/100] loss: 0.04779590666294098 loss_joints: 0.041439782828092575 loss_collision: 0.00023241555027198046 loss_jerk: 0.05243106558918953 loss_floor_contact: 0.010897757485508919
[13/100] loss: 0.03823867067694664 loss_joints: 0.032493799924850464 loss_collision: 0.0 loss_jerk: 0.05053596943616867 loss_floor_contact: 0.006912722252309322
[14/100] loss: 0.02998623251914978 loss_joints: 0.024749714881181717 loss_collision: 0.0009204192319884896 loss_jerk: 0.04826398193836212 loss_floor_contact: 0.003180762520059943
[15/100] loss: 0.02478032000362873 loss_joints: 0.019785335287451744 loss_collision: 0.0020826333202421665 loss_jerk: 0.045826662331819534 loss_floor_contact: 0.0020405459217727184
[16/100] loss: 0.02178790047764778 loss_joints: 0.01699242740869522 loss_collision: 0.0 loss_jerk: 0.04337610304355621 loss_floor_contact: 0.004578623455017805
[17/100] loss: 0.018184155225753784 loss_joints: 0.013261782005429268 loss_collision: 0.003206295659765601 loss_jerk: 0.04230283200740814 loss_floor_contact: 0.003714593593031168
[18/100] loss: 0.012105673551559448 loss_joints: 0.007675659842789173 loss_collision: 0.0005558474222198129 loss_jerk: 0.03686889261007309 loss_floor_contact: 0.006875398103147745
[19/100] loss: 0.022075679153203964 loss_joints: 0.01505199447274208 loss_collision: 0.0015129235107451677 loss_jerk: 0.05808470398187637 loss_floor_contact: 0.01063922606408596
[20/100] loss: 0.017597341910004616 loss_joints: 0.011092389933764935 loss_collision: 0.0020689177326858044 loss_jerk: 0.05825776234269142 loss_floor_contact: 0.0047228531911969185
[21/100] loss: 0.016766859218478203 loss_joints: 0.01040739007294178 loss_collision: 0.002116705756634474 loss_jerk: 0.05811914801597595 loss_floor_contact: 0.0033588316291570663
[22/100] loss: 0.015410128980875015 loss_joints: 0.008975589647889137 loss_collision: 0.0020538505632430315 loss_jerk: 0.058622173964977264 loss_floor_contact: 0.003669359954074025
[23/100] loss: 0.014540708623826504 loss_joints: 0.007955318316817284 loss_collision: 0.0019386985804885626 loss_jerk: 0.05790388956665993 loss_floor_contact: 0.006011315621435642
[24/100] loss: 0.013392746448516846 loss_joints: 0.006999162025749683 loss_collision: 0.00182174367364496 loss_jerk: 0.05619854852557182 loss_floor_contact: 0.005915553774684668
[25/100] loss: 0.01243947446346283 loss_joints: 0.0062773264944553375 loss_collision: 0.0019289745250716805 loss_jerk: 0.05437673628330231 loss_floor_contact: 0.005315763875842094
[26/100] loss: 0.011378055438399315 loss_joints: 0.00565321184694767 loss_collision: 0.0018648889381438494 loss_jerk: 0.05209589749574661 loss_floor_contact: 0.003287638770416379
[27/100] loss: 0.010867624543607235 loss_joints: 0.005328178405761719 loss_collision: 0.0018076535779982805 loss_jerk: 0.04973112419247627 loss_floor_contact: 0.00385568686760962
[28/100] loss: 0.01114724762737751 loss_joints: 0.005813807249069214 loss_collision: 0.002134238136932254 loss_jerk: 0.047014884650707245 loss_floor_contact: 0.004185283090919256
[29/100] loss: 0.011316374875605106 loss_joints: 0.0060985940508544445 loss_collision: 0.0019488122779875994 loss_jerk: 0.04541059583425522 loss_floor_contact: 0.00481839943677187
[30/100] loss: 0.010802887380123138 loss_joints: 0.005651014856994152 loss_collision: 0.0020086660515516996 loss_jerk: 0.04459038004279137 loss_floor_contact: 0.004919676575809717
[31/100] loss: 0.010176852345466614 loss_joints: 0.005028284154832363 loss_collision: 0.00193640380166471 loss_jerk: 0.044368334114551544 loss_floor_contact: 0.005180949345231056
[32/100] loss: 0.009969071485102177 loss_joints: 0.004902370274066925 loss_collision: 0.0019910037517547607 loss_jerk: 0.04419900104403496 loss_floor_contact: 0.004477004520595074
[33/100] loss: 0.009988292120397091 loss_joints: 0.004862337838858366 loss_collision: 0.0019308201735839248 loss_jerk: 0.04351262003183365 loss_floor_contact: 0.005816097836941481
[34/100] loss: 0.009789652191102505 loss_joints: 0.00466491375118494 loss_collision: 0.002029834082350135 loss_jerk: 0.04247463494539261 loss_floor_contact: 0.006742918398231268
[35/100] loss: 0.009391178376972675 loss_joints: 0.004429149907082319 loss_collision: 0.0019257643725723028 loss_jerk: 0.04139150679111481 loss_floor_contact: 0.006303014699369669
[36/100] loss: 0.008995573036372662 loss_joints: 0.004257146269083023 loss_collision: 0.0021873011719435453 loss_jerk: 0.04038172960281372 loss_floor_contact: 0.004815238993614912
[37/100] loss: 0.008864090777933598 loss_joints: 0.004092376213520765 loss_collision: 0.0022226530127227306 loss_jerk: 0.039453212171792984 loss_floor_contact: 0.006041276268661022
[38/100] loss: 0.008509945124387741 loss_joints: 0.003848953638225794 loss_collision: 0.0020600068382918835 loss_jerk: 0.03862328454852104 loss_floor_contact: 0.005926615558564663
[39/100] loss: 0.008319169282913208 loss_joints: 0.003533261828124523 loss_collision: 0.0021221169736236334 loss_jerk: 0.03758222609758377 loss_floor_contact: 0.00815473310649395
[40/100] loss: 0.0081599997356534 loss_joints: 0.003310949308797717 loss_collision: 0.002054384909570217 loss_jerk: 0.036695897579193115 loss_floor_contact: 0.009740222245454788
[41/100] loss: 0.007722992449998856 loss_joints: 0.0032136128284037113 loss_collision: 0.0019957530312240124 loss_jerk: 0.03582371771335602 loss_floor_contact: 0.007274326868355274
[42/100] loss: 0.007488667499274015 loss_joints: 0.0030886740423738956 loss_collision: 0.001996559789404273 loss_jerk: 0.03514852002263069 loss_floor_contact: 0.0068548573181033134
[43/100] loss: 0.007732809521257877 loss_joints: 0.002966568572446704 loss_collision: 0.002027232898399234 loss_jerk: 0.03521442785859108 loss_floor_contact: 0.010420742444694042
[44/100] loss: 0.0074526299722492695 loss_joints: 0.0029438899364322424 loss_collision: 0.001993945799767971 loss_jerk: 0.03479967266321182 loss_floor_contact: 0.008293782360851765
[45/100] loss: 0.00728052482008934 loss_joints: 0.002855757251381874 loss_collision: 0.0020758637692779303 loss_jerk: 0.03374709561467171 loss_floor_contact: 0.008424717001616955
[46/100] loss: 0.006984568666666746 loss_joints: 0.0027571970131248236 loss_collision: 0.0021513723768293858 loss_jerk: 0.032676272094249725 loss_floor_contact: 0.007446072064340115
[47/100] loss: 0.007055392488837242 loss_joints: 0.0027973575051873922 loss_collision: 0.00203465367667377 loss_jerk: 0.033379171043634415 loss_floor_contact: 0.007166529074311256
[48/100] loss: 0.007063749246299267 loss_joints: 0.002770555205643177 loss_collision: 0.0020096111111342907 loss_jerk: 0.03356274217367172 loss_floor_contact: 0.007359592244029045
[49/100] loss: 0.0069749546237289906 loss_joints: 0.0027030063793063164 loss_collision: 0.0020620995201170444 loss_jerk: 0.03336930274963379 loss_floor_contact: 0.007288079708814621
[50/100] loss: 0.006891846191138029 loss_joints: 0.0027223171200603247 loss_collision: 0.001984662376344204 loss_jerk: 0.03264591470360756 loss_floor_contact: 0.007064709905534983
[51/100] loss: 0.006870062556117773 loss_joints: 0.0027899877168238163 loss_collision: 0.0019482119241729379 loss_jerk: 0.031432680785655975 loss_floor_contact: 0.007419853005558252
[52/100] loss: 0.006782797630876303 loss_joints: 0.0027342212852090597 loss_collision: 0.0020212256349623203 loss_jerk: 0.030454818159341812 loss_floor_contact: 0.008009716868400574
[53/100] loss: 0.006549648940563202 loss_joints: 0.0025840322487056255 loss_collision: 0.001986508024856448 loss_jerk: 0.029801947996020317 loss_floor_contact: 0.00786771159619093
[54/100] loss: 0.0064054615795612335 loss_joints: 0.0024881423451006413 loss_collision: 0.002002839697524905 loss_jerk: 0.029299160465598106 loss_floor_contact: 0.007871194742619991
[55/100] loss: 0.006341156549751759 loss_joints: 0.0024698013439774513 loss_collision: 0.002139794174581766 loss_jerk: 0.02830928936600685 loss_floor_contact: 0.008264469914138317
[56/100] loss: 0.006299252156168222 loss_joints: 0.002408210653811693 loss_collision: 0.00212481408379972 loss_jerk: 0.028396490961313248 loss_floor_contact: 0.008389106951653957
[57/100] loss: 0.006189753767102957 loss_joints: 0.002373329596593976 loss_collision: 0.0020462041720747948 loss_jerk: 0.02812989056110382 loss_floor_contact: 0.007988146506249905
[58/100] loss: 0.006131051108241081 loss_joints: 0.0023479219526052475 loss_collision: 0.002206894103437662 loss_jerk: 0.027884170413017273 loss_floor_contact: 0.007740224711596966
[59/100] loss: 0.00606111716479063 loss_joints: 0.0023768374230712652 loss_collision: 0.0021283328533172607 loss_jerk: 0.027689626440405846 loss_floor_contact: 0.007024834863841534
[60/100] loss: 0.006169682834297419 loss_joints: 0.0023998927790671587 loss_collision: 0.002134729875251651 loss_jerk: 0.02738065831363201 loss_floor_contact: 0.008182513527572155
[61/100] loss: 0.006084872409701347 loss_joints: 0.0023463682737201452 loss_collision: 0.0021249609999358654 loss_jerk: 0.026996202766895294 loss_floor_contact: 0.008263875730335712
[62/100] loss: 0.005939419846981764 loss_joints: 0.0023056529462337494 loss_collision: 0.002182700904086232 loss_jerk: 0.026485692709684372 loss_floor_contact: 0.007669274695217609
[63/100] loss: 0.005713308695703745 loss_joints: 0.0022489489056169987 loss_collision: 0.0019968748092651367 loss_jerk: 0.026311267167329788 loss_floor_contact: 0.006335458252578974
[64/100] loss: 0.005729061551392078 loss_joints: 0.0021755611523985863 loss_collision: 0.002149301115423441 loss_jerk: 0.02674902230501175 loss_floor_contact: 0.0066366782411932945
[65/100] loss: 0.005574990529567003 loss_joints: 0.002134596463292837 loss_collision: 0.0021066495683044195 loss_jerk: 0.026907270774245262 loss_floor_contact: 0.00539002101868391
[66/100] loss: 0.0056067053228616714 loss_joints: 0.002139562740921974 loss_collision: 0.0022021064069122076 loss_jerk: 0.02683338336646557 loss_floor_contact: 0.005635937675833702
[67/100] loss: 0.005611776374280453 loss_joints: 0.0021342888940125704 loss_collision: 0.0022193556651473045 loss_jerk: 0.026633279398083687 loss_floor_contact: 0.005922240205109119
[68/100] loss: 0.005547143053263426 loss_joints: 0.0021074730902910233 loss_collision: 0.00216207979246974 loss_jerk: 0.026341618970036507 loss_floor_contact: 0.005893003661185503
[69/100] loss: 0.00559026887640357 loss_joints: 0.002070037415251136 loss_collision: 0.0021446305327117443 loss_jerk: 0.02631491795182228 loss_floor_contact: 0.006742766126990318
[70/100] loss: 0.005588790867477655 loss_joints: 0.0020536764059215784 loss_collision: 0.0021862622816115618 loss_jerk: 0.02646883763372898 loss_floor_contact: 0.006696047727018595
[71/100] loss: 0.005614684894680977 loss_joints: 0.0020676772110164165 loss_collision: 0.0021783753763884306 loss_jerk: 0.02673877589404583 loss_floor_contact: 0.0065529244020581245
[72/100] loss: 0.005591839551925659 loss_joints: 0.0020856386981904507 loss_collision: 0.002109651220962405 loss_jerk: 0.026806510984897614 loss_floor_contact: 0.006145843770354986
[73/100] loss: 0.005546454340219498 loss_joints: 0.002087453380227089 loss_collision: 0.002146974205970764 loss_jerk: 0.026672787964344025 loss_floor_contact: 0.005770253017544746
[74/100] loss: 0.005421760492026806 loss_joints: 0.0021373615600168705 loss_collision: 0.002153079491108656 loss_jerk: 0.02659977599978447 loss_floor_contact: 0.004091131035238504
[75/100] loss: 0.005648625548928976 loss_joints: 0.002149730920791626 loss_collision: 0.002021998167037964 loss_jerk: 0.026403259485960007 loss_floor_contact: 0.006563684903085232
[76/100] loss: 0.0056205918081104755 loss_joints: 0.0020993861835449934 loss_collision: 0.0020825332030653954 loss_jerk: 0.02608419395983219 loss_floor_contact: 0.0070453304797410965
[77/100] loss: 0.0055978912860155106 loss_joints: 0.0020264440681785345 loss_collision: 0.0020037591457366943 loss_jerk: 0.02569153718650341 loss_floor_contact: 0.008019177243113518
[78/100] loss: 0.005528095178306103 loss_joints: 0.0019770129583775997 loss_collision: 0.002142048440873623 loss_jerk: 0.025201430544257164 loss_floor_contact: 0.008167344145476818
[79/100] loss: 0.005455048754811287 loss_joints: 0.0020025866106152534 loss_collision: 0.0021499991416931152 loss_jerk: 0.025091277435421944 loss_floor_contact: 0.007283342536538839
[80/100] loss: 0.005479039624333382 loss_joints: 0.0020578396506607533 loss_collision: 0.0020783203653991222 loss_jerk: 0.0251315925270319 loss_floor_contact: 0.0070020826533436775
[81/100] loss: 0.005513924174010754 loss_joints: 0.0020797529723495245 loss_collision: 0.0022265571169555187 loss_jerk: 0.02513813227415085 loss_floor_contact: 0.0069770198315382
[82/100] loss: 0.005519488826394081 loss_joints: 0.0020532056223601103 loss_collision: 0.0022013806737959385 loss_jerk: 0.025122132152318954 loss_floor_contact: 0.007339315954595804
[83/100] loss: 0.005436737090349197 loss_joints: 0.001994034508243203 loss_collision: 0.0021194987930357456 loss_jerk: 0.025086967274546623 loss_floor_contact: 0.007220556028187275
[84/100] loss: 0.005366466008126736 loss_joints: 0.001932058366946876 loss_collision: 0.002165298443287611 loss_jerk: 0.02503364160656929 loss_floor_contact: 0.00714513473212719
[85/100] loss: 0.005378251429647207 loss_joints: 0.001897634705528617 loss_collision: 0.0020984497386962175 loss_jerk: 0.024965200573205948 loss_floor_contact: 0.00774251576513052
[86/100] loss: 0.005383366718888283 loss_joints: 0.0018937195418402553 loss_collision: 0.002072875155135989 loss_jerk: 0.02495557628571987 loss_floor_contact: 0.007868019863963127
[87/100] loss: 0.005393809173256159 loss_joints: 0.0018907481571659446 loss_collision: 0.0021386807784438133 loss_jerk: 0.02506471797823906 loss_floor_contact: 0.007827211171388626
[88/100] loss: 0.005386243108659983 loss_joints: 0.0018783207051455975 loss_collision: 0.0020654904656112194 loss_jerk: 0.025072678923606873 loss_floor_contact: 0.007941056042909622
[89/100] loss: 0.005284763872623444 loss_joints: 0.0018601976335048676 loss_collision: 0.002159220864996314 loss_jerk: 0.02500615268945694 loss_floor_contact: 0.007080288603901863
[90/100] loss: 0.0052584693767130375 loss_joints: 0.0018529001390561461 loss_collision: 0.0021565600764006376 loss_jerk: 0.024968743324279785 loss_floor_contact: 0.0069303857162594795
[91/100] loss: 0.005260527599602938 loss_joints: 0.0018522224854677916 loss_collision: 0.0021117159631103277 loss_jerk: 0.024962168186903 loss_floor_contact: 0.0070091658271849155
[92/100] loss: 0.005256175063550472 loss_joints: 0.0018580666510388255 loss_collision: 0.0021486603654921055 loss_jerk: 0.024973878636956215 loss_floor_contact: 0.00685854721814394
[93/100] loss: 0.005332986358553171 loss_joints: 0.0018710626754909754 loss_collision: 0.0021345936693251133 loss_jerk: 0.024993686005473137 loss_floor_contact: 0.00749095669016242
[94/100] loss: 0.005356167908757925 loss_joints: 0.0018755849450826645 loss_collision: 0.0022174972109496593 loss_jerk: 0.024963371455669403 loss_floor_contact: 0.007624955847859383
[95/100] loss: 0.005340763833373785 loss_joints: 0.001872414257377386 loss_collision: 0.002167778555303812 loss_jerk: 0.024901019409298897 loss_floor_contact: 0.00761469267308712
[96/100] loss: 0.005323838442564011 loss_joints: 0.0018651093123480678 loss_collision: 0.002102385740727186 loss_jerk: 0.0248335562646389 loss_floor_contact: 0.0076513527892529964
[97/100] loss: 0.005287492647767067 loss_joints: 0.00185694161336869 loss_collision: 0.002112463116645813 loss_jerk: 0.02481720596551895 loss_floor_contact: 0.007375841028988361
[98/100] loss: 0.005303533282130957 loss_joints: 0.0018504339968785644 loss_collision: 0.0021260702051222324 loss_jerk: 0.02482241950929165 loss_floor_contact: 0.007582501042634249
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-7.png]
[99/100] loss: 0.005167307332158089 loss_joints: 0.0018460041610524058 loss_collision: 0.0022300034761428833 loss_jerk: 0.024824531748890877 loss_floor_contact: 0.0061584957875311375
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path3-run6-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 259.32412                                                    ║
    ║     rollout = 113.94442                                                    ║
    ║     sdf     = 25.02320                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00516731                                                 ║
    ║     joints    = 0.00184600                                                 ║
    ║     collision = 0.00223000                                                 ║
    ║     jerk      = 0.02482453                                                 ║
    ║     floor     = 0.00615850                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	4m42.363s
user	4m1.303s
sys	0m16.168s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x631b2eb98c00] using SAR=1/1
[libx264 @ 0x631b2eb98c00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x631b2eb98c00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x631b2eb98c00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_run_6.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x631b2eb96fc0] video:186kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.614374%
frame=   25 fps=0.0 q=-1.0 Lsize=     187kB time=00:00:02.20 bitrate= 696.2kbits/s speed=2.89x    
[libx264 @ 0x631b2eb98c00] frame I:1     Avg QP:17.78  size: 67778
[libx264 @ 0x631b2eb98c00] frame P:8     Avg QP:20.64  size: 10749
[libx264 @ 0x631b2eb98c00] frame B:16    Avg QP:22.91  size:  2239
[libx264 @ 0x631b2eb98c00] consecutive B-frames:  8.0% 16.0% 12.0% 64.0%
[libx264 @ 0x631b2eb98c00] mb I  I16..4:  6.5% 64.7% 28.8%
[libx264 @ 0x631b2eb98c00] mb P  I16..4:  0.2%  1.8%  1.7%  P16..4: 11.5%  2.8%  1.8%  0.0%  0.0%    skip:80.2%
[libx264 @ 0x631b2eb98c00] mb B  I16..4:  0.1%  0.4%  0.1%  B16..8: 12.0%  1.3%  0.5%  direct: 0.8%  skip:84.7%  L0:50.7% L1:44.6% BI: 4.7%
[libx264 @ 0x631b2eb98c00] 8x8 transform intra:61.7% inter:58.7%
[libx264 @ 0x631b2eb98c00] coded y,uvDC,uvAC intra: 30.3% 19.0% 17.9% inter: 3.5% 3.7% 1.4%
[libx264 @ 0x631b2eb98c00] i16 v,h,dc,p: 69% 18% 13%  0%
[libx264 @ 0x631b2eb98c00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 50%  9% 34%  1%  1%  1%  1%  2%  1%
[libx264 @ 0x631b2eb98c00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 35% 24% 15%  4%  4%  4%  3%  8%  3%
[libx264 @ 0x631b2eb98c00] i8c dc,h,v,p: 90%  2%  6%  2%
[libx264 @ 0x631b2eb98c00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x631b2eb98c00] ref P L0: 54.9%  9.9% 18.1% 17.1%
[libx264 @ 0x631b2eb98c00] ref B L0: 75.8% 22.0%  2.2%
[libx264 @ 0x631b2eb98c00] ref B L1: 95.8%  4.2%
[libx264 @ 0x631b2eb98c00] kb/s:606.68
[INFO] Video saved as 'bin/result/optim_run_6.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:13<22:25, 13.59s/it]  2%|▏         | 2/100 [00:18<13:40,  8.38s/it]  3%|▎         | 3/100 [00:23<11:14,  6.95s/it]  4%|▍         | 4/100 [00:28<09:48,  6.13s/it]  5%|▌         | 5/100 [00:33<09:01,  5.70s/it]  6%|▌         | 6/100 [00:38<08:28,  5.41s/it]  7%|▋         | 7/100 [00:43<08:04,  5.21s/it]  8%|▊         | 8/100 [00:47<07:41,  5.01s/it]  9%|▉         | 9/100 [00:52<07:25,  4.89s/it] 10%|█         | 10/100 [00:57<07:17,  4.86s/it] 11%|█         | 11/100 [01:02<07:19,  4.94s/it] 12%|█▏        | 12/100 [01:07<07:21,  5.02s/it] 13%|█▎        | 13/100 [01:13<07:36,  5.25s/it] 14%|█▍        | 14/100 [01:17<07:18,  5.09s/it] 15%|█▌        | 15/100 [01:22<07:05,  5.01s/it] 16%|█▌        | 16/100 [01:28<07:13,  5.17s/it] 17%|█▋        | 17/100 [01:32<06:57,  5.03s/it] 18%|█▊        | 18/100 [01:37<06:51,  5.02s/it] 19%|█▉        | 19/100 [01:43<06:56,  5.14s/it] 20%|██        | 20/100 [01:48<07:00,  5.25s/it] 21%|██        | 21/100 [01:54<06:57,  5.28s/it] 22%|██▏       | 22/100 [01:59<06:59,  5.38s/it] 23%|██▎       | 23/100 [02:05<07:04,  5.51s/it] 24%|██▍       | 24/100 [02:10<06:51,  5.41s/it] 25%|██▌       | 25/100 [02:15<06:38,  5.32s/it] 26%|██▌       | 26/100 [02:21<06:33,  5.31s/it] 27%|██▋       | 27/100 [02:26<06:29,  5.34s/it] 28%|██▊       | 28/100 [02:32<06:27,  5.38s/it] 29%|██▉       | 29/100 [02:37<06:27,  5.46s/it] 30%|███       | 30/100 [02:43<06:22,  5.47s/it] 31%|███       | 31/100 [02:48<06:03,  5.26s/it] 32%|███▏      | 32/100 [02:53<05:59,  5.29s/it] 33%|███▎      | 33/100 [02:58<05:46,  5.17s/it] 34%|███▍      | 34/100 [03:03<05:42,  5.20s/it] 35%|███▌      | 35/100 [03:08<05:32,  5.11s/it] 36%|███▌      | 36/100 [03:13<05:19,  4.99s/it] 37%|███▋      | 37/100 [03:18<05:13,  4.98s/it] 38%|███▊      | 38/100 [03:23<05:08,  4.97s/it] 39%|███▉      | 39/100 [03:28<05:10,  5.09s/it] 40%|████      | 40/100 [03:33<04:59,  5.00s/it] 41%|████      | 41/100 [03:38<05:05,  5.18s/it] 42%|████▏     | 42/100 [03:43<04:54,  5.08s/it] 43%|████▎     | 43/100 [03:48<04:47,  5.05s/it] 44%|████▍     | 44/100 [03:53<04:44,  5.07s/it] 45%|████▌     | 45/100 [03:59<04:45,  5.20s/it] 46%|████▌     | 46/100 [04:04<04:44,  5.27s/it] 47%|████▋     | 47/100 [04:09<04:36,  5.22s/it] 48%|████▊     | 48/100 [04:15<04:37,  5.34s/it] 49%|████▉     | 49/100 [04:20<04:29,  5.29s/it] 50%|█████     | 50/100 [04:25<04:20,  5.21s/it] 51%|█████     | 51/100 [04:30<04:09,  5.10s/it] 52%|█████▏    | 52/100 [04:35<04:04,  5.09s/it] 53%|█████▎    | 53/100 [04:40<03:54,  4.98s/it] 54%|█████▍    | 54/100 [04:45<03:47,  4.95s/it] 55%|█████▌    | 55/100 [04:50<03:48,  5.08s/it] 56%|█████▌    | 56/100 [04:55<03:45,  5.12s/it] 57%|█████▋    | 57/100 [05:01<03:45,  5.24s/it] 58%|█████▊    | 58/100 [05:06<03:40,  5.25s/it] 59%|█████▉    | 59/100 [05:11<03:32,  5.17s/it] 60%|██████    | 60/100 [05:16<03:30,  5.26s/it] 61%|██████    | 61/100 [05:21<03:21,  5.18s/it] 62%|██████▏   | 62/100 [05:27<03:20,  5.27s/it] 63%|██████▎   | 63/100 [05:32<03:14,  5.25s/it] 64%|██████▍   | 64/100 [05:37<03:07,  5.22s/it] 65%|██████▌   | 65/100 [05:43<03:03,  5.23s/it] 66%|██████▌   | 66/100 [05:47<02:54,  5.14s/it] 67%|██████▋   | 67/100 [05:52<02:46,  5.06s/it] 68%|██████▊   | 68/100 [05:57<02:41,  5.06s/it] 69%|██████▉   | 69/100 [06:03<02:39,  5.15s/it] 70%|███████   | 70/100 [06:08<02:33,  5.11s/it] 71%|███████   | 71/100 [06:13<02:29,  5.17s/it] 72%|███████▏  | 72/100 [06:19<02:29,  5.34s/it] 73%|███████▎  | 73/100 [06:24<02:25,  5.38s/it] 74%|███████▍  | 74/100 [06:29<02:16,  5.26s/it] 75%|███████▌  | 75/100 [06:35<02:12,  5.31s/it] 76%|███████▌  | 76/100 [06:40<02:05,  5.22s/it] 77%|███████▋  | 77/100 [06:45<01:59,  5.19s/it] 78%|███████▊  | 78/100 [06:51<01:57,  5.33s/it] 79%|███████▉  | 79/100 [06:56<01:52,  5.36s/it] 80%|████████  | 80/100 [07:01<01:44,  5.24s/it] 81%|████████  | 81/100 [07:06<01:41,  5.32s/it] 82%|████████▏ | 82/100 [07:12<01:36,  5.34s/it] 83%|████████▎ | 83/100 [07:17<01:29,  5.29s/it] 84%|████████▍ | 84/100 [07:22<01:23,  5.24s/it] 85%|████████▌ | 85/100 [07:27<01:17,  5.19s/it] 86%|████████▌ | 86/100 [07:32<01:11,  5.13s/it] 87%|████████▋ | 87/100 [07:37<01:06,  5.14s/it] 88%|████████▊ | 88/100 [07:43<01:02,  5.18s/it] 89%|████████▉ | 89/100 [07:48<00:56,  5.13s/it] 90%|█████████ | 90/100 [07:53<00:52,  5.21s/it] 91%|█████████ | 91/100 [07:58<00:46,  5.16s/it] 92%|█████████▏| 92/100 [08:03<00:40,  5.09s/it] 93%|█████████▎| 93/100 [08:08<00:36,  5.15s/it] 94%|█████████▍| 94/100 [08:14<00:31,  5.24s/it] 95%|█████████▌| 95/100 [08:19<00:25,  5.17s/it] 96%|█████████▌| 96/100 [08:24<00:20,  5.18s/it] 97%|█████████▋| 97/100 [08:30<00:15,  5.31s/it] 98%|█████████▊| 98/100 [08:35<00:10,  5.22s/it] 99%|█████████▉| 99/100 [08:40<00:05,  5.28s/it]100%|██████████| 100/100 [08:54<00:00,  8.01s/it]100%|██████████| 100/100 [08:54<00:00,  5.35s/it]
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-13.png]
[0/100] loss: 2.7077414989471436 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 1.0675195455551147
[1/100] loss: 2.7148008346557617 loss_joints: 2.5857651233673096 loss_collision: 0.0 loss_jerk: 0.08968132734298706 loss_floor_contact: 1.2006758451461792
[2/100] loss: 2.3078646659851074 loss_joints: 2.2120399475097656 loss_collision: 0.0 loss_jerk: 0.06881371885538101 loss_floor_contact: 0.8894317150115967
[3/100] loss: 2.2148618698120117 loss_joints: 2.1253271102905273 loss_collision: 0.0004018488107249141 loss_jerk: 0.0823437049984932 loss_floor_contact: 0.8126029372215271
[4/100] loss: 2.0018484592437744 loss_joints: 1.9289886951446533 loss_collision: 0.0 loss_jerk: 0.06906784325838089 loss_floor_contact: 0.659530520439148
[5/100] loss: 1.783588171005249 loss_joints: 1.7220901250839233 loss_collision: 0.0 loss_jerk: 0.06797756999731064 loss_floor_contact: 0.5470024943351746
[6/100] loss: 1.5850579738616943 loss_joints: 1.5334784984588623 loss_collision: 0.0 loss_jerk: 0.0678020715713501 loss_floor_contact: 0.4479927718639374
[7/100] loss: 1.4243587255477905 loss_joints: 1.380918264389038 loss_collision: 0.0 loss_jerk: 0.06640814244747162 loss_floor_contact: 0.3679969906806946
[8/100] loss: 1.2311279773712158 loss_joints: 1.1951537132263184 loss_collision: 0.0 loss_jerk: 0.06467603892087936 loss_floor_contact: 0.2950662672519684
[9/100] loss: 1.035010814666748 loss_joints: 1.0054020881652832 loss_collision: 0.0 loss_jerk: 0.06325383484363556 loss_floor_contact: 0.2328331619501114
[10/100] loss: 0.8041131496429443 loss_joints: 0.7801388502120972 loss_collision: 0.0 loss_jerk: 0.06191248074173927 loss_floor_contact: 0.17783059179782867
[11/100] loss: 0.6684761047363281 loss_joints: 0.6476354598999023 loss_collision: 0.0 loss_jerk: 0.05996067821979523 loss_floor_contact: 0.14844605326652527
[12/100] loss: 0.5670724511146545 loss_joints: 0.5505461692810059 loss_collision: 0.0 loss_jerk: 0.057677626609802246 loss_floor_contact: 0.10758540779352188
[13/100] loss: 0.45300665497779846 loss_joints: 0.438765287399292 loss_collision: 0.0 loss_jerk: 0.06086217239499092 loss_floor_contact: 0.08155126124620438
[14/100] loss: 0.3166920840740204 loss_joints: 0.3057901859283447 loss_collision: 0.0009870048379525542 loss_jerk: 0.05459365248680115 loss_floor_contact: 0.05343816429376602
[15/100] loss: 0.1935223788022995 loss_joints: 0.18007509410381317 loss_collision: 0.0011403905227780342 loss_jerk: 0.056223876774311066 loss_floor_contact: 0.07710853219032288
[16/100] loss: 0.1337207406759262 loss_joints: 0.12362903356552124 loss_collision: 0.0011172639206051826 loss_jerk: 0.048641834408044815 loss_floor_contact: 0.05115798860788345
[17/100] loss: 0.0921887680888176 loss_joints: 0.08301933854818344 loss_collision: 0.0020519117824733257 loss_jerk: 0.044708527624607086 loss_floor_contact: 0.04493388161063194
[18/100] loss: 0.0659012421965599 loss_joints: 0.05641399323940277 loss_collision: 0.0011771058198064566 loss_jerk: 0.04844333976507187 loss_floor_contact: 0.045252032577991486
[19/100] loss: 0.0437292642891407 loss_joints: 0.0366615392267704 loss_collision: 0.0015070508234202862 loss_jerk: 0.0474017858505249 loss_floor_contact: 0.021768398582935333
[20/100] loss: 0.03251560032367706 loss_joints: 0.026951564475893974 loss_collision: 0.008727654814720154 loss_jerk: 0.04573653265833855 loss_floor_contact: 0.001176181947812438
[21/100] loss: 0.03049556538462639 loss_joints: 0.02531873807311058 loss_collision: 0.006575546693056822 loss_jerk: 0.04450678825378418 loss_floor_contact: 0.0006859302520751953
[22/100] loss: 0.03469320386648178 loss_joints: 0.02892361208796501 loss_collision: 0.006901286076754332 loss_jerk: 0.04983987286686897 loss_floor_contact: 0.0009547392255626619
[23/100] loss: 0.03882411867380142 loss_joints: 0.03236456960439682 loss_collision: 0.009303092956542969 loss_jerk: 0.05244116857647896 loss_floor_contact: 0.0028512089047580957
[24/100] loss: 0.03906482085585594 loss_joints: 0.03263014554977417 loss_collision: 0.010061565786600113 loss_jerk: 0.053049296140670776 loss_floor_contact: 0.0012359058018773794
[25/100] loss: 0.036276333034038544 loss_joints: 0.028835546225309372 loss_collision: 0.021428130567073822 loss_jerk: 0.05208186060190201 loss_floor_contact: 0.0008978740661405027
[26/100] loss: 0.02782004326581955 loss_joints: 0.021342948079109192 loss_collision: 0.014946999959647655 loss_jerk: 0.049321480095386505 loss_floor_contact: 0.0005024614511057734
[27/100] loss: 0.01940477266907692 loss_joints: 0.013251280412077904 loss_collision: 0.015911489725112915 loss_jerk: 0.04509137198328972 loss_floor_contact: 0.0005320585914887488
[28/100] loss: 0.013251278549432755 loss_joints: 0.006644095294177532 loss_collision: 0.021293459460139275 loss_jerk: 0.04378661885857582 loss_floor_contact: 0.0009917491115629673
[29/100] loss: 0.013843300752341747 loss_joints: 0.0070825605653226376 loss_collision: 0.021034136414527893 loss_jerk: 0.045798104256391525 loss_floor_contact: 0.0007751572993583977
[30/100] loss: 0.017632873728871346 loss_joints: 0.011952117085456848 loss_collision: 0.007634852081537247 loss_jerk: 0.047636978328228 loss_floor_contact: 0.0015357251977548003
[31/100] loss: 0.021310027688741684 loss_joints: 0.015678800642490387 loss_collision: 0.004745291080325842 loss_jerk: 0.049100227653980255 loss_floor_contact: 0.002466736128553748
[32/100] loss: 0.021795013919472694 loss_joints: 0.016047220677137375 loss_collision: 0.004815329797565937 loss_jerk: 0.05007516220211983 loss_floor_contact: 0.0025874364655464888
[33/100] loss: 0.01865009032189846 loss_joints: 0.0130075141787529 loss_collision: 0.004232953302562237 loss_jerk: 0.05070352926850319 loss_floor_contact: 0.0014892690815031528
[34/100] loss: 0.013966509141027927 loss_joints: 0.00821865163743496 loss_collision: 0.0044243186712265015 loss_jerk: 0.051034413278102875 loss_floor_contact: 0.0020198398269712925
[35/100] loss: 0.010787644423544407 loss_joints: 0.004139674827456474 loss_collision: 0.014400389976799488 loss_jerk: 0.050930097699165344 loss_floor_contact: 0.001149203977547586
[36/100] loss: 0.00953440461307764 loss_joints: 0.0023198651615530252 loss_collision: 0.020334508270025253 loss_jerk: 0.05033005401492119 loss_floor_contact: 0.001480835024267435
[37/100] loss: 0.008968949317932129 loss_joints: 0.0024267742410302162 loss_collision: 0.013834209181368351 loss_jerk: 0.05019685998558998 loss_floor_contact: 0.0013906796230003238
[38/100] loss: 0.009485182352364063 loss_joints: 0.002701355842873454 loss_collision: 0.0160463098436594 loss_jerk: 0.05035438761115074 loss_floor_contact: 0.0014375575119629502
[39/100] loss: 0.009205174632370472 loss_joints: 0.0025183975230902433 loss_collision: 0.014127908274531364 loss_jerk: 0.05069122090935707 loss_floor_contact: 0.002048643771559
[40/100] loss: 0.008206170983612537 loss_joints: 0.001983208116143942 loss_collision: 0.009403003379702568 loss_jerk: 0.051129478961229324 loss_floor_contact: 0.0016971483128145337
[41/100] loss: 0.007596277631819248 loss_joints: 0.0014642050955444574 loss_collision: 0.007178735453635454 loss_jerk: 0.05152552202343941 loss_floor_contact: 0.0026164662558585405
[42/100] loss: 0.00760639226064086 loss_joints: 0.0018170075491070747 loss_collision: 0.004536555614322424 loss_jerk: 0.05184105411171913 loss_floor_contact: 0.0015162344789132476
[43/100] loss: 0.008103596977889538 loss_joints: 0.0023837867192924023 loss_collision: 0.0026395104359835386 loss_jerk: 0.052105363458395004 loss_floor_contact: 0.002453221706673503
[44/100] loss: 0.008156664669513702 loss_joints: 0.002107817679643631 loss_collision: 0.0020662557799369097 loss_jerk: 0.05445637181401253 loss_floor_contact: 0.0039658439345657825
[45/100] loss: 0.007411960978060961 loss_joints: 0.001229029381647706 loss_collision: 0.0032125781290233135 loss_jerk: 0.05614988133311272 loss_floor_contact: 0.0024668541736900806
[46/100] loss: 0.007203489542007446 loss_joints: 0.0009224002715200186 loss_collision: 0.0023583737201988697 loss_jerk: 0.057241685688495636 loss_floor_contact: 0.0032108279410749674
[47/100] loss: 0.008850441314280033 loss_joints: 0.002227592281997204 loss_collision: 0.003491299692541361 loss_jerk: 0.05784150958061218 loss_floor_contact: 0.004895675927400589
[48/100] loss: 0.00987805612385273 loss_joints: 0.0034105777740478516 loss_collision: 0.003168964758515358 loss_jerk: 0.05751001834869385 loss_floor_contact: 0.003995797596871853
[49/100] loss: 0.009850025177001953 loss_joints: 0.0034938855096697807 loss_collision: 0.0033712629228830338 loss_jerk: 0.05625323951244354 loss_floor_contact: 0.00393689563497901
[50/100] loss: 0.00868565496057272 loss_joints: 0.002563565969467163 loss_collision: 0.00283287581987679 loss_jerk: 0.054099638015031815 loss_floor_contact: 0.004288376308977604
[51/100] loss: 0.0069857509806752205 loss_joints: 0.001267154235392809 loss_collision: 0.0012452075025066733 loss_jerk: 0.05215342342853546 loss_floor_contact: 0.0037873343098908663
[52/100] loss: 0.006484871730208397 loss_joints: 0.0006128749810159206 loss_collision: 0.002537955529987812 loss_jerk: 0.05200684815645218 loss_floor_contact: 0.004175162874162197
[53/100] loss: 0.006648488342761993 loss_joints: 0.0008821784285828471 loss_collision: 0.002297006081789732 loss_jerk: 0.05173565819859505 loss_floor_contact: 0.0036304364912211895
[54/100] loss: 0.006655271630734205 loss_joints: 0.0010093396995216608 loss_collision: 0.0013267077738419175 loss_jerk: 0.05146348103880882 loss_floor_contact: 0.0036691271234303713
[55/100] loss: 0.006404492538422346 loss_joints: 0.0007458130712620914 loss_collision: 0.002190876519307494 loss_jerk: 0.051183778792619705 loss_floor_contact: 0.003212134586647153
[56/100] loss: 0.006071761250495911 loss_joints: 0.0004716553958132863 loss_collision: 0.0015450899954885244 loss_jerk: 0.050899844616651535 loss_floor_contact: 0.0035561220720410347
[57/100] loss: 0.006418060511350632 loss_joints: 0.0008324418449774384 loss_collision: 0.0014839826617389917 loss_jerk: 0.05059146136045456 loss_floor_contact: 0.003780738916248083
[58/100] loss: 0.00721233244985342 loss_joints: 0.001626808661967516 loss_collision: 0.0011108597973361611 loss_jerk: 0.05005943775177002 loss_floor_contact: 0.004684937186539173
[59/100] loss: 0.007593546062707901 loss_joints: 0.001945330761373043 loss_collision: 0.0024482575245201588 loss_jerk: 0.05039174482226372 loss_floor_contact: 0.0036421495024114847
[60/100] loss: 0.007244950160384178 loss_joints: 0.0016502449288964272 loss_collision: 0.0015054242685437202 loss_jerk: 0.0502782016992569 loss_floor_contact: 0.00416342169046402
[61/100] loss: 0.00665941322222352 loss_joints: 0.0010294470703229308 loss_collision: 0.0011198222637176514 loss_jerk: 0.049715399742126465 loss_floor_contact: 0.0054644388146698475
[62/100] loss: 0.006263876333832741 loss_joints: 0.0005911140469834208 loss_collision: 0.0026919785887002945 loss_jerk: 0.04887443408370018 loss_floor_contact: 0.005161209497600794
[63/100] loss: 0.006268038880079985 loss_joints: 0.0007981336675584316 loss_collision: 0.002260931534692645 loss_jerk: 0.047886740416288376 loss_floor_contact: 0.004551384598016739
[64/100] loss: 0.006682633422315121 loss_joints: 0.0012106559006497264 loss_collision: 0.0022610414307564497 loss_jerk: 0.047819387167692184 loss_floor_contact: 0.004639348015189171
[65/100] loss: 0.006779954303056002 loss_joints: 0.00133434496819973 loss_collision: 0.001687955460511148 loss_jerk: 0.047513578087091446 loss_floor_contact: 0.005254558753222227
[66/100] loss: 0.00645731296390295 loss_joints: 0.0011528236791491508 loss_collision: 0.0019184901611879468 loss_jerk: 0.04685679450631142 loss_floor_contact: 0.004269612021744251
[67/100] loss: 0.00617626216262579 loss_joints: 0.0008660349994897842 loss_collision: 0.002961380174383521 loss_jerk: 0.04631713777780533 loss_floor_contact: 0.0038237511180341244
[68/100] loss: 0.005983902141451836 loss_joints: 0.000716036360245198 loss_collision: 0.003363196738064289 loss_jerk: 0.046026088297367096 loss_floor_contact: 0.0032893752213567495
[69/100] loss: 0.005882700439542532 loss_joints: 0.0007431210251525044 loss_collision: 0.0027846810407936573 loss_jerk: 0.045710641890764236 loss_floor_contact: 0.0029004698153585196
[70/100] loss: 0.005886231083422899 loss_joints: 0.0007273743394762278 loss_collision: 0.002792130457237363 loss_jerk: 0.04546117037534714 loss_floor_contact: 0.003335266374051571
[71/100] loss: 0.0058248452842235565 loss_joints: 0.000639883684925735 loss_collision: 0.002788872690871358 loss_jerk: 0.04528135061264038 loss_floor_contact: 0.0037793931551277637
[72/100] loss: 0.005805421620607376 loss_joints: 0.0006247495184652507 loss_collision: 0.0034523585345596075 loss_jerk: 0.04503237456083298 loss_floor_contact: 0.0033219836186617613
[73/100] loss: 0.00581360561773181 loss_joints: 0.0006448592175729573 loss_collision: 0.0028931121341884136 loss_jerk: 0.04474588483572006 loss_floor_contact: 0.004048463888466358
[74/100] loss: 0.005690507125109434 loss_joints: 0.0006286946590989828 loss_collision: 0.0031147748231887817 loss_jerk: 0.044525887817144394 loss_floor_contact: 0.0029774613212794065
[75/100] loss: 0.005739313084632158 loss_joints: 0.0006371403578668833 loss_collision: 0.0027729228604584932 loss_jerk: 0.04437198117375374 loss_floor_contact: 0.003876821603626013
[76/100] loss: 0.005763143301010132 loss_joints: 0.0006367780733853579 loss_collision: 0.0028835260309278965 loss_jerk: 0.04446764662861824 loss_floor_contact: 0.003912476357072592
[77/100] loss: 0.00569328386336565 loss_joints: 0.0005929288454353809 loss_collision: 0.0028012350667268038 loss_jerk: 0.044438302516937256 loss_floor_contact: 0.0037640100345015526
[78/100] loss: 0.005652718711644411 loss_joints: 0.0005218321457505226 loss_collision: 0.0031916603911668062 loss_jerk: 0.04417596384882927 loss_floor_contact: 0.003941238857805729
[79/100] loss: 0.005496629513800144 loss_joints: 0.00047447398537769914 loss_collision: 0.002842398826032877 loss_jerk: 0.043822966516017914 loss_floor_contact: 0.0035561849363148212
[80/100] loss: 0.005342249292880297 loss_joints: 0.00041499079088680446 loss_collision: 0.002244363771751523 loss_jerk: 0.04375503212213516 loss_floor_contact: 0.0032731876708567142
[81/100] loss: 0.005288105458021164 loss_joints: 0.00037625172990374267 loss_collision: 0.0022894316352903843 loss_jerk: 0.0437195710837841 loss_floor_contact: 0.0031095307786017656
[82/100] loss: 0.005217905156314373 loss_joints: 0.00034071406116709113 loss_collision: 0.0016173194162547588 loss_jerk: 0.043652355670928955 loss_floor_contact: 0.0035022329539060593
[83/100] loss: 0.0051535312086343765 loss_joints: 0.00031916977604851127 loss_collision: 0.002094540512189269 loss_jerk: 0.043617717921733856 loss_floor_contact: 0.0026313536800444126
[84/100] loss: 0.005207446403801441 loss_joints: 0.0003103198832832277 loss_collision: 0.0012205346720293164 loss_jerk: 0.04354359954595566 loss_floor_contact: 0.004207126330584288
[85/100] loss: 0.00525116641074419 loss_joints: 0.00030234374571591616 loss_collision: 0.001465045497752726 loss_jerk: 0.04347776994109154 loss_floor_contact: 0.004545412492007017
[86/100] loss: 0.005273299291729927 loss_joints: 0.0002985723549500108 loss_collision: 0.0021021608263254166 loss_jerk: 0.04352358728647232 loss_floor_contact: 0.004121522419154644
[87/100] loss: 0.005233767442405224 loss_joints: 0.00031066476367414 loss_collision: 0.0019690589979290962 loss_jerk: 0.04354162514209747 loss_floor_contact: 0.0037203384563326836
[88/100] loss: 0.005250524263828993 loss_joints: 0.0003163254295941442 loss_collision: 0.0012643395457416773 loss_jerk: 0.04348071664571762 loss_floor_contact: 0.004596927668899298
[89/100] loss: 0.005235512275248766 loss_joints: 0.00030098517891019583 loss_collision: 0.0012883245944976807 loss_jerk: 0.04343485087156296 loss_floor_contact: 0.004622098058462143
[90/100] loss: 0.005205537658184767 loss_joints: 0.0002774494932964444 loss_collision: 0.0020538982935249805 loss_jerk: 0.04340147599577904 loss_floor_contact: 0.003825506428256631
[91/100] loss: 0.005202739965170622 loss_joints: 0.00027096556732431054 loss_collision: 0.0015987043734639883 loss_jerk: 0.04330464452505112 loss_floor_contact: 0.004414394497871399
[92/100] loss: 0.005146464798599482 loss_joints: 0.000268646574113518 loss_collision: 0.0015250559663400054 loss_jerk: 0.04315003752708435 loss_floor_contact: 0.0041030896827578545
[93/100] loss: 0.005079290363937616 loss_joints: 0.00027376931393519044 loss_collision: 0.0018480272265151143 loss_jerk: 0.043066006153821945 loss_floor_contact: 0.0031411731615662575
[94/100] loss: 0.0050771660171449184 loss_joints: 0.0002719300682656467 loss_collision: 0.0012574276188388467 loss_jerk: 0.042952053248882294 loss_floor_contact: 0.003842878621071577
[95/100] loss: 0.005025871563702822 loss_joints: 0.0002679993922356516 loss_collision: 0.0012397743994370103 loss_jerk: 0.042845528572797775 loss_floor_contact: 0.0034934203140437603
[96/100] loss: 0.005022263154387474 loss_joints: 0.00026182527653872967 loss_collision: 0.001968822907656431 loss_jerk: 0.04277074337005615 loss_floor_contact: 0.0028648145962506533
[97/100] loss: 0.005046396516263485 loss_joints: 0.00025690183974802494 loss_collision: 0.0019744280725717545 loss_jerk: 0.04276131093502045 loss_floor_contact: 0.0031592058949172497
[98/100] loss: 0.005046661011874676 loss_joints: 0.00025487280800007284 loss_collision: 0.0019089614506810904 loss_jerk: 0.042757146060466766 loss_floor_contact: 0.0032517784275114536
[Done] Plotting SDF-Points [bin/imgs/sdf-points-1-13.png]
[99/100] loss: 0.005006004124879837 loss_joints: 0.00025461215409450233 loss_collision: 0.0019518916960805655 loss_jerk: 0.04275011643767357 loss_floor_contact: 0.0028119098860770464
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/cabE-path3-run12-4000_use_pred_joints_ddim10_guidance5.0_seed0_contact0.1_thresh0.0_collision0.1_jerk0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 534.82883                                                    ║
    ║     rollout = 243.29110                                                    ║
    ║     sdf     = 47.65750                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00500600                                                 ║
    ║     joints    = 0.00025461                                                 ║
    ║     collision = 0.00195189                                                 ║
    ║     jerk      = 0.04275012                                                 ║
    ║     floor     = 0.00281191                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	9m16.225s
user	7m44.428s
sys	0m29.191s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x6288d5bf7c00] using SAR=1/1
[libx264 @ 0x6288d5bf7c00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x6288d5bf7c00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x6288d5bf7c00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_run_12.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x6288d5bf5fc0] video:174kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.655155%
frame=   25 fps=0.0 q=-1.0 Lsize=     175kB time=00:00:02.20 bitrate= 653.1kbits/s speed=3.06x    
[libx264 @ 0x6288d5bf7c00] frame I:1     Avg QP:18.29  size: 69541
[libx264 @ 0x6288d5bf7c00] frame P:8     Avg QP:20.96  size: 10104
[libx264 @ 0x6288d5bf7c00] frame B:16    Avg QP:20.53  size:  1710
[libx264 @ 0x6288d5bf7c00] consecutive B-frames: 12.0%  8.0%  0.0% 80.0%
[libx264 @ 0x6288d5bf7c00] mb I  I16..4:  2.9% 68.6% 28.5%
[libx264 @ 0x6288d5bf7c00] mb P  I16..4:  0.2%  1.6%  1.6%  P16..4:  8.7%  2.5%  1.7%  0.0%  0.0%    skip:83.8%
[libx264 @ 0x6288d5bf7c00] mb B  I16..4:  0.1%  0.4%  0.0%  B16..8: 10.4%  1.3%  0.5%  direct: 0.5%  skip:86.6%  L0:35.8% L1:59.9% BI: 4.3%
[libx264 @ 0x6288d5bf7c00] 8x8 transform intra:64.3% inter:53.9%
[libx264 @ 0x6288d5bf7c00] coded y,uvDC,uvAC intra: 30.7% 20.1% 19.0% inter: 2.6% 2.6% 0.8%
[libx264 @ 0x6288d5bf7c00] i16 v,h,dc,p: 52% 29% 18%  1%
[libx264 @ 0x6288d5bf7c00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 54%  8% 31%  1%  1%  2%  1%  2%  1%
[libx264 @ 0x6288d5bf7c00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 35% 23% 14%  4%  4%  4%  4%  9%  3%
[libx264 @ 0x6288d5bf7c00] i8c dc,h,v,p: 89%  2%  6%  3%
[libx264 @ 0x6288d5bf7c00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x6288d5bf7c00] ref P L0: 66.7% 10.2% 15.6%  7.4%
[libx264 @ 0x6288d5bf7c00] ref B L0: 72.2% 25.1%  2.7%
[libx264 @ 0x6288d5bf7c00] ref B L1: 91.4%  8.6%
[libx264 @ 0x6288d5bf7c00] kb/s:568.77
[INFO] Video saved as 'bin/result/optim_run_12.mp4'.
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
Traceback (most recent call last):
  File "/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/davidbl/iDART/mld/optim_scene_mld.py", line 589, in <module>
    with open(optim_args.interaction_cfg, 'r') as f:
FileNotFoundError: [Errno 2] No such file or directory: './data/optim_interaction/cab_e/path1/moonwalk8.json'
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl

real	0m16.302s
user	0m13.151s
sys	0m3.544s
ffmpeg version 6.1.1 Copyright (c) 2000-2023 the FFmpeg developers
  built with gcc 12.3.0 (conda-forge gcc 12.3.0-5)
  configuration: --prefix=/work/courses/digital_human/6/miniconda3/envs/DART --cc=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-cc --cxx=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-c++ --nm=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-nm --ar=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/x86_64-conda-linux-gnu-ar --disable-doc --disable-openssl --enable-demuxer=dash --enable-hardcoded-tables --enable-libfreetype --enable-libharfbuzz --enable-libfontconfig --enable-libopenh264 --enable-libdav1d --enable-gnutls --enable-libmp3lame --enable-libvpx --enable-libass --enable-pthreads --enable-vaapi --enable-libopenvino --enable-gpl --enable-libx264 --enable-libx265 --enable-libaom --enable-libsvtav1 --enable-libxml2 --enable-pic --enable-shared --disable-static --enable-version3 --enable-zlib --enable-libopus --pkg-config=/home/conda/feedstock_root/build_artifacts/ffmpeg_1706918361713/_build_env/bin/pkg-config
  libavutil      58. 29.100 / 58. 29.100
  libavcodec     60. 31.102 / 60. 31.102
  libavformat    60. 16.100 / 60. 16.100
  libavdevice    60.  3.100 / 60.  3.100
  libavfilter     9. 12.100 /  9. 12.100
  libswscale      7.  5.100 /  7.  5.100
  libswresample   4. 12.100 /  4. 12.100
  libpostproc    57.  3.100 / 57.  3.100
Input #0, image2, from 'bin/imgs/sdf-points-0-%d.png':
  Duration: 00:00:02.50, start: 0.000000, bitrate: N/A
  Stream #0:0: Video: png, rgba(pc, gbr/unknown/unknown), 1000x800 [SAR 3937:3937 DAR 5:4], 10 fps, 10 tbr, 10 tbn
Stream mapping:
  Stream #0:0 -> #0:0 (png (native) -> h264 (libx264))
Press [q] to stop, [?] for help
[libx264 @ 0x6302d39bac00] using SAR=1/1
[libx264 @ 0x6302d39bac00] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX FMA3 BMI2 AVX2
[libx264 @ 0x6302d39bac00] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x6302d39bac00] 264 - core 164 r3095 baee400 - H.264/MPEG-4 AVC codec - Copyleft 2003-2022 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=3 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=10 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'bin/result/optim_moonwalk8.mp4':
  Metadata:
    encoder         : Lavf60.16.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 1000x800 [SAR 1:1 DAR 5:4], q=2-31, 10 fps, 10240 tbn
    Metadata:
      encoder         : Lavc60.31.102 libx264
    Side data:
      cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
frame=    0 fps=0.0 q=0.0 size=       0kB time=N/A bitrate=N/A speed=N/A    [out#0/mp4 @ 0x6302d39b8fc0] video:174kB audio:0kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.655155%
frame=   25 fps=0.0 q=-1.0 Lsize=     175kB time=00:00:02.20 bitrate= 653.1kbits/s speed=3.37x    
[libx264 @ 0x6302d39bac00] frame I:1     Avg QP:18.29  size: 69541
[libx264 @ 0x6302d39bac00] frame P:8     Avg QP:20.96  size: 10104
[libx264 @ 0x6302d39bac00] frame B:16    Avg QP:20.53  size:  1710
[libx264 @ 0x6302d39bac00] consecutive B-frames: 12.0%  8.0%  0.0% 80.0%
[libx264 @ 0x6302d39bac00] mb I  I16..4:  2.9% 68.6% 28.5%
[libx264 @ 0x6302d39bac00] mb P  I16..4:  0.2%  1.6%  1.6%  P16..4:  8.7%  2.5%  1.7%  0.0%  0.0%    skip:83.8%
[libx264 @ 0x6302d39bac00] mb B  I16..4:  0.1%  0.4%  0.0%  B16..8: 10.4%  1.3%  0.5%  direct: 0.5%  skip:86.6%  L0:35.8% L1:59.9% BI: 4.3%
[libx264 @ 0x6302d39bac00] 8x8 transform intra:64.3% inter:53.9%
[libx264 @ 0x6302d39bac00] coded y,uvDC,uvAC intra: 30.7% 20.1% 19.0% inter: 2.6% 2.6% 0.8%
[libx264 @ 0x6302d39bac00] i16 v,h,dc,p: 52% 29% 18%  1%
[libx264 @ 0x6302d39bac00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 54%  8% 31%  1%  1%  2%  1%  2%  1%
[libx264 @ 0x6302d39bac00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 35% 23% 14%  4%  4%  4%  4%  9%  3%
[libx264 @ 0x6302d39bac00] i8c dc,h,v,p: 89%  2%  6%  3%
[libx264 @ 0x6302d39bac00] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x6302d39bac00] ref P L0: 66.7% 10.2% 15.6%  7.4%
[libx264 @ 0x6302d39bac00] ref B L0: 72.2% 25.1%  2.7%
[libx264 @ 0x6302d39bac00] ref B L1: 91.4%  8.6%
[libx264 @ 0x6302d39bac00] kb/s:568.77
[INFO] Video saved as 'bin/result/optim_moonwalk8.mp4'.
