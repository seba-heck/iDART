[INFO] Running interaction: run_12
[INFO] Running optimization with learning rate: 0.25
[INFO] Running with contact threshold: 0.75
[INFO] Running with collision=0.1, contact=0.1, jerk=0.1, skate=0.1
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:06<10:21,  6.27s/it]  2%|▏         | 2/100 [00:11<08:57,  5.48s/it]  3%|▎         | 3/100 [00:16<08:27,  5.24s/it]  4%|▍         | 4/100 [00:20<07:59,  4.99s/it]  5%|▌         | 5/100 [00:25<07:44,  4.89s/it]  6%|▌         | 6/100 [00:30<07:28,  4.77s/it]  7%|▋         | 7/100 [00:34<07:17,  4.71s/it]  8%|▊         | 8/100 [00:39<07:05,  4.62s/it]  9%|▉         | 9/100 [00:43<06:58,  4.60s/it] 10%|█         | 10/100 [00:48<06:52,  4.58s/it] 11%|█         | 11/100 [00:53<06:56,  4.68s/it] 12%|█▏        | 12/100 [00:57<06:45,  4.60s/it] 13%|█▎        | 13/100 [01:01<06:32,  4.51s/it] 14%|█▍        | 14/100 [01:06<06:33,  4.58s/it] 15%|█▌        | 15/100 [01:10<06:25,  4.54s/it] 16%|█▌        | 16/100 [01:15<06:25,  4.59s/it] 17%|█▋        | 17/100 [01:20<06:17,  4.55s/it] 18%|█▊        | 18/100 [01:25<06:23,  4.68s/it] 19%|█▉        | 19/100 [01:29<06:16,  4.65s/it] 20%|██        | 20/100 [01:34<06:13,  4.67s/it] 21%|██        | 21/100 [01:39<06:11,  4.70s/it] 22%|██▏       | 22/100 [01:43<06:02,  4.65s/it] 23%|██▎       | 23/100 [01:48<05:59,  4.66s/it] 24%|██▍       | 24/100 [01:53<05:59,  4.73s/it] 25%|██▌       | 25/100 [01:57<05:50,  4.67s/it] 26%|██▌       | 26/100 [02:02<05:53,  4.78s/it] 27%|██▋       | 27/100 [02:07<05:45,  4.74s/it] 28%|██▊       | 28/100 [02:12<05:43,  4.78s/it] 29%|██▉       | 29/100 [02:16<05:36,  4.74s/it] 30%|███       | 30/100 [02:21<05:29,  4.71s/it] 31%|███       | 31/100 [02:26<05:25,  4.71s/it] 32%|███▏      | 32/100 [02:30<05:17,  4.67s/it] 33%|███▎      | 33/100 [02:35<05:09,  4.63s/it] 34%|███▍      | 34/100 [02:40<05:07,  4.66s/it] 35%|███▌      | 35/100 [02:44<05:04,  4.69s/it] 36%|███▌      | 36/100 [02:49<04:57,  4.65s/it] 37%|███▋      | 37/100 [02:53<04:49,  4.60s/it] 38%|███▊      | 38/100 [02:58<04:44,  4.59s/it] 39%|███▉      | 39/100 [03:03<04:43,  4.64s/it] 40%|████      | 40/100 [03:07<04:31,  4.53s/it] 41%|████      | 41/100 [03:11<04:24,  4.48s/it] 42%|████▏     | 42/100 [03:16<04:20,  4.49s/it] 43%|████▎     | 43/100 [03:20<04:16,  4.51s/it] 44%|████▍     | 44/100 [03:25<04:13,  4.52s/it] 45%|████▌     | 45/100 [03:30<04:14,  4.62s/it] 46%|████▌     | 46/100 [03:35<04:09,  4.62s/it] 47%|████▋     | 47/100 [03:39<04:08,  4.69s/it] 48%|████▊     | 48/100 [03:44<04:06,  4.75s/it] 49%|████▉     | 49/100 [03:49<04:03,  4.78s/it] 50%|█████     | 50/100 [03:54<04:00,  4.81s/it] 51%|█████     | 51/100 [03:59<03:52,  4.75s/it] 52%|█████▏    | 52/100 [04:03<03:46,  4.72s/it] 53%|█████▎    | 53/100 [04:08<03:41,  4.72s/it] 54%|█████▍    | 54/100 [04:13<03:36,  4.71s/it] 55%|█████▌    | 55/100 [04:17<03:31,  4.71s/it] 56%|█████▌    | 56/100 [04:22<03:25,  4.67s/it] 57%|█████▋    | 57/100 [04:27<03:21,  4.69s/it] 58%|█████▊    | 58/100 [04:32<03:18,  4.74s/it] 59%|█████▉    | 59/100 [04:36<03:14,  4.74s/it] 60%|██████    | 60/100 [04:41<03:07,  4.69s/it] 61%|██████    | 61/100 [04:45<03:00,  4.63s/it] 62%|██████▏   | 62/100 [04:50<02:53,  4.57s/it] 63%|██████▎   | 63/100 [04:54<02:46,  4.51s/it] 64%|██████▍   | 64/100 [04:59<02:41,  4.50s/it] 65%|██████▌   | 65/100 [05:03<02:36,  4.47s/it] 66%|██████▌   | 66/100 [05:07<02:31,  4.46s/it] 67%|██████▋   | 67/100 [05:12<02:27,  4.46s/it] 68%|██████▊   | 68/100 [05:17<02:25,  4.55s/it] 69%|██████▉   | 69/100 [05:22<02:23,  4.64s/it] 70%|███████   | 70/100 [05:26<02:19,  4.64s/it] 71%|███████   | 71/100 [05:31<02:13,  4.59s/it] 72%|███████▏  | 72/100 [05:35<02:09,  4.63s/it] 73%|███████▎  | 73/100 [05:40<02:07,  4.71s/it] 74%|███████▍  | 74/100 [05:45<02:05,  4.81s/it] 75%|███████▌  | 75/100 [05:50<02:02,  4.88s/it] 76%|███████▌  | 76/100 [05:55<01:59,  4.96s/it] 77%|███████▋  | 77/100 [06:00<01:54,  4.96s/it] 78%|███████▊  | 78/100 [06:05<01:49,  4.97s/it] 79%|███████▉  | 79/100 [06:10<01:43,  4.92s/it] 80%|████████  | 80/100 [06:15<01:38,  4.93s/it] 81%|████████  | 81/100 [06:20<01:35,  5.01s/it] 82%|████████▏ | 82/100 [06:25<01:28,  4.93s/it] 83%|████████▎ | 83/100 [06:30<01:23,  4.92s/it] 84%|████████▍ | 84/100 [06:35<01:18,  4.91s/it] 85%|████████▌ | 85/100 [06:40<01:13,  4.89s/it] 86%|████████▌ | 86/100 [06:45<01:09,  4.93s/it] 87%|████████▋ | 87/100 [06:50<01:04,  4.95s/it] 88%|████████▊ | 88/100 [06:55<01:00,  5.04s/it] 89%|████████▉ | 89/100 [07:00<00:55,  5.06s/it] 90%|█████████ | 90/100 [07:05<00:49,  4.99s/it] 91%|█████████ | 91/100 [07:09<00:43,  4.85s/it] 92%|█████████▏| 92/100 [07:14<00:38,  4.79s/it] 93%|█████████▎| 93/100 [07:19<00:33,  4.74s/it] 94%|█████████▍| 94/100 [07:23<00:28,  4.71s/it] 95%|█████████▌| 95/100 [07:28<00:24,  4.80s/it] 96%|█████████▌| 96/100 [07:33<00:18,  4.73s/it] 97%|█████████▋| 97/100 [07:38<00:14,  4.82s/it] 98%|█████████▊| 98/100 [07:43<00:09,  4.83s/it] 99%|█████████▉| 99/100 [07:48<00:04,  4.88s/it]100%|██████████| 100/100 [07:53<00:00,  4.86s/it]100%|██████████| 100/100 [07:53<00:00,  4.73s/it]
[0/100] loss: 2.6774706840515137 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 0.7648107409477234
[1/100] loss: 1.1479361057281494 loss_joints: 1.094731092453003 loss_collision: 0.0 loss_jerk: 0.07815314084291458 loss_floor_contact: 0.45389705896377563
[2/100] loss: 1.2021570205688477 loss_joints: 1.159254550933838 loss_collision: 0.000195154789253138 loss_jerk: 0.08768852055072784 loss_floor_contact: 0.34114137291908264
[3/100] loss: 0.4152398109436035 loss_joints: 0.403949111700058 loss_collision: 0.00045473530190065503 loss_jerk: 0.08232497423887253 loss_floor_contact: 0.03012702241539955
[4/100] loss: 0.032357797026634216 loss_joints: 0.02000625804066658 loss_collision: 0.0 loss_jerk: 0.10291621834039688 loss_floor_contact: 0.020599182695150375
[5/100] loss: 0.03849603980779648 loss_joints: 0.027624865993857384 loss_collision: 0.0 loss_jerk: 0.10871171951293945 loss_floor_contact: 0.0
[6/100] loss: 0.07342007011175156 loss_joints: 0.06376070529222488 loss_collision: 0.0 loss_jerk: 0.09659361839294434 loss_floor_contact: 0.0
[7/100] loss: 0.03942462056875229 loss_joints: 0.030932333320379257 loss_collision: 0.0 loss_jerk: 0.08492286503314972 loss_floor_contact: 0.0
[8/100] loss: 0.012569386512041092 loss_joints: 0.005054275505244732 loss_collision: 0.0 loss_jerk: 0.07515110820531845 loss_floor_contact: 0.0
[9/100] loss: 0.012230386957526207 loss_joints: 0.005267647095024586 loss_collision: 0.0 loss_jerk: 0.06962739676237106 loss_floor_contact: 0.0
[10/100] loss: 0.010898558422923088 loss_joints: 0.004214323125779629 loss_collision: 0.0 loss_jerk: 0.06684235483407974 loss_floor_contact: 0.0
[11/100] loss: 0.008293061517179012 loss_joints: 0.001606843783520162 loss_collision: 0.0 loss_jerk: 0.06686218082904816 loss_floor_contact: 0.0
[12/100] loss: 0.015256635844707489 loss_joints: 0.008487320505082607 loss_collision: 0.0 loss_jerk: 0.06769315153360367 loss_floor_contact: 0.0
[13/100] loss: 0.01351984217762947 loss_joints: 0.0069359950721263885 loss_collision: 0.0 loss_jerk: 0.06583847105503082 loss_floor_contact: 0.0
[14/100] loss: 0.008120378479361534 loss_joints: 0.0018778525991365314 loss_collision: 0.0 loss_jerk: 0.06242525950074196 loss_floor_contact: 0.0
[15/100] loss: 0.008798852562904358 loss_joints: 0.002553278114646673 loss_collision: 0.0 loss_jerk: 0.062455739825963974 loss_floor_contact: 0.0
[16/100] loss: 0.008570054545998573 loss_joints: 0.0020381161011755466 loss_collision: 0.0 loss_jerk: 0.06531938910484314 loss_floor_contact: 0.0
[17/100] loss: 0.007403723895549774 loss_joints: 0.0010470501147210598 loss_collision: 0.0 loss_jerk: 0.06356673687696457 loss_floor_contact: 0.0
[18/100] loss: 0.007461864035576582 loss_joints: 0.0014839860377833247 loss_collision: 0.0 loss_jerk: 0.05977877974510193 loss_floor_contact: 0.0
[19/100] loss: 0.00705457990989089 loss_joints: 0.0011764300288632512 loss_collision: 0.0 loss_jerk: 0.058781497180461884 loss_floor_contact: 0.0
[20/100] loss: 0.006373181007802486 loss_joints: 0.0005297745228745043 loss_collision: 0.0 loss_jerk: 0.05843406543135643 loss_floor_contact: 0.0
[21/100] loss: 0.006632292177528143 loss_joints: 0.0009327902225777507 loss_collision: 0.0 loss_jerk: 0.05699501931667328 loss_floor_contact: 0.0
[22/100] loss: 0.005788556300103664 loss_joints: 0.0003354107029736042 loss_collision: 0.0 loss_jerk: 0.05453145503997803 loss_floor_contact: 0.0
[23/100] loss: 0.006695485208183527 loss_joints: 0.0012746016727760434 loss_collision: 0.0 loss_jerk: 0.05420883744955063 loss_floor_contact: 0.0
[24/100] loss: 0.006508189719170332 loss_joints: 0.0011454257182776928 loss_collision: 0.0 loss_jerk: 0.05362764000892639 loss_floor_contact: 0.0
[25/100] loss: 0.00581363495439291 loss_joints: 0.0005947926547378302 loss_collision: 0.0 loss_jerk: 0.05218842253088951 loss_floor_contact: 0.0
[26/100] loss: 0.005807789042592049 loss_joints: 0.0007192233460955322 loss_collision: 0.0 loss_jerk: 0.05088565871119499 loss_floor_contact: 0.0
[27/100] loss: 0.0057014478370547295 loss_joints: 0.0007651516934856772 loss_collision: 0.0 loss_jerk: 0.04936295747756958 loss_floor_contact: 0.0
[28/100] loss: 0.0050058490596711636 loss_joints: 0.0001477905025240034 loss_collision: 0.0 loss_jerk: 0.048580583184957504 loss_floor_contact: 0.0
[29/100] loss: 0.006323626264929771 loss_joints: 0.0016055912710726261 loss_collision: 0.0 loss_jerk: 0.04718034714460373 loss_floor_contact: 0.0
[30/100] loss: 0.005840012803673744 loss_joints: 0.0011997184483334422 loss_collision: 0.0 loss_jerk: 0.0464029423892498 loss_floor_contact: 0.0
[31/100] loss: 0.004836706444621086 loss_joints: 0.0002047255402430892 loss_collision: 0.0 loss_jerk: 0.04631980508565903 loss_floor_contact: 0.0
[32/100] loss: 0.00473810825496912 loss_joints: 0.0002523969451431185 loss_collision: 0.0 loss_jerk: 0.04485711455345154 loss_floor_contact: 0.0
[33/100] loss: 0.004954932723194361 loss_joints: 0.0005962656578049064 loss_collision: 0.0 loss_jerk: 0.043586667627096176 loss_floor_contact: 0.0
[34/100] loss: 0.00464642932638526 loss_joints: 0.00035108611336909235 loss_collision: 0.0 loss_jerk: 0.042953427881002426 loss_floor_contact: 0.0
[35/100] loss: 0.005167428404092789 loss_joints: 0.0008491005282849073 loss_collision: 0.0 loss_jerk: 0.04318327456712723 loss_floor_contact: 0.0
[36/100] loss: 0.005113564897328615 loss_joints: 0.0008372076554223895 loss_collision: 0.0 loss_jerk: 0.042763568460941315 loss_floor_contact: 0.0
[37/100] loss: 0.004389700945466757 loss_joints: 0.00020379589113872498 loss_collision: 0.0 loss_jerk: 0.04185904935002327 loss_floor_contact: 0.0
[38/100] loss: 0.004301709122955799 loss_joints: 0.00017416971968486905 loss_collision: 0.0 loss_jerk: 0.04127539321780205 loss_floor_contact: 0.0
[39/100] loss: 0.004602899309247732 loss_joints: 0.0004903177032247186 loss_collision: 0.0 loss_jerk: 0.041125815361738205 loss_floor_contact: 0.0
[40/100] loss: 0.004301570355892181 loss_joints: 0.0002355556789552793 loss_collision: 0.0 loss_jerk: 0.04066014662384987 loss_floor_contact: 0.0
[41/100] loss: 0.004581950139254332 loss_joints: 0.000626570952590555 loss_collision: 0.0 loss_jerk: 0.03955379128456116 loss_floor_contact: 0.0
[42/100] loss: 0.004650551360100508 loss_joints: 0.0007282234146259725 loss_collision: 0.0 loss_jerk: 0.03922327980399132 loss_floor_contact: 0.0
[43/100] loss: 0.004037665203213692 loss_joints: 0.00012876710388809443 loss_collision: 0.0 loss_jerk: 0.039088983088731766 loss_floor_contact: 0.0
[44/100] loss: 0.0039663054049015045 loss_joints: 0.00019759891438297927 loss_collision: 0.0 loss_jerk: 0.037687063217163086 loss_floor_contact: 0.0
[45/100] loss: 0.0040461719036102295 loss_joints: 0.0003082726616412401 loss_collision: 0.0 loss_jerk: 0.03737899288535118 loss_floor_contact: 0.0
[46/100] loss: 0.0038374965079128742 loss_joints: 8.383697422686964e-05 loss_collision: 0.0 loss_jerk: 0.03753659501671791 loss_floor_contact: 0.0
[47/100] loss: 0.004321502987295389 loss_joints: 0.0005915692308917642 loss_collision: 0.0 loss_jerk: 0.03729933872818947 loss_floor_contact: 0.0
[48/100] loss: 0.004278103355318308 loss_joints: 0.0006101980106905103 loss_collision: 0.0 loss_jerk: 0.03667905181646347 loss_floor_contact: 0.0
[49/100] loss: 0.0036027012392878532 loss_joints: 3.6631176044465974e-05 loss_collision: 0.0 loss_jerk: 0.035660699009895325 loss_floor_contact: 0.0
[50/100] loss: 0.00383490021340549 loss_joints: 0.00035132846096530557 loss_collision: 0.0 loss_jerk: 0.03483571857213974 loss_floor_contact: 0.0
[51/100] loss: 0.0037566523533314466 loss_joints: 0.0002702321216929704 loss_collision: 0.0 loss_jerk: 0.03486420214176178 loss_floor_contact: 0.0
[52/100] loss: 0.0035306622739881277 loss_joints: 8.607817289885134e-05 loss_collision: 0.0 loss_jerk: 0.03444584086537361 loss_floor_contact: 0.0
[53/100] loss: 0.0036697518080472946 loss_joints: 0.00031193115864880383 loss_collision: 0.0 loss_jerk: 0.03357820585370064 loss_floor_contact: 0.0
[54/100] loss: 0.0034604573156684637 loss_joints: 0.00013799447333440185 loss_collision: 0.0 loss_jerk: 0.03322462737560272 loss_floor_contact: 0.0
[55/100] loss: 0.003553323447704315 loss_joints: 0.000207260949537158 loss_collision: 0.0 loss_jerk: 0.033460624516010284 loss_floor_contact: 0.0
[56/100] loss: 0.003548376727849245 loss_joints: 0.0002590549411252141 loss_collision: 0.0 loss_jerk: 0.03289321810007095 loss_floor_contact: 0.0
[57/100] loss: 0.0033052677754312754 loss_joints: 7.222689600894228e-05 loss_collision: 0.0 loss_jerk: 0.032330408692359924 loss_floor_contact: 0.0
[58/100] loss: 0.003412392223253846 loss_joints: 0.0001321294403169304 loss_collision: 0.0 loss_jerk: 0.03280262649059296 loss_floor_contact: 0.0
[59/100] loss: 0.003279922530055046 loss_joints: 7.065005775075406e-05 loss_collision: 0.0 loss_jerk: 0.03209272399544716 loss_floor_contact: 0.0
[60/100] loss: 0.0032888497225940228 loss_joints: 0.00010253075743094087 loss_collision: 0.0 loss_jerk: 0.03186319023370743 loss_floor_contact: 0.0
[61/100] loss: 0.003247882006689906 loss_joints: 8.9461995230522e-05 loss_collision: 0.0 loss_jerk: 0.03158419951796532 loss_floor_contact: 0.0
[62/100] loss: 0.003225741209462285 loss_joints: 7.86284072091803e-05 loss_collision: 0.0 loss_jerk: 0.0314711295068264 loss_floor_contact: 0.0
[63/100] loss: 0.0032498021610081196 loss_joints: 0.00015559347230009735 loss_collision: 0.0 loss_jerk: 0.03094208613038063 loss_floor_contact: 0.0
[64/100] loss: 0.003116279374808073 loss_joints: 6.676999328192323e-05 loss_collision: 0.0 loss_jerk: 0.030495094135403633 loss_floor_contact: 0.0
[65/100] loss: 0.003130213124677539 loss_joints: 0.00012471350783016533 loss_collision: 0.0 loss_jerk: 0.03005499765276909 loss_floor_contact: 0.0
[66/100] loss: 0.0031057451851665974 loss_joints: 0.00012710102600976825 loss_collision: 0.0 loss_jerk: 0.02978644147515297 loss_floor_contact: 0.0
[67/100] loss: 0.0030170169193297625 loss_joints: 5.335751848178916e-05 loss_collision: 0.0 loss_jerk: 0.029636593535542488 loss_floor_contact: 0.0
[68/100] loss: 0.003022239077836275 loss_joints: 7.331712549785152e-05 loss_collision: 0.0 loss_jerk: 0.029489217326045036 loss_floor_contact: 0.0
[69/100] loss: 0.0030361865647137165 loss_joints: 7.964847463881597e-05 loss_collision: 0.0 loss_jerk: 0.02956537902355194 loss_floor_contact: 0.0
[70/100] loss: 0.002908342285081744 loss_joints: 1.6056015738286078e-05 loss_collision: 0.0 loss_jerk: 0.02892286330461502 loss_floor_contact: 0.0
[71/100] loss: 0.0028764507733285427 loss_joints: 1.7985410522669554e-05 loss_collision: 0.0 loss_jerk: 0.02858465351164341 loss_floor_contact: 0.0
[72/100] loss: 0.0029093462508171797 loss_joints: 3.113725324510597e-05 loss_collision: 0.0 loss_jerk: 0.028782090172171593 loss_floor_contact: 0.0
[73/100] loss: 0.0028470742981880903 loss_joints: 1.2564923054014798e-05 loss_collision: 0.0 loss_jerk: 0.02834509313106537 loss_floor_contact: 0.0
[74/100] loss: 0.0028192917816340923 loss_joints: 2.2618711227551103e-05 loss_collision: 0.0 loss_jerk: 0.027966728433966637 loss_floor_contact: 0.0
[75/100] loss: 0.002790801925584674 loss_joints: 8.092931238934398e-06 loss_collision: 0.0 loss_jerk: 0.02782708965241909 loss_floor_contact: 0.0
[76/100] loss: 0.0027990045491605997 loss_joints: 3.463094981270842e-05 loss_collision: 0.0 loss_jerk: 0.027643734589219093 loss_floor_contact: 0.0
[77/100] loss: 0.002766077872365713 loss_joints: 3.4879674785770476e-05 loss_collision: 0.0 loss_jerk: 0.027311982586979866 loss_floor_contact: 0.0
[78/100] loss: 0.002752091735601425 loss_joints: 3.6446485864871647e-06 loss_collision: 0.0 loss_jerk: 0.0274844691157341 loss_floor_contact: 0.0
[79/100] loss: 0.00282491953112185 loss_joints: 7.597536023240536e-05 loss_collision: 0.0 loss_jerk: 0.027489440515637398 loss_floor_contact: 0.0
[80/100] loss: 0.0027497282717376947 loss_joints: 5.303928264766e-05 loss_collision: 0.0 loss_jerk: 0.026966888457536697 loss_floor_contact: 0.0
[81/100] loss: 0.0027284310199320316 loss_joints: 5.1238268497399986e-05 loss_collision: 0.0 loss_jerk: 0.026771927252411842 loss_floor_contact: 0.0
[82/100] loss: 0.002687124302610755 loss_joints: 5.010619861423038e-05 loss_collision: 0.0 loss_jerk: 0.026370182633399963 loss_floor_contact: 0.0
[83/100] loss: 0.002644685562700033 loss_joints: 2.3787240934325382e-05 loss_collision: 0.0 loss_jerk: 0.02620898373425007 loss_floor_contact: 0.0
[84/100] loss: 0.0026394634041935205 loss_joints: 2.4080791263259016e-05 loss_collision: 0.0 loss_jerk: 0.026153825223445892 loss_floor_contact: 0.0
[85/100] loss: 0.0026067709550261497 loss_joints: 1.1209350304852705e-05 loss_collision: 0.0 loss_jerk: 0.02595561556518078 loss_floor_contact: 0.0
[86/100] loss: 0.0025763073936104774 loss_joints: 1.599473580427002e-05 loss_collision: 0.0 loss_jerk: 0.025603124871850014 loss_floor_contact: 0.0
[87/100] loss: 0.00258208648301661 loss_joints: 1.002713088382734e-05 loss_collision: 0.0 loss_jerk: 0.025720592588186264 loss_floor_contact: 0.0
[88/100] loss: 0.0025547954719513655 loss_joints: 3.410608769627288e-06 loss_collision: 0.0 loss_jerk: 0.025513848289847374 loss_floor_contact: 0.0
[89/100] loss: 0.0025492114946246147 loss_joints: 2.6508778319112025e-05 loss_collision: 0.0 loss_jerk: 0.025227027013897896 loss_floor_contact: 0.0
[90/100] loss: 0.00252479943446815 loss_joints: 1.7282496628467925e-05 loss_collision: 0.0 loss_jerk: 0.025075169280171394 loss_floor_contact: 0.0
[91/100] loss: 0.002520287875086069 loss_joints: 6.309358923317632e-06 loss_collision: 0.0 loss_jerk: 0.025139786303043365 loss_floor_contact: 0.0
[92/100] loss: 0.002497776411473751 loss_joints: 7.6267369877314195e-06 loss_collision: 0.0 loss_jerk: 0.02490149438381195 loss_floor_contact: 0.0
[93/100] loss: 0.00248109083622694 loss_joints: 3.1724493965157308e-06 loss_collision: 0.0 loss_jerk: 0.02477918192744255 loss_floor_contact: 0.0
[94/100] loss: 0.002471156883984804 loss_joints: 5.271770987747004e-06 loss_collision: 0.0 loss_jerk: 0.024658851325511932 loss_floor_contact: 0.0
[95/100] loss: 0.0024466230534017086 loss_joints: 1.4119948446023045e-06 loss_collision: 0.0 loss_jerk: 0.02445211075246334 loss_floor_contact: 0.0
[96/100] loss: 0.00244074291549623 loss_joints: 1.9215606243960792e-06 loss_collision: 0.0 loss_jerk: 0.024388212710618973 loss_floor_contact: 0.0
[97/100] loss: 0.0024307509884238243 loss_joints: 1.117806505135377e-06 loss_collision: 0.0 loss_jerk: 0.024296332150697708 loss_floor_contact: 0.0
[98/100] loss: 0.002430462511256337 loss_joints: 1.5916803022264503e-06 loss_collision: 0.0 loss_jerk: 0.024288708344101906 loss_floor_contact: 0.0
[99/100] loss: 0.0024244943633675575 loss_joints: 6.171131872179103e-07 loss_collision: 0.0 loss_jerk: 0.024238772690296173 loss_floor_contact: 0.0
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.25/contact_thresh_0.75/cabE-path3-run12-4000_collision0.1_contact0.1_jerk0.1_skate0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 473.16721                                                    ║
    ║     rollout = 223.48828                                                    ║
    ║     sdf     = 22.87301                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00242449                                                 ║
    ║     joints    = 0.00000062                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.02423877                                                 ║
    ║     floor     = 0.00000000                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	8m32.683s
user	7m16.900s
sys	0m21.807s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.1, skate=0.5
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<07:31,  4.57s/it]  2%|▏         | 2/100 [00:09<07:25,  4.55s/it]  3%|▎         | 3/100 [00:14<07:40,  4.75s/it]  4%|▍         | 4/100 [00:18<07:33,  4.72s/it]  5%|▌         | 5/100 [00:23<07:25,  4.69s/it]  6%|▌         | 6/100 [00:28<07:34,  4.83s/it]  7%|▋         | 7/100 [00:33<07:20,  4.74s/it]  8%|▊         | 8/100 [00:37<07:14,  4.72s/it]  9%|▉         | 9/100 [00:42<07:09,  4.73s/it] 10%|█         | 10/100 [00:47<07:02,  4.70s/it] 11%|█         | 11/100 [00:52<07:06,  4.79s/it] 12%|█▏        | 12/100 [00:56<06:53,  4.70s/it] 13%|█▎        | 13/100 [01:00<06:39,  4.59s/it] 14%|█▍        | 14/100 [01:05<06:30,  4.54s/it] 15%|█▌        | 15/100 [01:09<06:20,  4.47s/it] 16%|█▌        | 16/100 [01:13<06:10,  4.41s/it] 17%|█▋        | 17/100 [01:18<06:10,  4.46s/it] 18%|█▊        | 18/100 [01:23<06:11,  4.53s/it] 19%|█▉        | 19/100 [01:27<06:11,  4.58s/it] 20%|██        | 20/100 [01:32<06:10,  4.64s/it] 21%|██        | 21/100 [01:37<06:01,  4.58s/it] 22%|██▏       | 22/100 [01:41<05:58,  4.60s/it] 23%|██▎       | 23/100 [01:46<06:00,  4.68s/it] 24%|██▍       | 24/100 [01:51<06:09,  4.86s/it] 25%|██▌       | 25/100 [01:56<06:03,  4.84s/it] 26%|██▌       | 26/100 [02:01<06:00,  4.87s/it] 27%|██▋       | 27/100 [02:06<05:51,  4.81s/it] 28%|██▊       | 28/100 [02:11<06:04,  5.06s/it] 29%|██▉       | 29/100 [02:17<06:01,  5.10s/it] 30%|███       | 30/100 [02:22<05:56,  5.09s/it] 31%|███       | 31/100 [02:27<05:51,  5.10s/it] 32%|███▏      | 32/100 [02:33<06:00,  5.31s/it] 33%|███▎      | 33/100 [02:38<05:53,  5.28s/it] 34%|███▍      | 34/100 [02:43<05:45,  5.23s/it] 35%|███▌      | 35/100 [02:48<05:39,  5.23s/it] 36%|███▌      | 36/100 [02:53<05:32,  5.20s/it] 37%|███▋      | 37/100 [02:58<05:26,  5.18s/it] 38%|███▊      | 38/100 [03:04<05:30,  5.32s/it] 39%|███▉      | 39/100 [03:10<05:30,  5.42s/it] 40%|████      | 40/100 [03:15<05:29,  5.49s/it] 41%|████      | 41/100 [03:21<05:28,  5.58s/it] 42%|████▏     | 42/100 [03:27<05:19,  5.51s/it] 43%|████▎     | 43/100 [03:32<05:12,  5.48s/it] 44%|████▍     | 44/100 [03:38<05:08,  5.51s/it] 45%|████▌     | 45/100 [03:42<04:49,  5.26s/it] 46%|████▌     | 46/100 [03:47<04:34,  5.08s/it] 47%|████▋     | 47/100 [03:52<04:26,  5.02s/it] 48%|████▊     | 48/100 [03:57<04:30,  5.19s/it] 49%|████▉     | 49/100 [04:02<04:20,  5.10s/it] 50%|█████     | 50/100 [04:07<04:09,  5.00s/it] 51%|█████     | 51/100 [04:12<04:04,  4.99s/it] 52%|█████▏    | 52/100 [04:18<04:15,  5.32s/it] 53%|█████▎    | 53/100 [04:23<04:11,  5.35s/it] 54%|█████▍    | 54/100 [04:28<03:54,  5.09s/it] 55%|█████▌    | 55/100 [04:32<03:40,  4.90s/it] 56%|█████▌    | 56/100 [04:37<03:33,  4.86s/it] 57%|█████▋    | 57/100 [04:42<03:28,  4.84s/it] 58%|█████▊    | 58/100 [04:47<03:24,  4.87s/it] 59%|█████▉    | 59/100 [04:52<03:16,  4.78s/it] 60%|██████    | 60/100 [04:57<03:18,  4.96s/it] 61%|██████    | 61/100 [05:02<03:19,  5.11s/it] 62%|██████▏   | 62/100 [05:07<03:12,  5.07s/it] 63%|██████▎   | 63/100 [05:12<03:07,  5.08s/it] 64%|██████▍   | 64/100 [05:18<03:03,  5.09s/it] 65%|██████▌   | 65/100 [05:23<03:00,  5.17s/it] 66%|██████▌   | 66/100 [05:28<02:51,  5.04s/it] 67%|██████▋   | 67/100 [05:32<02:44,  4.98s/it] 68%|██████▊   | 68/100 [05:37<02:38,  4.97s/it] 69%|██████▉   | 69/100 [05:43<02:35,  5.02s/it] 70%|███████   | 70/100 [05:47<02:26,  4.90s/it] 71%|███████   | 71/100 [05:52<02:18,  4.77s/it] 72%|███████▏  | 72/100 [05:56<02:12,  4.73s/it] 73%|███████▎  | 73/100 [06:01<02:09,  4.78s/it] 74%|███████▍  | 74/100 [06:07<02:09,  4.97s/it] 75%|███████▌  | 75/100 [06:11<02:03,  4.94s/it] 76%|███████▌  | 76/100 [06:16<01:56,  4.84s/it] 77%|███████▋  | 77/100 [06:21<01:51,  4.84s/it] 78%|███████▊  | 78/100 [06:26<01:46,  4.83s/it] 79%|███████▉  | 79/100 [06:31<01:41,  4.83s/it] 80%|████████  | 80/100 [06:36<01:38,  4.93s/it] 81%|████████  | 81/100 [06:40<01:30,  4.77s/it] 82%|████████▏ | 82/100 [06:44<01:23,  4.64s/it] 83%|████████▎ | 83/100 [06:50<01:21,  4.79s/it] 84%|████████▍ | 84/100 [06:54<01:17,  4.82s/it] 85%|████████▌ | 85/100 [07:00<01:14,  4.96s/it] 86%|████████▌ | 86/100 [07:05<01:08,  4.90s/it] 87%|████████▋ | 87/100 [07:09<01:03,  4.87s/it] 88%|████████▊ | 88/100 [07:15<00:59,  4.97s/it] 89%|████████▉ | 89/100 [07:20<00:56,  5.14s/it] 90%|█████████ | 90/100 [07:25<00:51,  5.15s/it] 91%|█████████ | 91/100 [07:30<00:45,  5.09s/it] 92%|█████████▏| 92/100 [07:35<00:40,  5.02s/it] 93%|█████████▎| 93/100 [07:40<00:34,  4.97s/it] 94%|█████████▍| 94/100 [07:45<00:29,  5.00s/it] 95%|█████████▌| 95/100 [07:50<00:25,  5.11s/it] 96%|█████████▌| 96/100 [07:55<00:20,  5.07s/it] 97%|█████████▋| 97/100 [08:00<00:15,  5.03s/it] 98%|█████████▊| 98/100 [08:05<00:09,  4.98s/it] 99%|█████████▉| 99/100 [08:10<00:04,  4.91s/it]100%|██████████| 100/100 [08:15<00:00,  4.85s/it]100%|██████████| 100/100 [08:15<00:00,  4.95s/it]
[0/100] loss: 2.6774706840515137 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 0.7648107409477234
[1/100] loss: 1.1479361057281494 loss_joints: 1.094731092453003 loss_collision: 0.0 loss_jerk: 0.07815314084291458 loss_floor_contact: 0.45389705896377563
[2/100] loss: 1.2021570205688477 loss_joints: 1.159254550933838 loss_collision: 0.000195154789253138 loss_jerk: 0.08768852055072784 loss_floor_contact: 0.34114137291908264
[3/100] loss: 0.4152398109436035 loss_joints: 0.403949111700058 loss_collision: 0.00045473530190065503 loss_jerk: 0.08232497423887253 loss_floor_contact: 0.03012702241539955
[4/100] loss: 0.032357797026634216 loss_joints: 0.02000625804066658 loss_collision: 0.0 loss_jerk: 0.10291621834039688 loss_floor_contact: 0.020599182695150375
[5/100] loss: 0.03849603980779648 loss_joints: 0.027624865993857384 loss_collision: 0.0 loss_jerk: 0.10871171951293945 loss_floor_contact: 0.0
[6/100] loss: 0.07342007011175156 loss_joints: 0.06376070529222488 loss_collision: 0.0 loss_jerk: 0.09659361839294434 loss_floor_contact: 0.0
[7/100] loss: 0.03942462056875229 loss_joints: 0.030932333320379257 loss_collision: 0.0 loss_jerk: 0.08492286503314972 loss_floor_contact: 0.0
[8/100] loss: 0.012569386512041092 loss_joints: 0.005054275505244732 loss_collision: 0.0 loss_jerk: 0.07515110820531845 loss_floor_contact: 0.0
[9/100] loss: 0.012230386957526207 loss_joints: 0.005267647095024586 loss_collision: 0.0 loss_jerk: 0.06962739676237106 loss_floor_contact: 0.0
[10/100] loss: 0.010898558422923088 loss_joints: 0.004214323125779629 loss_collision: 0.0 loss_jerk: 0.06684235483407974 loss_floor_contact: 0.0
[11/100] loss: 0.008293061517179012 loss_joints: 0.001606843783520162 loss_collision: 0.0 loss_jerk: 0.06686218082904816 loss_floor_contact: 0.0
[12/100] loss: 0.015256635844707489 loss_joints: 0.008487320505082607 loss_collision: 0.0 loss_jerk: 0.06769315153360367 loss_floor_contact: 0.0
[13/100] loss: 0.01351984217762947 loss_joints: 0.0069359950721263885 loss_collision: 0.0 loss_jerk: 0.06583847105503082 loss_floor_contact: 0.0
[14/100] loss: 0.008120378479361534 loss_joints: 0.0018778525991365314 loss_collision: 0.0 loss_jerk: 0.06242525950074196 loss_floor_contact: 0.0
[15/100] loss: 0.008798852562904358 loss_joints: 0.002553278114646673 loss_collision: 0.0 loss_jerk: 0.062455739825963974 loss_floor_contact: 0.0
[16/100] loss: 0.008570054545998573 loss_joints: 0.0020381161011755466 loss_collision: 0.0 loss_jerk: 0.06531938910484314 loss_floor_contact: 0.0
[17/100] loss: 0.007403723895549774 loss_joints: 0.0010470501147210598 loss_collision: 0.0 loss_jerk: 0.06356673687696457 loss_floor_contact: 0.0
[18/100] loss: 0.007461864035576582 loss_joints: 0.0014839860377833247 loss_collision: 0.0 loss_jerk: 0.05977877974510193 loss_floor_contact: 0.0
[19/100] loss: 0.00705457990989089 loss_joints: 0.0011764300288632512 loss_collision: 0.0 loss_jerk: 0.058781497180461884 loss_floor_contact: 0.0
[20/100] loss: 0.006373181007802486 loss_joints: 0.0005297745228745043 loss_collision: 0.0 loss_jerk: 0.05843406543135643 loss_floor_contact: 0.0
[21/100] loss: 0.006632292177528143 loss_joints: 0.0009327902225777507 loss_collision: 0.0 loss_jerk: 0.05699501931667328 loss_floor_contact: 0.0
[22/100] loss: 0.005788556300103664 loss_joints: 0.0003354107029736042 loss_collision: 0.0 loss_jerk: 0.05453145503997803 loss_floor_contact: 0.0
[23/100] loss: 0.006695485208183527 loss_joints: 0.0012746016727760434 loss_collision: 0.0 loss_jerk: 0.05420883744955063 loss_floor_contact: 0.0
[24/100] loss: 0.006508189719170332 loss_joints: 0.0011454257182776928 loss_collision: 0.0 loss_jerk: 0.05362764000892639 loss_floor_contact: 0.0
[25/100] loss: 0.00581363495439291 loss_joints: 0.0005947926547378302 loss_collision: 0.0 loss_jerk: 0.05218842253088951 loss_floor_contact: 0.0
[26/100] loss: 0.005807789042592049 loss_joints: 0.0007192233460955322 loss_collision: 0.0 loss_jerk: 0.05088565871119499 loss_floor_contact: 0.0
[27/100] loss: 0.0057014478370547295 loss_joints: 0.0007651516934856772 loss_collision: 0.0 loss_jerk: 0.04936295747756958 loss_floor_contact: 0.0
[28/100] loss: 0.0050058490596711636 loss_joints: 0.0001477905025240034 loss_collision: 0.0 loss_jerk: 0.048580583184957504 loss_floor_contact: 0.0
[29/100] loss: 0.006323626264929771 loss_joints: 0.0016055912710726261 loss_collision: 0.0 loss_jerk: 0.04718034714460373 loss_floor_contact: 0.0
[30/100] loss: 0.005840012803673744 loss_joints: 0.0011997184483334422 loss_collision: 0.0 loss_jerk: 0.0464029423892498 loss_floor_contact: 0.0
[31/100] loss: 0.004836706444621086 loss_joints: 0.0002047255402430892 loss_collision: 0.0 loss_jerk: 0.04631980508565903 loss_floor_contact: 0.0
[32/100] loss: 0.00473810825496912 loss_joints: 0.0002523969451431185 loss_collision: 0.0 loss_jerk: 0.04485711455345154 loss_floor_contact: 0.0
[33/100] loss: 0.004954932723194361 loss_joints: 0.0005962656578049064 loss_collision: 0.0 loss_jerk: 0.043586667627096176 loss_floor_contact: 0.0
[34/100] loss: 0.00464642932638526 loss_joints: 0.00035108611336909235 loss_collision: 0.0 loss_jerk: 0.042953427881002426 loss_floor_contact: 0.0
[35/100] loss: 0.005167428404092789 loss_joints: 0.0008491005282849073 loss_collision: 0.0 loss_jerk: 0.04318327456712723 loss_floor_contact: 0.0
[36/100] loss: 0.005113564897328615 loss_joints: 0.0008372076554223895 loss_collision: 0.0 loss_jerk: 0.042763568460941315 loss_floor_contact: 0.0
[37/100] loss: 0.004389700945466757 loss_joints: 0.00020379589113872498 loss_collision: 0.0 loss_jerk: 0.04185904935002327 loss_floor_contact: 0.0
[38/100] loss: 0.004301709122955799 loss_joints: 0.00017416971968486905 loss_collision: 0.0 loss_jerk: 0.04127539321780205 loss_floor_contact: 0.0
[39/100] loss: 0.004602899309247732 loss_joints: 0.0004903177032247186 loss_collision: 0.0 loss_jerk: 0.041125815361738205 loss_floor_contact: 0.0
[40/100] loss: 0.004301570355892181 loss_joints: 0.0002355556789552793 loss_collision: 0.0 loss_jerk: 0.04066014662384987 loss_floor_contact: 0.0
[41/100] loss: 0.004581950139254332 loss_joints: 0.000626570952590555 loss_collision: 0.0 loss_jerk: 0.03955379128456116 loss_floor_contact: 0.0
[42/100] loss: 0.004650551360100508 loss_joints: 0.0007282234146259725 loss_collision: 0.0 loss_jerk: 0.03922327980399132 loss_floor_contact: 0.0
[43/100] loss: 0.004037665203213692 loss_joints: 0.00012876710388809443 loss_collision: 0.0 loss_jerk: 0.039088983088731766 loss_floor_contact: 0.0
[44/100] loss: 0.0039663054049015045 loss_joints: 0.00019759891438297927 loss_collision: 0.0 loss_jerk: 0.037687063217163086 loss_floor_contact: 0.0
[45/100] loss: 0.0040461719036102295 loss_joints: 0.0003082726616412401 loss_collision: 0.0 loss_jerk: 0.03737899288535118 loss_floor_contact: 0.0
[46/100] loss: 0.0038374965079128742 loss_joints: 8.383697422686964e-05 loss_collision: 0.0 loss_jerk: 0.03753659501671791 loss_floor_contact: 0.0
[47/100] loss: 0.004321502987295389 loss_joints: 0.0005915692308917642 loss_collision: 0.0 loss_jerk: 0.03729933872818947 loss_floor_contact: 0.0
[48/100] loss: 0.004278103355318308 loss_joints: 0.0006101980106905103 loss_collision: 0.0 loss_jerk: 0.03667905181646347 loss_floor_contact: 0.0
[49/100] loss: 0.0036027012392878532 loss_joints: 3.6631176044465974e-05 loss_collision: 0.0 loss_jerk: 0.035660699009895325 loss_floor_contact: 0.0
[50/100] loss: 0.00383490021340549 loss_joints: 0.00035132846096530557 loss_collision: 0.0 loss_jerk: 0.03483571857213974 loss_floor_contact: 0.0
[51/100] loss: 0.0037566523533314466 loss_joints: 0.0002702321216929704 loss_collision: 0.0 loss_jerk: 0.03486420214176178 loss_floor_contact: 0.0
[52/100] loss: 0.0035306622739881277 loss_joints: 8.607817289885134e-05 loss_collision: 0.0 loss_jerk: 0.03444584086537361 loss_floor_contact: 0.0
[53/100] loss: 0.0036697518080472946 loss_joints: 0.00031193115864880383 loss_collision: 0.0 loss_jerk: 0.03357820585370064 loss_floor_contact: 0.0
[54/100] loss: 0.0034604573156684637 loss_joints: 0.00013799447333440185 loss_collision: 0.0 loss_jerk: 0.03322462737560272 loss_floor_contact: 0.0
[55/100] loss: 0.003553323447704315 loss_joints: 0.000207260949537158 loss_collision: 0.0 loss_jerk: 0.033460624516010284 loss_floor_contact: 0.0
[56/100] loss: 0.003548376727849245 loss_joints: 0.0002590549411252141 loss_collision: 0.0 loss_jerk: 0.03289321810007095 loss_floor_contact: 0.0
[57/100] loss: 0.0033052677754312754 loss_joints: 7.222689600894228e-05 loss_collision: 0.0 loss_jerk: 0.032330408692359924 loss_floor_contact: 0.0
[58/100] loss: 0.003412392223253846 loss_joints: 0.0001321294403169304 loss_collision: 0.0 loss_jerk: 0.03280262649059296 loss_floor_contact: 0.0
[59/100] loss: 0.003279922530055046 loss_joints: 7.065005775075406e-05 loss_collision: 0.0 loss_jerk: 0.03209272399544716 loss_floor_contact: 0.0
[60/100] loss: 0.0032888497225940228 loss_joints: 0.00010253075743094087 loss_collision: 0.0 loss_jerk: 0.03186319023370743 loss_floor_contact: 0.0
[61/100] loss: 0.003247882006689906 loss_joints: 8.9461995230522e-05 loss_collision: 0.0 loss_jerk: 0.03158419951796532 loss_floor_contact: 0.0
[62/100] loss: 0.003225741209462285 loss_joints: 7.86284072091803e-05 loss_collision: 0.0 loss_jerk: 0.0314711295068264 loss_floor_contact: 0.0
[63/100] loss: 0.0032498021610081196 loss_joints: 0.00015559347230009735 loss_collision: 0.0 loss_jerk: 0.03094208613038063 loss_floor_contact: 0.0
[64/100] loss: 0.003116279374808073 loss_joints: 6.676999328192323e-05 loss_collision: 0.0 loss_jerk: 0.030495094135403633 loss_floor_contact: 0.0
[65/100] loss: 0.003130213124677539 loss_joints: 0.00012471350783016533 loss_collision: 0.0 loss_jerk: 0.03005499765276909 loss_floor_contact: 0.0
[66/100] loss: 0.0031057451851665974 loss_joints: 0.00012710102600976825 loss_collision: 0.0 loss_jerk: 0.02978644147515297 loss_floor_contact: 0.0
[67/100] loss: 0.0030170169193297625 loss_joints: 5.335751848178916e-05 loss_collision: 0.0 loss_jerk: 0.029636593535542488 loss_floor_contact: 0.0
[68/100] loss: 0.003022239077836275 loss_joints: 7.331712549785152e-05 loss_collision: 0.0 loss_jerk: 0.029489217326045036 loss_floor_contact: 0.0
[69/100] loss: 0.0030361865647137165 loss_joints: 7.964847463881597e-05 loss_collision: 0.0 loss_jerk: 0.02956537902355194 loss_floor_contact: 0.0
[70/100] loss: 0.002908342285081744 loss_joints: 1.6056015738286078e-05 loss_collision: 0.0 loss_jerk: 0.02892286330461502 loss_floor_contact: 0.0
[71/100] loss: 0.0028764507733285427 loss_joints: 1.7985410522669554e-05 loss_collision: 0.0 loss_jerk: 0.02858465351164341 loss_floor_contact: 0.0
[72/100] loss: 0.0029093462508171797 loss_joints: 3.113725324510597e-05 loss_collision: 0.0 loss_jerk: 0.028782090172171593 loss_floor_contact: 0.0
[73/100] loss: 0.0028470742981880903 loss_joints: 1.2564923054014798e-05 loss_collision: 0.0 loss_jerk: 0.02834509313106537 loss_floor_contact: 0.0
[74/100] loss: 0.0028192917816340923 loss_joints: 2.2618711227551103e-05 loss_collision: 0.0 loss_jerk: 0.027966728433966637 loss_floor_contact: 0.0
[75/100] loss: 0.002790801925584674 loss_joints: 8.092931238934398e-06 loss_collision: 0.0 loss_jerk: 0.02782708965241909 loss_floor_contact: 0.0
[76/100] loss: 0.0027990045491605997 loss_joints: 3.463094981270842e-05 loss_collision: 0.0 loss_jerk: 0.027643734589219093 loss_floor_contact: 0.0
[77/100] loss: 0.002766077872365713 loss_joints: 3.4879674785770476e-05 loss_collision: 0.0 loss_jerk: 0.027311982586979866 loss_floor_contact: 0.0
[78/100] loss: 0.002752091735601425 loss_joints: 3.6446485864871647e-06 loss_collision: 0.0 loss_jerk: 0.0274844691157341 loss_floor_contact: 0.0
[79/100] loss: 0.00282491953112185 loss_joints: 7.597536023240536e-05 loss_collision: 0.0 loss_jerk: 0.027489440515637398 loss_floor_contact: 0.0
[80/100] loss: 0.0027497282717376947 loss_joints: 5.303928264766e-05 loss_collision: 0.0 loss_jerk: 0.026966888457536697 loss_floor_contact: 0.0
[81/100] loss: 0.0027284310199320316 loss_joints: 5.1238268497399986e-05 loss_collision: 0.0 loss_jerk: 0.026771927252411842 loss_floor_contact: 0.0
[82/100] loss: 0.002687124302610755 loss_joints: 5.010619861423038e-05 loss_collision: 0.0 loss_jerk: 0.026370182633399963 loss_floor_contact: 0.0
[83/100] loss: 0.002644685562700033 loss_joints: 2.3787240934325382e-05 loss_collision: 0.0 loss_jerk: 0.02620898373425007 loss_floor_contact: 0.0
[84/100] loss: 0.0026394634041935205 loss_joints: 2.4080791263259016e-05 loss_collision: 0.0 loss_jerk: 0.026153825223445892 loss_floor_contact: 0.0
[85/100] loss: 0.0026067709550261497 loss_joints: 1.1209350304852705e-05 loss_collision: 0.0 loss_jerk: 0.02595561556518078 loss_floor_contact: 0.0
[86/100] loss: 0.0025763073936104774 loss_joints: 1.599473580427002e-05 loss_collision: 0.0 loss_jerk: 0.025603124871850014 loss_floor_contact: 0.0
[87/100] loss: 0.00258208648301661 loss_joints: 1.002713088382734e-05 loss_collision: 0.0 loss_jerk: 0.025720592588186264 loss_floor_contact: 0.0
[88/100] loss: 0.0025547954719513655 loss_joints: 3.410608769627288e-06 loss_collision: 0.0 loss_jerk: 0.025513848289847374 loss_floor_contact: 0.0
[89/100] loss: 0.0025492114946246147 loss_joints: 2.6508778319112025e-05 loss_collision: 0.0 loss_jerk: 0.025227027013897896 loss_floor_contact: 0.0
[90/100] loss: 0.00252479943446815 loss_joints: 1.7282496628467925e-05 loss_collision: 0.0 loss_jerk: 0.025075169280171394 loss_floor_contact: 0.0
[91/100] loss: 0.002520287875086069 loss_joints: 6.309358923317632e-06 loss_collision: 0.0 loss_jerk: 0.025139786303043365 loss_floor_contact: 0.0
[92/100] loss: 0.002497776411473751 loss_joints: 7.6267369877314195e-06 loss_collision: 0.0 loss_jerk: 0.02490149438381195 loss_floor_contact: 0.0
[93/100] loss: 0.00248109083622694 loss_joints: 3.1724493965157308e-06 loss_collision: 0.0 loss_jerk: 0.02477918192744255 loss_floor_contact: 0.0
[94/100] loss: 0.002471156883984804 loss_joints: 5.271770987747004e-06 loss_collision: 0.0 loss_jerk: 0.024658851325511932 loss_floor_contact: 0.0
[95/100] loss: 0.0024466230534017086 loss_joints: 1.4119948446023045e-06 loss_collision: 0.0 loss_jerk: 0.02445211075246334 loss_floor_contact: 0.0
[96/100] loss: 0.00244074291549623 loss_joints: 1.9215606243960792e-06 loss_collision: 0.0 loss_jerk: 0.024388212710618973 loss_floor_contact: 0.0
[97/100] loss: 0.0024307509884238243 loss_joints: 1.117806505135377e-06 loss_collision: 0.0 loss_jerk: 0.024296332150697708 loss_floor_contact: 0.0
[98/100] loss: 0.002430462511256337 loss_joints: 1.5916803022264503e-06 loss_collision: 0.0 loss_jerk: 0.024288708344101906 loss_floor_contact: 0.0
[99/100] loss: 0.0024244943633675575 loss_joints: 6.171131872179103e-07 loss_collision: 0.0 loss_jerk: 0.024238772690296173 loss_floor_contact: 0.0
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.25/contact_thresh_0.75/cabE-path3-run12-4000_collision0.1_contact0.1_jerk0.1_skate0.5]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 495.13123                                                    ║
    ║     rollout = 232.92896                                                    ║
    ║     sdf     = 23.52994                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00242449                                                 ║
    ║     joints    = 0.00000062                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.02423877                                                 ║
    ║     floor     = 0.00000000                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	8m36.036s
user	7m17.420s
sys	0m29.030s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.1, skate=1.0
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<07:13,  4.38s/it]  2%|▏         | 2/100 [00:08<07:05,  4.35s/it]  3%|▎         | 3/100 [00:13<07:32,  4.66s/it]  4%|▍         | 4/100 [00:17<07:11,  4.49s/it]  5%|▌         | 5/100 [00:23<07:36,  4.81s/it]  6%|▌         | 6/100 [00:28<07:34,  4.84s/it]  7%|▋         | 7/100 [00:32<07:26,  4.81s/it]  8%|▊         | 8/100 [00:37<07:20,  4.79s/it]  9%|▉         | 9/100 [00:42<07:10,  4.73s/it] 10%|█         | 10/100 [00:46<07:03,  4.71s/it] 11%|█         | 11/100 [00:51<07:02,  4.75s/it] 12%|█▏        | 12/100 [00:56<06:51,  4.67s/it] 13%|█▎        | 13/100 [01:01<06:48,  4.70s/it] 14%|█▍        | 14/100 [01:05<06:39,  4.65s/it] 15%|█▌        | 15/100 [01:10<06:30,  4.60s/it] 16%|█▌        | 16/100 [01:14<06:20,  4.53s/it] 17%|█▋        | 17/100 [01:18<06:11,  4.48s/it] 18%|█▊        | 18/100 [01:23<06:03,  4.43s/it] 19%|█▉        | 19/100 [01:27<06:00,  4.45s/it] 20%|██        | 20/100 [01:31<05:50,  4.38s/it] 21%|██        | 21/100 [01:36<05:41,  4.32s/it] 22%|██▏       | 22/100 [01:40<05:33,  4.28s/it] 23%|██▎       | 23/100 [01:44<05:25,  4.23s/it] 24%|██▍       | 24/100 [01:48<05:16,  4.17s/it] 25%|██▌       | 25/100 [01:52<05:13,  4.18s/it] 26%|██▌       | 26/100 [01:56<05:10,  4.20s/it] 27%|██▋       | 27/100 [02:00<05:04,  4.17s/it] 28%|██▊       | 28/100 [02:05<04:59,  4.16s/it] 29%|██▉       | 29/100 [02:09<04:58,  4.21s/it] 30%|███       | 30/100 [02:13<04:53,  4.19s/it] 31%|███       | 31/100 [02:17<04:51,  4.23s/it] 32%|███▏      | 32/100 [02:22<04:47,  4.23s/it] 33%|███▎      | 33/100 [02:26<04:42,  4.21s/it] 34%|███▍      | 34/100 [02:30<04:35,  4.18s/it] 35%|███▌      | 35/100 [02:34<04:31,  4.17s/it] 36%|███▌      | 36/100 [02:38<04:24,  4.13s/it] 37%|███▋      | 37/100 [02:42<04:22,  4.16s/it] 38%|███▊      | 38/100 [02:46<04:17,  4.15s/it] 39%|███▉      | 39/100 [02:51<04:15,  4.19s/it] 40%|████      | 40/100 [02:55<04:10,  4.17s/it] 41%|████      | 41/100 [02:59<04:05,  4.15s/it] 42%|████▏     | 42/100 [03:03<04:04,  4.21s/it] 43%|████▎     | 43/100 [03:07<04:00,  4.22s/it] 44%|████▍     | 44/100 [03:12<03:54,  4.18s/it] 45%|████▌     | 45/100 [03:16<03:48,  4.16s/it] 46%|████▌     | 46/100 [03:20<03:44,  4.16s/it] 47%|████▋     | 47/100 [03:24<03:42,  4.19s/it] 48%|████▊     | 48/100 [03:28<03:36,  4.17s/it] 49%|████▉     | 49/100 [03:32<03:32,  4.16s/it] 50%|█████     | 50/100 [03:37<03:30,  4.21s/it] 51%|█████     | 51/100 [03:41<03:27,  4.23s/it] 52%|█████▏    | 52/100 [03:45<03:23,  4.23s/it] 53%|█████▎    | 53/100 [03:50<03:22,  4.32s/it] 54%|█████▍    | 54/100 [03:54<03:15,  4.25s/it] 55%|█████▌    | 55/100 [03:58<03:09,  4.21s/it] 56%|█████▌    | 56/100 [04:02<03:05,  4.21s/it] 57%|█████▋    | 57/100 [04:06<03:01,  4.21s/it] 58%|█████▊    | 58/100 [04:11<02:59,  4.27s/it] 59%|█████▉    | 59/100 [04:15<02:57,  4.32s/it] 60%|██████    | 60/100 [04:20<02:56,  4.41s/it] 61%|██████    | 61/100 [04:24<02:49,  4.36s/it] 62%|██████▏   | 62/100 [04:28<02:43,  4.31s/it] 63%|██████▎   | 63/100 [04:33<02:40,  4.35s/it] 64%|██████▍   | 64/100 [04:37<02:34,  4.28s/it] 65%|██████▌   | 65/100 [04:41<02:29,  4.27s/it] 66%|██████▌   | 66/100 [04:45<02:24,  4.24s/it] 67%|██████▋   | 67/100 [04:49<02:19,  4.22s/it] 68%|██████▊   | 68/100 [04:54<02:15,  4.24s/it] 69%|██████▉   | 69/100 [04:58<02:11,  4.24s/it] 70%|███████   | 70/100 [05:02<02:07,  4.24s/it] 71%|███████   | 71/100 [05:07<02:04,  4.29s/it] 72%|███████▏  | 72/100 [05:11<01:59,  4.27s/it] 73%|███████▎  | 73/100 [05:15<01:54,  4.24s/it] 74%|███████▍  | 74/100 [05:19<01:51,  4.30s/it] 75%|███████▌  | 75/100 [05:24<01:46,  4.26s/it] 76%|███████▌  | 76/100 [05:28<01:41,  4.23s/it] 77%|███████▋  | 77/100 [05:32<01:36,  4.21s/it] 78%|███████▊  | 78/100 [05:36<01:32,  4.22s/it] 79%|███████▉  | 79/100 [05:40<01:28,  4.20s/it] 80%|████████  | 80/100 [05:44<01:23,  4.16s/it] 81%|████████  | 81/100 [05:49<01:20,  4.22s/it] 82%|████████▏ | 82/100 [05:53<01:15,  4.17s/it] 83%|████████▎ | 83/100 [05:57<01:11,  4.19s/it] 84%|████████▍ | 84/100 [06:01<01:06,  4.17s/it] 85%|████████▌ | 85/100 [06:05<01:02,  4.17s/it] 86%|████████▌ | 86/100 [06:10<00:58,  4.18s/it] 87%|████████▋ | 87/100 [06:14<00:53,  4.13s/it] 88%|████████▊ | 88/100 [06:18<00:49,  4.11s/it] 89%|████████▉ | 89/100 [06:22<00:45,  4.16s/it] 90%|█████████ | 90/100 [06:26<00:41,  4.14s/it] 91%|█████████ | 91/100 [06:30<00:37,  4.15s/it] 92%|█████████▏| 92/100 [06:34<00:33,  4.14s/it] 93%|█████████▎| 93/100 [06:38<00:28,  4.13s/it] 94%|█████████▍| 94/100 [06:42<00:24,  4.11s/it] 95%|█████████▌| 95/100 [06:47<00:20,  4.16s/it] 96%|█████████▌| 96/100 [06:51<00:16,  4.18s/it] 97%|█████████▋| 97/100 [06:55<00:12,  4.23s/it] 98%|█████████▊| 98/100 [06:59<00:08,  4.18s/it] 99%|█████████▉| 99/100 [07:03<00:04,  4.14s/it]100%|██████████| 100/100 [07:08<00:00,  4.13s/it]100%|██████████| 100/100 [07:08<00:00,  4.28s/it]
[0/100] loss: 2.6774706840515137 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 0.7648107409477234
[1/100] loss: 1.1479361057281494 loss_joints: 1.094731092453003 loss_collision: 0.0 loss_jerk: 0.07815314084291458 loss_floor_contact: 0.45389705896377563
[2/100] loss: 1.2021570205688477 loss_joints: 1.159254550933838 loss_collision: 0.000195154789253138 loss_jerk: 0.08768852055072784 loss_floor_contact: 0.34114137291908264
[3/100] loss: 0.4152398109436035 loss_joints: 0.403949111700058 loss_collision: 0.00045473530190065503 loss_jerk: 0.08232497423887253 loss_floor_contact: 0.03012702241539955
[4/100] loss: 0.032357797026634216 loss_joints: 0.02000625804066658 loss_collision: 0.0 loss_jerk: 0.10291621834039688 loss_floor_contact: 0.020599182695150375
[5/100] loss: 0.03849603980779648 loss_joints: 0.027624865993857384 loss_collision: 0.0 loss_jerk: 0.10871171951293945 loss_floor_contact: 0.0
[6/100] loss: 0.07342007011175156 loss_joints: 0.06376070529222488 loss_collision: 0.0 loss_jerk: 0.09659361839294434 loss_floor_contact: 0.0
[7/100] loss: 0.03942462056875229 loss_joints: 0.030932333320379257 loss_collision: 0.0 loss_jerk: 0.08492286503314972 loss_floor_contact: 0.0
[8/100] loss: 0.012569386512041092 loss_joints: 0.005054275505244732 loss_collision: 0.0 loss_jerk: 0.07515110820531845 loss_floor_contact: 0.0
[9/100] loss: 0.012230386957526207 loss_joints: 0.005267647095024586 loss_collision: 0.0 loss_jerk: 0.06962739676237106 loss_floor_contact: 0.0
[10/100] loss: 0.010898558422923088 loss_joints: 0.004214323125779629 loss_collision: 0.0 loss_jerk: 0.06684235483407974 loss_floor_contact: 0.0
[11/100] loss: 0.008293061517179012 loss_joints: 0.001606843783520162 loss_collision: 0.0 loss_jerk: 0.06686218082904816 loss_floor_contact: 0.0
[12/100] loss: 0.015256635844707489 loss_joints: 0.008487320505082607 loss_collision: 0.0 loss_jerk: 0.06769315153360367 loss_floor_contact: 0.0
[13/100] loss: 0.01351984217762947 loss_joints: 0.0069359950721263885 loss_collision: 0.0 loss_jerk: 0.06583847105503082 loss_floor_contact: 0.0
[14/100] loss: 0.008120378479361534 loss_joints: 0.0018778525991365314 loss_collision: 0.0 loss_jerk: 0.06242525950074196 loss_floor_contact: 0.0
[15/100] loss: 0.008798852562904358 loss_joints: 0.002553278114646673 loss_collision: 0.0 loss_jerk: 0.062455739825963974 loss_floor_contact: 0.0
[16/100] loss: 0.008570054545998573 loss_joints: 0.0020381161011755466 loss_collision: 0.0 loss_jerk: 0.06531938910484314 loss_floor_contact: 0.0
[17/100] loss: 0.007403723895549774 loss_joints: 0.0010470501147210598 loss_collision: 0.0 loss_jerk: 0.06356673687696457 loss_floor_contact: 0.0
[18/100] loss: 0.007461864035576582 loss_joints: 0.0014839860377833247 loss_collision: 0.0 loss_jerk: 0.05977877974510193 loss_floor_contact: 0.0
[19/100] loss: 0.00705457990989089 loss_joints: 0.0011764300288632512 loss_collision: 0.0 loss_jerk: 0.058781497180461884 loss_floor_contact: 0.0
[20/100] loss: 0.006373181007802486 loss_joints: 0.0005297745228745043 loss_collision: 0.0 loss_jerk: 0.05843406543135643 loss_floor_contact: 0.0
[21/100] loss: 0.006632292177528143 loss_joints: 0.0009327902225777507 loss_collision: 0.0 loss_jerk: 0.05699501931667328 loss_floor_contact: 0.0
[22/100] loss: 0.005788556300103664 loss_joints: 0.0003354107029736042 loss_collision: 0.0 loss_jerk: 0.05453145503997803 loss_floor_contact: 0.0
[23/100] loss: 0.006695485208183527 loss_joints: 0.0012746016727760434 loss_collision: 0.0 loss_jerk: 0.05420883744955063 loss_floor_contact: 0.0
[24/100] loss: 0.006508189719170332 loss_joints: 0.0011454257182776928 loss_collision: 0.0 loss_jerk: 0.05362764000892639 loss_floor_contact: 0.0
[25/100] loss: 0.00581363495439291 loss_joints: 0.0005947926547378302 loss_collision: 0.0 loss_jerk: 0.05218842253088951 loss_floor_contact: 0.0
[26/100] loss: 0.005807789042592049 loss_joints: 0.0007192233460955322 loss_collision: 0.0 loss_jerk: 0.05088565871119499 loss_floor_contact: 0.0
[27/100] loss: 0.0057014478370547295 loss_joints: 0.0007651516934856772 loss_collision: 0.0 loss_jerk: 0.04936295747756958 loss_floor_contact: 0.0
[28/100] loss: 0.0050058490596711636 loss_joints: 0.0001477905025240034 loss_collision: 0.0 loss_jerk: 0.048580583184957504 loss_floor_contact: 0.0
[29/100] loss: 0.006323626264929771 loss_joints: 0.0016055912710726261 loss_collision: 0.0 loss_jerk: 0.04718034714460373 loss_floor_contact: 0.0
[30/100] loss: 0.005840012803673744 loss_joints: 0.0011997184483334422 loss_collision: 0.0 loss_jerk: 0.0464029423892498 loss_floor_contact: 0.0
[31/100] loss: 0.004836706444621086 loss_joints: 0.0002047255402430892 loss_collision: 0.0 loss_jerk: 0.04631980508565903 loss_floor_contact: 0.0
[32/100] loss: 0.00473810825496912 loss_joints: 0.0002523969451431185 loss_collision: 0.0 loss_jerk: 0.04485711455345154 loss_floor_contact: 0.0
[33/100] loss: 0.004954932723194361 loss_joints: 0.0005962656578049064 loss_collision: 0.0 loss_jerk: 0.043586667627096176 loss_floor_contact: 0.0
[34/100] loss: 0.00464642932638526 loss_joints: 0.00035108611336909235 loss_collision: 0.0 loss_jerk: 0.042953427881002426 loss_floor_contact: 0.0
[35/100] loss: 0.005167428404092789 loss_joints: 0.0008491005282849073 loss_collision: 0.0 loss_jerk: 0.04318327456712723 loss_floor_contact: 0.0
[36/100] loss: 0.005113564897328615 loss_joints: 0.0008372076554223895 loss_collision: 0.0 loss_jerk: 0.042763568460941315 loss_floor_contact: 0.0
[37/100] loss: 0.004389700945466757 loss_joints: 0.00020379589113872498 loss_collision: 0.0 loss_jerk: 0.04185904935002327 loss_floor_contact: 0.0
[38/100] loss: 0.004301709122955799 loss_joints: 0.00017416971968486905 loss_collision: 0.0 loss_jerk: 0.04127539321780205 loss_floor_contact: 0.0
[39/100] loss: 0.004602899309247732 loss_joints: 0.0004903177032247186 loss_collision: 0.0 loss_jerk: 0.041125815361738205 loss_floor_contact: 0.0
[40/100] loss: 0.004301570355892181 loss_joints: 0.0002355556789552793 loss_collision: 0.0 loss_jerk: 0.04066014662384987 loss_floor_contact: 0.0
[41/100] loss: 0.004581950139254332 loss_joints: 0.000626570952590555 loss_collision: 0.0 loss_jerk: 0.03955379128456116 loss_floor_contact: 0.0
[42/100] loss: 0.004650551360100508 loss_joints: 0.0007282234146259725 loss_collision: 0.0 loss_jerk: 0.03922327980399132 loss_floor_contact: 0.0
[43/100] loss: 0.004037665203213692 loss_joints: 0.00012876710388809443 loss_collision: 0.0 loss_jerk: 0.039088983088731766 loss_floor_contact: 0.0
[44/100] loss: 0.0039663054049015045 loss_joints: 0.00019759891438297927 loss_collision: 0.0 loss_jerk: 0.037687063217163086 loss_floor_contact: 0.0
[45/100] loss: 0.0040461719036102295 loss_joints: 0.0003082726616412401 loss_collision: 0.0 loss_jerk: 0.03737899288535118 loss_floor_contact: 0.0
[46/100] loss: 0.0038374965079128742 loss_joints: 8.383697422686964e-05 loss_collision: 0.0 loss_jerk: 0.03753659501671791 loss_floor_contact: 0.0
[47/100] loss: 0.004321502987295389 loss_joints: 0.0005915692308917642 loss_collision: 0.0 loss_jerk: 0.03729933872818947 loss_floor_contact: 0.0
[48/100] loss: 0.004278103355318308 loss_joints: 0.0006101980106905103 loss_collision: 0.0 loss_jerk: 0.03667905181646347 loss_floor_contact: 0.0
[49/100] loss: 0.0036027012392878532 loss_joints: 3.6631176044465974e-05 loss_collision: 0.0 loss_jerk: 0.035660699009895325 loss_floor_contact: 0.0
[50/100] loss: 0.00383490021340549 loss_joints: 0.00035132846096530557 loss_collision: 0.0 loss_jerk: 0.03483571857213974 loss_floor_contact: 0.0
[51/100] loss: 0.0037566523533314466 loss_joints: 0.0002702321216929704 loss_collision: 0.0 loss_jerk: 0.03486420214176178 loss_floor_contact: 0.0
[52/100] loss: 0.0035306622739881277 loss_joints: 8.607817289885134e-05 loss_collision: 0.0 loss_jerk: 0.03444584086537361 loss_floor_contact: 0.0
[53/100] loss: 0.0036697518080472946 loss_joints: 0.00031193115864880383 loss_collision: 0.0 loss_jerk: 0.03357820585370064 loss_floor_contact: 0.0
[54/100] loss: 0.0034604573156684637 loss_joints: 0.00013799447333440185 loss_collision: 0.0 loss_jerk: 0.03322462737560272 loss_floor_contact: 0.0
[55/100] loss: 0.003553323447704315 loss_joints: 0.000207260949537158 loss_collision: 0.0 loss_jerk: 0.033460624516010284 loss_floor_contact: 0.0
[56/100] loss: 0.003548376727849245 loss_joints: 0.0002590549411252141 loss_collision: 0.0 loss_jerk: 0.03289321810007095 loss_floor_contact: 0.0
[57/100] loss: 0.0033052677754312754 loss_joints: 7.222689600894228e-05 loss_collision: 0.0 loss_jerk: 0.032330408692359924 loss_floor_contact: 0.0
[58/100] loss: 0.003412392223253846 loss_joints: 0.0001321294403169304 loss_collision: 0.0 loss_jerk: 0.03280262649059296 loss_floor_contact: 0.0
[59/100] loss: 0.003279922530055046 loss_joints: 7.065005775075406e-05 loss_collision: 0.0 loss_jerk: 0.03209272399544716 loss_floor_contact: 0.0
[60/100] loss: 0.0032888497225940228 loss_joints: 0.00010253075743094087 loss_collision: 0.0 loss_jerk: 0.03186319023370743 loss_floor_contact: 0.0
[61/100] loss: 0.003247882006689906 loss_joints: 8.9461995230522e-05 loss_collision: 0.0 loss_jerk: 0.03158419951796532 loss_floor_contact: 0.0
[62/100] loss: 0.003225741209462285 loss_joints: 7.86284072091803e-05 loss_collision: 0.0 loss_jerk: 0.0314711295068264 loss_floor_contact: 0.0
[63/100] loss: 0.0032498021610081196 loss_joints: 0.00015559347230009735 loss_collision: 0.0 loss_jerk: 0.03094208613038063 loss_floor_contact: 0.0
[64/100] loss: 0.003116279374808073 loss_joints: 6.676999328192323e-05 loss_collision: 0.0 loss_jerk: 0.030495094135403633 loss_floor_contact: 0.0
[65/100] loss: 0.003130213124677539 loss_joints: 0.00012471350783016533 loss_collision: 0.0 loss_jerk: 0.03005499765276909 loss_floor_contact: 0.0
[66/100] loss: 0.0031057451851665974 loss_joints: 0.00012710102600976825 loss_collision: 0.0 loss_jerk: 0.02978644147515297 loss_floor_contact: 0.0
[67/100] loss: 0.0030170169193297625 loss_joints: 5.335751848178916e-05 loss_collision: 0.0 loss_jerk: 0.029636593535542488 loss_floor_contact: 0.0
[68/100] loss: 0.003022239077836275 loss_joints: 7.331712549785152e-05 loss_collision: 0.0 loss_jerk: 0.029489217326045036 loss_floor_contact: 0.0
[69/100] loss: 0.0030361865647137165 loss_joints: 7.964847463881597e-05 loss_collision: 0.0 loss_jerk: 0.02956537902355194 loss_floor_contact: 0.0
[70/100] loss: 0.002908342285081744 loss_joints: 1.6056015738286078e-05 loss_collision: 0.0 loss_jerk: 0.02892286330461502 loss_floor_contact: 0.0
[71/100] loss: 0.0028764507733285427 loss_joints: 1.7985410522669554e-05 loss_collision: 0.0 loss_jerk: 0.02858465351164341 loss_floor_contact: 0.0
[72/100] loss: 0.0029093462508171797 loss_joints: 3.113725324510597e-05 loss_collision: 0.0 loss_jerk: 0.028782090172171593 loss_floor_contact: 0.0
[73/100] loss: 0.0028470742981880903 loss_joints: 1.2564923054014798e-05 loss_collision: 0.0 loss_jerk: 0.02834509313106537 loss_floor_contact: 0.0
[74/100] loss: 0.0028192917816340923 loss_joints: 2.2618711227551103e-05 loss_collision: 0.0 loss_jerk: 0.027966728433966637 loss_floor_contact: 0.0
[75/100] loss: 0.002790801925584674 loss_joints: 8.092931238934398e-06 loss_collision: 0.0 loss_jerk: 0.02782708965241909 loss_floor_contact: 0.0
[76/100] loss: 0.0027990045491605997 loss_joints: 3.463094981270842e-05 loss_collision: 0.0 loss_jerk: 0.027643734589219093 loss_floor_contact: 0.0
[77/100] loss: 0.002766077872365713 loss_joints: 3.4879674785770476e-05 loss_collision: 0.0 loss_jerk: 0.027311982586979866 loss_floor_contact: 0.0
[78/100] loss: 0.002752091735601425 loss_joints: 3.6446485864871647e-06 loss_collision: 0.0 loss_jerk: 0.0274844691157341 loss_floor_contact: 0.0
[79/100] loss: 0.00282491953112185 loss_joints: 7.597536023240536e-05 loss_collision: 0.0 loss_jerk: 0.027489440515637398 loss_floor_contact: 0.0
[80/100] loss: 0.0027497282717376947 loss_joints: 5.303928264766e-05 loss_collision: 0.0 loss_jerk: 0.026966888457536697 loss_floor_contact: 0.0
[81/100] loss: 0.0027284310199320316 loss_joints: 5.1238268497399986e-05 loss_collision: 0.0 loss_jerk: 0.026771927252411842 loss_floor_contact: 0.0
[82/100] loss: 0.002687124302610755 loss_joints: 5.010619861423038e-05 loss_collision: 0.0 loss_jerk: 0.026370182633399963 loss_floor_contact: 0.0
[83/100] loss: 0.002644685562700033 loss_joints: 2.3787240934325382e-05 loss_collision: 0.0 loss_jerk: 0.02620898373425007 loss_floor_contact: 0.0
[84/100] loss: 0.0026394634041935205 loss_joints: 2.4080791263259016e-05 loss_collision: 0.0 loss_jerk: 0.026153825223445892 loss_floor_contact: 0.0
[85/100] loss: 0.0026067709550261497 loss_joints: 1.1209350304852705e-05 loss_collision: 0.0 loss_jerk: 0.02595561556518078 loss_floor_contact: 0.0
[86/100] loss: 0.0025763073936104774 loss_joints: 1.599473580427002e-05 loss_collision: 0.0 loss_jerk: 0.025603124871850014 loss_floor_contact: 0.0
[87/100] loss: 0.00258208648301661 loss_joints: 1.002713088382734e-05 loss_collision: 0.0 loss_jerk: 0.025720592588186264 loss_floor_contact: 0.0
[88/100] loss: 0.0025547954719513655 loss_joints: 3.410608769627288e-06 loss_collision: 0.0 loss_jerk: 0.025513848289847374 loss_floor_contact: 0.0
[89/100] loss: 0.0025492114946246147 loss_joints: 2.6508778319112025e-05 loss_collision: 0.0 loss_jerk: 0.025227027013897896 loss_floor_contact: 0.0
[90/100] loss: 0.00252479943446815 loss_joints: 1.7282496628467925e-05 loss_collision: 0.0 loss_jerk: 0.025075169280171394 loss_floor_contact: 0.0
[91/100] loss: 0.002520287875086069 loss_joints: 6.309358923317632e-06 loss_collision: 0.0 loss_jerk: 0.025139786303043365 loss_floor_contact: 0.0
[92/100] loss: 0.002497776411473751 loss_joints: 7.6267369877314195e-06 loss_collision: 0.0 loss_jerk: 0.02490149438381195 loss_floor_contact: 0.0
[93/100] loss: 0.00248109083622694 loss_joints: 3.1724493965157308e-06 loss_collision: 0.0 loss_jerk: 0.02477918192744255 loss_floor_contact: 0.0
[94/100] loss: 0.002471156883984804 loss_joints: 5.271770987747004e-06 loss_collision: 0.0 loss_jerk: 0.024658851325511932 loss_floor_contact: 0.0
[95/100] loss: 0.0024466230534017086 loss_joints: 1.4119948446023045e-06 loss_collision: 0.0 loss_jerk: 0.02445211075246334 loss_floor_contact: 0.0
[96/100] loss: 0.00244074291549623 loss_joints: 1.9215606243960792e-06 loss_collision: 0.0 loss_jerk: 0.024388212710618973 loss_floor_contact: 0.0
[97/100] loss: 0.0024307509884238243 loss_joints: 1.117806505135377e-06 loss_collision: 0.0 loss_jerk: 0.024296332150697708 loss_floor_contact: 0.0
[98/100] loss: 0.002430462511256337 loss_joints: 1.5916803022264503e-06 loss_collision: 0.0 loss_jerk: 0.024288708344101906 loss_floor_contact: 0.0
[99/100] loss: 0.0024244943633675575 loss_joints: 6.171131872179103e-07 loss_collision: 0.0 loss_jerk: 0.024238772690296173 loss_floor_contact: 0.0
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.25/contact_thresh_0.75/cabE-path3-run12-4000_collision0.1_contact0.1_jerk0.1_skate1.0]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 428.00564                                                    ║
    ║     rollout = 199.87716                                                    ║
    ║     sdf     = 18.74194                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00242449                                                 ║
    ║     joints    = 0.00000062                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.02423877                                                 ║
    ║     floor     = 0.00000000                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	7m27.858s
user	6m44.505s
sys	0m20.256s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.5, skate=0.1
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<06:58,  4.22s/it]  2%|▏         | 2/100 [00:08<06:40,  4.08s/it]  3%|▎         | 3/100 [00:13<07:08,  4.41s/it]  4%|▍         | 4/100 [00:17<06:54,  4.31s/it]  5%|▌         | 5/100 [00:21<06:51,  4.34s/it]  6%|▌         | 6/100 [00:25<06:38,  4.24s/it]  7%|▋         | 7/100 [00:29<06:31,  4.21s/it]  8%|▊         | 8/100 [00:33<06:25,  4.19s/it]  9%|▉         | 9/100 [00:38<06:23,  4.21s/it] 10%|█         | 10/100 [00:42<06:12,  4.14s/it] 11%|█         | 11/100 [00:46<06:14,  4.21s/it] 12%|█▏        | 12/100 [00:50<06:09,  4.20s/it] 13%|█▎        | 13/100 [00:54<06:01,  4.15s/it] 14%|█▍        | 14/100 [00:58<05:56,  4.15s/it] 15%|█▌        | 15/100 [01:02<05:51,  4.14s/it] 16%|█▌        | 16/100 [01:07<05:53,  4.21s/it] 17%|█▋        | 17/100 [01:11<05:54,  4.27s/it] 18%|█▊        | 18/100 [01:16<05:52,  4.30s/it] 19%|█▉        | 19/100 [01:20<05:48,  4.30s/it] 20%|██        | 20/100 [01:24<05:41,  4.27s/it] 21%|██        | 21/100 [01:28<05:38,  4.28s/it] 22%|██▏       | 22/100 [01:33<05:34,  4.29s/it] 23%|██▎       | 23/100 [01:37<05:30,  4.29s/it] 24%|██▍       | 24/100 [01:41<05:23,  4.25s/it] 25%|██▌       | 25/100 [01:45<05:14,  4.20s/it] 26%|██▌       | 26/100 [01:50<05:11,  4.21s/it] 27%|██▋       | 27/100 [01:54<05:08,  4.22s/it] 28%|██▊       | 28/100 [01:58<05:06,  4.26s/it] 29%|██▉       | 29/100 [02:02<04:59,  4.22s/it] 30%|███       | 30/100 [02:07<04:57,  4.25s/it] 31%|███       | 31/100 [02:11<04:53,  4.26s/it] 32%|███▏      | 32/100 [02:15<04:48,  4.24s/it] 33%|███▎      | 33/100 [02:19<04:40,  4.19s/it] 34%|███▍      | 34/100 [02:23<04:33,  4.14s/it] 35%|███▌      | 35/100 [02:28<04:34,  4.22s/it] 36%|███▌      | 36/100 [02:32<04:30,  4.23s/it] 37%|███▋      | 37/100 [02:36<04:25,  4.22s/it] 38%|███▊      | 38/100 [02:40<04:20,  4.20s/it] 39%|███▉      | 39/100 [02:45<04:19,  4.25s/it] 40%|████      | 40/100 [02:49<04:11,  4.19s/it] 41%|████      | 41/100 [02:53<04:04,  4.14s/it] 42%|████▏     | 42/100 [02:57<03:58,  4.11s/it] 43%|████▎     | 43/100 [03:01<03:55,  4.13s/it] 44%|████▍     | 44/100 [03:05<03:53,  4.17s/it] 45%|████▌     | 45/100 [03:09<03:48,  4.16s/it] 46%|████▌     | 46/100 [03:13<03:45,  4.17s/it] 47%|████▋     | 47/100 [03:18<03:42,  4.21s/it] 48%|████▊     | 48/100 [03:22<03:37,  4.19s/it] 49%|████▉     | 49/100 [03:26<03:33,  4.19s/it] 50%|█████     | 50/100 [03:30<03:28,  4.18s/it] 51%|█████     | 51/100 [03:34<03:25,  4.19s/it] 52%|█████▏    | 52/100 [03:39<03:20,  4.17s/it] 53%|█████▎    | 53/100 [03:43<03:16,  4.18s/it] 54%|█████▍    | 54/100 [03:47<03:11,  4.15s/it] 55%|█████▌    | 55/100 [03:51<03:06,  4.13s/it] 56%|█████▌    | 56/100 [03:55<03:00,  4.11s/it] 57%|█████▋    | 57/100 [03:59<02:56,  4.10s/it] 58%|█████▊    | 58/100 [04:03<02:52,  4.12s/it] 59%|█████▉    | 59/100 [04:07<02:49,  4.14s/it] 60%|██████    | 60/100 [04:12<02:46,  4.16s/it] 61%|██████    | 61/100 [04:16<02:43,  4.18s/it] 62%|██████▏   | 62/100 [04:20<02:40,  4.21s/it] 63%|██████▎   | 63/100 [04:24<02:34,  4.19s/it] 64%|██████▍   | 64/100 [04:28<02:29,  4.15s/it] 65%|██████▌   | 65/100 [04:32<02:24,  4.14s/it] 66%|██████▌   | 66/100 [04:37<02:20,  4.14s/it] 67%|██████▋   | 67/100 [04:41<02:15,  4.11s/it] 68%|██████▊   | 68/100 [04:45<02:13,  4.19s/it] 69%|██████▉   | 69/100 [04:49<02:10,  4.20s/it] 70%|███████   | 70/100 [04:53<02:05,  4.20s/it] 71%|███████   | 71/100 [04:58<02:01,  4.18s/it] 72%|███████▏  | 72/100 [05:02<01:57,  4.18s/it] 73%|███████▎  | 73/100 [05:06<01:52,  4.17s/it] 74%|███████▍  | 74/100 [05:10<01:51,  4.29s/it] 75%|███████▌  | 75/100 [05:15<01:46,  4.24s/it] 76%|███████▌  | 76/100 [05:19<01:41,  4.24s/it] 77%|███████▋  | 77/100 [05:23<01:36,  4.21s/it] 78%|███████▊  | 78/100 [05:27<01:32,  4.21s/it] 79%|███████▉  | 79/100 [05:31<01:27,  4.18s/it] 80%|████████  | 80/100 [05:35<01:23,  4.18s/it] 81%|████████  | 81/100 [05:40<01:20,  4.22s/it] 82%|████████▏ | 82/100 [05:44<01:16,  4.23s/it] 83%|████████▎ | 83/100 [05:48<01:11,  4.21s/it] 84%|████████▍ | 84/100 [05:52<01:07,  4.22s/it] 85%|████████▌ | 85/100 [05:56<01:02,  4.18s/it] 86%|████████▌ | 86/100 [06:01<00:58,  4.15s/it] 87%|████████▋ | 87/100 [06:05<00:53,  4.12s/it] 88%|████████▊ | 88/100 [06:09<00:49,  4.11s/it] 89%|████████▉ | 89/100 [06:13<00:45,  4.14s/it] 90%|█████████ | 90/100 [06:17<00:41,  4.15s/it] 91%|█████████ | 91/100 [06:21<00:37,  4.15s/it] 92%|█████████▏| 92/100 [06:25<00:33,  4.16s/it] 93%|█████████▎| 93/100 [06:30<00:28,  4.14s/it] 94%|█████████▍| 94/100 [06:34<00:24,  4.11s/it] 95%|█████████▌| 95/100 [06:38<00:20,  4.17s/it] 96%|█████████▌| 96/100 [06:42<00:16,  4.13s/it] 97%|█████████▋| 97/100 [06:46<00:12,  4.12s/it] 98%|█████████▊| 98/100 [06:50<00:08,  4.10s/it] 99%|█████████▉| 99/100 [06:54<00:04,  4.09s/it]100%|██████████| 100/100 [06:58<00:00,  4.08s/it]100%|██████████| 100/100 [06:58<00:00,  4.19s/it]
[0/100] loss: 2.7128372192382812 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 0.7648107409477234
[1/100] loss: 1.0538480281829834 loss_joints: 0.9680825471878052 loss_collision: 0.0 loss_jerk: 0.08088590949773788 loss_floor_contact: 0.45322591066360474
[2/100] loss: 0.9111217856407166 loss_joints: 0.8809795379638672 loss_collision: 0.0 loss_jerk: 0.05224321782588959 loss_floor_contact: 0.04020615294575691
[3/100] loss: 0.4998719394207001 loss_joints: 0.47840866446495056 loss_collision: 0.0 loss_jerk: 0.04292652755975723 loss_floor_contact: 0.0
[4/100] loss: 0.398628830909729 loss_joints: 0.38266128301620483 loss_collision: 0.0022069858387112617 loss_jerk: 0.03149371221661568 loss_floor_contact: 0.0
[5/100] loss: 0.26981571316719055 loss_joints: 0.25427383184432983 loss_collision: 0.0017710706451907754 loss_jerk: 0.03072950802743435 loss_floor_contact: 0.0
[6/100] loss: 0.13625188171863556 loss_joints: 0.10905315726995468 loss_collision: 0.0017591898795217276 loss_jerk: 0.054045628756284714 loss_floor_contact: 0.0
[7/100] loss: 0.07441408932209015 loss_joints: 0.04059680551290512 loss_collision: 0.0011795323807746172 loss_jerk: 0.06739865243434906 loss_floor_contact: 0.0
[8/100] loss: 0.04883415997028351 loss_joints: 0.02572263590991497 loss_collision: 0.0010529814753681421 loss_jerk: 0.046012453734874725 loss_floor_contact: 0.0
[9/100] loss: 0.030539531260728836 loss_joints: 0.009855324402451515 loss_collision: 0.0009504453628323972 loss_jerk: 0.041178327053785324 loss_floor_contact: 0.0
[10/100] loss: 0.02620837837457657 loss_joints: 0.005820257123559713 loss_collision: 0.0010773470858111978 loss_jerk: 0.0405607745051384 loss_floor_contact: 0.0
[11/100] loss: 0.03922276943922043 loss_joints: 0.01411435753107071 loss_collision: 0.001002615550532937 loss_jerk: 0.05001629889011383 loss_floor_contact: 0.0
[12/100] loss: 0.037273429334163666 loss_joints: 0.0149019043892622 loss_collision: 0.0011261518811807036 loss_jerk: 0.04451781511306763 loss_floor_contact: 0.0
[13/100] loss: 0.027867645025253296 loss_joints: 0.008675718680024147 loss_collision: 0.0011847030837088823 loss_jerk: 0.038146913051605225 loss_floor_contact: 0.0
[14/100] loss: 0.020174143835902214 loss_joints: 0.0015406000893563032 loss_collision: 0.0012042236048728228 loss_jerk: 0.037026241421699524 loss_floor_contact: 0.0
[15/100] loss: 0.019518781453371048 loss_joints: 0.001159285893663764 loss_collision: 0.001025925506837666 loss_jerk: 0.0365138053894043 loss_floor_contact: 0.0
[16/100] loss: 0.021908428519964218 loss_joints: 0.003900115843862295 loss_collision: 0.0011330305133014917 loss_jerk: 0.03579001873731613 loss_floor_contact: 0.0
[17/100] loss: 0.020650800317525864 loss_joints: 0.004066945053637028 loss_collision: 0.0011367534752935171 loss_jerk: 0.03294035792350769 loss_floor_contact: 0.0
[18/100] loss: 0.018415261059999466 loss_joints: 0.002341677900403738 loss_collision: 0.001097927917726338 loss_jerk: 0.03192758187651634 loss_floor_contact: 0.0
[19/100] loss: 0.016109248623251915 loss_joints: 0.0014448845759034157 loss_collision: 0.0010545357363298535 loss_jerk: 0.029117820784449577 loss_floor_contact: 0.0
[20/100] loss: 0.016659963876008987 loss_joints: 0.0015270798467099667 loss_collision: 0.0010004559298977256 loss_jerk: 0.03006567806005478 loss_floor_contact: 0.0
[21/100] loss: 0.016814254224300385 loss_joints: 0.0010756681440398097 loss_collision: 0.001123391673900187 loss_jerk: 0.03125249221920967 loss_floor_contact: 0.0
[22/100] loss: 0.01580229587852955 loss_joints: 0.0010173203190788627 loss_collision: 0.0010867624077945948 loss_jerk: 0.029352599754929543 loss_floor_contact: 0.0
[23/100] loss: 0.01455003209412098 loss_joints: 0.000922162551432848 loss_collision: 0.0010120123624801636 loss_jerk: 0.027053337544202805 loss_floor_contact: 0.0
[24/100] loss: 0.01321211364120245 loss_joints: 0.00028846756322309375 loss_collision: 0.0009564906940795481 loss_jerk: 0.025655994191765785 loss_floor_contact: 0.0
[25/100] loss: 0.012230722233653069 loss_joints: 6.523983029183e-05 loss_collision: 0.0007453343132510781 loss_jerk: 0.024181898683309555 loss_floor_contact: 0.0
[26/100] loss: 0.01198083721101284 loss_joints: 0.0003841515281237662 loss_collision: 0.0007276030955836177 loss_jerk: 0.023047851398587227 loss_floor_contact: 0.0
[27/100] loss: 0.01173435803502798 loss_joints: 0.000529843382537365 loss_collision: 0.0006316671497188509 loss_jerk: 0.022282695397734642 loss_floor_contact: 0.0
[28/100] loss: 0.011130183935165405 loss_joints: 0.00012171601701993495 loss_collision: 0.0007278930861502886 loss_jerk: 0.021871356293559074 loss_floor_contact: 0.0
[29/100] loss: 0.01073786523193121 loss_joints: 0.0001855964947026223 loss_collision: 0.0006506454665213823 loss_jerk: 0.020974408835172653 loss_floor_contact: 0.0
[30/100] loss: 0.010020448826253414 loss_joints: 0.0002164699835702777 loss_collision: 0.0005966941243968904 loss_jerk: 0.01948861964046955 loss_floor_contact: 0.0
[31/100] loss: 0.00990887451916933 loss_joints: 0.00017705615027807653 loss_collision: 0.0005900229443795979 loss_jerk: 0.019345631822943687 loss_floor_contact: 0.0
[32/100] loss: 0.009600157849490643 loss_joints: 0.0004384592757560313 loss_collision: 0.0005191644886508584 loss_jerk: 0.018219564110040665 loss_floor_contact: 0.0
[33/100] loss: 0.00929445680230856 loss_joints: 0.00030474376399070024 loss_collision: 0.0 loss_jerk: 0.017979426309466362 loss_floor_contact: 0.0
[34/100] loss: 0.008808901533484459 loss_joints: 0.00020239896548446268 loss_collision: 0.0 loss_jerk: 0.01721300557255745 loss_floor_contact: 0.0
[35/100] loss: 0.008537521585822105 loss_joints: 0.0001765356573741883 loss_collision: 0.0 loss_jerk: 0.016721971333026886 loss_floor_contact: 0.0
[36/100] loss: 0.008816749788820744 loss_joints: 8.917688319343142e-06 loss_collision: 0.0 loss_jerk: 0.0176156647503376 loss_floor_contact: 0.0
[37/100] loss: 0.008377255871891975 loss_joints: 0.00036712150904349983 loss_collision: 0.0 loss_jerk: 0.016020268201828003 loss_floor_contact: 0.0
[38/100] loss: 0.008412941358983517 loss_joints: 0.0004971691523678601 loss_collision: 0.0 loss_jerk: 0.015831544995307922 loss_floor_contact: 0.0
[39/100] loss: 0.008350319229066372 loss_joints: 0.00010673317592591047 loss_collision: 0.0 loss_jerk: 0.01648717187345028 loss_floor_contact: 0.0
[40/100] loss: 0.00797123834490776 loss_joints: 0.0002134735113941133 loss_collision: 0.0 loss_jerk: 0.015515530481934547 loss_floor_contact: 0.0
[41/100] loss: 0.00798262469470501 loss_joints: 0.00026319595053792 loss_collision: 0.0 loss_jerk: 0.015438857488334179 loss_floor_contact: 0.0
[42/100] loss: 0.007853861898183823 loss_joints: 0.0001482884690631181 loss_collision: 0.0 loss_jerk: 0.015411145985126495 loss_floor_contact: 0.0
[43/100] loss: 0.007582489866763353 loss_joints: 0.00027481073630042374 loss_collision: 0.0 loss_jerk: 0.014615357853472233 loss_floor_contact: 0.0
[44/100] loss: 0.00749944057315588 loss_joints: 0.00010283214214723557 loss_collision: 0.0 loss_jerk: 0.014793217182159424 loss_floor_contact: 0.0
[45/100] loss: 0.007392551749944687 loss_joints: 0.0001032391082844697 loss_collision: 0.0 loss_jerk: 0.014578625559806824 loss_floor_contact: 0.0
[46/100] loss: 0.007647762540727854 loss_joints: 0.0002140394353773445 loss_collision: 0.0 loss_jerk: 0.014867446385324001 loss_floor_contact: 0.0
[47/100] loss: 0.007360358722507954 loss_joints: 6.412332004401833e-05 loss_collision: 0.0 loss_jerk: 0.014592470601201057 loss_floor_contact: 0.0
[48/100] loss: 0.0072924415580928326 loss_joints: 0.00012041922309435904 loss_collision: 0.0 loss_jerk: 0.014344044961035252 loss_floor_contact: 0.0
[49/100] loss: 0.00751532195135951 loss_joints: 0.0002517338143661618 loss_collision: 0.0 loss_jerk: 0.01452717650681734 loss_floor_contact: 0.0
[50/100] loss: 0.007463173009455204 loss_joints: 0.00017454939370509237 loss_collision: 0.0 loss_jerk: 0.014577247202396393 loss_floor_contact: 0.0
[51/100] loss: 0.008160210214555264 loss_joints: 0.00011282395280431956 loss_collision: 0.0 loss_jerk: 0.016094772145152092 loss_floor_contact: 0.0
[52/100] loss: 0.00769121153280139 loss_joints: 0.00017432768072467297 loss_collision: 0.0 loss_jerk: 0.015033767558634281 loss_floor_contact: 0.0
[53/100] loss: 0.007240233477205038 loss_joints: 8.793677989160642e-05 loss_collision: 0.0 loss_jerk: 0.014304593205451965 loss_floor_contact: 0.0
[54/100] loss: 0.00718862796202302 loss_joints: 0.00015066783817019314 loss_collision: 0.0 loss_jerk: 0.01407591998577118 loss_floor_contact: 0.0
[55/100] loss: 0.007134377025067806 loss_joints: 0.00012375949881970882 loss_collision: 0.0 loss_jerk: 0.014021234586834908 loss_floor_contact: 0.0
[56/100] loss: 0.0072442009113729 loss_joints: 2.9952122986287577e-06 loss_collision: 0.0 loss_jerk: 0.014482411555945873 loss_floor_contact: 0.0
[57/100] loss: 0.007372433319687843 loss_joints: 0.0001574620109749958 loss_collision: 0.0 loss_jerk: 0.014429942704737186 loss_floor_contact: 0.0
[58/100] loss: 0.007181234657764435 loss_joints: 0.00022215591161511838 loss_collision: 0.0 loss_jerk: 0.013918157666921616 loss_floor_contact: 0.0
[59/100] loss: 0.007253600750118494 loss_joints: 0.00015248644922394305 loss_collision: 0.0 loss_jerk: 0.014202228747308254 loss_floor_contact: 0.0
[60/100] loss: 0.007118538953363895 loss_joints: 0.00014804344391450286 loss_collision: 0.0 loss_jerk: 0.013940990902483463 loss_floor_contact: 0.0
[61/100] loss: 0.0069354441948235035 loss_joints: 0.00010361434397054836 loss_collision: 0.0 loss_jerk: 0.013663659803569317 loss_floor_contact: 0.0
[62/100] loss: 0.006850294768810272 loss_joints: 7.773163815727457e-05 loss_collision: 0.0 loss_jerk: 0.013545126654207706 loss_floor_contact: 0.0
[63/100] loss: 0.007003955077379942 loss_joints: 9.744585258886218e-05 loss_collision: 0.0 loss_jerk: 0.013813018798828125 loss_floor_contact: 0.0
[64/100] loss: 0.007299188524484634 loss_joints: 0.0001767720968928188 loss_collision: 0.0 loss_jerk: 0.014244833029806614 loss_floor_contact: 0.0
[65/100] loss: 0.00728449085727334 loss_joints: 0.00013639491226058453 loss_collision: 0.0 loss_jerk: 0.014296191744506359 loss_floor_contact: 0.0
[66/100] loss: 0.007124765310436487 loss_joints: 1.9974340830231085e-05 loss_collision: 0.0 loss_jerk: 0.014209581539034843 loss_floor_contact: 0.0
[67/100] loss: 0.006914515048265457 loss_joints: 5.9352489188313484e-05 loss_collision: 0.0 loss_jerk: 0.013710325583815575 loss_floor_contact: 0.0
[68/100] loss: 0.006864210125058889 loss_joints: 0.00015352954505942762 loss_collision: 0.0 loss_jerk: 0.013421361334621906 loss_floor_contact: 0.0
[69/100] loss: 0.006769683677703142 loss_joints: 9.551843686494976e-05 loss_collision: 0.0 loss_jerk: 0.013348330743610859 loss_floor_contact: 0.0
[70/100] loss: 0.007030308712273836 loss_joints: 2.2826248823548667e-05 loss_collision: 0.0 loss_jerk: 0.014014964923262596 loss_floor_contact: 0.0
[71/100] loss: 0.00697837769985199 loss_joints: 5.2830153435934335e-05 loss_collision: 0.0 loss_jerk: 0.013851094990968704 loss_floor_contact: 0.0
[72/100] loss: 0.00689377635717392 loss_joints: 6.474347173934802e-05 loss_collision: 0.0 loss_jerk: 0.013658065348863602 loss_floor_contact: 0.0
[73/100] loss: 0.006691502407193184 loss_joints: 5.7067431043833494e-05 loss_collision: 0.0 loss_jerk: 0.013268870301544666 loss_floor_contact: 0.0
[74/100] loss: 0.006647796370089054 loss_joints: 7.627045852132142e-05 loss_collision: 0.0 loss_jerk: 0.013143051415681839 loss_floor_contact: 0.0
[75/100] loss: 0.00658470718190074 loss_joints: 9.353566565550864e-05 loss_collision: 0.0 loss_jerk: 0.012982343323528767 loss_floor_contact: 0.0
[76/100] loss: 0.006502263247966766 loss_joints: 5.319112096913159e-05 loss_collision: 0.0 loss_jerk: 0.01289814431220293 loss_floor_contact: 0.0
[77/100] loss: 0.006516229826956987 loss_joints: 7.256776734720916e-05 loss_collision: 0.0 loss_jerk: 0.012887324206531048 loss_floor_contact: 0.0
[78/100] loss: 0.006665186490863562 loss_joints: 0.00011777080362662673 loss_collision: 0.0 loss_jerk: 0.013094831258058548 loss_floor_contact: 0.0
[79/100] loss: 0.006568775977939367 loss_joints: 0.00011203932808712125 loss_collision: 0.0 loss_jerk: 0.012913472950458527 loss_floor_contact: 0.0
[80/100] loss: 0.006417469121515751 loss_joints: 3.314804780529812e-05 loss_collision: 0.0 loss_jerk: 0.012768642045557499 loss_floor_contact: 0.0
[81/100] loss: 0.0063832830637693405 loss_joints: 1.2625183444470167e-05 loss_collision: 0.0 loss_jerk: 0.012741316109895706 loss_floor_contact: 0.0
[82/100] loss: 0.0063677504658699036 loss_joints: 1.903400698211044e-05 loss_collision: 0.0 loss_jerk: 0.0126974331215024 loss_floor_contact: 0.0
[83/100] loss: 0.00631010252982378 loss_joints: 1.8535318986323546e-06 loss_collision: 0.0 loss_jerk: 0.01261649839580059 loss_floor_contact: 0.0
[84/100] loss: 0.006340718828141689 loss_joints: 3.497760189929977e-05 loss_collision: 0.0 loss_jerk: 0.012611482292413712 loss_floor_contact: 0.0
[85/100] loss: 0.006308776326477528 loss_joints: 7.658385584363714e-05 loss_collision: 0.0 loss_jerk: 0.01246438454836607 loss_floor_contact: 0.0
[86/100] loss: 0.006287865806370974 loss_joints: 6.264261901378632e-05 loss_collision: 0.0 loss_jerk: 0.012450446374714375 loss_floor_contact: 0.0
[87/100] loss: 0.0061745778657495975 loss_joints: 2.4632161512272432e-05 loss_collision: 0.0 loss_jerk: 0.01229989156126976 loss_floor_contact: 0.0
[88/100] loss: 0.0061241574585437775 loss_joints: 4.961231752531603e-06 loss_collision: 0.0 loss_jerk: 0.012238392606377602 loss_floor_contact: 0.0
[89/100] loss: 0.006142050959169865 loss_joints: 1.183931453851983e-05 loss_collision: 0.0 loss_jerk: 0.01226042304188013 loss_floor_contact: 0.0
[90/100] loss: 0.006105330307036638 loss_joints: 1.2549751772894524e-05 loss_collision: 0.0 loss_jerk: 0.01218556147068739 loss_floor_contact: 0.0
[91/100] loss: 0.006041873712092638 loss_joints: 1.0643794666975737e-05 loss_collision: 0.0 loss_jerk: 0.01206246018409729 loss_floor_contact: 0.0
[92/100] loss: 0.0060084364376962185 loss_joints: 6.791757186874747e-06 loss_collision: 0.0 loss_jerk: 0.01200328953564167 loss_floor_contact: 0.0
[93/100] loss: 0.005972801707684994 loss_joints: 3.686915079015307e-06 loss_collision: 0.0 loss_jerk: 0.011938229203224182 loss_floor_contact: 0.0
[94/100] loss: 0.005959059577435255 loss_joints: 2.8229551389813423e-06 loss_collision: 0.0 loss_jerk: 0.011912473477423191 loss_floor_contact: 0.0
[95/100] loss: 0.005948258098214865 loss_joints: 3.6016069770994363e-06 loss_collision: 0.0 loss_jerk: 0.011889313347637653 loss_floor_contact: 0.0
[96/100] loss: 0.00594255980104208 loss_joints: 1.4245614465835388e-06 loss_collision: 0.0 loss_jerk: 0.011882270686328411 loss_floor_contact: 0.0
[97/100] loss: 0.005924232769757509 loss_joints: 2.751819039303882e-08 loss_collision: 0.0 loss_jerk: 0.011848410591483116 loss_floor_contact: 0.0
[98/100] loss: 0.005910804495215416 loss_joints: 3.026662795946322e-07 loss_collision: 0.0 loss_jerk: 0.011821003630757332 loss_floor_contact: 0.0
[99/100] loss: 0.005904023069888353 loss_joints: 1.259861903690762e-07 loss_collision: 0.0 loss_jerk: 0.011807793751358986 loss_floor_contact: 0.0
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.25/contact_thresh_0.75/cabE-path3-run12-4000_collision0.1_contact0.1_jerk0.5_skate0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 418.68625                                                    ║
    ║     rollout = 196.04376                                                    ║
    ║     sdf     = 18.02426                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00590402                                                 ║
    ║     joints    = 0.00000013                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.01180779                                                 ║
    ║     floor     = 0.00000000                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	7m17.278s
user	6m37.972s
sys	0m18.863s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.5, skate=0.5
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<06:46,  4.10s/it]  2%|▏         | 2/100 [00:08<06:32,  4.00s/it]  3%|▎         | 3/100 [00:12<06:56,  4.29s/it]  4%|▍         | 4/100 [00:16<06:40,  4.17s/it]  5%|▌         | 5/100 [00:21<06:44,  4.26s/it]  6%|▌         | 6/100 [00:25<06:43,  4.30s/it]  7%|▋         | 7/100 [00:29<06:32,  4.23s/it]  8%|▊         | 8/100 [00:33<06:31,  4.26s/it]  9%|▉         | 9/100 [00:37<06:24,  4.23s/it] 10%|█         | 10/100 [00:42<06:18,  4.20s/it] 11%|█         | 11/100 [00:46<06:14,  4.20s/it] 12%|█▏        | 12/100 [00:50<06:09,  4.20s/it] 13%|█▎        | 13/100 [00:54<06:00,  4.15s/it] 14%|█▍        | 14/100 [00:58<05:54,  4.12s/it] 15%|█▌        | 15/100 [01:02<05:50,  4.13s/it] 16%|█▌        | 16/100 [01:06<05:44,  4.10s/it] 17%|█▋        | 17/100 [01:10<05:38,  4.08s/it] 18%|█▊        | 18/100 [01:15<05:37,  4.12s/it] 19%|█▉        | 19/100 [01:19<05:34,  4.12s/it] 20%|██        | 20/100 [01:23<05:31,  4.15s/it] 21%|██        | 21/100 [01:27<05:27,  4.14s/it] 22%|██▏       | 22/100 [01:31<05:21,  4.13s/it] 23%|██▎       | 23/100 [01:35<05:19,  4.15s/it] 24%|██▍       | 24/100 [01:40<05:19,  4.20s/it] 25%|██▌       | 25/100 [01:44<05:14,  4.19s/it] 26%|██▌       | 26/100 [01:48<05:17,  4.29s/it] 27%|██▋       | 27/100 [01:53<05:11,  4.27s/it] 28%|██▊       | 28/100 [01:57<05:05,  4.24s/it] 29%|██▉       | 29/100 [02:01<04:59,  4.22s/it] 30%|███       | 30/100 [02:05<04:55,  4.22s/it] 31%|███       | 31/100 [02:10<04:55,  4.29s/it] 32%|███▏      | 32/100 [02:14<04:54,  4.33s/it] 33%|███▎      | 33/100 [02:18<04:47,  4.29s/it] 34%|███▍      | 34/100 [02:23<04:44,  4.30s/it] 35%|███▌      | 35/100 [02:27<04:36,  4.25s/it] 36%|███▌      | 36/100 [02:31<04:30,  4.23s/it] 37%|███▋      | 37/100 [02:35<04:23,  4.18s/it] 38%|███▊      | 38/100 [02:39<04:17,  4.15s/it] 39%|███▉      | 39/100 [02:43<04:15,  4.18s/it] 40%|████      | 40/100 [02:47<04:12,  4.20s/it] 41%|████      | 41/100 [02:52<04:07,  4.20s/it] 42%|████▏     | 42/100 [02:56<04:02,  4.18s/it] 43%|████▎     | 43/100 [03:00<03:55,  4.14s/it] 44%|████▍     | 44/100 [03:04<03:51,  4.14s/it] 45%|████▌     | 45/100 [03:08<03:47,  4.13s/it] 46%|████▌     | 46/100 [03:12<03:43,  4.15s/it] 47%|████▋     | 47/100 [03:17<03:41,  4.18s/it] 48%|████▊     | 48/100 [03:21<03:37,  4.17s/it] 49%|████▉     | 49/100 [03:25<03:32,  4.16s/it] 50%|█████     | 50/100 [03:29<03:26,  4.14s/it] 51%|█████     | 51/100 [03:33<03:25,  4.19s/it] 52%|█████▏    | 52/100 [03:37<03:20,  4.18s/it] 53%|█████▎    | 53/100 [03:42<03:17,  4.20s/it] 54%|█████▍    | 54/100 [03:46<03:12,  4.19s/it] 55%|█████▌    | 55/100 [03:50<03:07,  4.16s/it] 56%|█████▌    | 56/100 [03:54<03:03,  4.16s/it] 57%|█████▋    | 57/100 [03:58<02:58,  4.14s/it] 58%|█████▊    | 58/100 [04:02<02:53,  4.13s/it] 59%|█████▉    | 59/100 [04:06<02:48,  4.12s/it] 60%|██████    | 60/100 [04:11<02:50,  4.27s/it] 61%|██████    | 61/100 [04:15<02:49,  4.35s/it] 62%|██████▏   | 62/100 [04:20<02:45,  4.35s/it] 63%|██████▎   | 63/100 [04:24<02:41,  4.35s/it] 64%|██████▍   | 64/100 [04:29<02:39,  4.44s/it] 65%|██████▌   | 65/100 [04:33<02:37,  4.50s/it] 66%|██████▌   | 66/100 [04:38<02:30,  4.43s/it] 67%|██████▋   | 67/100 [04:42<02:25,  4.40s/it] 68%|██████▊   | 68/100 [04:47<02:23,  4.47s/it] 69%|██████▉   | 69/100 [04:51<02:17,  4.42s/it] 70%|███████   | 70/100 [04:55<02:10,  4.35s/it] 71%|███████   | 71/100 [05:00<02:05,  4.34s/it] 72%|███████▏  | 72/100 [05:04<02:01,  4.32s/it] 73%|███████▎  | 73/100 [05:08<01:56,  4.32s/it] 74%|███████▍  | 74/100 [05:13<01:53,  4.38s/it] 75%|███████▌  | 75/100 [05:17<01:49,  4.38s/it] 76%|███████▌  | 76/100 [05:21<01:45,  4.39s/it] 77%|███████▋  | 77/100 [05:26<01:41,  4.39s/it] 78%|███████▊  | 78/100 [05:30<01:36,  4.38s/it] 79%|███████▉  | 79/100 [05:34<01:31,  4.34s/it] 80%|████████  | 80/100 [05:39<01:25,  4.28s/it] 81%|████████  | 81/100 [05:43<01:22,  4.33s/it] 82%|████████▏ | 82/100 [05:47<01:17,  4.30s/it] 83%|████████▎ | 83/100 [05:52<01:12,  4.29s/it] 84%|████████▍ | 84/100 [05:56<01:08,  4.25s/it] 85%|████████▌ | 85/100 [06:00<01:03,  4.22s/it] 86%|████████▌ | 86/100 [06:04<00:58,  4.20s/it] 87%|████████▋ | 87/100 [06:08<00:54,  4.17s/it] 88%|████████▊ | 88/100 [06:12<00:49,  4.16s/it] 89%|████████▉ | 89/100 [06:17<00:46,  4.27s/it] 90%|█████████ | 90/100 [06:21<00:42,  4.24s/it] 91%|█████████ | 91/100 [06:25<00:38,  4.27s/it] 92%|█████████▏| 92/100 [06:30<00:34,  4.28s/it] 93%|█████████▎| 93/100 [06:34<00:29,  4.24s/it] 94%|█████████▍| 94/100 [06:38<00:25,  4.23s/it] 95%|█████████▌| 95/100 [06:42<00:21,  4.25s/it] 96%|█████████▌| 96/100 [06:46<00:16,  4.24s/it] 97%|█████████▋| 97/100 [06:51<00:12,  4.28s/it] 98%|█████████▊| 98/100 [06:55<00:08,  4.25s/it] 99%|█████████▉| 99/100 [06:59<00:04,  4.24s/it]100%|██████████| 100/100 [07:03<00:00,  4.22s/it]100%|██████████| 100/100 [07:03<00:00,  4.24s/it]
[0/100] loss: 2.7128372192382812 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 0.7648107409477234
[1/100] loss: 1.0538480281829834 loss_joints: 0.9680825471878052 loss_collision: 0.0 loss_jerk: 0.08088590949773788 loss_floor_contact: 0.45322591066360474
[2/100] loss: 0.9111217856407166 loss_joints: 0.8809795379638672 loss_collision: 0.0 loss_jerk: 0.05224321782588959 loss_floor_contact: 0.04020615294575691
[3/100] loss: 0.4998719394207001 loss_joints: 0.47840866446495056 loss_collision: 0.0 loss_jerk: 0.04292652755975723 loss_floor_contact: 0.0
[4/100] loss: 0.398628830909729 loss_joints: 0.38266128301620483 loss_collision: 0.0022069858387112617 loss_jerk: 0.03149371221661568 loss_floor_contact: 0.0
[5/100] loss: 0.26981571316719055 loss_joints: 0.25427383184432983 loss_collision: 0.0017710706451907754 loss_jerk: 0.03072950802743435 loss_floor_contact: 0.0
[6/100] loss: 0.13625188171863556 loss_joints: 0.10905315726995468 loss_collision: 0.0017591898795217276 loss_jerk: 0.054045628756284714 loss_floor_contact: 0.0
[7/100] loss: 0.07441408932209015 loss_joints: 0.04059680551290512 loss_collision: 0.0011795323807746172 loss_jerk: 0.06739865243434906 loss_floor_contact: 0.0
[8/100] loss: 0.04883415997028351 loss_joints: 0.02572263590991497 loss_collision: 0.0010529814753681421 loss_jerk: 0.046012453734874725 loss_floor_contact: 0.0
[9/100] loss: 0.030539531260728836 loss_joints: 0.009855324402451515 loss_collision: 0.0009504453628323972 loss_jerk: 0.041178327053785324 loss_floor_contact: 0.0
[10/100] loss: 0.02620837837457657 loss_joints: 0.005820257123559713 loss_collision: 0.0010773470858111978 loss_jerk: 0.0405607745051384 loss_floor_contact: 0.0
[11/100] loss: 0.03922276943922043 loss_joints: 0.01411435753107071 loss_collision: 0.001002615550532937 loss_jerk: 0.05001629889011383 loss_floor_contact: 0.0
[12/100] loss: 0.037273429334163666 loss_joints: 0.0149019043892622 loss_collision: 0.0011261518811807036 loss_jerk: 0.04451781511306763 loss_floor_contact: 0.0
[13/100] loss: 0.027867645025253296 loss_joints: 0.008675718680024147 loss_collision: 0.0011847030837088823 loss_jerk: 0.038146913051605225 loss_floor_contact: 0.0
[14/100] loss: 0.020174143835902214 loss_joints: 0.0015406000893563032 loss_collision: 0.0012042236048728228 loss_jerk: 0.037026241421699524 loss_floor_contact: 0.0
[15/100] loss: 0.019518781453371048 loss_joints: 0.001159285893663764 loss_collision: 0.001025925506837666 loss_jerk: 0.0365138053894043 loss_floor_contact: 0.0
[16/100] loss: 0.021908428519964218 loss_joints: 0.003900115843862295 loss_collision: 0.0011330305133014917 loss_jerk: 0.03579001873731613 loss_floor_contact: 0.0
[17/100] loss: 0.020650800317525864 loss_joints: 0.004066945053637028 loss_collision: 0.0011367534752935171 loss_jerk: 0.03294035792350769 loss_floor_contact: 0.0
[18/100] loss: 0.018415261059999466 loss_joints: 0.002341677900403738 loss_collision: 0.001097927917726338 loss_jerk: 0.03192758187651634 loss_floor_contact: 0.0
[19/100] loss: 0.016109248623251915 loss_joints: 0.0014448845759034157 loss_collision: 0.0010545357363298535 loss_jerk: 0.029117820784449577 loss_floor_contact: 0.0
[20/100] loss: 0.016659963876008987 loss_joints: 0.0015270798467099667 loss_collision: 0.0010004559298977256 loss_jerk: 0.03006567806005478 loss_floor_contact: 0.0
[21/100] loss: 0.016814254224300385 loss_joints: 0.0010756681440398097 loss_collision: 0.001123391673900187 loss_jerk: 0.03125249221920967 loss_floor_contact: 0.0
[22/100] loss: 0.01580229587852955 loss_joints: 0.0010173203190788627 loss_collision: 0.0010867624077945948 loss_jerk: 0.029352599754929543 loss_floor_contact: 0.0
[23/100] loss: 0.01455003209412098 loss_joints: 0.000922162551432848 loss_collision: 0.0010120123624801636 loss_jerk: 0.027053337544202805 loss_floor_contact: 0.0
[24/100] loss: 0.01321211364120245 loss_joints: 0.00028846756322309375 loss_collision: 0.0009564906940795481 loss_jerk: 0.025655994191765785 loss_floor_contact: 0.0
[25/100] loss: 0.012230722233653069 loss_joints: 6.523983029183e-05 loss_collision: 0.0007453343132510781 loss_jerk: 0.024181898683309555 loss_floor_contact: 0.0
[26/100] loss: 0.01198083721101284 loss_joints: 0.0003841515281237662 loss_collision: 0.0007276030955836177 loss_jerk: 0.023047851398587227 loss_floor_contact: 0.0
[27/100] loss: 0.01173435803502798 loss_joints: 0.000529843382537365 loss_collision: 0.0006316671497188509 loss_jerk: 0.022282695397734642 loss_floor_contact: 0.0
[28/100] loss: 0.011130183935165405 loss_joints: 0.00012171601701993495 loss_collision: 0.0007278930861502886 loss_jerk: 0.021871356293559074 loss_floor_contact: 0.0
[29/100] loss: 0.01073786523193121 loss_joints: 0.0001855964947026223 loss_collision: 0.0006506454665213823 loss_jerk: 0.020974408835172653 loss_floor_contact: 0.0
[30/100] loss: 0.010020448826253414 loss_joints: 0.0002164699835702777 loss_collision: 0.0005966941243968904 loss_jerk: 0.01948861964046955 loss_floor_contact: 0.0
[31/100] loss: 0.00990887451916933 loss_joints: 0.00017705615027807653 loss_collision: 0.0005900229443795979 loss_jerk: 0.019345631822943687 loss_floor_contact: 0.0
[32/100] loss: 0.009600157849490643 loss_joints: 0.0004384592757560313 loss_collision: 0.0005191644886508584 loss_jerk: 0.018219564110040665 loss_floor_contact: 0.0
[33/100] loss: 0.00929445680230856 loss_joints: 0.00030474376399070024 loss_collision: 0.0 loss_jerk: 0.017979426309466362 loss_floor_contact: 0.0
[34/100] loss: 0.008808901533484459 loss_joints: 0.00020239896548446268 loss_collision: 0.0 loss_jerk: 0.01721300557255745 loss_floor_contact: 0.0
[35/100] loss: 0.008537521585822105 loss_joints: 0.0001765356573741883 loss_collision: 0.0 loss_jerk: 0.016721971333026886 loss_floor_contact: 0.0
[36/100] loss: 0.008816749788820744 loss_joints: 8.917688319343142e-06 loss_collision: 0.0 loss_jerk: 0.0176156647503376 loss_floor_contact: 0.0
[37/100] loss: 0.008377255871891975 loss_joints: 0.00036712150904349983 loss_collision: 0.0 loss_jerk: 0.016020268201828003 loss_floor_contact: 0.0
[38/100] loss: 0.008412941358983517 loss_joints: 0.0004971691523678601 loss_collision: 0.0 loss_jerk: 0.015831544995307922 loss_floor_contact: 0.0
[39/100] loss: 0.008350319229066372 loss_joints: 0.00010673317592591047 loss_collision: 0.0 loss_jerk: 0.01648717187345028 loss_floor_contact: 0.0
[40/100] loss: 0.00797123834490776 loss_joints: 0.0002134735113941133 loss_collision: 0.0 loss_jerk: 0.015515530481934547 loss_floor_contact: 0.0
[41/100] loss: 0.00798262469470501 loss_joints: 0.00026319595053792 loss_collision: 0.0 loss_jerk: 0.015438857488334179 loss_floor_contact: 0.0
[42/100] loss: 0.007853861898183823 loss_joints: 0.0001482884690631181 loss_collision: 0.0 loss_jerk: 0.015411145985126495 loss_floor_contact: 0.0
[43/100] loss: 0.007582489866763353 loss_joints: 0.00027481073630042374 loss_collision: 0.0 loss_jerk: 0.014615357853472233 loss_floor_contact: 0.0
[44/100] loss: 0.00749944057315588 loss_joints: 0.00010283214214723557 loss_collision: 0.0 loss_jerk: 0.014793217182159424 loss_floor_contact: 0.0
[45/100] loss: 0.007392551749944687 loss_joints: 0.0001032391082844697 loss_collision: 0.0 loss_jerk: 0.014578625559806824 loss_floor_contact: 0.0
[46/100] loss: 0.007647762540727854 loss_joints: 0.0002140394353773445 loss_collision: 0.0 loss_jerk: 0.014867446385324001 loss_floor_contact: 0.0
[47/100] loss: 0.007360358722507954 loss_joints: 6.412332004401833e-05 loss_collision: 0.0 loss_jerk: 0.014592470601201057 loss_floor_contact: 0.0
[48/100] loss: 0.0072924415580928326 loss_joints: 0.00012041922309435904 loss_collision: 0.0 loss_jerk: 0.014344044961035252 loss_floor_contact: 0.0
[49/100] loss: 0.00751532195135951 loss_joints: 0.0002517338143661618 loss_collision: 0.0 loss_jerk: 0.01452717650681734 loss_floor_contact: 0.0
[50/100] loss: 0.007463173009455204 loss_joints: 0.00017454939370509237 loss_collision: 0.0 loss_jerk: 0.014577247202396393 loss_floor_contact: 0.0
[51/100] loss: 0.008160210214555264 loss_joints: 0.00011282395280431956 loss_collision: 0.0 loss_jerk: 0.016094772145152092 loss_floor_contact: 0.0
[52/100] loss: 0.00769121153280139 loss_joints: 0.00017432768072467297 loss_collision: 0.0 loss_jerk: 0.015033767558634281 loss_floor_contact: 0.0
[53/100] loss: 0.007240233477205038 loss_joints: 8.793677989160642e-05 loss_collision: 0.0 loss_jerk: 0.014304593205451965 loss_floor_contact: 0.0
[54/100] loss: 0.00718862796202302 loss_joints: 0.00015066783817019314 loss_collision: 0.0 loss_jerk: 0.01407591998577118 loss_floor_contact: 0.0
[55/100] loss: 0.007134377025067806 loss_joints: 0.00012375949881970882 loss_collision: 0.0 loss_jerk: 0.014021234586834908 loss_floor_contact: 0.0
[56/100] loss: 0.0072442009113729 loss_joints: 2.9952122986287577e-06 loss_collision: 0.0 loss_jerk: 0.014482411555945873 loss_floor_contact: 0.0
[57/100] loss: 0.007372433319687843 loss_joints: 0.0001574620109749958 loss_collision: 0.0 loss_jerk: 0.014429942704737186 loss_floor_contact: 0.0
[58/100] loss: 0.007181234657764435 loss_joints: 0.00022215591161511838 loss_collision: 0.0 loss_jerk: 0.013918157666921616 loss_floor_contact: 0.0
[59/100] loss: 0.007253600750118494 loss_joints: 0.00015248644922394305 loss_collision: 0.0 loss_jerk: 0.014202228747308254 loss_floor_contact: 0.0
[60/100] loss: 0.007118538953363895 loss_joints: 0.00014804344391450286 loss_collision: 0.0 loss_jerk: 0.013940990902483463 loss_floor_contact: 0.0
[61/100] loss: 0.0069354441948235035 loss_joints: 0.00010361434397054836 loss_collision: 0.0 loss_jerk: 0.013663659803569317 loss_floor_contact: 0.0
[62/100] loss: 0.006850294768810272 loss_joints: 7.773163815727457e-05 loss_collision: 0.0 loss_jerk: 0.013545126654207706 loss_floor_contact: 0.0
[63/100] loss: 0.007003955077379942 loss_joints: 9.744585258886218e-05 loss_collision: 0.0 loss_jerk: 0.013813018798828125 loss_floor_contact: 0.0
[64/100] loss: 0.007299188524484634 loss_joints: 0.0001767720968928188 loss_collision: 0.0 loss_jerk: 0.014244833029806614 loss_floor_contact: 0.0
[65/100] loss: 0.00728449085727334 loss_joints: 0.00013639491226058453 loss_collision: 0.0 loss_jerk: 0.014296191744506359 loss_floor_contact: 0.0
[66/100] loss: 0.007124765310436487 loss_joints: 1.9974340830231085e-05 loss_collision: 0.0 loss_jerk: 0.014209581539034843 loss_floor_contact: 0.0
[67/100] loss: 0.006914515048265457 loss_joints: 5.9352489188313484e-05 loss_collision: 0.0 loss_jerk: 0.013710325583815575 loss_floor_contact: 0.0
[68/100] loss: 0.006864210125058889 loss_joints: 0.00015352954505942762 loss_collision: 0.0 loss_jerk: 0.013421361334621906 loss_floor_contact: 0.0
[69/100] loss: 0.006769683677703142 loss_joints: 9.551843686494976e-05 loss_collision: 0.0 loss_jerk: 0.013348330743610859 loss_floor_contact: 0.0
[70/100] loss: 0.007030308712273836 loss_joints: 2.2826248823548667e-05 loss_collision: 0.0 loss_jerk: 0.014014964923262596 loss_floor_contact: 0.0
[71/100] loss: 0.00697837769985199 loss_joints: 5.2830153435934335e-05 loss_collision: 0.0 loss_jerk: 0.013851094990968704 loss_floor_contact: 0.0
[72/100] loss: 0.00689377635717392 loss_joints: 6.474347173934802e-05 loss_collision: 0.0 loss_jerk: 0.013658065348863602 loss_floor_contact: 0.0
[73/100] loss: 0.006691502407193184 loss_joints: 5.7067431043833494e-05 loss_collision: 0.0 loss_jerk: 0.013268870301544666 loss_floor_contact: 0.0
[74/100] loss: 0.006647796370089054 loss_joints: 7.627045852132142e-05 loss_collision: 0.0 loss_jerk: 0.013143051415681839 loss_floor_contact: 0.0
[75/100] loss: 0.00658470718190074 loss_joints: 9.353566565550864e-05 loss_collision: 0.0 loss_jerk: 0.012982343323528767 loss_floor_contact: 0.0
[76/100] loss: 0.006502263247966766 loss_joints: 5.319112096913159e-05 loss_collision: 0.0 loss_jerk: 0.01289814431220293 loss_floor_contact: 0.0
[77/100] loss: 0.006516229826956987 loss_joints: 7.256776734720916e-05 loss_collision: 0.0 loss_jerk: 0.012887324206531048 loss_floor_contact: 0.0
[78/100] loss: 0.006665186490863562 loss_joints: 0.00011777080362662673 loss_collision: 0.0 loss_jerk: 0.013094831258058548 loss_floor_contact: 0.0
[79/100] loss: 0.006568775977939367 loss_joints: 0.00011203932808712125 loss_collision: 0.0 loss_jerk: 0.012913472950458527 loss_floor_contact: 0.0
[80/100] loss: 0.006417469121515751 loss_joints: 3.314804780529812e-05 loss_collision: 0.0 loss_jerk: 0.012768642045557499 loss_floor_contact: 0.0
[81/100] loss: 0.0063832830637693405 loss_joints: 1.2625183444470167e-05 loss_collision: 0.0 loss_jerk: 0.012741316109895706 loss_floor_contact: 0.0
[82/100] loss: 0.0063677504658699036 loss_joints: 1.903400698211044e-05 loss_collision: 0.0 loss_jerk: 0.0126974331215024 loss_floor_contact: 0.0
[83/100] loss: 0.00631010252982378 loss_joints: 1.8535318986323546e-06 loss_collision: 0.0 loss_jerk: 0.01261649839580059 loss_floor_contact: 0.0
[84/100] loss: 0.006340718828141689 loss_joints: 3.497760189929977e-05 loss_collision: 0.0 loss_jerk: 0.012611482292413712 loss_floor_contact: 0.0
[85/100] loss: 0.006308776326477528 loss_joints: 7.658385584363714e-05 loss_collision: 0.0 loss_jerk: 0.01246438454836607 loss_floor_contact: 0.0
[86/100] loss: 0.006287865806370974 loss_joints: 6.264261901378632e-05 loss_collision: 0.0 loss_jerk: 0.012450446374714375 loss_floor_contact: 0.0
[87/100] loss: 0.0061745778657495975 loss_joints: 2.4632161512272432e-05 loss_collision: 0.0 loss_jerk: 0.01229989156126976 loss_floor_contact: 0.0
[88/100] loss: 0.0061241574585437775 loss_joints: 4.961231752531603e-06 loss_collision: 0.0 loss_jerk: 0.012238392606377602 loss_floor_contact: 0.0
[89/100] loss: 0.006142050959169865 loss_joints: 1.183931453851983e-05 loss_collision: 0.0 loss_jerk: 0.01226042304188013 loss_floor_contact: 0.0
[90/100] loss: 0.006105330307036638 loss_joints: 1.2549751772894524e-05 loss_collision: 0.0 loss_jerk: 0.01218556147068739 loss_floor_contact: 0.0
[91/100] loss: 0.006041873712092638 loss_joints: 1.0643794666975737e-05 loss_collision: 0.0 loss_jerk: 0.01206246018409729 loss_floor_contact: 0.0
[92/100] loss: 0.0060084364376962185 loss_joints: 6.791757186874747e-06 loss_collision: 0.0 loss_jerk: 0.01200328953564167 loss_floor_contact: 0.0
[93/100] loss: 0.005972801707684994 loss_joints: 3.686915079015307e-06 loss_collision: 0.0 loss_jerk: 0.011938229203224182 loss_floor_contact: 0.0
[94/100] loss: 0.005959059577435255 loss_joints: 2.8229551389813423e-06 loss_collision: 0.0 loss_jerk: 0.011912473477423191 loss_floor_contact: 0.0
[95/100] loss: 0.005948258098214865 loss_joints: 3.6016069770994363e-06 loss_collision: 0.0 loss_jerk: 0.011889313347637653 loss_floor_contact: 0.0
[96/100] loss: 0.00594255980104208 loss_joints: 1.4245614465835388e-06 loss_collision: 0.0 loss_jerk: 0.011882270686328411 loss_floor_contact: 0.0
[97/100] loss: 0.005924232769757509 loss_joints: 2.751819039303882e-08 loss_collision: 0.0 loss_jerk: 0.011848410591483116 loss_floor_contact: 0.0
[98/100] loss: 0.005910804495215416 loss_joints: 3.026662795946322e-07 loss_collision: 0.0 loss_jerk: 0.011821003630757332 loss_floor_contact: 0.0
[99/100] loss: 0.005904023069888353 loss_joints: 1.259861903690762e-07 loss_collision: 0.0 loss_jerk: 0.011807793751358986 loss_floor_contact: 0.0
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.25/contact_thresh_0.75/cabE-path3-run12-4000_collision0.1_contact0.1_jerk0.5_skate0.5]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 423.89397                                                    ║
    ║     rollout = 190.96554                                                    ║
    ║     sdf     = 18.00870                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00590402                                                 ║
    ║     joints    = 0.00000013                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.01180779                                                 ║
    ║     floor     = 0.00000000                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	7m22.161s
user	6m43.798s
sys	0m19.166s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.5, skate=1.0
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<06:40,  4.05s/it]  2%|▏         | 2/100 [00:07<06:28,  3.96s/it]  3%|▎         | 3/100 [00:13<07:14,  4.48s/it]  4%|▍         | 4/100 [00:17<07:11,  4.49s/it]  5%|▌         | 5/100 [00:21<06:55,  4.38s/it]  6%|▌         | 6/100 [00:25<06:41,  4.27s/it]  7%|▋         | 7/100 [00:29<06:28,  4.18s/it]  8%|▊         | 8/100 [00:33<06:19,  4.12s/it]  9%|▉         | 9/100 [00:37<06:17,  4.15s/it] 10%|█         | 10/100 [00:42<06:14,  4.16s/it] 11%|█         | 11/100 [00:46<06:12,  4.18s/it] 12%|█▏        | 12/100 [00:50<06:06,  4.16s/it] 13%|█▎        | 13/100 [00:54<06:03,  4.18s/it] 14%|█▍        | 14/100 [00:58<05:55,  4.13s/it] 15%|█▌        | 15/100 [01:02<05:48,  4.10s/it] 16%|█▌        | 16/100 [01:07<05:48,  4.15s/it] 17%|█▋        | 17/100 [01:11<05:42,  4.12s/it] 18%|█▊        | 18/100 [01:15<05:41,  4.17s/it] 19%|█▉        | 19/100 [01:19<05:37,  4.17s/it] 20%|██        | 20/100 [01:23<05:29,  4.12s/it] 21%|██        | 21/100 [01:27<05:23,  4.10s/it] 22%|██▏       | 22/100 [01:31<05:18,  4.09s/it] 23%|██▎       | 23/100 [01:35<05:12,  4.05s/it] 24%|██▍       | 24/100 [01:39<05:07,  4.05s/it] 25%|██▌       | 25/100 [01:43<05:05,  4.07s/it] 26%|██▌       | 26/100 [01:48<05:05,  4.13s/it] 27%|██▋       | 27/100 [01:52<04:57,  4.07s/it] 28%|██▊       | 28/100 [01:56<04:52,  4.06s/it] 29%|██▉       | 29/100 [02:00<04:48,  4.06s/it] 30%|███       | 30/100 [02:04<04:42,  4.03s/it] 31%|███       | 31/100 [02:08<04:38,  4.04s/it] 32%|███▏      | 32/100 [02:12<04:35,  4.05s/it] 33%|███▎      | 33/100 [02:16<04:31,  4.05s/it] 34%|███▍      | 34/100 [02:20<04:27,  4.05s/it] 35%|███▌      | 35/100 [02:24<04:25,  4.08s/it] 36%|███▌      | 36/100 [02:28<04:19,  4.05s/it] 37%|███▋      | 37/100 [02:32<04:18,  4.11s/it] 38%|███▊      | 38/100 [02:36<04:15,  4.13s/it] 39%|███▉      | 39/100 [02:40<04:11,  4.12s/it] 40%|████      | 40/100 [02:44<04:04,  4.08s/it] 41%|████      | 41/100 [02:48<03:59,  4.06s/it] 42%|████▏     | 42/100 [02:53<03:56,  4.08s/it] 43%|████▎     | 43/100 [02:57<03:51,  4.05s/it] 44%|████▍     | 44/100 [03:01<03:48,  4.07s/it] 45%|████▌     | 45/100 [03:05<03:43,  4.05s/it] 46%|████▌     | 46/100 [03:09<03:37,  4.03s/it] 47%|████▋     | 47/100 [03:13<03:35,  4.06s/it] 48%|████▊     | 48/100 [03:17<03:29,  4.04s/it] 49%|████▉     | 49/100 [03:21<03:26,  4.05s/it] 50%|█████     | 50/100 [03:25<03:22,  4.05s/it] 51%|█████     | 51/100 [03:29<03:18,  4.05s/it] 52%|█████▏    | 52/100 [03:33<03:13,  4.04s/it] 53%|█████▎    | 53/100 [03:37<03:11,  4.07s/it] 54%|█████▍    | 54/100 [03:41<03:05,  4.03s/it] 55%|█████▌    | 55/100 [03:45<03:01,  4.04s/it] 56%|█████▌    | 56/100 [03:49<02:56,  4.01s/it] 57%|█████▋    | 57/100 [03:53<02:52,  4.01s/it] 58%|█████▊    | 58/100 [03:57<02:50,  4.06s/it] 59%|█████▉    | 59/100 [04:01<02:45,  4.02s/it] 60%|██████    | 60/100 [04:05<02:42,  4.06s/it] 61%|██████    | 61/100 [04:09<02:38,  4.05s/it] 62%|██████▏   | 62/100 [04:14<02:38,  4.17s/it] 63%|██████▎   | 63/100 [04:18<02:36,  4.24s/it] 64%|██████▍   | 64/100 [04:22<02:31,  4.21s/it] 65%|██████▌   | 65/100 [04:27<02:27,  4.23s/it] 66%|██████▌   | 66/100 [04:31<02:25,  4.29s/it] 67%|██████▋   | 67/100 [04:35<02:21,  4.29s/it] 68%|██████▊   | 68/100 [04:40<02:20,  4.40s/it] 69%|██████▉   | 69/100 [04:44<02:15,  4.38s/it] 70%|███████   | 70/100 [04:49<02:12,  4.43s/it] 71%|███████   | 71/100 [04:53<02:07,  4.41s/it] 72%|███████▏  | 72/100 [04:58<02:03,  4.43s/it] 73%|███████▎  | 73/100 [05:02<01:58,  4.40s/it] 74%|███████▍  | 74/100 [05:06<01:54,  4.41s/it] 75%|███████▌  | 75/100 [05:11<01:50,  4.43s/it] 76%|███████▌  | 76/100 [05:15<01:46,  4.44s/it] 77%|███████▋  | 77/100 [05:20<01:41,  4.43s/it] 78%|███████▊  | 78/100 [05:25<01:40,  4.59s/it] 79%|███████▉  | 79/100 [05:30<01:37,  4.63s/it] 80%|████████  | 80/100 [05:34<01:31,  4.57s/it] 81%|████████  | 81/100 [05:39<01:26,  4.58s/it] 82%|████████▏ | 82/100 [05:43<01:22,  4.56s/it] 83%|████████▎ | 83/100 [05:48<01:17,  4.59s/it] 84%|████████▍ | 84/100 [05:52<01:14,  4.63s/it] 85%|████████▌ | 85/100 [05:57<01:09,  4.63s/it] 86%|████████▌ | 86/100 [06:02<01:04,  4.63s/it] 87%|████████▋ | 87/100 [06:06<01:00,  4.65s/it] 88%|████████▊ | 88/100 [06:11<00:55,  4.63s/it] 89%|████████▉ | 89/100 [06:16<00:51,  4.68s/it] 90%|█████████ | 90/100 [06:21<00:47,  4.71s/it] 91%|█████████ | 91/100 [06:25<00:42,  4.67s/it] 92%|█████████▏| 92/100 [06:30<00:37,  4.66s/it] 93%|█████████▎| 93/100 [06:34<00:32,  4.65s/it] 94%|█████████▍| 94/100 [06:39<00:27,  4.65s/it] 95%|█████████▌| 95/100 [06:44<00:23,  4.66s/it] 96%|█████████▌| 96/100 [06:48<00:18,  4.64s/it] 97%|█████████▋| 97/100 [06:53<00:13,  4.59s/it] 98%|█████████▊| 98/100 [06:57<00:09,  4.51s/it] 99%|█████████▉| 99/100 [07:02<00:04,  4.51s/it]100%|██████████| 100/100 [07:06<00:00,  4.55s/it]100%|██████████| 100/100 [07:06<00:00,  4.27s/it]
[0/100] loss: 2.7128372192382812 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 0.7648107409477234
[1/100] loss: 1.0538480281829834 loss_joints: 0.9680825471878052 loss_collision: 0.0 loss_jerk: 0.08088590949773788 loss_floor_contact: 0.45322591066360474
[2/100] loss: 0.9111217856407166 loss_joints: 0.8809795379638672 loss_collision: 0.0 loss_jerk: 0.05224321782588959 loss_floor_contact: 0.04020615294575691
[3/100] loss: 0.4998719394207001 loss_joints: 0.47840866446495056 loss_collision: 0.0 loss_jerk: 0.04292652755975723 loss_floor_contact: 0.0
[4/100] loss: 0.398628830909729 loss_joints: 0.38266128301620483 loss_collision: 0.0022069858387112617 loss_jerk: 0.03149371221661568 loss_floor_contact: 0.0
[5/100] loss: 0.26981571316719055 loss_joints: 0.25427383184432983 loss_collision: 0.0017710706451907754 loss_jerk: 0.03072950802743435 loss_floor_contact: 0.0
[6/100] loss: 0.13625188171863556 loss_joints: 0.10905315726995468 loss_collision: 0.0017591898795217276 loss_jerk: 0.054045628756284714 loss_floor_contact: 0.0
[7/100] loss: 0.07441408932209015 loss_joints: 0.04059680551290512 loss_collision: 0.0011795323807746172 loss_jerk: 0.06739865243434906 loss_floor_contact: 0.0
[8/100] loss: 0.04883415997028351 loss_joints: 0.02572263590991497 loss_collision: 0.0010529814753681421 loss_jerk: 0.046012453734874725 loss_floor_contact: 0.0
[9/100] loss: 0.030539531260728836 loss_joints: 0.009855324402451515 loss_collision: 0.0009504453628323972 loss_jerk: 0.041178327053785324 loss_floor_contact: 0.0
[10/100] loss: 0.02620837837457657 loss_joints: 0.005820257123559713 loss_collision: 0.0010773470858111978 loss_jerk: 0.0405607745051384 loss_floor_contact: 0.0
[11/100] loss: 0.03922276943922043 loss_joints: 0.01411435753107071 loss_collision: 0.001002615550532937 loss_jerk: 0.05001629889011383 loss_floor_contact: 0.0
[12/100] loss: 0.037273429334163666 loss_joints: 0.0149019043892622 loss_collision: 0.0011261518811807036 loss_jerk: 0.04451781511306763 loss_floor_contact: 0.0
[13/100] loss: 0.027867645025253296 loss_joints: 0.008675718680024147 loss_collision: 0.0011847030837088823 loss_jerk: 0.038146913051605225 loss_floor_contact: 0.0
[14/100] loss: 0.020174143835902214 loss_joints: 0.0015406000893563032 loss_collision: 0.0012042236048728228 loss_jerk: 0.037026241421699524 loss_floor_contact: 0.0
[15/100] loss: 0.019518781453371048 loss_joints: 0.001159285893663764 loss_collision: 0.001025925506837666 loss_jerk: 0.0365138053894043 loss_floor_contact: 0.0
[16/100] loss: 0.021908428519964218 loss_joints: 0.003900115843862295 loss_collision: 0.0011330305133014917 loss_jerk: 0.03579001873731613 loss_floor_contact: 0.0
[17/100] loss: 0.020650800317525864 loss_joints: 0.004066945053637028 loss_collision: 0.0011367534752935171 loss_jerk: 0.03294035792350769 loss_floor_contact: 0.0
[18/100] loss: 0.018415261059999466 loss_joints: 0.002341677900403738 loss_collision: 0.001097927917726338 loss_jerk: 0.03192758187651634 loss_floor_contact: 0.0
[19/100] loss: 0.016109248623251915 loss_joints: 0.0014448845759034157 loss_collision: 0.0010545357363298535 loss_jerk: 0.029117820784449577 loss_floor_contact: 0.0
[20/100] loss: 0.016659963876008987 loss_joints: 0.0015270798467099667 loss_collision: 0.0010004559298977256 loss_jerk: 0.03006567806005478 loss_floor_contact: 0.0
[21/100] loss: 0.016814254224300385 loss_joints: 0.0010756681440398097 loss_collision: 0.001123391673900187 loss_jerk: 0.03125249221920967 loss_floor_contact: 0.0
[22/100] loss: 0.01580229587852955 loss_joints: 0.0010173203190788627 loss_collision: 0.0010867624077945948 loss_jerk: 0.029352599754929543 loss_floor_contact: 0.0
[23/100] loss: 0.01455003209412098 loss_joints: 0.000922162551432848 loss_collision: 0.0010120123624801636 loss_jerk: 0.027053337544202805 loss_floor_contact: 0.0
[24/100] loss: 0.01321211364120245 loss_joints: 0.00028846756322309375 loss_collision: 0.0009564906940795481 loss_jerk: 0.025655994191765785 loss_floor_contact: 0.0
[25/100] loss: 0.012230722233653069 loss_joints: 6.523983029183e-05 loss_collision: 0.0007453343132510781 loss_jerk: 0.024181898683309555 loss_floor_contact: 0.0
[26/100] loss: 0.01198083721101284 loss_joints: 0.0003841515281237662 loss_collision: 0.0007276030955836177 loss_jerk: 0.023047851398587227 loss_floor_contact: 0.0
[27/100] loss: 0.01173435803502798 loss_joints: 0.000529843382537365 loss_collision: 0.0006316671497188509 loss_jerk: 0.022282695397734642 loss_floor_contact: 0.0
[28/100] loss: 0.011130183935165405 loss_joints: 0.00012171601701993495 loss_collision: 0.0007278930861502886 loss_jerk: 0.021871356293559074 loss_floor_contact: 0.0
[29/100] loss: 0.01073786523193121 loss_joints: 0.0001855964947026223 loss_collision: 0.0006506454665213823 loss_jerk: 0.020974408835172653 loss_floor_contact: 0.0
[30/100] loss: 0.010020448826253414 loss_joints: 0.0002164699835702777 loss_collision: 0.0005966941243968904 loss_jerk: 0.01948861964046955 loss_floor_contact: 0.0
[31/100] loss: 0.00990887451916933 loss_joints: 0.00017705615027807653 loss_collision: 0.0005900229443795979 loss_jerk: 0.019345631822943687 loss_floor_contact: 0.0
[32/100] loss: 0.009600157849490643 loss_joints: 0.0004384592757560313 loss_collision: 0.0005191644886508584 loss_jerk: 0.018219564110040665 loss_floor_contact: 0.0
[33/100] loss: 0.00929445680230856 loss_joints: 0.00030474376399070024 loss_collision: 0.0 loss_jerk: 0.017979426309466362 loss_floor_contact: 0.0
[34/100] loss: 0.008808901533484459 loss_joints: 0.00020239896548446268 loss_collision: 0.0 loss_jerk: 0.01721300557255745 loss_floor_contact: 0.0
[35/100] loss: 0.008537521585822105 loss_joints: 0.0001765356573741883 loss_collision: 0.0 loss_jerk: 0.016721971333026886 loss_floor_contact: 0.0
[36/100] loss: 0.008816749788820744 loss_joints: 8.917688319343142e-06 loss_collision: 0.0 loss_jerk: 0.0176156647503376 loss_floor_contact: 0.0
[37/100] loss: 0.008377255871891975 loss_joints: 0.00036712150904349983 loss_collision: 0.0 loss_jerk: 0.016020268201828003 loss_floor_contact: 0.0
[38/100] loss: 0.008412941358983517 loss_joints: 0.0004971691523678601 loss_collision: 0.0 loss_jerk: 0.015831544995307922 loss_floor_contact: 0.0
[39/100] loss: 0.008350319229066372 loss_joints: 0.00010673317592591047 loss_collision: 0.0 loss_jerk: 0.01648717187345028 loss_floor_contact: 0.0
[40/100] loss: 0.00797123834490776 loss_joints: 0.0002134735113941133 loss_collision: 0.0 loss_jerk: 0.015515530481934547 loss_floor_contact: 0.0
[41/100] loss: 0.00798262469470501 loss_joints: 0.00026319595053792 loss_collision: 0.0 loss_jerk: 0.015438857488334179 loss_floor_contact: 0.0
[42/100] loss: 0.007853861898183823 loss_joints: 0.0001482884690631181 loss_collision: 0.0 loss_jerk: 0.015411145985126495 loss_floor_contact: 0.0
[43/100] loss: 0.007582489866763353 loss_joints: 0.00027481073630042374 loss_collision: 0.0 loss_jerk: 0.014615357853472233 loss_floor_contact: 0.0
[44/100] loss: 0.00749944057315588 loss_joints: 0.00010283214214723557 loss_collision: 0.0 loss_jerk: 0.014793217182159424 loss_floor_contact: 0.0
[45/100] loss: 0.007392551749944687 loss_joints: 0.0001032391082844697 loss_collision: 0.0 loss_jerk: 0.014578625559806824 loss_floor_contact: 0.0
[46/100] loss: 0.007647762540727854 loss_joints: 0.0002140394353773445 loss_collision: 0.0 loss_jerk: 0.014867446385324001 loss_floor_contact: 0.0
[47/100] loss: 0.007360358722507954 loss_joints: 6.412332004401833e-05 loss_collision: 0.0 loss_jerk: 0.014592470601201057 loss_floor_contact: 0.0
[48/100] loss: 0.0072924415580928326 loss_joints: 0.00012041922309435904 loss_collision: 0.0 loss_jerk: 0.014344044961035252 loss_floor_contact: 0.0
[49/100] loss: 0.00751532195135951 loss_joints: 0.0002517338143661618 loss_collision: 0.0 loss_jerk: 0.01452717650681734 loss_floor_contact: 0.0
[50/100] loss: 0.007463173009455204 loss_joints: 0.00017454939370509237 loss_collision: 0.0 loss_jerk: 0.014577247202396393 loss_floor_contact: 0.0
[51/100] loss: 0.008160210214555264 loss_joints: 0.00011282395280431956 loss_collision: 0.0 loss_jerk: 0.016094772145152092 loss_floor_contact: 0.0
[52/100] loss: 0.00769121153280139 loss_joints: 0.00017432768072467297 loss_collision: 0.0 loss_jerk: 0.015033767558634281 loss_floor_contact: 0.0
[53/100] loss: 0.007240233477205038 loss_joints: 8.793677989160642e-05 loss_collision: 0.0 loss_jerk: 0.014304593205451965 loss_floor_contact: 0.0
[54/100] loss: 0.00718862796202302 loss_joints: 0.00015066783817019314 loss_collision: 0.0 loss_jerk: 0.01407591998577118 loss_floor_contact: 0.0
[55/100] loss: 0.007134377025067806 loss_joints: 0.00012375949881970882 loss_collision: 0.0 loss_jerk: 0.014021234586834908 loss_floor_contact: 0.0
[56/100] loss: 0.0072442009113729 loss_joints: 2.9952122986287577e-06 loss_collision: 0.0 loss_jerk: 0.014482411555945873 loss_floor_contact: 0.0
[57/100] loss: 0.007372433319687843 loss_joints: 0.0001574620109749958 loss_collision: 0.0 loss_jerk: 0.014429942704737186 loss_floor_contact: 0.0
[58/100] loss: 0.007181234657764435 loss_joints: 0.00022215591161511838 loss_collision: 0.0 loss_jerk: 0.013918157666921616 loss_floor_contact: 0.0
[59/100] loss: 0.007253600750118494 loss_joints: 0.00015248644922394305 loss_collision: 0.0 loss_jerk: 0.014202228747308254 loss_floor_contact: 0.0
[60/100] loss: 0.007118538953363895 loss_joints: 0.00014804344391450286 loss_collision: 0.0 loss_jerk: 0.013940990902483463 loss_floor_contact: 0.0
[61/100] loss: 0.0069354441948235035 loss_joints: 0.00010361434397054836 loss_collision: 0.0 loss_jerk: 0.013663659803569317 loss_floor_contact: 0.0
[62/100] loss: 0.006850294768810272 loss_joints: 7.773163815727457e-05 loss_collision: 0.0 loss_jerk: 0.013545126654207706 loss_floor_contact: 0.0
[63/100] loss: 0.007003955077379942 loss_joints: 9.744585258886218e-05 loss_collision: 0.0 loss_jerk: 0.013813018798828125 loss_floor_contact: 0.0
[64/100] loss: 0.007299188524484634 loss_joints: 0.0001767720968928188 loss_collision: 0.0 loss_jerk: 0.014244833029806614 loss_floor_contact: 0.0
[65/100] loss: 0.00728449085727334 loss_joints: 0.00013639491226058453 loss_collision: 0.0 loss_jerk: 0.014296191744506359 loss_floor_contact: 0.0
[66/100] loss: 0.007124765310436487 loss_joints: 1.9974340830231085e-05 loss_collision: 0.0 loss_jerk: 0.014209581539034843 loss_floor_contact: 0.0
[67/100] loss: 0.006914515048265457 loss_joints: 5.9352489188313484e-05 loss_collision: 0.0 loss_jerk: 0.013710325583815575 loss_floor_contact: 0.0
[68/100] loss: 0.006864210125058889 loss_joints: 0.00015352954505942762 loss_collision: 0.0 loss_jerk: 0.013421361334621906 loss_floor_contact: 0.0
[69/100] loss: 0.006769683677703142 loss_joints: 9.551843686494976e-05 loss_collision: 0.0 loss_jerk: 0.013348330743610859 loss_floor_contact: 0.0
[70/100] loss: 0.007030308712273836 loss_joints: 2.2826248823548667e-05 loss_collision: 0.0 loss_jerk: 0.014014964923262596 loss_floor_contact: 0.0
[71/100] loss: 0.00697837769985199 loss_joints: 5.2830153435934335e-05 loss_collision: 0.0 loss_jerk: 0.013851094990968704 loss_floor_contact: 0.0
[72/100] loss: 0.00689377635717392 loss_joints: 6.474347173934802e-05 loss_collision: 0.0 loss_jerk: 0.013658065348863602 loss_floor_contact: 0.0
[73/100] loss: 0.006691502407193184 loss_joints: 5.7067431043833494e-05 loss_collision: 0.0 loss_jerk: 0.013268870301544666 loss_floor_contact: 0.0
[74/100] loss: 0.006647796370089054 loss_joints: 7.627045852132142e-05 loss_collision: 0.0 loss_jerk: 0.013143051415681839 loss_floor_contact: 0.0
[75/100] loss: 0.00658470718190074 loss_joints: 9.353566565550864e-05 loss_collision: 0.0 loss_jerk: 0.012982343323528767 loss_floor_contact: 0.0
[76/100] loss: 0.006502263247966766 loss_joints: 5.319112096913159e-05 loss_collision: 0.0 loss_jerk: 0.01289814431220293 loss_floor_contact: 0.0
[77/100] loss: 0.006516229826956987 loss_joints: 7.256776734720916e-05 loss_collision: 0.0 loss_jerk: 0.012887324206531048 loss_floor_contact: 0.0
[78/100] loss: 0.006665186490863562 loss_joints: 0.00011777080362662673 loss_collision: 0.0 loss_jerk: 0.013094831258058548 loss_floor_contact: 0.0
[79/100] loss: 0.006568775977939367 loss_joints: 0.00011203932808712125 loss_collision: 0.0 loss_jerk: 0.012913472950458527 loss_floor_contact: 0.0
[80/100] loss: 0.006417469121515751 loss_joints: 3.314804780529812e-05 loss_collision: 0.0 loss_jerk: 0.012768642045557499 loss_floor_contact: 0.0
[81/100] loss: 0.0063832830637693405 loss_joints: 1.2625183444470167e-05 loss_collision: 0.0 loss_jerk: 0.012741316109895706 loss_floor_contact: 0.0
[82/100] loss: 0.0063677504658699036 loss_joints: 1.903400698211044e-05 loss_collision: 0.0 loss_jerk: 0.0126974331215024 loss_floor_contact: 0.0
[83/100] loss: 0.00631010252982378 loss_joints: 1.8535318986323546e-06 loss_collision: 0.0 loss_jerk: 0.01261649839580059 loss_floor_contact: 0.0
[84/100] loss: 0.006340718828141689 loss_joints: 3.497760189929977e-05 loss_collision: 0.0 loss_jerk: 0.012611482292413712 loss_floor_contact: 0.0
[85/100] loss: 0.006308776326477528 loss_joints: 7.658385584363714e-05 loss_collision: 0.0 loss_jerk: 0.01246438454836607 loss_floor_contact: 0.0
[86/100] loss: 0.006287865806370974 loss_joints: 6.264261901378632e-05 loss_collision: 0.0 loss_jerk: 0.012450446374714375 loss_floor_contact: 0.0
[87/100] loss: 0.0061745778657495975 loss_joints: 2.4632161512272432e-05 loss_collision: 0.0 loss_jerk: 0.01229989156126976 loss_floor_contact: 0.0
[88/100] loss: 0.0061241574585437775 loss_joints: 4.961231752531603e-06 loss_collision: 0.0 loss_jerk: 0.012238392606377602 loss_floor_contact: 0.0
[89/100] loss: 0.006142050959169865 loss_joints: 1.183931453851983e-05 loss_collision: 0.0 loss_jerk: 0.01226042304188013 loss_floor_contact: 0.0
[90/100] loss: 0.006105330307036638 loss_joints: 1.2549751772894524e-05 loss_collision: 0.0 loss_jerk: 0.01218556147068739 loss_floor_contact: 0.0
[91/100] loss: 0.006041873712092638 loss_joints: 1.0643794666975737e-05 loss_collision: 0.0 loss_jerk: 0.01206246018409729 loss_floor_contact: 0.0
[92/100] loss: 0.0060084364376962185 loss_joints: 6.791757186874747e-06 loss_collision: 0.0 loss_jerk: 0.01200328953564167 loss_floor_contact: 0.0
[93/100] loss: 0.005972801707684994 loss_joints: 3.686915079015307e-06 loss_collision: 0.0 loss_jerk: 0.011938229203224182 loss_floor_contact: 0.0
[94/100] loss: 0.005959059577435255 loss_joints: 2.8229551389813423e-06 loss_collision: 0.0 loss_jerk: 0.011912473477423191 loss_floor_contact: 0.0
[95/100] loss: 0.005948258098214865 loss_joints: 3.6016069770994363e-06 loss_collision: 0.0 loss_jerk: 0.011889313347637653 loss_floor_contact: 0.0
[96/100] loss: 0.00594255980104208 loss_joints: 1.4245614465835388e-06 loss_collision: 0.0 loss_jerk: 0.011882270686328411 loss_floor_contact: 0.0
[97/100] loss: 0.005924232769757509 loss_joints: 2.751819039303882e-08 loss_collision: 0.0 loss_jerk: 0.011848410591483116 loss_floor_contact: 0.0
[98/100] loss: 0.005910804495215416 loss_joints: 3.026662795946322e-07 loss_collision: 0.0 loss_jerk: 0.011821003630757332 loss_floor_contact: 0.0
[99/100] loss: 0.005904023069888353 loss_joints: 1.259861903690762e-07 loss_collision: 0.0 loss_jerk: 0.011807793751358986 loss_floor_contact: 0.0
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.25/contact_thresh_0.75/cabE-path3-run12-4000_collision0.1_contact0.1_jerk0.5_skate1.0]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 426.79079                                                    ║
    ║     rollout = 189.49051                                                    ║
    ║     sdf     = 18.72018                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00590402                                                 ║
    ║     joints    = 0.00000013                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.01180779                                                 ║
    ║     floor     = 0.00000000                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	7m24.573s
user	6m41.443s
sys	0m17.190s
[INFO] Running with collision=0.1, contact=0.1, jerk=1.0, skate=0.1
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:34,  3.99s/it]  2%|▏         | 2/100 [00:07<06:26,  3.95s/it]  3%|▎         | 3/100 [00:12<06:52,  4.26s/it]  4%|▍         | 4/100 [00:16<06:39,  4.16s/it]  5%|▌         | 5/100 [00:20<06:39,  4.20s/it]  6%|▌         | 6/100 [00:24<06:32,  4.17s/it]  7%|▋         | 7/100 [00:29<06:31,  4.21s/it]  8%|▊         | 8/100 [00:33<06:33,  4.28s/it]  9%|▉         | 9/100 [00:37<06:30,  4.30s/it] 10%|█         | 10/100 [00:42<06:21,  4.24s/it] 11%|█         | 11/100 [00:46<06:18,  4.25s/it] 12%|█▏        | 12/100 [00:50<06:11,  4.22s/it] 13%|█▎        | 13/100 [00:54<06:06,  4.21s/it] 14%|█▍        | 14/100 [00:58<05:58,  4.17s/it] 15%|█▌        | 15/100 [01:02<05:49,  4.12s/it] 16%|█▌        | 16/100 [01:06<05:41,  4.07s/it] 17%|█▋        | 17/100 [01:10<05:34,  4.03s/it] 18%|█▊        | 18/100 [01:14<05:37,  4.12s/it] 19%|█▉        | 19/100 [01:19<05:31,  4.09s/it] 20%|██        | 20/100 [01:23<05:36,  4.21s/it] 21%|██        | 21/100 [01:28<05:39,  4.30s/it] 22%|██▏       | 22/100 [01:32<05:39,  4.35s/it] 23%|██▎       | 23/100 [01:36<05:34,  4.35s/it] 24%|██▍       | 24/100 [01:41<05:28,  4.32s/it] 25%|██▌       | 25/100 [01:45<05:29,  4.39s/it] 26%|██▌       | 26/100 [01:50<05:25,  4.40s/it] 27%|██▋       | 27/100 [01:54<05:17,  4.35s/it] 28%|██▊       | 28/100 [01:58<05:11,  4.33s/it] 29%|██▉       | 29/100 [02:02<05:03,  4.28s/it] 30%|███       | 30/100 [02:07<05:08,  4.41s/it] 31%|███       | 31/100 [02:11<05:05,  4.42s/it] 32%|███▏      | 32/100 [02:16<05:01,  4.44s/it] 33%|███▎      | 33/100 [02:20<04:55,  4.42s/it] 34%|███▍      | 34/100 [02:25<04:51,  4.42s/it] 35%|███▌      | 35/100 [02:29<04:42,  4.35s/it] 36%|███▌      | 36/100 [02:33<04:39,  4.37s/it] 37%|███▋      | 37/100 [02:38<04:40,  4.45s/it] 38%|███▊      | 38/100 [02:43<04:39,  4.51s/it] 39%|███▉      | 39/100 [02:48<04:44,  4.66s/it] 40%|████      | 40/100 [02:52<04:44,  4.73s/it] 41%|████      | 41/100 [02:57<04:42,  4.79s/it] 42%|████▏     | 42/100 [03:02<04:36,  4.76s/it] 43%|████▎     | 43/100 [03:07<04:32,  4.78s/it] 44%|████▍     | 44/100 [03:12<04:25,  4.75s/it] 45%|████▌     | 45/100 [03:16<04:17,  4.68s/it] 46%|████▌     | 46/100 [03:21<04:11,  4.65s/it] 47%|████▋     | 47/100 [03:25<04:07,  4.67s/it] 48%|████▊     | 48/100 [03:30<04:02,  4.67s/it] 49%|████▉     | 49/100 [03:35<04:01,  4.75s/it] 50%|█████     | 50/100 [03:40<03:56,  4.73s/it] 51%|█████     | 51/100 [03:44<03:50,  4.70s/it] 52%|█████▏    | 52/100 [03:49<03:44,  4.68s/it] 53%|█████▎    | 53/100 [03:54<03:41,  4.72s/it] 54%|█████▍    | 54/100 [03:58<03:34,  4.66s/it] 55%|█████▌    | 55/100 [04:03<03:27,  4.62s/it] 56%|█████▌    | 56/100 [04:08<03:24,  4.65s/it] 57%|█████▋    | 57/100 [04:12<03:20,  4.66s/it] 58%|█████▊    | 58/100 [04:17<03:16,  4.68s/it] 59%|█████▉    | 59/100 [04:22<03:11,  4.67s/it] 60%|██████    | 60/100 [04:26<03:07,  4.68s/it] 61%|██████    | 61/100 [04:31<03:02,  4.68s/it] 62%|██████▏   | 62/100 [04:36<02:57,  4.66s/it] 63%|██████▎   | 63/100 [04:40<02:51,  4.63s/it] 64%|██████▍   | 64/100 [04:45<02:45,  4.59s/it] 65%|██████▌   | 65/100 [04:49<02:40,  4.59s/it] 66%|██████▌   | 66/100 [04:54<02:35,  4.58s/it] 67%|██████▋   | 67/100 [04:58<02:28,  4.49s/it] 68%|██████▊   | 68/100 [05:03<02:23,  4.48s/it] 69%|██████▉   | 69/100 [05:07<02:17,  4.43s/it] 70%|███████   | 70/100 [05:11<02:09,  4.32s/it] 71%|███████   | 71/100 [05:15<02:06,  4.35s/it] 72%|███████▏  | 72/100 [05:20<02:02,  4.37s/it] 73%|███████▎  | 73/100 [05:24<01:58,  4.38s/it] 74%|███████▍  | 74/100 [05:28<01:53,  4.35s/it] 75%|███████▌  | 75/100 [05:33<01:47,  4.31s/it] 76%|███████▌  | 76/100 [05:37<01:42,  4.27s/it] 77%|███████▋  | 77/100 [05:42<01:41,  4.42s/it] 78%|███████▊  | 78/100 [05:46<01:37,  4.45s/it] 79%|███████▉  | 79/100 [05:51<01:33,  4.46s/it] 80%|████████  | 80/100 [05:55<01:30,  4.54s/it] 81%|████████  | 81/100 [06:00<01:26,  4.57s/it] 82%|████████▏ | 82/100 [06:05<01:25,  4.73s/it] 83%|████████▎ | 83/100 [06:10<01:19,  4.69s/it] 84%|████████▍ | 84/100 [06:14<01:15,  4.69s/it] 85%|████████▌ | 85/100 [06:19<01:09,  4.66s/it] 86%|████████▌ | 86/100 [06:24<01:05,  4.66s/it] 87%|████████▋ | 87/100 [06:28<01:00,  4.66s/it] 88%|████████▊ | 88/100 [06:33<00:55,  4.62s/it] 89%|████████▉ | 89/100 [06:38<00:51,  4.65s/it] 90%|█████████ | 90/100 [06:42<00:46,  4.67s/it] 91%|█████████ | 91/100 [06:47<00:42,  4.69s/it] 92%|█████████▏| 92/100 [06:52<00:37,  4.73s/it] 93%|█████████▎| 93/100 [06:56<00:33,  4.72s/it] 94%|█████████▍| 94/100 [07:01<00:28,  4.71s/it] 95%|█████████▌| 95/100 [07:06<00:23,  4.70s/it] 96%|█████████▌| 96/100 [07:11<00:18,  4.69s/it] 97%|█████████▋| 97/100 [07:15<00:14,  4.72s/it] 98%|█████████▊| 98/100 [07:20<00:09,  4.73s/it] 99%|█████████▉| 99/100 [07:25<00:04,  4.74s/it]100%|██████████| 100/100 [07:30<00:00,  4.84s/it]100%|██████████| 100/100 [07:30<00:00,  4.50s/it]
[0/100] loss: 2.757045269012451 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 0.7648107409477234
[1/100] loss: 1.5058484077453613 loss_joints: 1.318758487701416 loss_collision: 0.0 loss_jerk: 0.11411149799823761 loss_floor_contact: 0.7297835946083069
[2/100] loss: 0.6349831223487854 loss_joints: 0.5192995071411133 loss_collision: 0.0 loss_jerk: 0.08997837454080582 loss_floor_contact: 0.2570522129535675
[3/100] loss: 0.11877574771642685 loss_joints: 0.044477395713329315 loss_collision: 0.0 loss_jerk: 0.07429835200309753 loss_floor_contact: 0.0
[4/100] loss: 0.10885924100875854 loss_joints: 0.04364877566695213 loss_collision: 0.0 loss_jerk: 0.06521046906709671 loss_floor_contact: 0.0
[5/100] loss: 0.0998254120349884 loss_joints: 0.043557457625865936 loss_collision: 0.0006858924753032625 loss_jerk: 0.056199368089437485 loss_floor_contact: 0.0
[6/100] loss: 0.06625264883041382 loss_joints: 0.009010388515889645 loss_collision: 0.0007222398417070508 loss_jerk: 0.05717003718018532 loss_floor_contact: 0.0
[7/100] loss: 0.052301108837127686 loss_joints: 0.002375412732362747 loss_collision: 0.0 loss_jerk: 0.04992569610476494 loss_floor_contact: 0.0
[8/100] loss: 0.047642022371292114 loss_joints: 0.0005462357075884938 loss_collision: 0.0 loss_jerk: 0.04709578678011894 loss_floor_contact: 0.0
[9/100] loss: 0.04361937940120697 loss_joints: 0.00045165253686718643 loss_collision: 0.0 loss_jerk: 0.04316772520542145 loss_floor_contact: 0.0
[10/100] loss: 0.046091292053461075 loss_joints: 0.005473045166581869 loss_collision: 0.0 loss_jerk: 0.04061824828386307 loss_floor_contact: 0.0
[11/100] loss: 0.0417126901447773 loss_joints: 0.0029259505681693554 loss_collision: 0.0 loss_jerk: 0.038786739110946655 loss_floor_contact: 0.0
[12/100] loss: 0.05137019604444504 loss_joints: 0.003012700704857707 loss_collision: 0.0 loss_jerk: 0.04835749417543411 loss_floor_contact: 0.0
[13/100] loss: 0.048818737268447876 loss_joints: 0.002896505407989025 loss_collision: 0.0 loss_jerk: 0.045922230929136276 loss_floor_contact: 0.0
[14/100] loss: 0.03644644841551781 loss_joints: 0.0010114969918504357 loss_collision: 0.0 loss_jerk: 0.03543495014309883 loss_floor_contact: 0.0
[15/100] loss: 0.05739586800336838 loss_joints: 0.017942776903510094 loss_collision: 0.0 loss_jerk: 0.039453089237213135 loss_floor_contact: 0.0
[16/100] loss: 0.059759728610515594 loss_joints: 0.023103250190615654 loss_collision: 0.0 loss_jerk: 0.03665648028254509 loss_floor_contact: 0.0
[17/100] loss: 0.04715609923005104 loss_joints: 0.012629917822778225 loss_collision: 0.0 loss_jerk: 0.03452618047595024 loss_floor_contact: 0.0
[18/100] loss: 0.03759755194187164 loss_joints: 0.00143947615288198 loss_collision: 0.0 loss_jerk: 0.03615807741880417 loss_floor_contact: 0.0
[19/100] loss: 0.03940542787313461 loss_joints: 0.0061369421891868114 loss_collision: 0.0 loss_jerk: 0.033268485218286514 loss_floor_contact: 0.0
[20/100] loss: 0.04372940957546234 loss_joints: 0.010855359956622124 loss_collision: 0.0 loss_jerk: 0.03287404775619507 loss_floor_contact: 0.0
[21/100] loss: 0.03882654756307602 loss_joints: 0.006136057898402214 loss_collision: 0.0 loss_jerk: 0.032690491527318954 loss_floor_contact: 0.0
[22/100] loss: 0.03275662660598755 loss_joints: 0.00021371209004428238 loss_collision: 0.0 loss_jerk: 0.032542914152145386 loss_floor_contact: 0.0
[23/100] loss: 0.03476446494460106 loss_joints: 0.0025614160113036633 loss_collision: 0.0 loss_jerk: 0.03220304846763611 loss_floor_contact: 0.0
[24/100] loss: 0.03630276024341583 loss_joints: 0.004545537289232016 loss_collision: 0.0 loss_jerk: 0.03175722435116768 loss_floor_contact: 0.0
[25/100] loss: 0.03322435915470123 loss_joints: 0.00179130001924932 loss_collision: 0.0 loss_jerk: 0.03143306076526642 loss_floor_contact: 0.0
[26/100] loss: 0.031008396297693253 loss_joints: 0.00016619810776319355 loss_collision: 0.0 loss_jerk: 0.030842198058962822 loss_floor_contact: 0.0
[27/100] loss: 0.03206756338477135 loss_joints: 0.0010921352077275515 loss_collision: 0.0 loss_jerk: 0.030975427478551865 loss_floor_contact: 0.0
[28/100] loss: 0.031746622174978256 loss_joints: 0.0004250277706887573 loss_collision: 0.0 loss_jerk: 0.03132159262895584 loss_floor_contact: 0.0
[29/100] loss: 0.030759338289499283 loss_joints: 0.00032109784660860896 loss_collision: 0.0 loss_jerk: 0.030438240617513657 loss_floor_contact: 0.0
[30/100] loss: 0.030472520738840103 loss_joints: 0.001677348162047565 loss_collision: 0.0 loss_jerk: 0.02879517339169979 loss_floor_contact: 0.0
[31/100] loss: 0.02906934916973114 loss_joints: 0.0012555996654555202 loss_collision: 0.0 loss_jerk: 0.027813749387860298 loss_floor_contact: 0.0
[32/100] loss: 0.028767475858330727 loss_joints: 0.00012373867502901703 loss_collision: 0.0 loss_jerk: 0.028643736615777016 loss_floor_contact: 0.0
[33/100] loss: 0.028430679813027382 loss_joints: 0.00012719057849608362 loss_collision: 0.0 loss_jerk: 0.028303489089012146 loss_floor_contact: 0.0
[34/100] loss: 0.027710922062397003 loss_joints: 1.0579522040643496e-06 loss_collision: 0.0 loss_jerk: 0.02770986407995224 loss_floor_contact: 0.0
[35/100] loss: 0.02713046409189701 loss_joints: 3.075792483286932e-05 loss_collision: 0.0 loss_jerk: 0.02709970623254776 loss_floor_contact: 0.0
[36/100] loss: 0.026711558923125267 loss_joints: 8.531589628546499e-06 loss_collision: 0.0 loss_jerk: 0.02670302800834179 loss_floor_contact: 0.0
[37/100] loss: 0.027481161057949066 loss_joints: 0.00032612215727567673 loss_collision: 0.0 loss_jerk: 0.027155037969350815 loss_floor_contact: 0.0
[38/100] loss: 0.026368699967861176 loss_joints: 0.0006503453478217125 loss_collision: 0.0 loss_jerk: 0.025718355551362038 loss_floor_contact: 0.0
[39/100] loss: 0.026129914447665215 loss_joints: 0.0002261482150061056 loss_collision: 0.0 loss_jerk: 0.025903766974806786 loss_floor_contact: 0.0
[40/100] loss: 0.027291977778077126 loss_joints: 0.0002222231705673039 loss_collision: 0.0 loss_jerk: 0.027069754898548126 loss_floor_contact: 0.0
[41/100] loss: 0.025047043338418007 loss_joints: 0.00023272713588085026 loss_collision: 0.0 loss_jerk: 0.024814317002892494 loss_floor_contact: 0.0
[42/100] loss: 0.02477145381271839 loss_joints: 4.504004755290225e-05 loss_collision: 0.0 loss_jerk: 0.024726413190364838 loss_floor_contact: 0.0
[43/100] loss: 0.02417410910129547 loss_joints: 0.00013482564827427268 loss_collision: 0.0 loss_jerk: 0.024039283394813538 loss_floor_contact: 0.0
[44/100] loss: 0.023639285936951637 loss_joints: 4.2118728742934763e-05 loss_collision: 0.0 loss_jerk: 0.023597167804837227 loss_floor_contact: 0.0
[45/100] loss: 0.024030329659581184 loss_joints: 0.0006763776182197034 loss_collision: 0.0 loss_jerk: 0.023353952914476395 loss_floor_contact: 0.0
[46/100] loss: 0.02336314134299755 loss_joints: 0.0006087529473006725 loss_collision: 0.0 loss_jerk: 0.02275438793003559 loss_floor_contact: 0.0
[47/100] loss: 0.02230958454310894 loss_joints: 4.580062159220688e-05 loss_collision: 0.0 loss_jerk: 0.0222637839615345 loss_floor_contact: 0.0
[48/100] loss: 0.022764744237065315 loss_joints: 0.0005499187391251326 loss_collision: 0.000336378812789917 loss_jerk: 0.022181186825037003 loss_floor_contact: 0.0
[49/100] loss: 0.02265353687107563 loss_joints: 0.0006092090043239295 loss_collision: 0.0003780206898227334 loss_jerk: 0.022006526589393616 loss_floor_contact: 0.0
[50/100] loss: 0.021978149190545082 loss_joints: 0.00010459439363330603 loss_collision: 0.00019344458996783942 loss_jerk: 0.021854210644960403 loss_floor_contact: 0.0
[51/100] loss: 0.02165110409259796 loss_joints: 0.0001495440665166825 loss_collision: 0.0 loss_jerk: 0.021501559764146805 loss_floor_contact: 0.0
[52/100] loss: 0.021549327298998833 loss_joints: 0.0002535028615966439 loss_collision: 0.0 loss_jerk: 0.021295825019478798 loss_floor_contact: 0.0
[53/100] loss: 0.02121705189347267 loss_joints: 4.299639113014564e-05 loss_collision: 8.027599687920883e-05 loss_jerk: 0.021166028454899788 loss_floor_contact: 0.0
[54/100] loss: 0.02069273591041565 loss_joints: 0.00031145947286859155 loss_collision: 0.0 loss_jerk: 0.020381275564432144 loss_floor_contact: 0.0
[55/100] loss: 0.020592045038938522 loss_joints: 0.0005969016929157078 loss_collision: 0.0 loss_jerk: 0.01999514363706112 loss_floor_contact: 0.0
[56/100] loss: 0.020189041271805763 loss_joints: 0.0003048629150725901 loss_collision: 0.0 loss_jerk: 0.019884178414940834 loss_floor_contact: 0.0
[57/100] loss: 0.0198382418602705 loss_joints: 5.299122858559713e-05 loss_collision: 0.0 loss_jerk: 0.01978525146842003 loss_floor_contact: 0.0
[58/100] loss: 0.019634079188108444 loss_joints: 6.690439477097243e-05 loss_collision: 0.0 loss_jerk: 0.019567174836993217 loss_floor_contact: 0.0
[59/100] loss: 0.018990587443113327 loss_joints: 0.00014201679732650518 loss_collision: 0.0 loss_jerk: 0.018848570063710213 loss_floor_contact: 0.0
[60/100] loss: 0.018486369401216507 loss_joints: 7.934030145406723e-05 loss_collision: 0.0 loss_jerk: 0.018407030031085014 loss_floor_contact: 0.0
[61/100] loss: 0.018455281853675842 loss_joints: 0.00013698777183890343 loss_collision: 0.0 loss_jerk: 0.01831829361617565 loss_floor_contact: 0.0
[62/100] loss: 0.018326347693800926 loss_joints: 0.00018299248768016696 loss_collision: 0.0 loss_jerk: 0.01814335584640503 loss_floor_contact: 0.0
[63/100] loss: 0.018328407779335976 loss_joints: 0.00013133480388205498 loss_collision: 0.0 loss_jerk: 0.0181970726698637 loss_floor_contact: 0.0
[64/100] loss: 0.01802426390349865 loss_joints: 4.881560926150996e-06 loss_collision: 0.0 loss_jerk: 0.018019381910562515 loss_floor_contact: 0.0
[65/100] loss: 0.017735226079821587 loss_joints: 0.00014796532923355699 loss_collision: 0.0 loss_jerk: 0.017587261274456978 loss_floor_contact: 0.0
[66/100] loss: 0.018022753298282623 loss_joints: 0.00041227490874007344 loss_collision: 0.0 loss_jerk: 0.01761047914624214 loss_floor_contact: 0.0
[67/100] loss: 0.01782034896314144 loss_joints: 0.0004229842161294073 loss_collision: 0.0 loss_jerk: 0.017397364601492882 loss_floor_contact: 0.0
[68/100] loss: 0.017672812566161156 loss_joints: 0.0001955905754584819 loss_collision: 0.0 loss_jerk: 0.01747722178697586 loss_floor_contact: 0.0
[69/100] loss: 0.01708122156560421 loss_joints: 2.2014686692273244e-05 loss_collision: 0.0 loss_jerk: 0.01705920696258545 loss_floor_contact: 0.0
[70/100] loss: 0.01753285899758339 loss_joints: 0.00012763531412929296 loss_collision: 0.0 loss_jerk: 0.017405223101377487 loss_floor_contact: 0.0
[71/100] loss: 0.017334436997771263 loss_joints: 0.0002831324527505785 loss_collision: 0.0 loss_jerk: 0.017051303759217262 loss_floor_contact: 0.0
[72/100] loss: 0.016777431592345238 loss_joints: 0.0002957631950266659 loss_collision: 0.0 loss_jerk: 0.016481667757034302 loss_floor_contact: 0.0
[73/100] loss: 0.016779979690909386 loss_joints: 0.0001347219804301858 loss_collision: 0.0 loss_jerk: 0.01664525829255581 loss_floor_contact: 0.0
[74/100] loss: 0.016474448144435883 loss_joints: 8.808069833321497e-05 loss_collision: 0.0 loss_jerk: 0.01638636738061905 loss_floor_contact: 0.0
[75/100] loss: 0.016484811902046204 loss_joints: 0.00013157265493646264 loss_collision: 0.0 loss_jerk: 0.016353238373994827 loss_floor_contact: 0.0
[76/100] loss: 0.016509827226400375 loss_joints: 0.00012469812645576894 loss_collision: 0.0 loss_jerk: 0.01638512872159481 loss_floor_contact: 0.0
[77/100] loss: 0.016610037535429 loss_joints: 0.0001245087041752413 loss_collision: 0.0 loss_jerk: 0.016485529020428658 loss_floor_contact: 0.0
[78/100] loss: 0.01647459901869297 loss_joints: 6.70410881866701e-05 loss_collision: 0.0 loss_jerk: 0.01640755869448185 loss_floor_contact: 0.0
[79/100] loss: 0.01611020416021347 loss_joints: 3.6173491935187485e-07 loss_collision: 0.0 loss_jerk: 0.01610984280705452 loss_floor_contact: 0.0
[80/100] loss: 0.015982916578650475 loss_joints: 6.492739339591935e-05 loss_collision: 0.0 loss_jerk: 0.015917988494038582 loss_floor_contact: 0.0
[81/100] loss: 0.015897387638688087 loss_joints: 0.00014840315270703286 loss_collision: 0.0 loss_jerk: 0.01574898511171341 loss_floor_contact: 0.0
[82/100] loss: 0.01586952432990074 loss_joints: 0.00013440128532238305 loss_collision: 0.0 loss_jerk: 0.015735123306512833 loss_floor_contact: 0.0
[83/100] loss: 0.015777258202433586 loss_joints: 4.243078001309186e-05 loss_collision: 0.0 loss_jerk: 0.015734827145934105 loss_floor_contact: 0.0
[84/100] loss: 0.01587856188416481 loss_joints: 1.3489108823705465e-05 loss_collision: 0.0 loss_jerk: 0.01586507260799408 loss_floor_contact: 0.0
[85/100] loss: 0.016023557633161545 loss_joints: 7.108313639037078e-06 loss_collision: 0.0 loss_jerk: 0.01601644977927208 loss_floor_contact: 0.0
[86/100] loss: 0.015761055052280426 loss_joints: 1.762266765581444e-05 loss_collision: 0.0 loss_jerk: 0.015743432566523552 loss_floor_contact: 0.0
[87/100] loss: 0.015619292855262756 loss_joints: 4.0276900108437985e-05 loss_collision: 0.0 loss_jerk: 0.01557901594787836 loss_floor_contact: 0.0
[88/100] loss: 0.01556388195604086 loss_joints: 5.808704736409709e-05 loss_collision: 0.0 loss_jerk: 0.015505795367062092 loss_floor_contact: 0.0
[89/100] loss: 0.015463931486010551 loss_joints: 6.111409311415628e-05 loss_collision: 0.0 loss_jerk: 0.01540281716734171 loss_floor_contact: 0.0
[90/100] loss: 0.015303966589272022 loss_joints: 4.8352601879741997e-05 loss_collision: 0.0 loss_jerk: 0.015255614183843136 loss_floor_contact: 0.0
[91/100] loss: 0.015203065238893032 loss_joints: 1.0787173778226133e-05 loss_collision: 0.0 loss_jerk: 0.015192277729511261 loss_floor_contact: 0.0
[92/100] loss: 0.015256260521709919 loss_joints: 7.727265256107785e-06 loss_collision: 0.0 loss_jerk: 0.015248533338308334 loss_floor_contact: 0.0
[93/100] loss: 0.015199663117527962 loss_joints: 2.8816712074331008e-05 loss_collision: 0.0 loss_jerk: 0.01517084613442421 loss_floor_contact: 0.0
[94/100] loss: 0.015108148567378521 loss_joints: 3.23640342685394e-05 loss_collision: 0.0 loss_jerk: 0.015075784176588058 loss_floor_contact: 0.0
[95/100] loss: 0.015005364082753658 loss_joints: 2.459236202412285e-05 loss_collision: 0.0 loss_jerk: 0.014980771578848362 loss_floor_contact: 0.0
[96/100] loss: 0.014971118420362473 loss_joints: 1.3823251720168628e-05 loss_collision: 0.0 loss_jerk: 0.014957294799387455 loss_floor_contact: 0.0
[97/100] loss: 0.015092860907316208 loss_joints: 8.232535947172437e-06 loss_collision: 0.0 loss_jerk: 0.015084628015756607 loss_floor_contact: 0.0
[98/100] loss: 0.015045390464365482 loss_joints: 7.018290489213541e-06 loss_collision: 0.0 loss_jerk: 0.01503837201744318 loss_floor_contact: 0.0
[99/100] loss: 0.01492821704596281 loss_joints: 6.849058991065249e-06 loss_collision: 0.0 loss_jerk: 0.014921368099749088 loss_floor_contact: 0.0
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.25/contact_thresh_0.75/cabE-path3-run12-4000_collision0.1_contact0.1_jerk1.0_skate0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 450.45549                                                    ║
    ║     rollout = 204.38561                                                    ║
    ║     sdf     = 22.10692                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.01492822                                                 ║
    ║     joints    = 0.00000685                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.01492137                                                 ║
    ║     floor     = 0.00000000                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	7m48.616s
user	6m48.441s
sys	0m19.457s
[INFO] Running with collision=0.1, contact=0.1, jerk=1.0, skate=0.5
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<07:44,  4.70s/it]  2%|▏         | 2/100 [00:09<07:30,  4.60s/it]  3%|▎         | 3/100 [00:14<08:01,  4.96s/it]  4%|▍         | 4/100 [00:19<07:41,  4.81s/it]  5%|▌         | 5/100 [00:23<07:32,  4.76s/it]  6%|▌         | 6/100 [00:28<07:25,  4.74s/it]  7%|▋         | 7/100 [00:33<07:16,  4.70s/it]  8%|▊         | 8/100 [00:37<07:15,  4.73s/it]  9%|▉         | 9/100 [00:42<07:09,  4.72s/it] 10%|█         | 10/100 [00:47<07:02,  4.69s/it] 11%|█         | 11/100 [00:52<06:59,  4.72s/it] 12%|█▏        | 12/100 [00:56<06:53,  4.70s/it] 13%|█▎        | 13/100 [01:01<06:53,  4.76s/it] 14%|█▍        | 14/100 [01:06<06:53,  4.81s/it] 15%|█▌        | 15/100 [01:11<06:43,  4.75s/it] 16%|█▌        | 16/100 [01:16<06:41,  4.78s/it] 17%|█▋        | 17/100 [01:20<06:31,  4.71s/it] 18%|█▊        | 18/100 [01:25<06:28,  4.73s/it] 19%|█▉        | 19/100 [01:29<06:18,  4.68s/it] 20%|██        | 20/100 [01:34<06:10,  4.63s/it] 21%|██        | 21/100 [01:38<06:02,  4.58s/it] 22%|██▏       | 22/100 [01:43<05:52,  4.52s/it] 23%|██▎       | 23/100 [01:47<05:46,  4.50s/it] 24%|██▍       | 24/100 [01:52<05:39,  4.46s/it] 25%|██▌       | 25/100 [01:56<05:33,  4.45s/it] 26%|██▌       | 26/100 [02:01<05:30,  4.46s/it] 27%|██▋       | 27/100 [02:05<05:23,  4.43s/it] 28%|██▊       | 28/100 [02:09<05:20,  4.45s/it] 29%|██▉       | 29/100 [02:14<05:16,  4.45s/it] 30%|███       | 30/100 [02:18<05:11,  4.45s/it] 31%|███       | 31/100 [02:23<05:12,  4.52s/it] 32%|███▏      | 32/100 [02:28<05:08,  4.54s/it] 33%|███▎      | 33/100 [02:32<04:58,  4.46s/it] 34%|███▍      | 34/100 [02:36<04:54,  4.46s/it] 35%|███▌      | 35/100 [02:41<04:48,  4.43s/it] 36%|███▌      | 36/100 [02:45<04:40,  4.38s/it] 37%|███▋      | 37/100 [02:49<04:32,  4.32s/it] 38%|███▊      | 38/100 [02:53<04:27,  4.32s/it] 39%|███▉      | 39/100 [02:58<04:25,  4.35s/it] 40%|████      | 40/100 [03:02<04:24,  4.41s/it] 41%|████      | 41/100 [03:07<04:18,  4.38s/it] 42%|████▏     | 42/100 [03:11<04:13,  4.38s/it] 43%|████▎     | 43/100 [03:15<04:08,  4.35s/it] 44%|████▍     | 44/100 [03:20<04:03,  4.36s/it] 45%|████▌     | 45/100 [03:24<03:58,  4.34s/it] 46%|████▌     | 46/100 [03:28<03:51,  4.29s/it] 47%|████▋     | 47/100 [03:33<03:52,  4.39s/it] 48%|████▊     | 48/100 [03:37<03:46,  4.36s/it] 49%|████▉     | 49/100 [03:41<03:40,  4.32s/it] 50%|█████     | 50/100 [03:46<03:39,  4.38s/it] 51%|█████     | 51/100 [03:50<03:34,  4.39s/it] 52%|█████▏    | 52/100 [03:54<03:27,  4.33s/it] 53%|█████▎    | 53/100 [03:59<03:25,  4.37s/it] 54%|█████▍    | 54/100 [04:03<03:21,  4.37s/it] 55%|█████▌    | 55/100 [04:08<03:17,  4.39s/it] 56%|█████▌    | 56/100 [04:12<03:13,  4.41s/it] 57%|█████▋    | 57/100 [04:16<03:08,  4.38s/it] 58%|█████▊    | 58/100 [04:21<03:04,  4.39s/it] 59%|█████▉    | 59/100 [04:25<02:59,  4.37s/it] 60%|██████    | 60/100 [04:30<02:59,  4.48s/it] 61%|██████    | 61/100 [04:35<02:55,  4.51s/it] 62%|██████▏   | 62/100 [04:39<02:53,  4.56s/it] 63%|██████▎   | 63/100 [04:44<02:48,  4.54s/it] 64%|██████▍   | 64/100 [04:48<02:42,  4.53s/it] 65%|██████▌   | 65/100 [04:53<02:39,  4.55s/it] 66%|██████▌   | 66/100 [04:58<02:36,  4.60s/it] 67%|██████▋   | 67/100 [05:02<02:32,  4.62s/it] 68%|██████▊   | 68/100 [05:07<02:30,  4.69s/it] 69%|██████▉   | 69/100 [05:12<02:24,  4.65s/it] 70%|███████   | 70/100 [05:16<02:17,  4.58s/it] 71%|███████   | 71/100 [05:20<02:11,  4.54s/it] 72%|███████▏  | 72/100 [05:25<02:07,  4.57s/it] 73%|███████▎  | 73/100 [05:30<02:03,  4.56s/it] 74%|███████▍  | 74/100 [05:34<02:00,  4.64s/it] 75%|███████▌  | 75/100 [05:39<01:56,  4.66s/it] 76%|███████▌  | 76/100 [05:44<01:50,  4.60s/it] 77%|███████▋  | 77/100 [05:48<01:45,  4.59s/it] 78%|███████▊  | 78/100 [05:53<01:41,  4.59s/it] 79%|███████▉  | 79/100 [05:57<01:36,  4.61s/it] 80%|████████  | 80/100 [06:02<01:32,  4.60s/it] 81%|████████  | 81/100 [06:07<01:28,  4.68s/it] 82%|████████▏ | 82/100 [06:11<01:23,  4.62s/it] 83%|████████▎ | 83/100 [06:16<01:18,  4.61s/it] 84%|████████▍ | 84/100 [06:20<01:13,  4.57s/it] 85%|████████▌ | 85/100 [06:25<01:08,  4.59s/it] 86%|████████▌ | 86/100 [06:30<01:04,  4.61s/it] 87%|████████▋ | 87/100 [06:34<00:59,  4.57s/it] 88%|████████▊ | 88/100 [06:39<00:54,  4.56s/it] 89%|████████▉ | 89/100 [06:43<00:50,  4.60s/it] 90%|█████████ | 90/100 [06:48<00:45,  4.59s/it] 91%|█████████ | 91/100 [06:53<00:41,  4.60s/it] 92%|█████████▏| 92/100 [06:57<00:36,  4.57s/it] 93%|█████████▎| 93/100 [07:02<00:32,  4.63s/it] 94%|█████████▍| 94/100 [07:06<00:27,  4.60s/it] 95%|█████████▌| 95/100 [07:11<00:23,  4.63s/it] 96%|█████████▌| 96/100 [07:16<00:18,  4.59s/it] 97%|█████████▋| 97/100 [07:20<00:13,  4.54s/it] 98%|█████████▊| 98/100 [07:24<00:09,  4.50s/it] 99%|█████████▉| 99/100 [07:29<00:04,  4.52s/it]100%|██████████| 100/100 [07:33<00:00,  4.47s/it]100%|██████████| 100/100 [07:33<00:00,  4.54s/it]
[0/100] loss: 2.757045269012451 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 0.7648107409477234
[1/100] loss: 1.5058484077453613 loss_joints: 1.318758487701416 loss_collision: 0.0 loss_jerk: 0.11411149799823761 loss_floor_contact: 0.7297835946083069
[2/100] loss: 0.6349831223487854 loss_joints: 0.5192995071411133 loss_collision: 0.0 loss_jerk: 0.08997837454080582 loss_floor_contact: 0.2570522129535675
[3/100] loss: 0.11877574771642685 loss_joints: 0.044477395713329315 loss_collision: 0.0 loss_jerk: 0.07429835200309753 loss_floor_contact: 0.0
[4/100] loss: 0.10885924100875854 loss_joints: 0.04364877566695213 loss_collision: 0.0 loss_jerk: 0.06521046906709671 loss_floor_contact: 0.0
[5/100] loss: 0.0998254120349884 loss_joints: 0.043557457625865936 loss_collision: 0.0006858924753032625 loss_jerk: 0.056199368089437485 loss_floor_contact: 0.0
[6/100] loss: 0.06625264883041382 loss_joints: 0.009010388515889645 loss_collision: 0.0007222398417070508 loss_jerk: 0.05717003718018532 loss_floor_contact: 0.0
[7/100] loss: 0.052301108837127686 loss_joints: 0.002375412732362747 loss_collision: 0.0 loss_jerk: 0.04992569610476494 loss_floor_contact: 0.0
[8/100] loss: 0.047642022371292114 loss_joints: 0.0005462357075884938 loss_collision: 0.0 loss_jerk: 0.04709578678011894 loss_floor_contact: 0.0
[9/100] loss: 0.04361937940120697 loss_joints: 0.00045165253686718643 loss_collision: 0.0 loss_jerk: 0.04316772520542145 loss_floor_contact: 0.0
[10/100] loss: 0.046091292053461075 loss_joints: 0.005473045166581869 loss_collision: 0.0 loss_jerk: 0.04061824828386307 loss_floor_contact: 0.0
[11/100] loss: 0.0417126901447773 loss_joints: 0.0029259505681693554 loss_collision: 0.0 loss_jerk: 0.038786739110946655 loss_floor_contact: 0.0
[12/100] loss: 0.05137019604444504 loss_joints: 0.003012700704857707 loss_collision: 0.0 loss_jerk: 0.04835749417543411 loss_floor_contact: 0.0
[13/100] loss: 0.048818737268447876 loss_joints: 0.002896505407989025 loss_collision: 0.0 loss_jerk: 0.045922230929136276 loss_floor_contact: 0.0
[14/100] loss: 0.03644644841551781 loss_joints: 0.0010114969918504357 loss_collision: 0.0 loss_jerk: 0.03543495014309883 loss_floor_contact: 0.0
[15/100] loss: 0.05739586800336838 loss_joints: 0.017942776903510094 loss_collision: 0.0 loss_jerk: 0.039453089237213135 loss_floor_contact: 0.0
[16/100] loss: 0.059759728610515594 loss_joints: 0.023103250190615654 loss_collision: 0.0 loss_jerk: 0.03665648028254509 loss_floor_contact: 0.0
[17/100] loss: 0.04715609923005104 loss_joints: 0.012629917822778225 loss_collision: 0.0 loss_jerk: 0.03452618047595024 loss_floor_contact: 0.0
[18/100] loss: 0.03759755194187164 loss_joints: 0.00143947615288198 loss_collision: 0.0 loss_jerk: 0.03615807741880417 loss_floor_contact: 0.0
[19/100] loss: 0.03940542787313461 loss_joints: 0.0061369421891868114 loss_collision: 0.0 loss_jerk: 0.033268485218286514 loss_floor_contact: 0.0
[20/100] loss: 0.04372940957546234 loss_joints: 0.010855359956622124 loss_collision: 0.0 loss_jerk: 0.03287404775619507 loss_floor_contact: 0.0
[21/100] loss: 0.03882654756307602 loss_joints: 0.006136057898402214 loss_collision: 0.0 loss_jerk: 0.032690491527318954 loss_floor_contact: 0.0
[22/100] loss: 0.03275662660598755 loss_joints: 0.00021371209004428238 loss_collision: 0.0 loss_jerk: 0.032542914152145386 loss_floor_contact: 0.0
[23/100] loss: 0.03476446494460106 loss_joints: 0.0025614160113036633 loss_collision: 0.0 loss_jerk: 0.03220304846763611 loss_floor_contact: 0.0
[24/100] loss: 0.03630276024341583 loss_joints: 0.004545537289232016 loss_collision: 0.0 loss_jerk: 0.03175722435116768 loss_floor_contact: 0.0
[25/100] loss: 0.03322435915470123 loss_joints: 0.00179130001924932 loss_collision: 0.0 loss_jerk: 0.03143306076526642 loss_floor_contact: 0.0
[26/100] loss: 0.031008396297693253 loss_joints: 0.00016619810776319355 loss_collision: 0.0 loss_jerk: 0.030842198058962822 loss_floor_contact: 0.0
[27/100] loss: 0.03206756338477135 loss_joints: 0.0010921352077275515 loss_collision: 0.0 loss_jerk: 0.030975427478551865 loss_floor_contact: 0.0
[28/100] loss: 0.031746622174978256 loss_joints: 0.0004250277706887573 loss_collision: 0.0 loss_jerk: 0.03132159262895584 loss_floor_contact: 0.0
[29/100] loss: 0.030759338289499283 loss_joints: 0.00032109784660860896 loss_collision: 0.0 loss_jerk: 0.030438240617513657 loss_floor_contact: 0.0
[30/100] loss: 0.030472520738840103 loss_joints: 0.001677348162047565 loss_collision: 0.0 loss_jerk: 0.02879517339169979 loss_floor_contact: 0.0
[31/100] loss: 0.02906934916973114 loss_joints: 0.0012555996654555202 loss_collision: 0.0 loss_jerk: 0.027813749387860298 loss_floor_contact: 0.0
[32/100] loss: 0.028767475858330727 loss_joints: 0.00012373867502901703 loss_collision: 0.0 loss_jerk: 0.028643736615777016 loss_floor_contact: 0.0
[33/100] loss: 0.028430679813027382 loss_joints: 0.00012719057849608362 loss_collision: 0.0 loss_jerk: 0.028303489089012146 loss_floor_contact: 0.0
[34/100] loss: 0.027710922062397003 loss_joints: 1.0579522040643496e-06 loss_collision: 0.0 loss_jerk: 0.02770986407995224 loss_floor_contact: 0.0
[35/100] loss: 0.02713046409189701 loss_joints: 3.075792483286932e-05 loss_collision: 0.0 loss_jerk: 0.02709970623254776 loss_floor_contact: 0.0
[36/100] loss: 0.026711558923125267 loss_joints: 8.531589628546499e-06 loss_collision: 0.0 loss_jerk: 0.02670302800834179 loss_floor_contact: 0.0
[37/100] loss: 0.027481161057949066 loss_joints: 0.00032612215727567673 loss_collision: 0.0 loss_jerk: 0.027155037969350815 loss_floor_contact: 0.0
[38/100] loss: 0.026368699967861176 loss_joints: 0.0006503453478217125 loss_collision: 0.0 loss_jerk: 0.025718355551362038 loss_floor_contact: 0.0
[39/100] loss: 0.026129914447665215 loss_joints: 0.0002261482150061056 loss_collision: 0.0 loss_jerk: 0.025903766974806786 loss_floor_contact: 0.0
[40/100] loss: 0.027291977778077126 loss_joints: 0.0002222231705673039 loss_collision: 0.0 loss_jerk: 0.027069754898548126 loss_floor_contact: 0.0
[41/100] loss: 0.025047043338418007 loss_joints: 0.00023272713588085026 loss_collision: 0.0 loss_jerk: 0.024814317002892494 loss_floor_contact: 0.0
[42/100] loss: 0.02477145381271839 loss_joints: 4.504004755290225e-05 loss_collision: 0.0 loss_jerk: 0.024726413190364838 loss_floor_contact: 0.0
[43/100] loss: 0.02417410910129547 loss_joints: 0.00013482564827427268 loss_collision: 0.0 loss_jerk: 0.024039283394813538 loss_floor_contact: 0.0
[44/100] loss: 0.023639285936951637 loss_joints: 4.2118728742934763e-05 loss_collision: 0.0 loss_jerk: 0.023597167804837227 loss_floor_contact: 0.0
[45/100] loss: 0.024030329659581184 loss_joints: 0.0006763776182197034 loss_collision: 0.0 loss_jerk: 0.023353952914476395 loss_floor_contact: 0.0
[46/100] loss: 0.02336314134299755 loss_joints: 0.0006087529473006725 loss_collision: 0.0 loss_jerk: 0.02275438793003559 loss_floor_contact: 0.0
[47/100] loss: 0.02230958454310894 loss_joints: 4.580062159220688e-05 loss_collision: 0.0 loss_jerk: 0.0222637839615345 loss_floor_contact: 0.0
[48/100] loss: 0.022764744237065315 loss_joints: 0.0005499187391251326 loss_collision: 0.000336378812789917 loss_jerk: 0.022181186825037003 loss_floor_contact: 0.0
[49/100] loss: 0.02265353687107563 loss_joints: 0.0006092090043239295 loss_collision: 0.0003780206898227334 loss_jerk: 0.022006526589393616 loss_floor_contact: 0.0
[50/100] loss: 0.021978149190545082 loss_joints: 0.00010459439363330603 loss_collision: 0.00019344458996783942 loss_jerk: 0.021854210644960403 loss_floor_contact: 0.0
[51/100] loss: 0.02165110409259796 loss_joints: 0.0001495440665166825 loss_collision: 0.0 loss_jerk: 0.021501559764146805 loss_floor_contact: 0.0
[52/100] loss: 0.021549327298998833 loss_joints: 0.0002535028615966439 loss_collision: 0.0 loss_jerk: 0.021295825019478798 loss_floor_contact: 0.0
[53/100] loss: 0.02121705189347267 loss_joints: 4.299639113014564e-05 loss_collision: 8.027599687920883e-05 loss_jerk: 0.021166028454899788 loss_floor_contact: 0.0
[54/100] loss: 0.02069273591041565 loss_joints: 0.00031145947286859155 loss_collision: 0.0 loss_jerk: 0.020381275564432144 loss_floor_contact: 0.0
[55/100] loss: 0.020592045038938522 loss_joints: 0.0005969016929157078 loss_collision: 0.0 loss_jerk: 0.01999514363706112 loss_floor_contact: 0.0
[56/100] loss: 0.020189041271805763 loss_joints: 0.0003048629150725901 loss_collision: 0.0 loss_jerk: 0.019884178414940834 loss_floor_contact: 0.0
[57/100] loss: 0.0198382418602705 loss_joints: 5.299122858559713e-05 loss_collision: 0.0 loss_jerk: 0.01978525146842003 loss_floor_contact: 0.0
[58/100] loss: 0.019634079188108444 loss_joints: 6.690439477097243e-05 loss_collision: 0.0 loss_jerk: 0.019567174836993217 loss_floor_contact: 0.0
[59/100] loss: 0.018990587443113327 loss_joints: 0.00014201679732650518 loss_collision: 0.0 loss_jerk: 0.018848570063710213 loss_floor_contact: 0.0
[60/100] loss: 0.018486369401216507 loss_joints: 7.934030145406723e-05 loss_collision: 0.0 loss_jerk: 0.018407030031085014 loss_floor_contact: 0.0
[61/100] loss: 0.018455281853675842 loss_joints: 0.00013698777183890343 loss_collision: 0.0 loss_jerk: 0.01831829361617565 loss_floor_contact: 0.0
[62/100] loss: 0.018326347693800926 loss_joints: 0.00018299248768016696 loss_collision: 0.0 loss_jerk: 0.01814335584640503 loss_floor_contact: 0.0
[63/100] loss: 0.018328407779335976 loss_joints: 0.00013133480388205498 loss_collision: 0.0 loss_jerk: 0.0181970726698637 loss_floor_contact: 0.0
[64/100] loss: 0.01802426390349865 loss_joints: 4.881560926150996e-06 loss_collision: 0.0 loss_jerk: 0.018019381910562515 loss_floor_contact: 0.0
[65/100] loss: 0.017735226079821587 loss_joints: 0.00014796532923355699 loss_collision: 0.0 loss_jerk: 0.017587261274456978 loss_floor_contact: 0.0
[66/100] loss: 0.018022753298282623 loss_joints: 0.00041227490874007344 loss_collision: 0.0 loss_jerk: 0.01761047914624214 loss_floor_contact: 0.0
[67/100] loss: 0.01782034896314144 loss_joints: 0.0004229842161294073 loss_collision: 0.0 loss_jerk: 0.017397364601492882 loss_floor_contact: 0.0
[68/100] loss: 0.017672812566161156 loss_joints: 0.0001955905754584819 loss_collision: 0.0 loss_jerk: 0.01747722178697586 loss_floor_contact: 0.0
[69/100] loss: 0.01708122156560421 loss_joints: 2.2014686692273244e-05 loss_collision: 0.0 loss_jerk: 0.01705920696258545 loss_floor_contact: 0.0
[70/100] loss: 0.01753285899758339 loss_joints: 0.00012763531412929296 loss_collision: 0.0 loss_jerk: 0.017405223101377487 loss_floor_contact: 0.0
[71/100] loss: 0.017334436997771263 loss_joints: 0.0002831324527505785 loss_collision: 0.0 loss_jerk: 0.017051303759217262 loss_floor_contact: 0.0
[72/100] loss: 0.016777431592345238 loss_joints: 0.0002957631950266659 loss_collision: 0.0 loss_jerk: 0.016481667757034302 loss_floor_contact: 0.0
[73/100] loss: 0.016779979690909386 loss_joints: 0.0001347219804301858 loss_collision: 0.0 loss_jerk: 0.01664525829255581 loss_floor_contact: 0.0
[74/100] loss: 0.016474448144435883 loss_joints: 8.808069833321497e-05 loss_collision: 0.0 loss_jerk: 0.01638636738061905 loss_floor_contact: 0.0
[75/100] loss: 0.016484811902046204 loss_joints: 0.00013157265493646264 loss_collision: 0.0 loss_jerk: 0.016353238373994827 loss_floor_contact: 0.0
[76/100] loss: 0.016509827226400375 loss_joints: 0.00012469812645576894 loss_collision: 0.0 loss_jerk: 0.01638512872159481 loss_floor_contact: 0.0
[77/100] loss: 0.016610037535429 loss_joints: 0.0001245087041752413 loss_collision: 0.0 loss_jerk: 0.016485529020428658 loss_floor_contact: 0.0
[78/100] loss: 0.01647459901869297 loss_joints: 6.70410881866701e-05 loss_collision: 0.0 loss_jerk: 0.01640755869448185 loss_floor_contact: 0.0
[79/100] loss: 0.01611020416021347 loss_joints: 3.6173491935187485e-07 loss_collision: 0.0 loss_jerk: 0.01610984280705452 loss_floor_contact: 0.0
[80/100] loss: 0.015982916578650475 loss_joints: 6.492739339591935e-05 loss_collision: 0.0 loss_jerk: 0.015917988494038582 loss_floor_contact: 0.0
[81/100] loss: 0.015897387638688087 loss_joints: 0.00014840315270703286 loss_collision: 0.0 loss_jerk: 0.01574898511171341 loss_floor_contact: 0.0
[82/100] loss: 0.01586952432990074 loss_joints: 0.00013440128532238305 loss_collision: 0.0 loss_jerk: 0.015735123306512833 loss_floor_contact: 0.0
[83/100] loss: 0.015777258202433586 loss_joints: 4.243078001309186e-05 loss_collision: 0.0 loss_jerk: 0.015734827145934105 loss_floor_contact: 0.0
[84/100] loss: 0.01587856188416481 loss_joints: 1.3489108823705465e-05 loss_collision: 0.0 loss_jerk: 0.01586507260799408 loss_floor_contact: 0.0
[85/100] loss: 0.016023557633161545 loss_joints: 7.108313639037078e-06 loss_collision: 0.0 loss_jerk: 0.01601644977927208 loss_floor_contact: 0.0
[86/100] loss: 0.015761055052280426 loss_joints: 1.762266765581444e-05 loss_collision: 0.0 loss_jerk: 0.015743432566523552 loss_floor_contact: 0.0
[87/100] loss: 0.015619292855262756 loss_joints: 4.0276900108437985e-05 loss_collision: 0.0 loss_jerk: 0.01557901594787836 loss_floor_contact: 0.0
[88/100] loss: 0.01556388195604086 loss_joints: 5.808704736409709e-05 loss_collision: 0.0 loss_jerk: 0.015505795367062092 loss_floor_contact: 0.0
[89/100] loss: 0.015463931486010551 loss_joints: 6.111409311415628e-05 loss_collision: 0.0 loss_jerk: 0.01540281716734171 loss_floor_contact: 0.0
[90/100] loss: 0.015303966589272022 loss_joints: 4.8352601879741997e-05 loss_collision: 0.0 loss_jerk: 0.015255614183843136 loss_floor_contact: 0.0
[91/100] loss: 0.015203065238893032 loss_joints: 1.0787173778226133e-05 loss_collision: 0.0 loss_jerk: 0.015192277729511261 loss_floor_contact: 0.0
[92/100] loss: 0.015256260521709919 loss_joints: 7.727265256107785e-06 loss_collision: 0.0 loss_jerk: 0.015248533338308334 loss_floor_contact: 0.0
[93/100] loss: 0.015199663117527962 loss_joints: 2.8816712074331008e-05 loss_collision: 0.0 loss_jerk: 0.01517084613442421 loss_floor_contact: 0.0
[94/100] loss: 0.015108148567378521 loss_joints: 3.23640342685394e-05 loss_collision: 0.0 loss_jerk: 0.015075784176588058 loss_floor_contact: 0.0
[95/100] loss: 0.015005364082753658 loss_joints: 2.459236202412285e-05 loss_collision: 0.0 loss_jerk: 0.014980771578848362 loss_floor_contact: 0.0
[96/100] loss: 0.014971118420362473 loss_joints: 1.3823251720168628e-05 loss_collision: 0.0 loss_jerk: 0.014957294799387455 loss_floor_contact: 0.0
[97/100] loss: 0.015092860907316208 loss_joints: 8.232535947172437e-06 loss_collision: 0.0 loss_jerk: 0.015084628015756607 loss_floor_contact: 0.0
[98/100] loss: 0.015045390464365482 loss_joints: 7.018290489213541e-06 loss_collision: 0.0 loss_jerk: 0.01503837201744318 loss_floor_contact: 0.0
[99/100] loss: 0.01492821704596281 loss_joints: 6.849058991065249e-06 loss_collision: 0.0 loss_jerk: 0.014921368099749088 loss_floor_contact: 0.0
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.25/contact_thresh_0.75/cabE-path3-run12-4000_collision0.1_contact0.1_jerk1.0_skate0.5]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 453.89399                                                    ║
    ║     rollout = 208.03583                                                    ║
    ║     sdf     = 20.10369                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.01492822                                                 ║
    ║     joints    = 0.00000685                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.01492137                                                 ║
    ║     floor     = 0.00000000                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	8m2.862s
user	7m1.636s
sys	0m18.905s
[INFO] Running with collision=0.1, contact=0.1, jerk=1.0, skate=1.0
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<07:16,  4.41s/it]  2%|▏         | 2/100 [00:08<06:49,  4.18s/it]  3%|▎         | 3/100 [00:13<07:04,  4.37s/it]  4%|▍         | 4/100 [00:17<06:49,  4.26s/it]  5%|▌         | 5/100 [00:21<06:46,  4.28s/it]  6%|▌         | 6/100 [00:25<06:37,  4.23s/it]  7%|▋         | 7/100 [00:29<06:28,  4.18s/it]  8%|▊         | 8/100 [00:33<06:20,  4.14s/it]  9%|▉         | 9/100 [00:37<06:12,  4.09s/it] 10%|█         | 10/100 [00:41<06:07,  4.09s/it] 11%|█         | 11/100 [00:46<06:08,  4.14s/it] 12%|█▏        | 12/100 [00:50<06:04,  4.14s/it] 13%|█▎        | 13/100 [00:55<06:21,  4.38s/it] 14%|█▍        | 14/100 [00:59<06:18,  4.40s/it] 15%|█▌        | 15/100 [01:04<06:18,  4.45s/it] 16%|█▌        | 16/100 [01:08<06:17,  4.49s/it] 17%|█▋        | 17/100 [01:13<06:12,  4.49s/it] 18%|█▊        | 18/100 [01:17<06:11,  4.53s/it] 19%|█▉        | 19/100 [01:22<06:07,  4.53s/it] 20%|██        | 20/100 [01:26<05:56,  4.46s/it] 21%|██        | 21/100 [01:30<05:45,  4.37s/it] 22%|██▏       | 22/100 [01:35<05:53,  4.53s/it] 23%|██▎       | 23/100 [01:40<05:50,  4.55s/it] 24%|██▍       | 24/100 [01:45<05:52,  4.64s/it] 25%|██▌       | 25/100 [01:49<05:44,  4.59s/it] 26%|██▌       | 26/100 [01:54<05:42,  4.63s/it] 27%|██▋       | 27/100 [01:58<05:38,  4.64s/it] 28%|██▊       | 28/100 [02:03<05:36,  4.68s/it] 29%|██▉       | 29/100 [02:08<05:35,  4.73s/it] 30%|███       | 30/100 [02:13<05:27,  4.69s/it] 31%|███       | 31/100 [02:17<05:22,  4.67s/it] 32%|███▏      | 32/100 [02:22<05:20,  4.71s/it] 33%|███▎      | 33/100 [02:27<05:14,  4.70s/it] 34%|███▍      | 34/100 [02:32<05:10,  4.70s/it] 35%|███▌      | 35/100 [02:36<05:03,  4.67s/it] 36%|███▌      | 36/100 [02:41<04:59,  4.68s/it] 37%|███▋      | 37/100 [02:46<04:55,  4.69s/it] 38%|███▊      | 38/100 [02:50<04:53,  4.74s/it] 39%|███▉      | 39/100 [02:56<04:56,  4.85s/it] 40%|████      | 40/100 [03:00<04:47,  4.79s/it] 41%|████      | 41/100 [03:05<04:39,  4.74s/it] 42%|████▏     | 42/100 [03:09<04:31,  4.68s/it] 43%|████▎     | 43/100 [03:14<04:24,  4.64s/it] 44%|████▍     | 44/100 [03:19<04:21,  4.68s/it] 45%|████▌     | 45/100 [03:23<04:16,  4.66s/it] 46%|████▌     | 46/100 [03:28<04:10,  4.64s/it] 47%|████▋     | 47/100 [03:33<04:09,  4.71s/it] 48%|████▊     | 48/100 [03:37<04:04,  4.69s/it] 49%|████▉     | 49/100 [03:42<03:58,  4.68s/it] 50%|█████     | 50/100 [03:47<03:54,  4.69s/it] 51%|█████     | 51/100 [03:51<03:49,  4.69s/it] 52%|█████▏    | 52/100 [03:56<03:44,  4.68s/it] 53%|█████▎    | 53/100 [04:01<03:42,  4.73s/it] 54%|█████▍    | 54/100 [04:05<03:34,  4.66s/it] 55%|█████▌    | 55/100 [04:10<03:27,  4.61s/it] 56%|█████▌    | 56/100 [04:14<03:21,  4.59s/it] 57%|█████▋    | 57/100 [04:19<03:16,  4.57s/it] 58%|█████▊    | 58/100 [04:24<03:12,  4.58s/it] 59%|█████▉    | 59/100 [04:28<03:04,  4.50s/it] 60%|██████    | 60/100 [04:32<02:59,  4.50s/it] 61%|██████    | 61/100 [04:37<02:57,  4.55s/it] 62%|██████▏   | 62/100 [04:42<02:52,  4.54s/it] 63%|██████▎   | 63/100 [04:46<02:46,  4.49s/it] 64%|██████▍   | 64/100 [04:50<02:39,  4.44s/it] 65%|██████▌   | 65/100 [04:55<02:34,  4.42s/it] 66%|██████▌   | 66/100 [04:59<02:29,  4.40s/it] 67%|██████▋   | 67/100 [05:03<02:23,  4.36s/it] 68%|██████▊   | 68/100 [05:08<02:19,  4.37s/it] 69%|██████▉   | 69/100 [05:12<02:14,  4.34s/it] 70%|███████   | 70/100 [05:16<02:09,  4.33s/it] 71%|███████   | 71/100 [05:20<02:04,  4.29s/it] 72%|███████▏  | 72/100 [05:25<02:01,  4.32s/it] 73%|███████▎  | 73/100 [05:29<01:58,  4.40s/it] 74%|███████▍  | 74/100 [05:34<01:54,  4.41s/it] 75%|███████▌  | 75/100 [05:38<01:49,  4.40s/it] 76%|███████▌  | 76/100 [05:43<01:45,  4.38s/it] 77%|███████▋  | 77/100 [05:47<01:41,  4.41s/it] 78%|███████▊  | 78/100 [05:51<01:37,  4.42s/it] 79%|███████▉  | 79/100 [05:56<01:33,  4.47s/it] 80%|████████  | 80/100 [06:00<01:28,  4.42s/it] 81%|████████  | 81/100 [06:05<01:25,  4.48s/it] 82%|████████▏ | 82/100 [06:10<01:20,  4.49s/it] 83%|████████▎ | 83/100 [06:14<01:16,  4.51s/it] 84%|████████▍ | 84/100 [06:18<01:11,  4.46s/it] 85%|████████▌ | 85/100 [06:23<01:06,  4.45s/it] 86%|████████▌ | 86/100 [06:27<01:02,  4.49s/it] 87%|████████▋ | 87/100 [06:32<00:58,  4.46s/it] 88%|████████▊ | 88/100 [06:36<00:53,  4.43s/it] 89%|████████▉ | 89/100 [06:41<00:49,  4.53s/it] 90%|█████████ | 90/100 [06:45<00:45,  4.50s/it] 91%|█████████ | 91/100 [06:50<00:40,  4.49s/it] 92%|█████████▏| 92/100 [06:54<00:35,  4.48s/it] 93%|█████████▎| 93/100 [06:59<00:31,  4.56s/it] 94%|█████████▍| 94/100 [07:04<00:27,  4.54s/it] 95%|█████████▌| 95/100 [07:08<00:23,  4.65s/it] 96%|█████████▌| 96/100 [07:13<00:18,  4.60s/it] 97%|█████████▋| 97/100 [07:18<00:13,  4.64s/it] 98%|█████████▊| 98/100 [07:23<00:09,  4.75s/it] 99%|█████████▉| 99/100 [07:28<00:04,  4.95s/it]100%|██████████| 100/100 [07:34<00:00,  5.25s/it]100%|██████████| 100/100 [07:34<00:00,  4.55s/it]
[0/100] loss: 2.757045269012451 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 0.7648107409477234
[1/100] loss: 1.5058484077453613 loss_joints: 1.318758487701416 loss_collision: 0.0 loss_jerk: 0.11411149799823761 loss_floor_contact: 0.7297835946083069
[2/100] loss: 0.6349831223487854 loss_joints: 0.5192995071411133 loss_collision: 0.0 loss_jerk: 0.08997837454080582 loss_floor_contact: 0.2570522129535675
[3/100] loss: 0.11877574771642685 loss_joints: 0.044477395713329315 loss_collision: 0.0 loss_jerk: 0.07429835200309753 loss_floor_contact: 0.0
[4/100] loss: 0.10885924100875854 loss_joints: 0.04364877566695213 loss_collision: 0.0 loss_jerk: 0.06521046906709671 loss_floor_contact: 0.0
[5/100] loss: 0.0998254120349884 loss_joints: 0.043557457625865936 loss_collision: 0.0006858924753032625 loss_jerk: 0.056199368089437485 loss_floor_contact: 0.0
[6/100] loss: 0.06625264883041382 loss_joints: 0.009010388515889645 loss_collision: 0.0007222398417070508 loss_jerk: 0.05717003718018532 loss_floor_contact: 0.0
[7/100] loss: 0.052301108837127686 loss_joints: 0.002375412732362747 loss_collision: 0.0 loss_jerk: 0.04992569610476494 loss_floor_contact: 0.0
[8/100] loss: 0.047642022371292114 loss_joints: 0.0005462357075884938 loss_collision: 0.0 loss_jerk: 0.04709578678011894 loss_floor_contact: 0.0
[9/100] loss: 0.04361937940120697 loss_joints: 0.00045165253686718643 loss_collision: 0.0 loss_jerk: 0.04316772520542145 loss_floor_contact: 0.0
[10/100] loss: 0.046091292053461075 loss_joints: 0.005473045166581869 loss_collision: 0.0 loss_jerk: 0.04061824828386307 loss_floor_contact: 0.0
[11/100] loss: 0.0417126901447773 loss_joints: 0.0029259505681693554 loss_collision: 0.0 loss_jerk: 0.038786739110946655 loss_floor_contact: 0.0
[12/100] loss: 0.05137019604444504 loss_joints: 0.003012700704857707 loss_collision: 0.0 loss_jerk: 0.04835749417543411 loss_floor_contact: 0.0
[13/100] loss: 0.048818737268447876 loss_joints: 0.002896505407989025 loss_collision: 0.0 loss_jerk: 0.045922230929136276 loss_floor_contact: 0.0
[14/100] loss: 0.03644644841551781 loss_joints: 0.0010114969918504357 loss_collision: 0.0 loss_jerk: 0.03543495014309883 loss_floor_contact: 0.0
[15/100] loss: 0.05739586800336838 loss_joints: 0.017942776903510094 loss_collision: 0.0 loss_jerk: 0.039453089237213135 loss_floor_contact: 0.0
[16/100] loss: 0.059759728610515594 loss_joints: 0.023103250190615654 loss_collision: 0.0 loss_jerk: 0.03665648028254509 loss_floor_contact: 0.0
[17/100] loss: 0.04715609923005104 loss_joints: 0.012629917822778225 loss_collision: 0.0 loss_jerk: 0.03452618047595024 loss_floor_contact: 0.0
[18/100] loss: 0.03759755194187164 loss_joints: 0.00143947615288198 loss_collision: 0.0 loss_jerk: 0.03615807741880417 loss_floor_contact: 0.0
[19/100] loss: 0.03940542787313461 loss_joints: 0.0061369421891868114 loss_collision: 0.0 loss_jerk: 0.033268485218286514 loss_floor_contact: 0.0
[20/100] loss: 0.04372940957546234 loss_joints: 0.010855359956622124 loss_collision: 0.0 loss_jerk: 0.03287404775619507 loss_floor_contact: 0.0
[21/100] loss: 0.03882654756307602 loss_joints: 0.006136057898402214 loss_collision: 0.0 loss_jerk: 0.032690491527318954 loss_floor_contact: 0.0
[22/100] loss: 0.03275662660598755 loss_joints: 0.00021371209004428238 loss_collision: 0.0 loss_jerk: 0.032542914152145386 loss_floor_contact: 0.0
[23/100] loss: 0.03476446494460106 loss_joints: 0.0025614160113036633 loss_collision: 0.0 loss_jerk: 0.03220304846763611 loss_floor_contact: 0.0
[24/100] loss: 0.03630276024341583 loss_joints: 0.004545537289232016 loss_collision: 0.0 loss_jerk: 0.03175722435116768 loss_floor_contact: 0.0
[25/100] loss: 0.03322435915470123 loss_joints: 0.00179130001924932 loss_collision: 0.0 loss_jerk: 0.03143306076526642 loss_floor_contact: 0.0
[26/100] loss: 0.031008396297693253 loss_joints: 0.00016619810776319355 loss_collision: 0.0 loss_jerk: 0.030842198058962822 loss_floor_contact: 0.0
[27/100] loss: 0.03206756338477135 loss_joints: 0.0010921352077275515 loss_collision: 0.0 loss_jerk: 0.030975427478551865 loss_floor_contact: 0.0
[28/100] loss: 0.031746622174978256 loss_joints: 0.0004250277706887573 loss_collision: 0.0 loss_jerk: 0.03132159262895584 loss_floor_contact: 0.0
[29/100] loss: 0.030759338289499283 loss_joints: 0.00032109784660860896 loss_collision: 0.0 loss_jerk: 0.030438240617513657 loss_floor_contact: 0.0
[30/100] loss: 0.030472520738840103 loss_joints: 0.001677348162047565 loss_collision: 0.0 loss_jerk: 0.02879517339169979 loss_floor_contact: 0.0
[31/100] loss: 0.02906934916973114 loss_joints: 0.0012555996654555202 loss_collision: 0.0 loss_jerk: 0.027813749387860298 loss_floor_contact: 0.0
[32/100] loss: 0.028767475858330727 loss_joints: 0.00012373867502901703 loss_collision: 0.0 loss_jerk: 0.028643736615777016 loss_floor_contact: 0.0
[33/100] loss: 0.028430679813027382 loss_joints: 0.00012719057849608362 loss_collision: 0.0 loss_jerk: 0.028303489089012146 loss_floor_contact: 0.0
[34/100] loss: 0.027710922062397003 loss_joints: 1.0579522040643496e-06 loss_collision: 0.0 loss_jerk: 0.02770986407995224 loss_floor_contact: 0.0
[35/100] loss: 0.02713046409189701 loss_joints: 3.075792483286932e-05 loss_collision: 0.0 loss_jerk: 0.02709970623254776 loss_floor_contact: 0.0
[36/100] loss: 0.026711558923125267 loss_joints: 8.531589628546499e-06 loss_collision: 0.0 loss_jerk: 0.02670302800834179 loss_floor_contact: 0.0
[37/100] loss: 0.027481161057949066 loss_joints: 0.00032612215727567673 loss_collision: 0.0 loss_jerk: 0.027155037969350815 loss_floor_contact: 0.0
[38/100] loss: 0.026368699967861176 loss_joints: 0.0006503453478217125 loss_collision: 0.0 loss_jerk: 0.025718355551362038 loss_floor_contact: 0.0
[39/100] loss: 0.026129914447665215 loss_joints: 0.0002261482150061056 loss_collision: 0.0 loss_jerk: 0.025903766974806786 loss_floor_contact: 0.0
[40/100] loss: 0.027291977778077126 loss_joints: 0.0002222231705673039 loss_collision: 0.0 loss_jerk: 0.027069754898548126 loss_floor_contact: 0.0
[41/100] loss: 0.025047043338418007 loss_joints: 0.00023272713588085026 loss_collision: 0.0 loss_jerk: 0.024814317002892494 loss_floor_contact: 0.0
[42/100] loss: 0.02477145381271839 loss_joints: 4.504004755290225e-05 loss_collision: 0.0 loss_jerk: 0.024726413190364838 loss_floor_contact: 0.0
[43/100] loss: 0.02417410910129547 loss_joints: 0.00013482564827427268 loss_collision: 0.0 loss_jerk: 0.024039283394813538 loss_floor_contact: 0.0
[44/100] loss: 0.023639285936951637 loss_joints: 4.2118728742934763e-05 loss_collision: 0.0 loss_jerk: 0.023597167804837227 loss_floor_contact: 0.0
[45/100] loss: 0.024030329659581184 loss_joints: 0.0006763776182197034 loss_collision: 0.0 loss_jerk: 0.023353952914476395 loss_floor_contact: 0.0
[46/100] loss: 0.02336314134299755 loss_joints: 0.0006087529473006725 loss_collision: 0.0 loss_jerk: 0.02275438793003559 loss_floor_contact: 0.0
[47/100] loss: 0.02230958454310894 loss_joints: 4.580062159220688e-05 loss_collision: 0.0 loss_jerk: 0.0222637839615345 loss_floor_contact: 0.0
[48/100] loss: 0.022764744237065315 loss_joints: 0.0005499187391251326 loss_collision: 0.000336378812789917 loss_jerk: 0.022181186825037003 loss_floor_contact: 0.0
[49/100] loss: 0.02265353687107563 loss_joints: 0.0006092090043239295 loss_collision: 0.0003780206898227334 loss_jerk: 0.022006526589393616 loss_floor_contact: 0.0
[50/100] loss: 0.021978149190545082 loss_joints: 0.00010459439363330603 loss_collision: 0.00019344458996783942 loss_jerk: 0.021854210644960403 loss_floor_contact: 0.0
[51/100] loss: 0.02165110409259796 loss_joints: 0.0001495440665166825 loss_collision: 0.0 loss_jerk: 0.021501559764146805 loss_floor_contact: 0.0
[52/100] loss: 0.021549327298998833 loss_joints: 0.0002535028615966439 loss_collision: 0.0 loss_jerk: 0.021295825019478798 loss_floor_contact: 0.0
[53/100] loss: 0.02121705189347267 loss_joints: 4.299639113014564e-05 loss_collision: 8.027599687920883e-05 loss_jerk: 0.021166028454899788 loss_floor_contact: 0.0
[54/100] loss: 0.02069273591041565 loss_joints: 0.00031145947286859155 loss_collision: 0.0 loss_jerk: 0.020381275564432144 loss_floor_contact: 0.0
[55/100] loss: 0.020592045038938522 loss_joints: 0.0005969016929157078 loss_collision: 0.0 loss_jerk: 0.01999514363706112 loss_floor_contact: 0.0
[56/100] loss: 0.020189041271805763 loss_joints: 0.0003048629150725901 loss_collision: 0.0 loss_jerk: 0.019884178414940834 loss_floor_contact: 0.0
[57/100] loss: 0.0198382418602705 loss_joints: 5.299122858559713e-05 loss_collision: 0.0 loss_jerk: 0.01978525146842003 loss_floor_contact: 0.0
[58/100] loss: 0.019634079188108444 loss_joints: 6.690439477097243e-05 loss_collision: 0.0 loss_jerk: 0.019567174836993217 loss_floor_contact: 0.0
[59/100] loss: 0.018990587443113327 loss_joints: 0.00014201679732650518 loss_collision: 0.0 loss_jerk: 0.018848570063710213 loss_floor_contact: 0.0
[60/100] loss: 0.018486369401216507 loss_joints: 7.934030145406723e-05 loss_collision: 0.0 loss_jerk: 0.018407030031085014 loss_floor_contact: 0.0
[61/100] loss: 0.018455281853675842 loss_joints: 0.00013698777183890343 loss_collision: 0.0 loss_jerk: 0.01831829361617565 loss_floor_contact: 0.0
[62/100] loss: 0.018326347693800926 loss_joints: 0.00018299248768016696 loss_collision: 0.0 loss_jerk: 0.01814335584640503 loss_floor_contact: 0.0
[63/100] loss: 0.018328407779335976 loss_joints: 0.00013133480388205498 loss_collision: 0.0 loss_jerk: 0.0181970726698637 loss_floor_contact: 0.0
[64/100] loss: 0.01802426390349865 loss_joints: 4.881560926150996e-06 loss_collision: 0.0 loss_jerk: 0.018019381910562515 loss_floor_contact: 0.0
[65/100] loss: 0.017735226079821587 loss_joints: 0.00014796532923355699 loss_collision: 0.0 loss_jerk: 0.017587261274456978 loss_floor_contact: 0.0
[66/100] loss: 0.018022753298282623 loss_joints: 0.00041227490874007344 loss_collision: 0.0 loss_jerk: 0.01761047914624214 loss_floor_contact: 0.0
[67/100] loss: 0.01782034896314144 loss_joints: 0.0004229842161294073 loss_collision: 0.0 loss_jerk: 0.017397364601492882 loss_floor_contact: 0.0
[68/100] loss: 0.017672812566161156 loss_joints: 0.0001955905754584819 loss_collision: 0.0 loss_jerk: 0.01747722178697586 loss_floor_contact: 0.0
[69/100] loss: 0.01708122156560421 loss_joints: 2.2014686692273244e-05 loss_collision: 0.0 loss_jerk: 0.01705920696258545 loss_floor_contact: 0.0
[70/100] loss: 0.01753285899758339 loss_joints: 0.00012763531412929296 loss_collision: 0.0 loss_jerk: 0.017405223101377487 loss_floor_contact: 0.0
[71/100] loss: 0.017334436997771263 loss_joints: 0.0002831324527505785 loss_collision: 0.0 loss_jerk: 0.017051303759217262 loss_floor_contact: 0.0
[72/100] loss: 0.016777431592345238 loss_joints: 0.0002957631950266659 loss_collision: 0.0 loss_jerk: 0.016481667757034302 loss_floor_contact: 0.0
[73/100] loss: 0.016779979690909386 loss_joints: 0.0001347219804301858 loss_collision: 0.0 loss_jerk: 0.01664525829255581 loss_floor_contact: 0.0
[74/100] loss: 0.016474448144435883 loss_joints: 8.808069833321497e-05 loss_collision: 0.0 loss_jerk: 0.01638636738061905 loss_floor_contact: 0.0
[75/100] loss: 0.016484811902046204 loss_joints: 0.00013157265493646264 loss_collision: 0.0 loss_jerk: 0.016353238373994827 loss_floor_contact: 0.0
[76/100] loss: 0.016509827226400375 loss_joints: 0.00012469812645576894 loss_collision: 0.0 loss_jerk: 0.01638512872159481 loss_floor_contact: 0.0
[77/100] loss: 0.016610037535429 loss_joints: 0.0001245087041752413 loss_collision: 0.0 loss_jerk: 0.016485529020428658 loss_floor_contact: 0.0
[78/100] loss: 0.01647459901869297 loss_joints: 6.70410881866701e-05 loss_collision: 0.0 loss_jerk: 0.01640755869448185 loss_floor_contact: 0.0
[79/100] loss: 0.01611020416021347 loss_joints: 3.6173491935187485e-07 loss_collision: 0.0 loss_jerk: 0.01610984280705452 loss_floor_contact: 0.0
[80/100] loss: 0.015982916578650475 loss_joints: 6.492739339591935e-05 loss_collision: 0.0 loss_jerk: 0.015917988494038582 loss_floor_contact: 0.0
[81/100] loss: 0.015897387638688087 loss_joints: 0.00014840315270703286 loss_collision: 0.0 loss_jerk: 0.01574898511171341 loss_floor_contact: 0.0
[82/100] loss: 0.01586952432990074 loss_joints: 0.00013440128532238305 loss_collision: 0.0 loss_jerk: 0.015735123306512833 loss_floor_contact: 0.0
[83/100] loss: 0.015777258202433586 loss_joints: 4.243078001309186e-05 loss_collision: 0.0 loss_jerk: 0.015734827145934105 loss_floor_contact: 0.0
[84/100] loss: 0.01587856188416481 loss_joints: 1.3489108823705465e-05 loss_collision: 0.0 loss_jerk: 0.01586507260799408 loss_floor_contact: 0.0
[85/100] loss: 0.016023557633161545 loss_joints: 7.108313639037078e-06 loss_collision: 0.0 loss_jerk: 0.01601644977927208 loss_floor_contact: 0.0
[86/100] loss: 0.015761055052280426 loss_joints: 1.762266765581444e-05 loss_collision: 0.0 loss_jerk: 0.015743432566523552 loss_floor_contact: 0.0
[87/100] loss: 0.015619292855262756 loss_joints: 4.0276900108437985e-05 loss_collision: 0.0 loss_jerk: 0.01557901594787836 loss_floor_contact: 0.0
[88/100] loss: 0.01556388195604086 loss_joints: 5.808704736409709e-05 loss_collision: 0.0 loss_jerk: 0.015505795367062092 loss_floor_contact: 0.0
[89/100] loss: 0.015463931486010551 loss_joints: 6.111409311415628e-05 loss_collision: 0.0 loss_jerk: 0.01540281716734171 loss_floor_contact: 0.0
[90/100] loss: 0.015303966589272022 loss_joints: 4.8352601879741997e-05 loss_collision: 0.0 loss_jerk: 0.015255614183843136 loss_floor_contact: 0.0
[91/100] loss: 0.015203065238893032 loss_joints: 1.0787173778226133e-05 loss_collision: 0.0 loss_jerk: 0.015192277729511261 loss_floor_contact: 0.0
[92/100] loss: 0.015256260521709919 loss_joints: 7.727265256107785e-06 loss_collision: 0.0 loss_jerk: 0.015248533338308334 loss_floor_contact: 0.0
[93/100] loss: 0.015199663117527962 loss_joints: 2.8816712074331008e-05 loss_collision: 0.0 loss_jerk: 0.01517084613442421 loss_floor_contact: 0.0
[94/100] loss: 0.015108148567378521 loss_joints: 3.23640342685394e-05 loss_collision: 0.0 loss_jerk: 0.015075784176588058 loss_floor_contact: 0.0
[95/100] loss: 0.015005364082753658 loss_joints: 2.459236202412285e-05 loss_collision: 0.0 loss_jerk: 0.014980771578848362 loss_floor_contact: 0.0
[96/100] loss: 0.014971118420362473 loss_joints: 1.3823251720168628e-05 loss_collision: 0.0 loss_jerk: 0.014957294799387455 loss_floor_contact: 0.0
[97/100] loss: 0.015092860907316208 loss_joints: 8.232535947172437e-06 loss_collision: 0.0 loss_jerk: 0.015084628015756607 loss_floor_contact: 0.0
[98/100] loss: 0.015045390464365482 loss_joints: 7.018290489213541e-06 loss_collision: 0.0 loss_jerk: 0.01503837201744318 loss_floor_contact: 0.0
[99/100] loss: 0.01492821704596281 loss_joints: 6.849058991065249e-06 loss_collision: 0.0 loss_jerk: 0.014921368099749088 loss_floor_contact: 0.0
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.25/contact_thresh_0.75/cabE-path3-run12-4000_collision0.1_contact0.1_jerk1.0_skate1.0]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 454.52320                                                    ║
    ║     rollout = 208.20417                                                    ║
    ║     sdf     = 20.37333                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.01492822                                                 ║
    ║     joints    = 0.00000685                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.01492137                                                 ║
    ║     floor     = 0.00000000                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	7m52.984s
user	6m57.773s
sys	0m19.761s
[INFO] Running with collision=0.1, contact=0.5, jerk=0.1, skate=0.1
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<08:06,  4.91s/it]  2%|▏         | 2/100 [00:10<08:12,  5.02s/it]  3%|▎         | 3/100 [00:15<08:24,  5.20s/it]  4%|▍         | 4/100 [00:20<08:05,  5.06s/it]  5%|▌         | 5/100 [00:25<08:15,  5.22s/it]  6%|▌         | 6/100 [00:30<07:55,  5.06s/it]  7%|▋         | 7/100 [00:35<07:43,  4.99s/it]  8%|▊         | 8/100 [00:40<07:30,  4.90s/it]  9%|▉         | 9/100 [00:45<07:28,  4.93s/it] 10%|█         | 10/100 [00:50<07:25,  4.95s/it] 11%|█         | 11/100 [00:55<07:29,  5.05s/it] 12%|█▏        | 12/100 [01:00<07:23,  5.04s/it] 13%|█▎        | 13/100 [01:05<07:22,  5.09s/it] 14%|█▍        | 14/100 [01:10<07:11,  5.02s/it] 15%|█▌        | 15/100 [01:15<07:02,  4.98s/it] 16%|█▌        | 16/100 [01:20<06:55,  4.94s/it] 17%|█▋        | 17/100 [01:25<06:50,  4.94s/it] 18%|█▊        | 18/100 [01:30<06:45,  4.95s/it] 19%|█▉        | 19/100 [01:35<06:41,  4.96s/it] 20%|██        | 20/100 [01:39<06:29,  4.87s/it] 21%|██        | 21/100 [01:44<06:18,  4.79s/it] 22%|██▏       | 22/100 [01:49<06:13,  4.79s/it] 23%|██▎       | 23/100 [01:53<06:06,  4.76s/it] 24%|██▍       | 24/100 [01:59<06:14,  4.92s/it] 25%|██▌       | 25/100 [02:04<06:23,  5.12s/it] 26%|██▌       | 26/100 [02:09<06:23,  5.18s/it] 27%|██▋       | 27/100 [02:14<06:04,  4.99s/it] 28%|██▊       | 28/100 [02:19<05:49,  4.85s/it] 29%|██▉       | 29/100 [02:24<05:53,  4.98s/it] 30%|███       | 30/100 [02:29<05:44,  4.93s/it] 31%|███       | 31/100 [02:34<05:43,  4.98s/it] 32%|███▏      | 32/100 [02:39<05:49,  5.14s/it] 33%|███▎      | 33/100 [02:44<05:45,  5.15s/it] 34%|███▍      | 34/100 [02:49<05:30,  5.01s/it] 35%|███▌      | 35/100 [02:54<05:19,  4.92s/it] 36%|███▌      | 36/100 [02:58<05:09,  4.84s/it] 37%|███▋      | 37/100 [03:03<05:05,  4.85s/it] 38%|███▊      | 38/100 [03:09<05:11,  5.02s/it] 39%|███▉      | 39/100 [03:14<05:13,  5.14s/it] 40%|████      | 40/100 [03:19<05:05,  5.09s/it] 41%|████      | 41/100 [03:24<04:54,  4.99s/it] 42%|████▏     | 42/100 [03:29<04:45,  4.93s/it] 43%|████▎     | 43/100 [03:34<04:40,  4.92s/it] 44%|████▍     | 44/100 [03:39<04:36,  4.94s/it] 45%|████▌     | 45/100 [03:44<04:33,  4.98s/it] 46%|████▌     | 46/100 [03:49<04:35,  5.09s/it] 47%|████▋     | 47/100 [03:54<04:30,  5.10s/it] 48%|████▊     | 48/100 [03:59<04:24,  5.08s/it] 49%|████▉     | 49/100 [04:04<04:14,  4.99s/it] 50%|█████     | 50/100 [04:09<04:03,  4.87s/it] 51%|█████     | 51/100 [04:13<03:58,  4.86s/it] 52%|█████▏    | 52/100 [04:18<03:50,  4.81s/it] 53%|█████▎    | 53/100 [04:23<03:47,  4.84s/it] 54%|█████▍    | 54/100 [04:28<03:40,  4.79s/it] 55%|█████▌    | 55/100 [04:32<03:35,  4.78s/it] 56%|█████▌    | 56/100 [04:37<03:28,  4.73s/it] 57%|█████▋    | 57/100 [04:42<03:22,  4.72s/it] 58%|█████▊    | 58/100 [04:47<03:20,  4.77s/it] 59%|█████▉    | 59/100 [04:51<03:14,  4.75s/it] 60%|██████    | 60/100 [04:56<03:14,  4.85s/it] 61%|██████    | 61/100 [05:01<03:06,  4.79s/it] 62%|██████▏   | 62/100 [05:06<02:59,  4.73s/it] 63%|██████▎   | 63/100 [05:11<02:56,  4.78s/it] 64%|██████▍   | 64/100 [05:15<02:50,  4.73s/it] 65%|██████▌   | 65/100 [05:20<02:43,  4.67s/it] 66%|██████▌   | 66/100 [05:24<02:38,  4.65s/it] 67%|██████▋   | 67/100 [05:29<02:33,  4.64s/it] 68%|██████▊   | 68/100 [05:34<02:29,  4.69s/it] 69%|██████▉   | 69/100 [05:38<02:24,  4.65s/it] 70%|███████   | 70/100 [05:43<02:19,  4.65s/it] 71%|███████   | 71/100 [05:47<02:13,  4.61s/it] 72%|███████▏  | 72/100 [05:52<02:10,  4.65s/it] 73%|███████▎  | 73/100 [05:57<02:06,  4.70s/it] 74%|███████▍  | 74/100 [06:02<02:04,  4.80s/it] 75%|███████▌  | 75/100 [06:07<01:58,  4.72s/it] 76%|███████▌  | 76/100 [06:11<01:53,  4.73s/it] 77%|███████▋  | 77/100 [06:16<01:46,  4.64s/it] 78%|███████▊  | 78/100 [06:21<01:42,  4.68s/it] 79%|███████▉  | 79/100 [06:25<01:37,  4.65s/it] 80%|████████  | 80/100 [06:30<01:32,  4.62s/it] 81%|████████  | 81/100 [06:34<01:28,  4.64s/it] 82%|████████▏ | 82/100 [06:39<01:22,  4.61s/it] 83%|████████▎ | 83/100 [06:43<01:17,  4.54s/it] 84%|████████▍ | 84/100 [06:48<01:12,  4.53s/it] 85%|████████▌ | 85/100 [06:52<01:07,  4.51s/it] 86%|████████▌ | 86/100 [06:57<01:03,  4.50s/it] 87%|████████▋ | 87/100 [07:01<00:57,  4.44s/it] 88%|████████▊ | 88/100 [07:05<00:52,  4.40s/it] 89%|████████▉ | 89/100 [07:10<00:48,  4.39s/it] 90%|█████████ | 90/100 [07:14<00:43,  4.37s/it] 91%|█████████ | 91/100 [07:18<00:39,  4.37s/it] 92%|█████████▏| 92/100 [07:23<00:34,  4.37s/it] 93%|█████████▎| 93/100 [07:27<00:30,  4.41s/it] 94%|█████████▍| 94/100 [07:32<00:26,  4.43s/it] 95%|█████████▌| 95/100 [07:36<00:22,  4.46s/it] 96%|█████████▌| 96/100 [07:41<00:17,  4.45s/it] 97%|█████████▋| 97/100 [07:45<00:13,  4.43s/it] 98%|█████████▊| 98/100 [07:49<00:08,  4.40s/it] 99%|█████████▉| 99/100 [07:54<00:04,  4.33s/it]100%|██████████| 100/100 [07:58<00:00,  4.34s/it]100%|██████████| 100/100 [07:58<00:00,  4.78s/it]
[0/100] loss: 2.9833948612213135 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 0.7648107409477234
[1/100] loss: 2.1182167530059814 loss_joints: 1.8274402618408203 loss_collision: 0.0 loss_jerk: 0.06442569941282272 loss_floor_contact: 0.5686680674552917
[2/100] loss: 0.6364164352416992 loss_joints: 0.4412543773651123 loss_collision: 0.0 loss_jerk: 0.10676388442516327 loss_floor_contact: 0.3689713180065155
[3/100] loss: 0.044381894171237946 loss_joints: 0.0284125916659832 loss_collision: 0.0002590853546280414 loss_jerk: 0.08026476949453354 loss_floor_contact: 0.015833836048841476
[4/100] loss: 0.1362551599740982 loss_joints: 0.12837481498718262 loss_collision: 0.0 loss_jerk: 0.0788034200668335 loss_floor_contact: 0.0
[5/100] loss: 0.07406503707170486 loss_joints: 0.06588391214609146 loss_collision: 0.0 loss_jerk: 0.08181127160787582 loss_floor_contact: 0.0
[6/100] loss: 0.07662694156169891 loss_joints: 0.06919658184051514 loss_collision: 0.0004627658927347511 loss_jerk: 0.07384080439805984 loss_floor_contact: 0.0
[7/100] loss: 0.028809072449803352 loss_joints: 0.021937992423772812 loss_collision: 0.0 loss_jerk: 0.0687107965350151 loss_floor_contact: 0.0
[8/100] loss: 0.020720381289720535 loss_joints: 0.01414045225828886 loss_collision: 0.0 loss_jerk: 0.065799281001091 loss_floor_contact: 0.0
[9/100] loss: 0.022601770237088203 loss_joints: 0.01640891097486019 loss_collision: 0.0 loss_jerk: 0.061928585171699524 loss_floor_contact: 0.0
[10/100] loss: 0.012888827361166477 loss_joints: 0.0071446276269853115 loss_collision: 0.0 loss_jerk: 0.05744199827313423 loss_floor_contact: 0.0
[11/100] loss: 0.0074392277747392654 loss_joints: 0.001717236591503024 loss_collision: 0.0 loss_jerk: 0.057219911366701126 loss_floor_contact: 0.0
[12/100] loss: 0.017730586230754852 loss_joints: 0.012011205777525902 loss_collision: 0.0 loss_jerk: 0.05719379335641861 loss_floor_contact: 0.0
[13/100] loss: 0.017604980617761612 loss_joints: 0.011903604492545128 loss_collision: 0.0 loss_jerk: 0.057013753801584244 loss_floor_contact: 0.0
[14/100] loss: 0.008547437377274036 loss_joints: 0.0029837964102625847 loss_collision: 0.0 loss_jerk: 0.05563640967011452 loss_floor_contact: 0.0
[15/100] loss: 0.007189443800598383 loss_joints: 0.0016285581514239311 loss_collision: 0.0 loss_jerk: 0.05560885742306709 loss_floor_contact: 0.0
[16/100] loss: 0.008261945098638535 loss_joints: 0.002580419648438692 loss_collision: 0.0 loss_jerk: 0.056815255433321 loss_floor_contact: 0.0
[17/100] loss: 0.007923610508441925 loss_joints: 0.002308347262442112 loss_collision: 0.0 loss_jerk: 0.05615263059735298 loss_floor_contact: 0.0
[18/100] loss: 0.0071565499529242516 loss_joints: 0.0017066576983779669 loss_collision: 0.0 loss_jerk: 0.05449891835451126 loss_floor_contact: 0.0
[19/100] loss: 0.006268941797316074 loss_joints: 0.0008460527169518173 loss_collision: 0.0 loss_jerk: 0.05422889068722725 loss_floor_contact: 0.0
[20/100] loss: 0.009322726167738438 loss_joints: 0.0038260191213339567 loss_collision: 0.0 loss_jerk: 0.05496706813573837 loss_floor_contact: 0.0
[21/100] loss: 0.008012187667191029 loss_joints: 0.0026366354431957006 loss_collision: 0.0 loss_jerk: 0.05375552549958229 loss_floor_contact: 0.0
[22/100] loss: 0.005705792456865311 loss_joints: 0.00040638301288709044 loss_collision: 0.0 loss_jerk: 0.05299409478902817 loss_floor_contact: 0.0
[23/100] loss: 0.005673553328961134 loss_joints: 0.0004096576594747603 loss_collision: 0.0 loss_jerk: 0.0526389554142952 loss_floor_contact: 0.0
[24/100] loss: 0.006634600926190615 loss_joints: 0.0014427447458729148 loss_collision: 0.0 loss_jerk: 0.05191855877637863 loss_floor_contact: 0.0
[25/100] loss: 0.005886214319616556 loss_joints: 0.0007239718688651919 loss_collision: 0.0 loss_jerk: 0.0516224205493927 loss_floor_contact: 0.0
[26/100] loss: 0.006177582312375307 loss_joints: 0.0010181558318436146 loss_collision: 0.0 loss_jerk: 0.051594264805316925 loss_floor_contact: 0.0
[27/100] loss: 0.00614271080121398 loss_joints: 0.0011469428427517414 loss_collision: 0.0 loss_jerk: 0.049957677721977234 loss_floor_contact: 0.0
[28/100] loss: 0.005246066488325596 loss_joints: 0.00019162846729159355 loss_collision: 0.0 loss_jerk: 0.0505443774163723 loss_floor_contact: 0.0
[29/100] loss: 0.005162101238965988 loss_joints: 0.00015351205365732312 loss_collision: 0.0 loss_jerk: 0.0500858910381794 loss_floor_contact: 0.0
[30/100] loss: 0.005914208013564348 loss_joints: 0.0009923656471073627 loss_collision: 0.0 loss_jerk: 0.049218423664569855 loss_floor_contact: 0.0
[31/100] loss: 0.005436071194708347 loss_joints: 0.0006068495567888021 loss_collision: 0.0 loss_jerk: 0.04829221963882446 loss_floor_contact: 0.0
[32/100] loss: 0.0052088601514697075 loss_joints: 0.0003878422430716455 loss_collision: 0.0 loss_jerk: 0.048210177570581436 loss_floor_contact: 0.0
[33/100] loss: 0.005156060680747032 loss_joints: 0.00042569806100800633 loss_collision: 0.0 loss_jerk: 0.04730362445116043 loss_floor_contact: 0.0
[34/100] loss: 0.004880690015852451 loss_joints: 0.00023025425616651773 loss_collision: 0.0 loss_jerk: 0.04650435969233513 loss_floor_contact: 0.0
[35/100] loss: 0.004713912960141897 loss_joints: 0.00012008749763481319 loss_collision: 0.0 loss_jerk: 0.04593825340270996 loss_floor_contact: 0.0
[36/100] loss: 0.005233991425484419 loss_joints: 0.0006574728759005666 loss_collision: 0.0 loss_jerk: 0.04576518386602402 loss_floor_contact: 0.0
[37/100] loss: 0.005126435775309801 loss_joints: 0.0006165063823573291 loss_collision: 0.0 loss_jerk: 0.04509929567575455 loss_floor_contact: 0.0
[38/100] loss: 0.00438658194616437 loss_joints: 5.134680759510957e-05 loss_collision: 0.0 loss_jerk: 0.04335235431790352 loss_floor_contact: 0.0
[39/100] loss: 0.004285353235900402 loss_joints: 2.9198015909059905e-05 loss_collision: 0.0 loss_jerk: 0.04256155341863632 loss_floor_contact: 0.0
[40/100] loss: 0.004635872785001993 loss_joints: 0.0004154156777076423 loss_collision: 0.0 loss_jerk: 0.04220457375049591 loss_floor_contact: 0.0
[41/100] loss: 0.004344602581113577 loss_joints: 0.00018656560860108584 loss_collision: 0.0 loss_jerk: 0.04158036783337593 loss_floor_contact: 0.0
[42/100] loss: 0.004447896033525467 loss_joints: 0.00039427794399671257 loss_collision: 0.0 loss_jerk: 0.04053618013858795 loss_floor_contact: 0.0
[43/100] loss: 0.0045335497707128525 loss_joints: 0.0004888223484158516 loss_collision: 0.0 loss_jerk: 0.04044727236032486 loss_floor_contact: 0.0
[44/100] loss: 0.004026544280350208 loss_joints: 2.270929326186888e-05 loss_collision: 0.0 loss_jerk: 0.040038347244262695 loss_floor_contact: 0.0
[45/100] loss: 0.004105608910322189 loss_joints: 0.00014164010644890368 loss_collision: 0.0 loss_jerk: 0.039639685302972794 loss_floor_contact: 0.0
[46/100] loss: 0.00401891116052866 loss_joints: 8.416653145104647e-05 loss_collision: 0.0 loss_jerk: 0.03934744745492935 loss_floor_contact: 0.0
[47/100] loss: 0.00397831853479147 loss_joints: 8.001485548447818e-05 loss_collision: 0.0 loss_jerk: 0.03898303583264351 loss_floor_contact: 0.0
[48/100] loss: 0.003871156834065914 loss_joints: 1.1049081876990385e-05 loss_collision: 0.0 loss_jerk: 0.03860107809305191 loss_floor_contact: 0.0
[49/100] loss: 0.004217872396111488 loss_joints: 0.00037441946915350854 loss_collision: 0.0 loss_jerk: 0.038434527814388275 loss_floor_contact: 0.0
[50/100] loss: 0.004239410627633333 loss_joints: 0.0003999092732556164 loss_collision: 0.0 loss_jerk: 0.03839501366019249 loss_floor_contact: 0.0
[51/100] loss: 0.003892232896760106 loss_joints: 5.531248098122887e-05 loss_collision: 0.0 loss_jerk: 0.038369204849004745 loss_floor_contact: 0.0
[52/100] loss: 0.004117765463888645 loss_joints: 0.0003125669900327921 loss_collision: 0.0 loss_jerk: 0.03805198520421982 loss_floor_contact: 0.0
[53/100] loss: 0.004232179839164019 loss_joints: 0.00048733007861301303 loss_collision: 0.0 loss_jerk: 0.03744849935173988 loss_floor_contact: 0.0
[54/100] loss: 0.00380622292868793 loss_joints: 0.0001287411287194118 loss_collision: 0.0 loss_jerk: 0.03677481785416603 loss_floor_contact: 0.0
[55/100] loss: 0.0037186455447226763 loss_joints: 0.00014044390991330147 loss_collision: 0.0 loss_jerk: 0.035782016813755035 loss_floor_contact: 0.0
[56/100] loss: 0.003843466052785516 loss_joints: 0.00028620270313695073 loss_collision: 0.0 loss_jerk: 0.035572633147239685 loss_floor_contact: 0.0
[57/100] loss: 0.0035771564580500126 loss_joints: 4.6592613216489553e-05 loss_collision: 0.0 loss_jerk: 0.03530563786625862 loss_floor_contact: 0.0
[58/100] loss: 0.003670503618195653 loss_joints: 0.00018815950897987932 loss_collision: 0.0 loss_jerk: 0.03482344001531601 loss_floor_contact: 0.0
[59/100] loss: 0.003781953826546669 loss_joints: 0.0003426614566706121 loss_collision: 0.0 loss_jerk: 0.03439292311668396 loss_floor_contact: 0.0
[60/100] loss: 0.003512684488669038 loss_joints: 0.0001069366917363368 loss_collision: 0.0 loss_jerk: 0.03405747562646866 loss_floor_contact: 0.0
[61/100] loss: 0.00348571315407753 loss_joints: 8.229167724493891e-05 loss_collision: 0.0 loss_jerk: 0.03403421491384506 loss_floor_contact: 0.0
[62/100] loss: 0.0036133897956460714 loss_joints: 0.00021018320694565773 loss_collision: 0.0 loss_jerk: 0.03403206542134285 loss_floor_contact: 0.0
[63/100] loss: 0.0034355176612734795 loss_joints: 8.464990969514474e-05 loss_collision: 0.0 loss_jerk: 0.033508677035570145 loss_floor_contact: 0.0
[64/100] loss: 0.0033828828018158674 loss_joints: 7.000441837590188e-05 loss_collision: 0.0 loss_jerk: 0.033128783106803894 loss_floor_contact: 0.0
[65/100] loss: 0.003484874265268445 loss_joints: 0.00018909054051619023 loss_collision: 0.0 loss_jerk: 0.032957836985588074 loss_floor_contact: 0.0
[66/100] loss: 0.0033682133071124554 loss_joints: 9.556920122122392e-05 loss_collision: 0.0 loss_jerk: 0.03272644057869911 loss_floor_contact: 0.0
[67/100] loss: 0.0033035294618457556 loss_joints: 3.569485852494836e-05 loss_collision: 0.0 loss_jerk: 0.03267834708094597 loss_floor_contact: 0.0
[68/100] loss: 0.0033053169026970863 loss_joints: 0.0001105290575651452 loss_collision: 0.0 loss_jerk: 0.03194787725806236 loss_floor_contact: 0.0
[69/100] loss: 0.0032743513584136963 loss_joints: 7.74824438849464e-05 loss_collision: 0.0 loss_jerk: 0.03196868672966957 loss_floor_contact: 0.0
[70/100] loss: 0.0031451249960809946 loss_joints: 4.317903858463978e-06 loss_collision: 0.0 loss_jerk: 0.031408071517944336 loss_floor_contact: 0.0
[71/100] loss: 0.0031552081927657127 loss_joints: 3.533150447765365e-05 loss_collision: 0.0 loss_jerk: 0.031198766082525253 loss_floor_contact: 0.0
[72/100] loss: 0.00311629893258214 loss_joints: 9.41445159696741e-06 loss_collision: 0.0 loss_jerk: 0.031068844720721245 loss_floor_contact: 0.0
[73/100] loss: 0.0030813838820904493 loss_joints: 3.0534632969647646e-05 loss_collision: 0.0 loss_jerk: 0.03050849214196205 loss_floor_contact: 0.0
[74/100] loss: 0.0030619152821600437 loss_joints: 2.220070018665865e-05 loss_collision: 0.0 loss_jerk: 0.030397146940231323 loss_floor_contact: 0.0
[75/100] loss: 0.00300708063878119 loss_joints: 1.1135822205687873e-05 loss_collision: 0.0 loss_jerk: 0.02995944768190384 loss_floor_contact: 0.0
[76/100] loss: 0.0030358179938048124 loss_joints: 5.07315962749999e-05 loss_collision: 0.0 loss_jerk: 0.02985086292028427 loss_floor_contact: 0.0
[77/100] loss: 0.002983349608257413 loss_joints: 2.7937159757129848e-05 loss_collision: 0.0 loss_jerk: 0.029554124921560287 loss_floor_contact: 0.0
[78/100] loss: 0.00293719838373363 loss_joints: 1.6471396520501003e-05 loss_collision: 0.0 loss_jerk: 0.029207270592451096 loss_floor_contact: 0.0
[79/100] loss: 0.002913343720138073 loss_joints: 1.7274433048442006e-05 loss_collision: 0.0 loss_jerk: 0.028960691764950752 loss_floor_contact: 0.0
[80/100] loss: 0.0028793984092772007 loss_joints: 7.211935553641524e-06 loss_collision: 0.0 loss_jerk: 0.02872186340391636 loss_floor_contact: 0.0
[81/100] loss: 0.002882753498852253 loss_joints: 1.8185215594712645e-05 loss_collision: 0.0 loss_jerk: 0.028645683079957962 loss_floor_contact: 0.0
[82/100] loss: 0.0028557113837450743 loss_joints: 1.753460855979938e-05 loss_collision: 0.0 loss_jerk: 0.028381766751408577 loss_floor_contact: 0.0
[83/100] loss: 0.0028197590727359056 loss_joints: 1.901611904031597e-05 loss_collision: 0.0 loss_jerk: 0.028007427230477333 loss_floor_contact: 0.0
[84/100] loss: 0.002800782211124897 loss_joints: 1.1903553968295455e-05 loss_collision: 0.0 loss_jerk: 0.027888787910342216 loss_floor_contact: 0.0
[85/100] loss: 0.002818669192492962 loss_joints: 2.425099773972761e-05 loss_collision: 0.0 loss_jerk: 0.027944182977080345 loss_floor_contact: 0.0
[86/100] loss: 0.002778668189421296 loss_joints: 6.649878741882276e-06 loss_collision: 0.0 loss_jerk: 0.02772018313407898 loss_floor_contact: 0.0
[87/100] loss: 0.002759129274636507 loss_joints: 1.4521217963192612e-05 loss_collision: 0.0 loss_jerk: 0.02744607999920845 loss_floor_contact: 0.0
[88/100] loss: 0.002767265308648348 loss_joints: 1.9198623704141937e-05 loss_collision: 0.0 loss_jerk: 0.02748066745698452 loss_floor_contact: 0.0
[89/100] loss: 0.0027295327745378017 loss_joints: 3.050340410482022e-06 loss_collision: 0.0 loss_jerk: 0.027264824137091637 loss_floor_contact: 0.0
[90/100] loss: 0.0027248351834714413 loss_joints: 7.036276201688452e-06 loss_collision: 0.0 loss_jerk: 0.02717798762023449 loss_floor_contact: 0.0
[91/100] loss: 0.002715729409828782 loss_joints: 1.0998974175890908e-05 loss_collision: 0.0 loss_jerk: 0.027047304436564445 loss_floor_contact: 0.0
[92/100] loss: 0.0026927811559289694 loss_joints: 5.586461156781297e-06 loss_collision: 0.0 loss_jerk: 0.026871945708990097 loss_floor_contact: 0.0
[93/100] loss: 0.0026763114146888256 loss_joints: 9.347685363536584e-07 loss_collision: 0.0 loss_jerk: 0.02675376459956169 loss_floor_contact: 0.0
[94/100] loss: 0.0026620186399668455 loss_joints: 2.596620106487535e-06 loss_collision: 0.0 loss_jerk: 0.026594221591949463 loss_floor_contact: 0.0
[95/100] loss: 0.0026508476585149765 loss_joints: 8.987480555333605e-07 loss_collision: 0.0 loss_jerk: 0.026499489322304726 loss_floor_contact: 0.0
[96/100] loss: 0.002656995551660657 loss_joints: 2.458253902659635e-07 loss_collision: 0.0 loss_jerk: 0.026567496359348297 loss_floor_contact: 0.0
[97/100] loss: 0.002655308460816741 loss_joints: 5.960182534181513e-07 loss_collision: 0.0 loss_jerk: 0.026547124609351158 loss_floor_contact: 0.0
[98/100] loss: 0.00264730560593307 loss_joints: 2.9606135854010063e-07 loss_collision: 0.0 loss_jerk: 0.026470094919204712 loss_floor_contact: 0.0
[99/100] loss: 0.002638323465362191 loss_joints: 4.4577705970993975e-09 loss_collision: 0.0 loss_jerk: 0.026383189484477043 loss_floor_contact: 0.0
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.25/contact_thresh_0.75/cabE-path3-run12-4000_collision0.1_contact0.5_jerk0.1_skate0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 478.43926                                                    ║
    ║     rollout = 217.00700                                                    ║
    ║     sdf     = 21.93821                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00263832                                                 ║
    ║     joints    = 0.00000000                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.02638319                                                 ║
    ║     floor     = 0.00000000                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	8m19.626s
user	7m10.756s
sys	0m26.492s
[INFO] Running with collision=0.1, contact=0.5, jerk=0.1, skate=0.5
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<06:57,  4.22s/it]  2%|▏         | 2/100 [00:08<06:41,  4.10s/it]  3%|▎         | 3/100 [00:13<07:09,  4.42s/it]  4%|▍         | 4/100 [00:17<06:54,  4.32s/it]  5%|▌         | 5/100 [00:21<06:53,  4.36s/it]  6%|▌         | 6/100 [00:26<06:52,  4.39s/it]  7%|▋         | 7/100 [00:30<06:43,  4.34s/it]  8%|▊         | 8/100 [00:34<06:40,  4.36s/it]  9%|▉         | 9/100 [00:39<06:37,  4.37s/it] 10%|█         | 10/100 [00:43<06:33,  4.37s/it] 11%|█         | 11/100 [00:48<06:37,  4.46s/it] 12%|█▏        | 12/100 [00:52<06:31,  4.45s/it] 13%|█▎        | 13/100 [00:56<06:23,  4.41s/it] 14%|█▍        | 14/100 [01:01<06:15,  4.37s/it] 15%|█▌        | 15/100 [01:05<06:12,  4.38s/it] 16%|█▌        | 16/100 [01:09<06:08,  4.38s/it] 17%|█▋        | 17/100 [01:14<06:01,  4.36s/it] 18%|█▊        | 18/100 [01:18<05:59,  4.39s/it] 19%|█▉        | 19/100 [01:22<05:49,  4.31s/it] 20%|██        | 20/100 [01:26<05:40,  4.25s/it] 21%|██        | 21/100 [01:31<05:36,  4.26s/it] 22%|██▏       | 22/100 [01:35<05:32,  4.27s/it] 23%|██▎       | 23/100 [01:39<05:25,  4.22s/it] 24%|██▍       | 24/100 [01:43<05:23,  4.26s/it] 25%|██▌       | 25/100 [01:48<05:19,  4.25s/it] 26%|██▌       | 26/100 [01:52<05:21,  4.35s/it] 27%|██▋       | 27/100 [01:57<05:16,  4.34s/it] 28%|██▊       | 28/100 [02:01<05:12,  4.35s/it] 29%|██▉       | 29/100 [02:05<05:08,  4.34s/it] 30%|███       | 30/100 [02:10<05:01,  4.31s/it] 31%|███       | 31/100 [02:14<04:56,  4.30s/it] 32%|███▏      | 32/100 [02:18<04:58,  4.39s/it] 33%|███▎      | 33/100 [02:23<04:50,  4.34s/it] 34%|███▍      | 34/100 [02:27<04:48,  4.37s/it] 35%|███▌      | 35/100 [02:31<04:41,  4.33s/it] 36%|███▌      | 36/100 [02:36<04:38,  4.34s/it] 37%|███▋      | 37/100 [02:40<04:31,  4.31s/it] 38%|███▊      | 38/100 [02:44<04:27,  4.31s/it] 39%|███▉      | 39/100 [02:49<04:24,  4.34s/it] 40%|████      | 40/100 [02:53<04:21,  4.36s/it] 41%|████      | 41/100 [02:58<04:20,  4.42s/it] 42%|████▏     | 42/100 [03:02<04:14,  4.39s/it] 43%|████▎     | 43/100 [03:06<04:11,  4.41s/it] 44%|████▍     | 44/100 [03:11<04:14,  4.55s/it] 45%|████▌     | 45/100 [03:16<04:13,  4.62s/it] 46%|████▌     | 46/100 [03:21<04:07,  4.59s/it] 47%|████▋     | 47/100 [03:25<04:02,  4.58s/it] 48%|████▊     | 48/100 [03:30<03:56,  4.55s/it] 49%|████▉     | 49/100 [03:34<03:46,  4.45s/it] 50%|█████     | 50/100 [03:38<03:38,  4.37s/it] 51%|█████     | 51/100 [03:42<03:32,  4.34s/it] 52%|█████▏    | 52/100 [03:46<03:26,  4.30s/it] 53%|█████▎    | 53/100 [03:51<03:21,  4.29s/it] 54%|█████▍    | 54/100 [03:55<03:17,  4.30s/it] 55%|█████▌    | 55/100 [03:59<03:10,  4.24s/it] 56%|█████▌    | 56/100 [04:03<03:05,  4.21s/it] 57%|█████▋    | 57/100 [04:07<02:59,  4.17s/it] 58%|█████▊    | 58/100 [04:11<02:53,  4.14s/it] 59%|█████▉    | 59/100 [04:15<02:47,  4.09s/it] 60%|██████    | 60/100 [04:20<02:44,  4.12s/it] 61%|██████    | 61/100 [04:24<02:39,  4.08s/it] 62%|██████▏   | 62/100 [04:28<02:36,  4.11s/it] 63%|██████▎   | 63/100 [04:32<02:31,  4.10s/it] 64%|██████▍   | 64/100 [04:36<02:27,  4.10s/it] 65%|██████▌   | 65/100 [04:40<02:23,  4.11s/it] 66%|██████▌   | 66/100 [04:44<02:20,  4.13s/it] 67%|██████▋   | 67/100 [04:48<02:15,  4.11s/it] 68%|██████▊   | 68/100 [04:53<02:12,  4.13s/it] 69%|██████▉   | 69/100 [04:57<02:07,  4.10s/it] 70%|███████   | 70/100 [05:01<02:02,  4.10s/it] 71%|███████   | 71/100 [05:05<01:58,  4.08s/it] 72%|███████▏  | 72/100 [05:09<01:54,  4.08s/it] 73%|███████▎  | 73/100 [05:13<01:50,  4.08s/it] 74%|███████▍  | 74/100 [05:17<01:48,  4.18s/it] 75%|███████▌  | 75/100 [05:21<01:44,  4.17s/it] 76%|███████▌  | 76/100 [05:26<01:40,  4.18s/it] 77%|███████▋  | 77/100 [05:30<01:35,  4.16s/it] 78%|███████▊  | 78/100 [05:34<01:31,  4.17s/it] 79%|███████▉  | 79/100 [05:38<01:27,  4.16s/it] 80%|████████  | 80/100 [05:42<01:23,  4.20s/it] 81%|████████  | 81/100 [05:47<01:20,  4.24s/it] 82%|████████▏ | 82/100 [05:51<01:17,  4.30s/it] 83%|████████▎ | 83/100 [05:56<01:14,  4.37s/it] 84%|████████▍ | 84/100 [06:00<01:10,  4.43s/it] 85%|████████▌ | 85/100 [06:05<01:07,  4.49s/it] 86%|████████▌ | 86/100 [06:10<01:03,  4.54s/it] 87%|████████▋ | 87/100 [06:14<00:58,  4.48s/it] 88%|████████▊ | 88/100 [06:18<00:53,  4.44s/it] 89%|████████▉ | 89/100 [06:23<00:48,  4.42s/it] 90%|█████████ | 90/100 [06:27<00:44,  4.41s/it] 91%|█████████ | 91/100 [06:31<00:39,  4.37s/it] 92%|█████████▏| 92/100 [06:36<00:35,  4.39s/it] 93%|█████████▎| 93/100 [06:40<00:30,  4.37s/it] 94%|█████████▍| 94/100 [06:44<00:26,  4.35s/it] 95%|█████████▌| 95/100 [06:49<00:22,  4.43s/it] 96%|█████████▌| 96/100 [06:53<00:17,  4.44s/it] 97%|█████████▋| 97/100 [06:58<00:13,  4.46s/it] 98%|█████████▊| 98/100 [07:02<00:09,  4.50s/it] 99%|█████████▉| 99/100 [07:07<00:04,  4.43s/it]100%|██████████| 100/100 [07:11<00:00,  4.41s/it]100%|██████████| 100/100 [07:11<00:00,  4.32s/it]
[0/100] loss: 2.9833948612213135 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 0.7648107409477234
[1/100] loss: 2.1182167530059814 loss_joints: 1.8274402618408203 loss_collision: 0.0 loss_jerk: 0.06442569941282272 loss_floor_contact: 0.5686680674552917
[2/100] loss: 0.6364164352416992 loss_joints: 0.4412543773651123 loss_collision: 0.0 loss_jerk: 0.10676388442516327 loss_floor_contact: 0.3689713180065155
[3/100] loss: 0.044381894171237946 loss_joints: 0.0284125916659832 loss_collision: 0.0002590853546280414 loss_jerk: 0.08026476949453354 loss_floor_contact: 0.015833836048841476
[4/100] loss: 0.1362551599740982 loss_joints: 0.12837481498718262 loss_collision: 0.0 loss_jerk: 0.0788034200668335 loss_floor_contact: 0.0
[5/100] loss: 0.07406503707170486 loss_joints: 0.06588391214609146 loss_collision: 0.0 loss_jerk: 0.08181127160787582 loss_floor_contact: 0.0
[6/100] loss: 0.07662694156169891 loss_joints: 0.06919658184051514 loss_collision: 0.0004627658927347511 loss_jerk: 0.07384080439805984 loss_floor_contact: 0.0
[7/100] loss: 0.028809072449803352 loss_joints: 0.021937992423772812 loss_collision: 0.0 loss_jerk: 0.0687107965350151 loss_floor_contact: 0.0
[8/100] loss: 0.020720381289720535 loss_joints: 0.01414045225828886 loss_collision: 0.0 loss_jerk: 0.065799281001091 loss_floor_contact: 0.0
[9/100] loss: 0.022601770237088203 loss_joints: 0.01640891097486019 loss_collision: 0.0 loss_jerk: 0.061928585171699524 loss_floor_contact: 0.0
[10/100] loss: 0.012888827361166477 loss_joints: 0.0071446276269853115 loss_collision: 0.0 loss_jerk: 0.05744199827313423 loss_floor_contact: 0.0
[11/100] loss: 0.0074392277747392654 loss_joints: 0.001717236591503024 loss_collision: 0.0 loss_jerk: 0.057219911366701126 loss_floor_contact: 0.0
[12/100] loss: 0.017730586230754852 loss_joints: 0.012011205777525902 loss_collision: 0.0 loss_jerk: 0.05719379335641861 loss_floor_contact: 0.0
[13/100] loss: 0.017604980617761612 loss_joints: 0.011903604492545128 loss_collision: 0.0 loss_jerk: 0.057013753801584244 loss_floor_contact: 0.0
[14/100] loss: 0.008547437377274036 loss_joints: 0.0029837964102625847 loss_collision: 0.0 loss_jerk: 0.05563640967011452 loss_floor_contact: 0.0
[15/100] loss: 0.007189443800598383 loss_joints: 0.0016285581514239311 loss_collision: 0.0 loss_jerk: 0.05560885742306709 loss_floor_contact: 0.0
[16/100] loss: 0.008261945098638535 loss_joints: 0.002580419648438692 loss_collision: 0.0 loss_jerk: 0.056815255433321 loss_floor_contact: 0.0
[17/100] loss: 0.007923610508441925 loss_joints: 0.002308347262442112 loss_collision: 0.0 loss_jerk: 0.05615263059735298 loss_floor_contact: 0.0
[18/100] loss: 0.0071565499529242516 loss_joints: 0.0017066576983779669 loss_collision: 0.0 loss_jerk: 0.05449891835451126 loss_floor_contact: 0.0
[19/100] loss: 0.006268941797316074 loss_joints: 0.0008460527169518173 loss_collision: 0.0 loss_jerk: 0.05422889068722725 loss_floor_contact: 0.0
[20/100] loss: 0.009322726167738438 loss_joints: 0.0038260191213339567 loss_collision: 0.0 loss_jerk: 0.05496706813573837 loss_floor_contact: 0.0
[21/100] loss: 0.008012187667191029 loss_joints: 0.0026366354431957006 loss_collision: 0.0 loss_jerk: 0.05375552549958229 loss_floor_contact: 0.0
[22/100] loss: 0.005705792456865311 loss_joints: 0.00040638301288709044 loss_collision: 0.0 loss_jerk: 0.05299409478902817 loss_floor_contact: 0.0
[23/100] loss: 0.005673553328961134 loss_joints: 0.0004096576594747603 loss_collision: 0.0 loss_jerk: 0.0526389554142952 loss_floor_contact: 0.0
[24/100] loss: 0.006634600926190615 loss_joints: 0.0014427447458729148 loss_collision: 0.0 loss_jerk: 0.05191855877637863 loss_floor_contact: 0.0
[25/100] loss: 0.005886214319616556 loss_joints: 0.0007239718688651919 loss_collision: 0.0 loss_jerk: 0.0516224205493927 loss_floor_contact: 0.0
[26/100] loss: 0.006177582312375307 loss_joints: 0.0010181558318436146 loss_collision: 0.0 loss_jerk: 0.051594264805316925 loss_floor_contact: 0.0
[27/100] loss: 0.00614271080121398 loss_joints: 0.0011469428427517414 loss_collision: 0.0 loss_jerk: 0.049957677721977234 loss_floor_contact: 0.0
[28/100] loss: 0.005246066488325596 loss_joints: 0.00019162846729159355 loss_collision: 0.0 loss_jerk: 0.0505443774163723 loss_floor_contact: 0.0
[29/100] loss: 0.005162101238965988 loss_joints: 0.00015351205365732312 loss_collision: 0.0 loss_jerk: 0.0500858910381794 loss_floor_contact: 0.0
[30/100] loss: 0.005914208013564348 loss_joints: 0.0009923656471073627 loss_collision: 0.0 loss_jerk: 0.049218423664569855 loss_floor_contact: 0.0
[31/100] loss: 0.005436071194708347 loss_joints: 0.0006068495567888021 loss_collision: 0.0 loss_jerk: 0.04829221963882446 loss_floor_contact: 0.0
[32/100] loss: 0.0052088601514697075 loss_joints: 0.0003878422430716455 loss_collision: 0.0 loss_jerk: 0.048210177570581436 loss_floor_contact: 0.0
[33/100] loss: 0.005156060680747032 loss_joints: 0.00042569806100800633 loss_collision: 0.0 loss_jerk: 0.04730362445116043 loss_floor_contact: 0.0
[34/100] loss: 0.004880690015852451 loss_joints: 0.00023025425616651773 loss_collision: 0.0 loss_jerk: 0.04650435969233513 loss_floor_contact: 0.0
[35/100] loss: 0.004713912960141897 loss_joints: 0.00012008749763481319 loss_collision: 0.0 loss_jerk: 0.04593825340270996 loss_floor_contact: 0.0
[36/100] loss: 0.005233991425484419 loss_joints: 0.0006574728759005666 loss_collision: 0.0 loss_jerk: 0.04576518386602402 loss_floor_contact: 0.0
[37/100] loss: 0.005126435775309801 loss_joints: 0.0006165063823573291 loss_collision: 0.0 loss_jerk: 0.04509929567575455 loss_floor_contact: 0.0
[38/100] loss: 0.00438658194616437 loss_joints: 5.134680759510957e-05 loss_collision: 0.0 loss_jerk: 0.04335235431790352 loss_floor_contact: 0.0
[39/100] loss: 0.004285353235900402 loss_joints: 2.9198015909059905e-05 loss_collision: 0.0 loss_jerk: 0.04256155341863632 loss_floor_contact: 0.0
[40/100] loss: 0.004635872785001993 loss_joints: 0.0004154156777076423 loss_collision: 0.0 loss_jerk: 0.04220457375049591 loss_floor_contact: 0.0
[41/100] loss: 0.004344602581113577 loss_joints: 0.00018656560860108584 loss_collision: 0.0 loss_jerk: 0.04158036783337593 loss_floor_contact: 0.0
[42/100] loss: 0.004447896033525467 loss_joints: 0.00039427794399671257 loss_collision: 0.0 loss_jerk: 0.04053618013858795 loss_floor_contact: 0.0
[43/100] loss: 0.0045335497707128525 loss_joints: 0.0004888223484158516 loss_collision: 0.0 loss_jerk: 0.04044727236032486 loss_floor_contact: 0.0
[44/100] loss: 0.004026544280350208 loss_joints: 2.270929326186888e-05 loss_collision: 0.0 loss_jerk: 0.040038347244262695 loss_floor_contact: 0.0
[45/100] loss: 0.004105608910322189 loss_joints: 0.00014164010644890368 loss_collision: 0.0 loss_jerk: 0.039639685302972794 loss_floor_contact: 0.0
[46/100] loss: 0.00401891116052866 loss_joints: 8.416653145104647e-05 loss_collision: 0.0 loss_jerk: 0.03934744745492935 loss_floor_contact: 0.0
[47/100] loss: 0.00397831853479147 loss_joints: 8.001485548447818e-05 loss_collision: 0.0 loss_jerk: 0.03898303583264351 loss_floor_contact: 0.0
[48/100] loss: 0.003871156834065914 loss_joints: 1.1049081876990385e-05 loss_collision: 0.0 loss_jerk: 0.03860107809305191 loss_floor_contact: 0.0
[49/100] loss: 0.004217872396111488 loss_joints: 0.00037441946915350854 loss_collision: 0.0 loss_jerk: 0.038434527814388275 loss_floor_contact: 0.0
[50/100] loss: 0.004239410627633333 loss_joints: 0.0003999092732556164 loss_collision: 0.0 loss_jerk: 0.03839501366019249 loss_floor_contact: 0.0
[51/100] loss: 0.003892232896760106 loss_joints: 5.531248098122887e-05 loss_collision: 0.0 loss_jerk: 0.038369204849004745 loss_floor_contact: 0.0
[52/100] loss: 0.004117765463888645 loss_joints: 0.0003125669900327921 loss_collision: 0.0 loss_jerk: 0.03805198520421982 loss_floor_contact: 0.0
[53/100] loss: 0.004232179839164019 loss_joints: 0.00048733007861301303 loss_collision: 0.0 loss_jerk: 0.03744849935173988 loss_floor_contact: 0.0
[54/100] loss: 0.00380622292868793 loss_joints: 0.0001287411287194118 loss_collision: 0.0 loss_jerk: 0.03677481785416603 loss_floor_contact: 0.0
[55/100] loss: 0.0037186455447226763 loss_joints: 0.00014044390991330147 loss_collision: 0.0 loss_jerk: 0.035782016813755035 loss_floor_contact: 0.0
[56/100] loss: 0.003843466052785516 loss_joints: 0.00028620270313695073 loss_collision: 0.0 loss_jerk: 0.035572633147239685 loss_floor_contact: 0.0
[57/100] loss: 0.0035771564580500126 loss_joints: 4.6592613216489553e-05 loss_collision: 0.0 loss_jerk: 0.03530563786625862 loss_floor_contact: 0.0
[58/100] loss: 0.003670503618195653 loss_joints: 0.00018815950897987932 loss_collision: 0.0 loss_jerk: 0.03482344001531601 loss_floor_contact: 0.0
[59/100] loss: 0.003781953826546669 loss_joints: 0.0003426614566706121 loss_collision: 0.0 loss_jerk: 0.03439292311668396 loss_floor_contact: 0.0
[60/100] loss: 0.003512684488669038 loss_joints: 0.0001069366917363368 loss_collision: 0.0 loss_jerk: 0.03405747562646866 loss_floor_contact: 0.0
[61/100] loss: 0.00348571315407753 loss_joints: 8.229167724493891e-05 loss_collision: 0.0 loss_jerk: 0.03403421491384506 loss_floor_contact: 0.0
[62/100] loss: 0.0036133897956460714 loss_joints: 0.00021018320694565773 loss_collision: 0.0 loss_jerk: 0.03403206542134285 loss_floor_contact: 0.0
[63/100] loss: 0.0034355176612734795 loss_joints: 8.464990969514474e-05 loss_collision: 0.0 loss_jerk: 0.033508677035570145 loss_floor_contact: 0.0
[64/100] loss: 0.0033828828018158674 loss_joints: 7.000441837590188e-05 loss_collision: 0.0 loss_jerk: 0.033128783106803894 loss_floor_contact: 0.0
[65/100] loss: 0.003484874265268445 loss_joints: 0.00018909054051619023 loss_collision: 0.0 loss_jerk: 0.032957836985588074 loss_floor_contact: 0.0
[66/100] loss: 0.0033682133071124554 loss_joints: 9.556920122122392e-05 loss_collision: 0.0 loss_jerk: 0.03272644057869911 loss_floor_contact: 0.0
[67/100] loss: 0.0033035294618457556 loss_joints: 3.569485852494836e-05 loss_collision: 0.0 loss_jerk: 0.03267834708094597 loss_floor_contact: 0.0
[68/100] loss: 0.0033053169026970863 loss_joints: 0.0001105290575651452 loss_collision: 0.0 loss_jerk: 0.03194787725806236 loss_floor_contact: 0.0
[69/100] loss: 0.0032743513584136963 loss_joints: 7.74824438849464e-05 loss_collision: 0.0 loss_jerk: 0.03196868672966957 loss_floor_contact: 0.0
[70/100] loss: 0.0031451249960809946 loss_joints: 4.317903858463978e-06 loss_collision: 0.0 loss_jerk: 0.031408071517944336 loss_floor_contact: 0.0
[71/100] loss: 0.0031552081927657127 loss_joints: 3.533150447765365e-05 loss_collision: 0.0 loss_jerk: 0.031198766082525253 loss_floor_contact: 0.0
[72/100] loss: 0.00311629893258214 loss_joints: 9.41445159696741e-06 loss_collision: 0.0 loss_jerk: 0.031068844720721245 loss_floor_contact: 0.0
[73/100] loss: 0.0030813838820904493 loss_joints: 3.0534632969647646e-05 loss_collision: 0.0 loss_jerk: 0.03050849214196205 loss_floor_contact: 0.0
[74/100] loss: 0.0030619152821600437 loss_joints: 2.220070018665865e-05 loss_collision: 0.0 loss_jerk: 0.030397146940231323 loss_floor_contact: 0.0
[75/100] loss: 0.00300708063878119 loss_joints: 1.1135822205687873e-05 loss_collision: 0.0 loss_jerk: 0.02995944768190384 loss_floor_contact: 0.0
[76/100] loss: 0.0030358179938048124 loss_joints: 5.07315962749999e-05 loss_collision: 0.0 loss_jerk: 0.02985086292028427 loss_floor_contact: 0.0
[77/100] loss: 0.002983349608257413 loss_joints: 2.7937159757129848e-05 loss_collision: 0.0 loss_jerk: 0.029554124921560287 loss_floor_contact: 0.0
[78/100] loss: 0.00293719838373363 loss_joints: 1.6471396520501003e-05 loss_collision: 0.0 loss_jerk: 0.029207270592451096 loss_floor_contact: 0.0
[79/100] loss: 0.002913343720138073 loss_joints: 1.7274433048442006e-05 loss_collision: 0.0 loss_jerk: 0.028960691764950752 loss_floor_contact: 0.0
[80/100] loss: 0.0028793984092772007 loss_joints: 7.211935553641524e-06 loss_collision: 0.0 loss_jerk: 0.02872186340391636 loss_floor_contact: 0.0
[81/100] loss: 0.002882753498852253 loss_joints: 1.8185215594712645e-05 loss_collision: 0.0 loss_jerk: 0.028645683079957962 loss_floor_contact: 0.0
[82/100] loss: 0.0028557113837450743 loss_joints: 1.753460855979938e-05 loss_collision: 0.0 loss_jerk: 0.028381766751408577 loss_floor_contact: 0.0
[83/100] loss: 0.0028197590727359056 loss_joints: 1.901611904031597e-05 loss_collision: 0.0 loss_jerk: 0.028007427230477333 loss_floor_contact: 0.0
[84/100] loss: 0.002800782211124897 loss_joints: 1.1903553968295455e-05 loss_collision: 0.0 loss_jerk: 0.027888787910342216 loss_floor_contact: 0.0
[85/100] loss: 0.002818669192492962 loss_joints: 2.425099773972761e-05 loss_collision: 0.0 loss_jerk: 0.027944182977080345 loss_floor_contact: 0.0
[86/100] loss: 0.002778668189421296 loss_joints: 6.649878741882276e-06 loss_collision: 0.0 loss_jerk: 0.02772018313407898 loss_floor_contact: 0.0
[87/100] loss: 0.002759129274636507 loss_joints: 1.4521217963192612e-05 loss_collision: 0.0 loss_jerk: 0.02744607999920845 loss_floor_contact: 0.0
[88/100] loss: 0.002767265308648348 loss_joints: 1.9198623704141937e-05 loss_collision: 0.0 loss_jerk: 0.02748066745698452 loss_floor_contact: 0.0
[89/100] loss: 0.0027295327745378017 loss_joints: 3.050340410482022e-06 loss_collision: 0.0 loss_jerk: 0.027264824137091637 loss_floor_contact: 0.0
[90/100] loss: 0.0027248351834714413 loss_joints: 7.036276201688452e-06 loss_collision: 0.0 loss_jerk: 0.02717798762023449 loss_floor_contact: 0.0
[91/100] loss: 0.002715729409828782 loss_joints: 1.0998974175890908e-05 loss_collision: 0.0 loss_jerk: 0.027047304436564445 loss_floor_contact: 0.0
[92/100] loss: 0.0026927811559289694 loss_joints: 5.586461156781297e-06 loss_collision: 0.0 loss_jerk: 0.026871945708990097 loss_floor_contact: 0.0
[93/100] loss: 0.0026763114146888256 loss_joints: 9.347685363536584e-07 loss_collision: 0.0 loss_jerk: 0.02675376459956169 loss_floor_contact: 0.0
[94/100] loss: 0.0026620186399668455 loss_joints: 2.596620106487535e-06 loss_collision: 0.0 loss_jerk: 0.026594221591949463 loss_floor_contact: 0.0
[95/100] loss: 0.0026508476585149765 loss_joints: 8.987480555333605e-07 loss_collision: 0.0 loss_jerk: 0.026499489322304726 loss_floor_contact: 0.0
[96/100] loss: 0.002656995551660657 loss_joints: 2.458253902659635e-07 loss_collision: 0.0 loss_jerk: 0.026567496359348297 loss_floor_contact: 0.0
[97/100] loss: 0.002655308460816741 loss_joints: 5.960182534181513e-07 loss_collision: 0.0 loss_jerk: 0.026547124609351158 loss_floor_contact: 0.0
[98/100] loss: 0.00264730560593307 loss_joints: 2.9606135854010063e-07 loss_collision: 0.0 loss_jerk: 0.026470094919204712 loss_floor_contact: 0.0
[99/100] loss: 0.002638323465362191 loss_joints: 4.4577705970993975e-09 loss_collision: 0.0 loss_jerk: 0.026383189484477043 loss_floor_contact: 0.0
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.25/contact_thresh_0.75/cabE-path3-run12-4000_collision0.1_contact0.5_jerk0.1_skate0.5]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 431.60402                                                    ║
    ║     rollout = 201.09166                                                    ║
    ║     sdf     = 19.19642                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00263832                                                 ║
    ║     joints    = 0.00000000                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.02638319                                                 ║
    ║     floor     = 0.00000000                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	7m30.969s
user	6m45.163s
sys	0m18.261s
[INFO] Running with collision=0.1, contact=0.5, jerk=0.1, skate=1.0
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<07:36,  4.61s/it]  2%|▏         | 2/100 [00:09<07:22,  4.52s/it]  3%|▎         | 3/100 [00:14<07:43,  4.78s/it]  4%|▍         | 4/100 [00:18<07:22,  4.61s/it]  5%|▌         | 5/100 [00:23<07:15,  4.58s/it]  6%|▌         | 6/100 [00:27<07:03,  4.50s/it]  7%|▋         | 7/100 [00:31<06:55,  4.47s/it]  8%|▊         | 8/100 [00:36<06:45,  4.41s/it]  9%|▉         | 9/100 [00:40<06:34,  4.33s/it] 10%|█         | 10/100 [00:44<06:26,  4.29s/it] 11%|█         | 11/100 [00:48<06:25,  4.33s/it] 12%|█▏        | 12/100 [00:53<06:20,  4.33s/it] 13%|█▎        | 13/100 [00:57<06:21,  4.39s/it] 14%|█▍        | 14/100 [01:02<06:27,  4.50s/it] 15%|█▌        | 15/100 [01:06<06:18,  4.46s/it] 16%|█▌        | 16/100 [01:11<06:15,  4.48s/it] 17%|█▋        | 17/100 [01:15<06:13,  4.50s/it] 18%|█▊        | 18/100 [01:20<06:18,  4.61s/it] 19%|█▉        | 19/100 [01:25<06:10,  4.58s/it] 20%|██        | 20/100 [01:29<06:08,  4.61s/it] 21%|██        | 21/100 [01:34<06:04,  4.62s/it] 22%|██▏       | 22/100 [01:39<05:59,  4.61s/it] 23%|██▎       | 23/100 [01:43<05:49,  4.54s/it] 24%|██▍       | 24/100 [01:47<05:42,  4.51s/it] 25%|██▌       | 25/100 [01:52<05:33,  4.45s/it] 26%|██▌       | 26/100 [01:56<05:31,  4.48s/it] 27%|██▋       | 27/100 [02:01<05:26,  4.47s/it] 28%|██▊       | 28/100 [02:05<05:22,  4.48s/it] 29%|██▉       | 29/100 [02:10<05:16,  4.45s/it] 30%|███       | 30/100 [02:14<05:10,  4.43s/it] 31%|███       | 31/100 [02:19<05:11,  4.52s/it] 32%|███▏      | 32/100 [02:24<05:13,  4.61s/it] 33%|███▎      | 33/100 [02:28<05:10,  4.64s/it] 34%|███▍      | 34/100 [02:33<05:14,  4.76s/it] 35%|███▌      | 35/100 [02:38<05:06,  4.71s/it] 36%|███▌      | 36/100 [02:42<04:56,  4.64s/it] 37%|███▋      | 37/100 [02:47<04:46,  4.55s/it] 38%|███▊      | 38/100 [02:51<04:39,  4.51s/it] 39%|███▉      | 39/100 [02:56<04:33,  4.49s/it] 40%|████      | 40/100 [03:00<04:31,  4.52s/it] 41%|████      | 41/100 [03:05<04:24,  4.48s/it] 42%|████▏     | 42/100 [03:09<04:18,  4.45s/it] 43%|████▎     | 43/100 [03:13<04:11,  4.41s/it] 44%|████▍     | 44/100 [03:18<04:08,  4.43s/it] 45%|████▌     | 45/100 [03:22<04:04,  4.44s/it] 46%|████▌     | 46/100 [03:27<03:59,  4.44s/it] 47%|████▋     | 47/100 [03:31<03:57,  4.48s/it] 48%|████▊     | 48/100 [03:36<03:53,  4.48s/it] 49%|████▉     | 49/100 [03:40<03:47,  4.47s/it] 50%|█████     | 50/100 [03:45<03:41,  4.44s/it] 51%|█████     | 51/100 [03:49<03:35,  4.41s/it] 52%|█████▏    | 52/100 [03:53<03:31,  4.42s/it] 53%|█████▎    | 53/100 [03:58<03:30,  4.49s/it] 54%|█████▍    | 54/100 [04:02<03:26,  4.49s/it] 55%|█████▌    | 55/100 [04:07<03:21,  4.47s/it] 56%|█████▌    | 56/100 [04:11<03:17,  4.48s/it] 57%|█████▋    | 57/100 [04:16<03:13,  4.50s/it] 58%|█████▊    | 58/100 [04:20<03:06,  4.45s/it] 59%|█████▉    | 59/100 [04:25<03:03,  4.48s/it] 60%|██████    | 60/100 [04:29<02:58,  4.47s/it] 61%|██████    | 61/100 [04:34<02:52,  4.43s/it] 62%|██████▏   | 62/100 [04:38<02:47,  4.41s/it] 63%|██████▎   | 63/100 [04:42<02:44,  4.44s/it] 64%|██████▍   | 64/100 [04:47<02:40,  4.45s/it] 65%|██████▌   | 65/100 [04:51<02:35,  4.44s/it] 66%|██████▌   | 66/100 [04:56<02:32,  4.47s/it] 67%|██████▋   | 67/100 [05:00<02:26,  4.43s/it] 68%|██████▊   | 68/100 [05:05<02:21,  4.42s/it] 69%|██████▉   | 69/100 [05:09<02:17,  4.43s/it] 70%|███████   | 70/100 [05:13<02:11,  4.39s/it] 71%|███████   | 71/100 [05:18<02:08,  4.42s/it] 72%|███████▏  | 72/100 [05:22<02:03,  4.43s/it] 73%|███████▎  | 73/100 [05:27<01:59,  4.42s/it] 74%|███████▍  | 74/100 [05:31<01:55,  4.44s/it] 75%|███████▌  | 75/100 [05:36<01:51,  4.48s/it] 76%|███████▌  | 76/100 [05:40<01:46,  4.45s/it] 77%|███████▋  | 77/100 [05:45<01:43,  4.51s/it] 78%|███████▊  | 78/100 [05:49<01:37,  4.45s/it] 79%|███████▉  | 79/100 [05:54<01:33,  4.43s/it] 80%|████████  | 80/100 [05:58<01:27,  4.38s/it] 81%|████████  | 81/100 [06:02<01:23,  4.42s/it] 82%|████████▏ | 82/100 [06:07<01:19,  4.40s/it] 83%|████████▎ | 83/100 [06:11<01:14,  4.40s/it] 84%|████████▍ | 84/100 [06:16<01:11,  4.47s/it] 85%|████████▌ | 85/100 [06:20<01:06,  4.45s/it] 86%|████████▌ | 86/100 [06:25<01:02,  4.46s/it] 87%|████████▋ | 87/100 [06:29<00:58,  4.46s/it] 88%|████████▊ | 88/100 [06:33<00:53,  4.46s/it] 89%|████████▉ | 89/100 [06:38<00:49,  4.46s/it] 90%|█████████ | 90/100 [06:42<00:44,  4.46s/it] 91%|█████████ | 91/100 [06:47<00:39,  4.42s/it] 92%|█████████▏| 92/100 [06:51<00:34,  4.37s/it] 93%|█████████▎| 93/100 [06:55<00:30,  4.39s/it] 94%|█████████▍| 94/100 [07:00<00:26,  4.38s/it] 95%|█████████▌| 95/100 [07:04<00:22,  4.46s/it] 96%|█████████▌| 96/100 [07:09<00:18,  4.53s/it] 97%|█████████▋| 97/100 [07:14<00:13,  4.55s/it] 98%|█████████▊| 98/100 [07:18<00:08,  4.49s/it] 99%|█████████▉| 99/100 [07:22<00:04,  4.46s/it]100%|██████████| 100/100 [07:27<00:00,  4.43s/it]100%|██████████| 100/100 [07:27<00:00,  4.47s/it]
[0/100] loss: 2.9833948612213135 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 0.7648107409477234
[1/100] loss: 2.1182167530059814 loss_joints: 1.8274402618408203 loss_collision: 0.0 loss_jerk: 0.06442569941282272 loss_floor_contact: 0.5686680674552917
[2/100] loss: 0.6364164352416992 loss_joints: 0.4412543773651123 loss_collision: 0.0 loss_jerk: 0.10676388442516327 loss_floor_contact: 0.3689713180065155
[3/100] loss: 0.044381894171237946 loss_joints: 0.0284125916659832 loss_collision: 0.0002590853546280414 loss_jerk: 0.08026476949453354 loss_floor_contact: 0.015833836048841476
[4/100] loss: 0.1362551599740982 loss_joints: 0.12837481498718262 loss_collision: 0.0 loss_jerk: 0.0788034200668335 loss_floor_contact: 0.0
[5/100] loss: 0.07406503707170486 loss_joints: 0.06588391214609146 loss_collision: 0.0 loss_jerk: 0.08181127160787582 loss_floor_contact: 0.0
[6/100] loss: 0.07662694156169891 loss_joints: 0.06919658184051514 loss_collision: 0.0004627658927347511 loss_jerk: 0.07384080439805984 loss_floor_contact: 0.0
[7/100] loss: 0.028809072449803352 loss_joints: 0.021937992423772812 loss_collision: 0.0 loss_jerk: 0.0687107965350151 loss_floor_contact: 0.0
[8/100] loss: 0.020720381289720535 loss_joints: 0.01414045225828886 loss_collision: 0.0 loss_jerk: 0.065799281001091 loss_floor_contact: 0.0
[9/100] loss: 0.022601770237088203 loss_joints: 0.01640891097486019 loss_collision: 0.0 loss_jerk: 0.061928585171699524 loss_floor_contact: 0.0
[10/100] loss: 0.012888827361166477 loss_joints: 0.0071446276269853115 loss_collision: 0.0 loss_jerk: 0.05744199827313423 loss_floor_contact: 0.0
[11/100] loss: 0.0074392277747392654 loss_joints: 0.001717236591503024 loss_collision: 0.0 loss_jerk: 0.057219911366701126 loss_floor_contact: 0.0
[12/100] loss: 0.017730586230754852 loss_joints: 0.012011205777525902 loss_collision: 0.0 loss_jerk: 0.05719379335641861 loss_floor_contact: 0.0
[13/100] loss: 0.017604980617761612 loss_joints: 0.011903604492545128 loss_collision: 0.0 loss_jerk: 0.057013753801584244 loss_floor_contact: 0.0
[14/100] loss: 0.008547437377274036 loss_joints: 0.0029837964102625847 loss_collision: 0.0 loss_jerk: 0.05563640967011452 loss_floor_contact: 0.0
[15/100] loss: 0.007189443800598383 loss_joints: 0.0016285581514239311 loss_collision: 0.0 loss_jerk: 0.05560885742306709 loss_floor_contact: 0.0
[16/100] loss: 0.008261945098638535 loss_joints: 0.002580419648438692 loss_collision: 0.0 loss_jerk: 0.056815255433321 loss_floor_contact: 0.0
[17/100] loss: 0.007923610508441925 loss_joints: 0.002308347262442112 loss_collision: 0.0 loss_jerk: 0.05615263059735298 loss_floor_contact: 0.0
[18/100] loss: 0.0071565499529242516 loss_joints: 0.0017066576983779669 loss_collision: 0.0 loss_jerk: 0.05449891835451126 loss_floor_contact: 0.0
[19/100] loss: 0.006268941797316074 loss_joints: 0.0008460527169518173 loss_collision: 0.0 loss_jerk: 0.05422889068722725 loss_floor_contact: 0.0
[20/100] loss: 0.009322726167738438 loss_joints: 0.0038260191213339567 loss_collision: 0.0 loss_jerk: 0.05496706813573837 loss_floor_contact: 0.0
[21/100] loss: 0.008012187667191029 loss_joints: 0.0026366354431957006 loss_collision: 0.0 loss_jerk: 0.05375552549958229 loss_floor_contact: 0.0
[22/100] loss: 0.005705792456865311 loss_joints: 0.00040638301288709044 loss_collision: 0.0 loss_jerk: 0.05299409478902817 loss_floor_contact: 0.0
[23/100] loss: 0.005673553328961134 loss_joints: 0.0004096576594747603 loss_collision: 0.0 loss_jerk: 0.0526389554142952 loss_floor_contact: 0.0
[24/100] loss: 0.006634600926190615 loss_joints: 0.0014427447458729148 loss_collision: 0.0 loss_jerk: 0.05191855877637863 loss_floor_contact: 0.0
[25/100] loss: 0.005886214319616556 loss_joints: 0.0007239718688651919 loss_collision: 0.0 loss_jerk: 0.0516224205493927 loss_floor_contact: 0.0
[26/100] loss: 0.006177582312375307 loss_joints: 0.0010181558318436146 loss_collision: 0.0 loss_jerk: 0.051594264805316925 loss_floor_contact: 0.0
[27/100] loss: 0.00614271080121398 loss_joints: 0.0011469428427517414 loss_collision: 0.0 loss_jerk: 0.049957677721977234 loss_floor_contact: 0.0
[28/100] loss: 0.005246066488325596 loss_joints: 0.00019162846729159355 loss_collision: 0.0 loss_jerk: 0.0505443774163723 loss_floor_contact: 0.0
[29/100] loss: 0.005162101238965988 loss_joints: 0.00015351205365732312 loss_collision: 0.0 loss_jerk: 0.0500858910381794 loss_floor_contact: 0.0
[30/100] loss: 0.005914208013564348 loss_joints: 0.0009923656471073627 loss_collision: 0.0 loss_jerk: 0.049218423664569855 loss_floor_contact: 0.0
[31/100] loss: 0.005436071194708347 loss_joints: 0.0006068495567888021 loss_collision: 0.0 loss_jerk: 0.04829221963882446 loss_floor_contact: 0.0
[32/100] loss: 0.0052088601514697075 loss_joints: 0.0003878422430716455 loss_collision: 0.0 loss_jerk: 0.048210177570581436 loss_floor_contact: 0.0
[33/100] loss: 0.005156060680747032 loss_joints: 0.00042569806100800633 loss_collision: 0.0 loss_jerk: 0.04730362445116043 loss_floor_contact: 0.0
[34/100] loss: 0.004880690015852451 loss_joints: 0.00023025425616651773 loss_collision: 0.0 loss_jerk: 0.04650435969233513 loss_floor_contact: 0.0
[35/100] loss: 0.004713912960141897 loss_joints: 0.00012008749763481319 loss_collision: 0.0 loss_jerk: 0.04593825340270996 loss_floor_contact: 0.0
[36/100] loss: 0.005233991425484419 loss_joints: 0.0006574728759005666 loss_collision: 0.0 loss_jerk: 0.04576518386602402 loss_floor_contact: 0.0
[37/100] loss: 0.005126435775309801 loss_joints: 0.0006165063823573291 loss_collision: 0.0 loss_jerk: 0.04509929567575455 loss_floor_contact: 0.0
[38/100] loss: 0.00438658194616437 loss_joints: 5.134680759510957e-05 loss_collision: 0.0 loss_jerk: 0.04335235431790352 loss_floor_contact: 0.0
[39/100] loss: 0.004285353235900402 loss_joints: 2.9198015909059905e-05 loss_collision: 0.0 loss_jerk: 0.04256155341863632 loss_floor_contact: 0.0
[40/100] loss: 0.004635872785001993 loss_joints: 0.0004154156777076423 loss_collision: 0.0 loss_jerk: 0.04220457375049591 loss_floor_contact: 0.0
[41/100] loss: 0.004344602581113577 loss_joints: 0.00018656560860108584 loss_collision: 0.0 loss_jerk: 0.04158036783337593 loss_floor_contact: 0.0
[42/100] loss: 0.004447896033525467 loss_joints: 0.00039427794399671257 loss_collision: 0.0 loss_jerk: 0.04053618013858795 loss_floor_contact: 0.0
[43/100] loss: 0.0045335497707128525 loss_joints: 0.0004888223484158516 loss_collision: 0.0 loss_jerk: 0.04044727236032486 loss_floor_contact: 0.0
[44/100] loss: 0.004026544280350208 loss_joints: 2.270929326186888e-05 loss_collision: 0.0 loss_jerk: 0.040038347244262695 loss_floor_contact: 0.0
[45/100] loss: 0.004105608910322189 loss_joints: 0.00014164010644890368 loss_collision: 0.0 loss_jerk: 0.039639685302972794 loss_floor_contact: 0.0
[46/100] loss: 0.00401891116052866 loss_joints: 8.416653145104647e-05 loss_collision: 0.0 loss_jerk: 0.03934744745492935 loss_floor_contact: 0.0
[47/100] loss: 0.00397831853479147 loss_joints: 8.001485548447818e-05 loss_collision: 0.0 loss_jerk: 0.03898303583264351 loss_floor_contact: 0.0
[48/100] loss: 0.003871156834065914 loss_joints: 1.1049081876990385e-05 loss_collision: 0.0 loss_jerk: 0.03860107809305191 loss_floor_contact: 0.0
[49/100] loss: 0.004217872396111488 loss_joints: 0.00037441946915350854 loss_collision: 0.0 loss_jerk: 0.038434527814388275 loss_floor_contact: 0.0
[50/100] loss: 0.004239410627633333 loss_joints: 0.0003999092732556164 loss_collision: 0.0 loss_jerk: 0.03839501366019249 loss_floor_contact: 0.0
[51/100] loss: 0.003892232896760106 loss_joints: 5.531248098122887e-05 loss_collision: 0.0 loss_jerk: 0.038369204849004745 loss_floor_contact: 0.0
[52/100] loss: 0.004117765463888645 loss_joints: 0.0003125669900327921 loss_collision: 0.0 loss_jerk: 0.03805198520421982 loss_floor_contact: 0.0
[53/100] loss: 0.004232179839164019 loss_joints: 0.00048733007861301303 loss_collision: 0.0 loss_jerk: 0.03744849935173988 loss_floor_contact: 0.0
[54/100] loss: 0.00380622292868793 loss_joints: 0.0001287411287194118 loss_collision: 0.0 loss_jerk: 0.03677481785416603 loss_floor_contact: 0.0
[55/100] loss: 0.0037186455447226763 loss_joints: 0.00014044390991330147 loss_collision: 0.0 loss_jerk: 0.035782016813755035 loss_floor_contact: 0.0
[56/100] loss: 0.003843466052785516 loss_joints: 0.00028620270313695073 loss_collision: 0.0 loss_jerk: 0.035572633147239685 loss_floor_contact: 0.0
[57/100] loss: 0.0035771564580500126 loss_joints: 4.6592613216489553e-05 loss_collision: 0.0 loss_jerk: 0.03530563786625862 loss_floor_contact: 0.0
[58/100] loss: 0.003670503618195653 loss_joints: 0.00018815950897987932 loss_collision: 0.0 loss_jerk: 0.03482344001531601 loss_floor_contact: 0.0
[59/100] loss: 0.003781953826546669 loss_joints: 0.0003426614566706121 loss_collision: 0.0 loss_jerk: 0.03439292311668396 loss_floor_contact: 0.0
[60/100] loss: 0.003512684488669038 loss_joints: 0.0001069366917363368 loss_collision: 0.0 loss_jerk: 0.03405747562646866 loss_floor_contact: 0.0
[61/100] loss: 0.00348571315407753 loss_joints: 8.229167724493891e-05 loss_collision: 0.0 loss_jerk: 0.03403421491384506 loss_floor_contact: 0.0
[62/100] loss: 0.0036133897956460714 loss_joints: 0.00021018320694565773 loss_collision: 0.0 loss_jerk: 0.03403206542134285 loss_floor_contact: 0.0
[63/100] loss: 0.0034355176612734795 loss_joints: 8.464990969514474e-05 loss_collision: 0.0 loss_jerk: 0.033508677035570145 loss_floor_contact: 0.0
[64/100] loss: 0.0033828828018158674 loss_joints: 7.000441837590188e-05 loss_collision: 0.0 loss_jerk: 0.033128783106803894 loss_floor_contact: 0.0
[65/100] loss: 0.003484874265268445 loss_joints: 0.00018909054051619023 loss_collision: 0.0 loss_jerk: 0.032957836985588074 loss_floor_contact: 0.0
[66/100] loss: 0.0033682133071124554 loss_joints: 9.556920122122392e-05 loss_collision: 0.0 loss_jerk: 0.03272644057869911 loss_floor_contact: 0.0
[67/100] loss: 0.0033035294618457556 loss_joints: 3.569485852494836e-05 loss_collision: 0.0 loss_jerk: 0.03267834708094597 loss_floor_contact: 0.0
[68/100] loss: 0.0033053169026970863 loss_joints: 0.0001105290575651452 loss_collision: 0.0 loss_jerk: 0.03194787725806236 loss_floor_contact: 0.0
[69/100] loss: 0.0032743513584136963 loss_joints: 7.74824438849464e-05 loss_collision: 0.0 loss_jerk: 0.03196868672966957 loss_floor_contact: 0.0
[70/100] loss: 0.0031451249960809946 loss_joints: 4.317903858463978e-06 loss_collision: 0.0 loss_jerk: 0.031408071517944336 loss_floor_contact: 0.0
[71/100] loss: 0.0031552081927657127 loss_joints: 3.533150447765365e-05 loss_collision: 0.0 loss_jerk: 0.031198766082525253 loss_floor_contact: 0.0
[72/100] loss: 0.00311629893258214 loss_joints: 9.41445159696741e-06 loss_collision: 0.0 loss_jerk: 0.031068844720721245 loss_floor_contact: 0.0
[73/100] loss: 0.0030813838820904493 loss_joints: 3.0534632969647646e-05 loss_collision: 0.0 loss_jerk: 0.03050849214196205 loss_floor_contact: 0.0
[74/100] loss: 0.0030619152821600437 loss_joints: 2.220070018665865e-05 loss_collision: 0.0 loss_jerk: 0.030397146940231323 loss_floor_contact: 0.0
[75/100] loss: 0.00300708063878119 loss_joints: 1.1135822205687873e-05 loss_collision: 0.0 loss_jerk: 0.02995944768190384 loss_floor_contact: 0.0
[76/100] loss: 0.0030358179938048124 loss_joints: 5.07315962749999e-05 loss_collision: 0.0 loss_jerk: 0.02985086292028427 loss_floor_contact: 0.0
[77/100] loss: 0.002983349608257413 loss_joints: 2.7937159757129848e-05 loss_collision: 0.0 loss_jerk: 0.029554124921560287 loss_floor_contact: 0.0
[78/100] loss: 0.00293719838373363 loss_joints: 1.6471396520501003e-05 loss_collision: 0.0 loss_jerk: 0.029207270592451096 loss_floor_contact: 0.0
[79/100] loss: 0.002913343720138073 loss_joints: 1.7274433048442006e-05 loss_collision: 0.0 loss_jerk: 0.028960691764950752 loss_floor_contact: 0.0
[80/100] loss: 0.0028793984092772007 loss_joints: 7.211935553641524e-06 loss_collision: 0.0 loss_jerk: 0.02872186340391636 loss_floor_contact: 0.0
[81/100] loss: 0.002882753498852253 loss_joints: 1.8185215594712645e-05 loss_collision: 0.0 loss_jerk: 0.028645683079957962 loss_floor_contact: 0.0
[82/100] loss: 0.0028557113837450743 loss_joints: 1.753460855979938e-05 loss_collision: 0.0 loss_jerk: 0.028381766751408577 loss_floor_contact: 0.0
[83/100] loss: 0.0028197590727359056 loss_joints: 1.901611904031597e-05 loss_collision: 0.0 loss_jerk: 0.028007427230477333 loss_floor_contact: 0.0
[84/100] loss: 0.002800782211124897 loss_joints: 1.1903553968295455e-05 loss_collision: 0.0 loss_jerk: 0.027888787910342216 loss_floor_contact: 0.0
[85/100] loss: 0.002818669192492962 loss_joints: 2.425099773972761e-05 loss_collision: 0.0 loss_jerk: 0.027944182977080345 loss_floor_contact: 0.0
[86/100] loss: 0.002778668189421296 loss_joints: 6.649878741882276e-06 loss_collision: 0.0 loss_jerk: 0.02772018313407898 loss_floor_contact: 0.0
[87/100] loss: 0.002759129274636507 loss_joints: 1.4521217963192612e-05 loss_collision: 0.0 loss_jerk: 0.02744607999920845 loss_floor_contact: 0.0
[88/100] loss: 0.002767265308648348 loss_joints: 1.9198623704141937e-05 loss_collision: 0.0 loss_jerk: 0.02748066745698452 loss_floor_contact: 0.0
[89/100] loss: 0.0027295327745378017 loss_joints: 3.050340410482022e-06 loss_collision: 0.0 loss_jerk: 0.027264824137091637 loss_floor_contact: 0.0
[90/100] loss: 0.0027248351834714413 loss_joints: 7.036276201688452e-06 loss_collision: 0.0 loss_jerk: 0.02717798762023449 loss_floor_contact: 0.0
[91/100] loss: 0.002715729409828782 loss_joints: 1.0998974175890908e-05 loss_collision: 0.0 loss_jerk: 0.027047304436564445 loss_floor_contact: 0.0
[92/100] loss: 0.0026927811559289694 loss_joints: 5.586461156781297e-06 loss_collision: 0.0 loss_jerk: 0.026871945708990097 loss_floor_contact: 0.0
[93/100] loss: 0.0026763114146888256 loss_joints: 9.347685363536584e-07 loss_collision: 0.0 loss_jerk: 0.02675376459956169 loss_floor_contact: 0.0
[94/100] loss: 0.0026620186399668455 loss_joints: 2.596620106487535e-06 loss_collision: 0.0 loss_jerk: 0.026594221591949463 loss_floor_contact: 0.0
[95/100] loss: 0.0026508476585149765 loss_joints: 8.987480555333605e-07 loss_collision: 0.0 loss_jerk: 0.026499489322304726 loss_floor_contact: 0.0
[96/100] loss: 0.002656995551660657 loss_joints: 2.458253902659635e-07 loss_collision: 0.0 loss_jerk: 0.026567496359348297 loss_floor_contact: 0.0
[97/100] loss: 0.002655308460816741 loss_joints: 5.960182534181513e-07 loss_collision: 0.0 loss_jerk: 0.026547124609351158 loss_floor_contact: 0.0
[98/100] loss: 0.00264730560593307 loss_joints: 2.9606135854010063e-07 loss_collision: 0.0 loss_jerk: 0.026470094919204712 loss_floor_contact: 0.0
[99/100] loss: 0.002638323465362191 loss_joints: 4.4577705970993975e-09 loss_collision: 0.0 loss_jerk: 0.026383189484477043 loss_floor_contact: 0.0
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.25/contact_thresh_0.75/cabE-path3-run12-4000_collision0.1_contact0.5_jerk0.1_skate1.0]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 447.29801                                                    ║
    ║     rollout = 207.02741                                                    ║
    ║     sdf     = 20.57199                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00263832                                                 ║
    ║     joints    = 0.00000000                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.02638319                                                 ║
    ║     floor     = 0.00000000                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	7m46.152s
user	6m54.003s
sys	0m17.665s
[INFO] Running with collision=0.1, contact=0.5, jerk=0.5, skate=0.1
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<06:49,  4.14s/it]  2%|▏         | 2/100 [00:08<06:48,  4.17s/it]  3%|▎         | 3/100 [00:13<07:11,  4.45s/it]  4%|▍         | 4/100 [00:17<06:53,  4.30s/it]  5%|▌         | 5/100 [00:21<06:47,  4.29s/it]  6%|▌         | 6/100 [00:25<06:39,  4.25s/it]  7%|▋         | 7/100 [00:29<06:30,  4.20s/it]  8%|▊         | 8/100 [00:33<06:23,  4.17s/it]  9%|▉         | 9/100 [00:37<06:15,  4.13s/it] 10%|█         | 10/100 [00:42<06:12,  4.14s/it] 11%|█         | 11/100 [00:46<06:18,  4.26s/it] 12%|█▏        | 12/100 [00:50<06:08,  4.18s/it] 13%|█▎        | 13/100 [00:54<06:08,  4.23s/it] 14%|█▍        | 14/100 [00:58<05:55,  4.14s/it] 15%|█▌        | 15/100 [01:03<06:01,  4.26s/it] 16%|█▌        | 16/100 [01:07<06:00,  4.29s/it] 17%|█▋        | 17/100 [01:12<05:59,  4.33s/it] 18%|█▊        | 18/100 [01:16<05:57,  4.36s/it] 19%|█▉        | 19/100 [01:20<05:47,  4.29s/it] 20%|██        | 20/100 [01:25<05:44,  4.31s/it] 21%|██        | 21/100 [01:29<05:37,  4.27s/it] 22%|██▏       | 22/100 [01:33<05:28,  4.21s/it] 23%|██▎       | 23/100 [01:37<05:21,  4.18s/it] 24%|██▍       | 24/100 [01:41<05:16,  4.16s/it] 25%|██▌       | 25/100 [01:45<05:12,  4.16s/it] 26%|██▌       | 26/100 [01:49<05:09,  4.19s/it] 27%|██▋       | 27/100 [01:53<05:01,  4.13s/it] 28%|██▊       | 28/100 [01:58<04:56,  4.12s/it] 29%|██▉       | 29/100 [02:02<04:51,  4.11s/it] 30%|███       | 30/100 [02:06<04:46,  4.10s/it] 31%|███       | 31/100 [02:10<04:44,  4.12s/it] 32%|███▏      | 32/100 [02:14<04:44,  4.19s/it] 33%|███▎      | 33/100 [02:18<04:33,  4.09s/it] 34%|███▍      | 34/100 [02:22<04:29,  4.08s/it] 35%|███▌      | 35/100 [02:26<04:27,  4.12s/it] 36%|███▌      | 36/100 [02:30<04:22,  4.10s/it] 37%|███▋      | 37/100 [02:34<04:17,  4.08s/it] 38%|███▊      | 38/100 [02:39<04:15,  4.12s/it] 39%|███▉      | 39/100 [02:43<04:13,  4.15s/it] 40%|████      | 40/100 [02:47<04:06,  4.11s/it] 41%|████      | 41/100 [02:51<04:01,  4.10s/it] 42%|████▏     | 42/100 [02:55<03:57,  4.10s/it] 43%|████▎     | 43/100 [02:59<03:53,  4.09s/it] 44%|████▍     | 44/100 [03:03<03:45,  4.02s/it] 45%|████▌     | 45/100 [03:07<03:45,  4.11s/it] 46%|████▌     | 46/100 [03:12<03:43,  4.14s/it] 47%|████▋     | 47/100 [03:16<03:39,  4.14s/it] 48%|████▊     | 48/100 [03:20<03:33,  4.10s/it] 49%|████▉     | 49/100 [03:24<03:38,  4.28s/it] 50%|█████     | 50/100 [03:29<03:34,  4.28s/it] 51%|█████     | 51/100 [03:33<03:26,  4.22s/it] 52%|█████▏    | 52/100 [03:37<03:19,  4.16s/it] 53%|█████▎    | 53/100 [03:41<03:16,  4.18s/it] 54%|█████▍    | 54/100 [03:45<03:12,  4.18s/it] 55%|█████▌    | 55/100 [03:50<03:12,  4.29s/it] 56%|█████▌    | 56/100 [03:54<03:06,  4.24s/it] 57%|█████▋    | 57/100 [03:58<03:05,  4.31s/it] 58%|█████▊    | 58/100 [04:03<03:01,  4.31s/it] 59%|█████▉    | 59/100 [04:07<02:54,  4.26s/it] 60%|██████    | 60/100 [04:11<02:49,  4.24s/it] 61%|██████    | 61/100 [04:15<02:43,  4.20s/it] 62%|██████▏   | 62/100 [04:19<02:41,  4.24s/it] 63%|██████▎   | 63/100 [04:23<02:34,  4.19s/it] 64%|██████▍   | 64/100 [04:28<02:29,  4.15s/it] 65%|██████▌   | 65/100 [04:32<02:28,  4.24s/it] 66%|██████▌   | 66/100 [04:36<02:24,  4.24s/it] 67%|██████▋   | 67/100 [04:40<02:18,  4.21s/it] 68%|██████▊   | 68/100 [04:45<02:16,  4.28s/it] 69%|██████▉   | 69/100 [04:49<02:12,  4.26s/it] 70%|███████   | 70/100 [04:53<02:05,  4.19s/it] 71%|███████   | 71/100 [04:57<01:58,  4.10s/it] 72%|███████▏  | 72/100 [05:01<01:53,  4.05s/it] 73%|███████▎  | 73/100 [05:05<01:49,  4.05s/it] 74%|███████▍  | 74/100 [05:09<01:46,  4.09s/it] 75%|███████▌  | 75/100 [05:13<01:43,  4.13s/it] 76%|███████▌  | 76/100 [05:17<01:39,  4.14s/it] 77%|███████▋  | 77/100 [05:21<01:34,  4.10s/it] 78%|███████▊  | 78/100 [05:26<01:29,  4.08s/it] 79%|███████▉  | 79/100 [05:29<01:24,  4.03s/it] 80%|████████  | 80/100 [05:34<01:20,  4.04s/it] 81%|████████  | 81/100 [05:38<01:17,  4.07s/it] 82%|████████▏ | 82/100 [05:42<01:15,  4.22s/it] 83%|████████▎ | 83/100 [05:47<01:12,  4.25s/it] 84%|████████▍ | 84/100 [05:51<01:08,  4.25s/it] 85%|████████▌ | 85/100 [05:55<01:05,  4.34s/it] 86%|████████▌ | 86/100 [06:00<01:02,  4.45s/it] 87%|████████▋ | 87/100 [06:04<00:57,  4.43s/it] 88%|████████▊ | 88/100 [06:09<00:53,  4.49s/it] 89%|████████▉ | 89/100 [06:13<00:48,  4.42s/it] 90%|█████████ | 90/100 [06:18<00:43,  4.39s/it] 91%|█████████ | 91/100 [06:22<00:39,  4.43s/it] 92%|█████████▏| 92/100 [06:26<00:34,  4.28s/it] 93%|█████████▎| 93/100 [06:30<00:29,  4.24s/it] 94%|█████████▍| 94/100 [06:34<00:25,  4.19s/it] 95%|█████████▌| 95/100 [06:39<00:21,  4.22s/it] 96%|█████████▌| 96/100 [06:43<00:16,  4.15s/it] 97%|█████████▋| 97/100 [06:46<00:12,  4.08s/it] 98%|█████████▊| 98/100 [06:50<00:08,  4.04s/it] 99%|█████████▉| 99/100 [06:55<00:04,  4.08s/it]100%|██████████| 100/100 [06:58<00:00,  4.02s/it]100%|██████████| 100/100 [06:59<00:00,  4.19s/it]
[0/100] loss: 3.018761396408081 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 0.7648107409477234
[1/100] loss: 2.302818775177002 loss_joints: 1.952919363975525 loss_collision: 0.0 loss_jerk: 0.07439745217561722 loss_floor_contact: 0.6254011988639832
[2/100] loss: 0.6144314408302307 loss_joints: 0.5027137994766235 loss_collision: 0.0 loss_jerk: 0.09852539747953415 loss_floor_contact: 0.12490985542535782
[3/100] loss: 0.09109582751989365 loss_joints: 0.04964321851730347 loss_collision: 0.0006837352411821485 loss_jerk: 0.08276847004890442 loss_floor_contact: 0.0
[4/100] loss: 0.4027253985404968 loss_joints: 0.353011816740036 loss_collision: 0.015402215532958508 loss_jerk: 0.09634671360254288 loss_floor_contact: 0.0
[5/100] loss: 0.2822299599647522 loss_joints: 0.23550574481487274 loss_collision: 0.005085221026092768 loss_jerk: 0.09243141114711761 loss_floor_contact: 0.0
[6/100] loss: 0.07097926735877991 loss_joints: 0.028390442952513695 loss_collision: 0.0 loss_jerk: 0.08517765253782272 loss_floor_contact: 0.0
[7/100] loss: 0.1224595457315445 loss_joints: 0.08694299310445786 loss_collision: 0.0002789188001770526 loss_jerk: 0.07097731530666351 loss_floor_contact: 0.0
[8/100] loss: 0.1411789357662201 loss_joints: 0.1090683862566948 loss_collision: 0.0 loss_jerk: 0.06422111392021179 loss_floor_contact: 0.0
[9/100] loss: 0.09391774237155914 loss_joints: 0.0611727237701416 loss_collision: 0.0008482807315886021 loss_jerk: 0.06532038748264313 loss_floor_contact: 0.0
[10/100] loss: 0.057849396020174026 loss_joints: 0.025857409462332726 loss_collision: 0.0015429683262482285 loss_jerk: 0.06367538124322891 loss_floor_contact: 0.0
[11/100] loss: 0.05015029013156891 loss_joints: 0.01666206493973732 loss_collision: 0.0 loss_jerk: 0.06697645038366318 loss_floor_contact: 0.0
[12/100] loss: 0.05152982100844383 loss_joints: 0.017038840800523758 loss_collision: 0.0 loss_jerk: 0.06898196041584015 loss_floor_contact: 0.0
[13/100] loss: 0.04560547322034836 loss_joints: 0.012716326862573624 loss_collision: 0.0 loss_jerk: 0.06577829271554947 loss_floor_contact: 0.0
[14/100] loss: 0.04137823358178139 loss_joints: 0.010388326831161976 loss_collision: 0.0005637567956000566 loss_jerk: 0.061867062002420425 loss_floor_contact: 0.0
[15/100] loss: 0.03185616433620453 loss_joints: 0.003736077807843685 loss_collision: 0.00041002954822033644 loss_jerk: 0.056158166378736496 loss_floor_contact: 0.0
[16/100] loss: 0.03187985718250275 loss_joints: 0.004869708325713873 loss_collision: 0.00025601458037272096 loss_jerk: 0.053969092667102814 loss_floor_contact: 0.0
[17/100] loss: 0.0340094268321991 loss_joints: 0.008217813447117805 loss_collision: 0.00019661051919683814 loss_jerk: 0.05154390633106232 loss_floor_contact: 0.0
[18/100] loss: 0.029063411056995392 loss_joints: 0.003630570601671934 loss_collision: 0.0001607732119737193 loss_jerk: 0.050833526998758316 loss_floor_contact: 0.0
[19/100] loss: 0.026327282190322876 loss_joints: 0.00027701276121661067 loss_collision: 0.00020293548004701734 loss_jerk: 0.052059952169656754 loss_floor_contact: 0.0
[20/100] loss: 0.027010831981897354 loss_joints: 0.0011244371999055147 loss_collision: 0.00011365918180672452 loss_jerk: 0.0517500564455986 loss_floor_contact: 0.0
[21/100] loss: 0.02387589029967785 loss_joints: 0.00018620461924001575 loss_collision: 5.9727295592892915e-05 loss_jerk: 0.04736742749810219 loss_floor_contact: 0.0
[22/100] loss: 0.02417975850403309 loss_joints: 0.0012959814630448818 loss_collision: 0.0 loss_jerk: 0.04576755315065384 loss_floor_contact: 0.0
[23/100] loss: 0.023759663105010986 loss_joints: 0.0012051656376570463 loss_collision: 0.00012047130439896137 loss_jerk: 0.04508490115404129 loss_floor_contact: 0.0
[24/100] loss: 0.021500494331121445 loss_joints: 0.00030480651184916496 loss_collision: 0.00018042325973510742 loss_jerk: 0.04235529154539108 loss_floor_contact: 0.0
[25/100] loss: 0.021269798278808594 loss_joints: 0.0004950651782564819 loss_collision: 0.0002853274345397949 loss_jerk: 0.04149240255355835 loss_floor_contact: 0.0
[26/100] loss: 0.02080344222486019 loss_joints: 0.00020200111612211913 loss_collision: 0.0002965869789477438 loss_jerk: 0.041143566370010376 loss_floor_contact: 0.0
[27/100] loss: 0.020126091316342354 loss_joints: 0.0003770575567614287 loss_collision: 7.722125883447006e-05 loss_jerk: 0.03948262333869934 loss_floor_contact: 0.0
[28/100] loss: 0.018946994096040726 loss_joints: 0.00039363207179121673 loss_collision: 0.00012652920850086957 loss_jerk: 0.03708141669631004 loss_floor_contact: 0.0
[29/100] loss: 0.018174367025494576 loss_joints: 7.792235555825755e-05 loss_collision: 0.0 loss_jerk: 0.036192890256643295 loss_floor_contact: 0.0
[30/100] loss: 0.017196115106344223 loss_joints: 3.6525372706819326e-05 loss_collision: 0.0 loss_jerk: 0.034319180995225906 loss_floor_contact: 0.0
[31/100] loss: 0.01787308044731617 loss_joints: 0.000773994717746973 loss_collision: 0.0 loss_jerk: 0.03419817239046097 loss_floor_contact: 0.0
[32/100] loss: 0.016923196613788605 loss_joints: 0.000328662630636245 loss_collision: 0.0 loss_jerk: 0.0331890694797039 loss_floor_contact: 0.0
[33/100] loss: 0.017547165974974632 loss_joints: 0.0013287983601912856 loss_collision: 0.0 loss_jerk: 0.032436735928058624 loss_floor_contact: 0.0
[34/100] loss: 0.0170513316988945 loss_joints: 0.001536768744699657 loss_collision: 0.0 loss_jerk: 0.031029127538204193 loss_floor_contact: 0.0
[35/100] loss: 0.015620498917996883 loss_joints: 0.0002683639759197831 loss_collision: 0.0 loss_jerk: 0.03070426918566227 loss_floor_contact: 0.0
[36/100] loss: 0.015666447579860687 loss_joints: 0.0006770083564333618 loss_collision: 0.0 loss_jerk: 0.029978878796100616 loss_floor_contact: 0.0
[37/100] loss: 0.015623820945620537 loss_joints: 0.0009336781222373247 loss_collision: 0.0 loss_jerk: 0.02938028611242771 loss_floor_contact: 0.0
[38/100] loss: 0.015921244397759438 loss_joints: 0.000807407486718148 loss_collision: 0.0 loss_jerk: 0.030227672308683395 loss_floor_contact: 0.0
[39/100] loss: 0.015165810473263264 loss_joints: 0.00034467526711523533 loss_collision: 0.0 loss_jerk: 0.029642270877957344 loss_floor_contact: 0.0
[40/100] loss: 0.01575329527258873 loss_joints: 0.0005182054592296481 loss_collision: 0.0 loss_jerk: 0.03047018125653267 loss_floor_contact: 0.0
[41/100] loss: 0.0151224909350276 loss_joints: 0.0004720145370811224 loss_collision: 0.0 loss_jerk: 0.029300952330231667 loss_floor_contact: 0.0
[42/100] loss: 0.014331389218568802 loss_joints: 6.958316953387111e-05 loss_collision: 0.00016816420247778296 loss_jerk: 0.0284899789839983 loss_floor_contact: 0.0
[43/100] loss: 0.013737441971898079 loss_joints: 8.605908078607172e-05 loss_collision: 0.0001390656689181924 loss_jerk: 0.027274953201413155 loss_floor_contact: 0.0
[44/100] loss: 0.014024836011230946 loss_joints: 0.00013010634575039148 loss_collision: 0.0005123810260556638 loss_jerk: 0.027686983346939087 loss_floor_contact: 0.0
[45/100] loss: 0.013603245839476585 loss_joints: 0.00017241484601981938 loss_collision: 0.00027430974296294153 loss_jerk: 0.026806799694895744 loss_floor_contact: 0.0
[46/100] loss: 0.013779597356915474 loss_joints: 9.658816270530224e-05 loss_collision: 2.086391941702459e-05 loss_jerk: 0.02736184559762478 loss_floor_contact: 0.0
[47/100] loss: 0.013636479154229164 loss_joints: 0.00018826653831638396 loss_collision: 0.0 loss_jerk: 0.02689642459154129 loss_floor_contact: 0.0
[48/100] loss: 0.013253256678581238 loss_joints: 0.0001876999158412218 loss_collision: 0.00016073769074864686 loss_jerk: 0.026098966598510742 loss_floor_contact: 0.0
[49/100] loss: 0.013193485327064991 loss_joints: 7.268426270456985e-05 loss_collision: 0.0005057890084572136 loss_jerk: 0.026140443980693817 loss_floor_contact: 0.0
[50/100] loss: 0.013170077465474606 loss_joints: 0.00010545250552240759 loss_collision: 0.000443215569248423 loss_jerk: 0.026040606200695038 loss_floor_contact: 0.0
[51/100] loss: 0.013074461370706558 loss_joints: 0.00014000297232996672 loss_collision: 0.0003680472436826676 loss_jerk: 0.025795307010412216 loss_floor_contact: 0.0
[52/100] loss: 0.013151289895176888 loss_joints: 0.0002197600551880896 loss_collision: 0.000470485829282552 loss_jerk: 0.025768961757421494 loss_floor_contact: 0.0
[53/100] loss: 0.012820165604352951 loss_joints: 3.907014615833759e-05 loss_collision: 0.00023885874543339014 loss_jerk: 0.02551441825926304 loss_floor_contact: 0.0
[54/100] loss: 0.012647618539631367 loss_joints: 0.0004223202704451978 loss_collision: 5.732706267735921e-05 loss_jerk: 0.0244391318410635 loss_floor_contact: 0.0
[55/100] loss: 0.012436790391802788 loss_joints: 0.00051949976477772 loss_collision: 0.0 loss_jerk: 0.023834580555558205 loss_floor_contact: 0.0
[56/100] loss: 0.011985422112047672 loss_joints: 0.00012457075354177505 loss_collision: 0.0 loss_jerk: 0.02372170239686966 loss_floor_contact: 0.0
[57/100] loss: 0.012854618020355701 loss_joints: 0.00040634602191857994 loss_collision: 0.0 loss_jerk: 0.024896543473005295 loss_floor_contact: 0.0
[58/100] loss: 0.01256437785923481 loss_joints: 0.0004051322757732123 loss_collision: 0.0 loss_jerk: 0.02431849204003811 loss_floor_contact: 0.0
[59/100] loss: 0.01187183614820242 loss_joints: 8.724620420252904e-05 loss_collision: 0.0 loss_jerk: 0.023569179698824883 loss_floor_contact: 0.0
[60/100] loss: 0.011885765939950943 loss_joints: 0.00023940262326505035 loss_collision: 0.0 loss_jerk: 0.023292725905776024 loss_floor_contact: 0.0
[61/100] loss: 0.011746063828468323 loss_joints: 0.0002672002883628011 loss_collision: 0.0 loss_jerk: 0.022957727313041687 loss_floor_contact: 0.0
[62/100] loss: 0.011654154397547245 loss_joints: 0.000136156304506585 loss_collision: 0.0 loss_jerk: 0.023035995662212372 loss_floor_contact: 0.0
[63/100] loss: 0.011701409704983234 loss_joints: 4.403109414852224e-05 loss_collision: 0.0 loss_jerk: 0.023314757272601128 loss_floor_contact: 0.0
[64/100] loss: 0.011624854989349842 loss_joints: 0.00020473243785090744 loss_collision: 0.0 loss_jerk: 0.022840244695544243 loss_floor_contact: 0.0
[65/100] loss: 0.011767532676458359 loss_joints: 0.00026675232220441103 loss_collision: 0.0 loss_jerk: 0.02300156094133854 loss_floor_contact: 0.0
[66/100] loss: 0.011642134748399258 loss_joints: 2.5562030714354478e-05 loss_collision: 0.0 loss_jerk: 0.023233145475387573 loss_floor_contact: 0.0
[67/100] loss: 0.011740042828023434 loss_joints: 0.00022192571486812085 loss_collision: 0.0 loss_jerk: 0.023036234080791473 loss_floor_contact: 0.0
[68/100] loss: 0.011717131361365318 loss_joints: 0.0003396001411601901 loss_collision: 0.0 loss_jerk: 0.022755062207579613 loss_floor_contact: 0.0
[69/100] loss: 0.011245574802160263 loss_joints: 0.00010659170220606029 loss_collision: 0.0 loss_jerk: 0.022277966141700745 loss_floor_contact: 0.0
[70/100] loss: 0.011288047768175602 loss_joints: 0.00014479769743047655 loss_collision: 0.0 loss_jerk: 0.02228650078177452 loss_floor_contact: 0.0
[71/100] loss: 0.01134646125137806 loss_joints: 0.00020058975496795028 loss_collision: 0.0 loss_jerk: 0.022291742265224457 loss_floor_contact: 0.0
[72/100] loss: 0.011101880110800266 loss_joints: 0.00011964872101088986 loss_collision: 0.0 loss_jerk: 0.021964462473988533 loss_floor_contact: 0.0
[73/100] loss: 0.0109871132299304 loss_joints: 0.00017275560821872205 loss_collision: 0.0 loss_jerk: 0.021628715097904205 loss_floor_contact: 0.0
[74/100] loss: 0.010699920356273651 loss_joints: 0.0001721264998195693 loss_collision: 0.0 loss_jerk: 0.021055588498711586 loss_floor_contact: 0.0
[75/100] loss: 0.010866199620068073 loss_joints: 0.00019618688384070992 loss_collision: 0.0 loss_jerk: 0.02134002558887005 loss_floor_contact: 0.0
[76/100] loss: 0.01072060689330101 loss_joints: 0.00017646956257522106 loss_collision: 0.0 loss_jerk: 0.02108827419579029 loss_floor_contact: 0.0
[77/100] loss: 0.010782088153064251 loss_joints: 6.09823691775091e-05 loss_collision: 0.0 loss_jerk: 0.021442212164402008 loss_floor_contact: 0.0
[78/100] loss: 0.010783984325826168 loss_joints: 0.0001147622533608228 loss_collision: 0.0 loss_jerk: 0.02133844420313835 loss_floor_contact: 0.0
[79/100] loss: 0.010596109554171562 loss_joints: 0.0002080775157082826 loss_collision: 0.0 loss_jerk: 0.020776063203811646 loss_floor_contact: 0.0
[80/100] loss: 0.01031824853271246 loss_joints: 9.712419705465436e-05 loss_collision: 0.0 loss_jerk: 0.02044224925339222 loss_floor_contact: 0.0
[81/100] loss: 0.010246187448501587 loss_joints: 4.465082383831032e-06 loss_collision: 0.0 loss_jerk: 0.02048344537615776 loss_floor_contact: 0.0
[82/100] loss: 0.01023019663989544 loss_joints: 6.285778363235295e-05 loss_collision: 0.0 loss_jerk: 0.020334677770733833 loss_floor_contact: 0.0
[83/100] loss: 0.01026215497404337 loss_joints: 4.739913856610656e-05 loss_collision: 0.0 loss_jerk: 0.020429512485861778 loss_floor_contact: 0.0
[84/100] loss: 0.010079942643642426 loss_joints: 1.0376850696047768e-05 loss_collision: 0.0 loss_jerk: 0.02013913169503212 loss_floor_contact: 0.0
[85/100] loss: 0.010055405087769032 loss_joints: 3.3380369131918997e-05 loss_collision: 0.0 loss_jerk: 0.020044049248099327 loss_floor_contact: 0.0
[86/100] loss: 0.009993452578783035 loss_joints: 1.8881928554037586e-05 loss_collision: 0.0 loss_jerk: 0.019949141889810562 loss_floor_contact: 0.0
[87/100] loss: 0.009964830242097378 loss_joints: 1.7724845520206145e-06 loss_collision: 0.0 loss_jerk: 0.01992611587047577 loss_floor_contact: 0.0
[88/100] loss: 0.009889688342809677 loss_joints: 3.2850352909008507e-06 loss_collision: 0.0 loss_jerk: 0.019772807136178017 loss_floor_contact: 0.0
[89/100] loss: 0.009920194745063782 loss_joints: 3.0856818966640276e-07 loss_collision: 0.0 loss_jerk: 0.019839772954583168 loss_floor_contact: 0.0
[90/100] loss: 0.009926960803568363 loss_joints: 1.5881196304690093e-06 loss_collision: 0.0 loss_jerk: 0.019850745797157288 loss_floor_contact: 0.0
[91/100] loss: 0.009916514158248901 loss_joints: 2.580540012786514e-06 loss_collision: 0.0 loss_jerk: 0.019827866926789284 loss_floor_contact: 0.0
[92/100] loss: 0.009779511019587517 loss_joints: 1.3922316384196165e-06 loss_collision: 0.0 loss_jerk: 0.019556237384676933 loss_floor_contact: 0.0
[93/100] loss: 0.009791363961994648 loss_joints: 5.141238034411799e-06 loss_collision: 0.0 loss_jerk: 0.01957244612276554 loss_floor_contact: 0.0
[94/100] loss: 0.009727760218083858 loss_joints: 2.9237876333354507e-06 loss_collision: 0.0 loss_jerk: 0.01944967359304428 loss_floor_contact: 0.0
[95/100] loss: 0.009581600315868855 loss_joints: 7.247962798828667e-07 loss_collision: 0.0 loss_jerk: 0.019161751493811607 loss_floor_contact: 0.0
[96/100] loss: 0.009510711766779423 loss_joints: 4.280133907741401e-06 loss_collision: 0.0 loss_jerk: 0.01901286281645298 loss_floor_contact: 0.0
[97/100] loss: 0.009539657272398472 loss_joints: 4.937616722600069e-06 loss_collision: 0.0 loss_jerk: 0.01906943880021572 loss_floor_contact: 0.0
[98/100] loss: 0.009492680430412292 loss_joints: 1.5426070376634016e-06 loss_collision: 0.0 loss_jerk: 0.01898227632045746 loss_floor_contact: 0.0
[99/100] loss: 0.00948211457580328 loss_joints: 1.2265513760212343e-07 loss_collision: 0.0 loss_jerk: 0.01896398328244686 loss_floor_contact: 0.0
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.25/contact_thresh_0.75/cabE-path3-run12-4000_collision0.1_contact0.5_jerk0.5_skate0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 419.01350                                                    ║
    ║     rollout = 190.74108                                                    ║
    ║     sdf     = 20.23628                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00948211                                                 ║
    ║     joints    = 0.00000012                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.01896398                                                 ║
    ║     floor     = 0.00000000                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	7m16.579s
user	6m21.634s
sys	0m19.958s
[INFO] Running with collision=0.1, contact=0.5, jerk=0.5, skate=0.5
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<06:39,  4.03s/it]  2%|▏         | 2/100 [00:07<06:29,  3.97s/it]  3%|▎         | 3/100 [00:12<06:54,  4.27s/it]  4%|▍         | 4/100 [00:16<06:46,  4.23s/it]  5%|▌         | 5/100 [00:21<06:49,  4.31s/it]  6%|▌         | 6/100 [00:25<07:00,  4.47s/it]  7%|▋         | 7/100 [00:30<06:54,  4.46s/it]  8%|▊         | 8/100 [00:35<06:57,  4.54s/it]  9%|▉         | 9/100 [00:39<06:51,  4.52s/it] 10%|█         | 10/100 [00:44<06:49,  4.55s/it] 11%|█         | 11/100 [00:48<06:44,  4.54s/it] 12%|█▏        | 12/100 [00:53<06:35,  4.49s/it] 13%|█▎        | 13/100 [00:57<06:30,  4.49s/it] 14%|█▍        | 14/100 [01:01<06:22,  4.45s/it] 15%|█▌        | 15/100 [01:06<06:18,  4.45s/it] 16%|█▌        | 16/100 [01:10<06:15,  4.47s/it] 17%|█▋        | 17/100 [01:15<06:11,  4.47s/it] 18%|█▊        | 18/100 [01:19<06:05,  4.46s/it] 19%|█▉        | 19/100 [01:24<06:06,  4.52s/it] 20%|██        | 20/100 [01:28<05:58,  4.48s/it] 21%|██        | 21/100 [01:33<05:57,  4.52s/it] 22%|██▏       | 22/100 [01:38<05:56,  4.57s/it] 23%|██▎       | 23/100 [01:42<05:47,  4.52s/it] 24%|██▍       | 24/100 [01:47<05:42,  4.51s/it] 25%|██▌       | 25/100 [01:51<05:40,  4.54s/it] 26%|██▌       | 26/100 [01:56<05:35,  4.54s/it] 27%|██▋       | 27/100 [02:00<05:30,  4.53s/it] 28%|██▊       | 28/100 [02:05<05:24,  4.51s/it] 29%|██▉       | 29/100 [02:09<05:14,  4.43s/it] 30%|███       | 30/100 [02:13<05:05,  4.37s/it] 31%|███       | 31/100 [02:18<05:03,  4.40s/it] 32%|███▏      | 32/100 [02:22<04:56,  4.37s/it] 33%|███▎      | 33/100 [02:26<04:55,  4.42s/it] 34%|███▍      | 34/100 [02:31<04:48,  4.37s/it] 35%|███▌      | 35/100 [02:35<04:46,  4.40s/it] 36%|███▌      | 36/100 [02:40<04:42,  4.41s/it] 37%|███▋      | 37/100 [02:44<04:38,  4.42s/it] 38%|███▊      | 38/100 [02:48<04:30,  4.36s/it] 39%|███▉      | 39/100 [02:53<04:31,  4.46s/it] 40%|████      | 40/100 [02:58<04:28,  4.48s/it] 41%|████      | 41/100 [03:02<04:26,  4.52s/it] 42%|████▏     | 42/100 [03:07<04:20,  4.49s/it] 43%|████▎     | 43/100 [03:11<04:10,  4.40s/it] 44%|████▍     | 44/100 [03:15<04:08,  4.44s/it] 45%|████▌     | 45/100 [03:20<04:02,  4.41s/it] 46%|████▌     | 46/100 [03:24<03:54,  4.34s/it] 47%|████▋     | 47/100 [03:28<03:53,  4.41s/it] 48%|████▊     | 48/100 [03:33<03:50,  4.43s/it] 49%|████▉     | 49/100 [03:37<03:45,  4.42s/it] 50%|█████     | 50/100 [03:42<03:40,  4.42s/it] 51%|█████     | 51/100 [03:46<03:37,  4.43s/it] 52%|█████▏    | 52/100 [03:51<03:33,  4.45s/it] 53%|█████▎    | 53/100 [03:55<03:30,  4.47s/it] 54%|█████▍    | 54/100 [03:59<03:24,  4.44s/it] 55%|█████▌    | 55/100 [04:04<03:19,  4.43s/it] 56%|█████▌    | 56/100 [04:08<03:13,  4.40s/it] 57%|█████▋    | 57/100 [04:13<03:09,  4.42s/it] 58%|█████▊    | 58/100 [04:17<03:07,  4.46s/it] 59%|█████▉    | 59/100 [04:22<03:02,  4.45s/it] 60%|██████    | 60/100 [04:26<03:02,  4.56s/it] 61%|██████    | 61/100 [04:31<02:54,  4.46s/it] 62%|██████▏   | 62/100 [04:35<02:49,  4.45s/it] 63%|██████▎   | 63/100 [04:40<02:44,  4.46s/it] 64%|██████▍   | 64/100 [04:44<02:37,  4.39s/it] 65%|██████▌   | 65/100 [04:48<02:33,  4.38s/it] 66%|██████▌   | 66/100 [04:53<02:28,  4.38s/it] 67%|██████▋   | 67/100 [04:57<02:22,  4.33s/it] 68%|██████▊   | 68/100 [05:01<02:19,  4.37s/it] 69%|██████▉   | 69/100 [05:06<02:15,  4.39s/it] 70%|███████   | 70/100 [05:10<02:11,  4.38s/it] 71%|███████   | 71/100 [05:14<02:07,  4.40s/it] 72%|███████▏  | 72/100 [05:19<02:03,  4.40s/it] 73%|███████▎  | 73/100 [05:23<01:59,  4.44s/it] 74%|███████▍  | 74/100 [05:28<01:55,  4.45s/it] 75%|███████▌  | 75/100 [05:32<01:49,  4.40s/it] 76%|███████▌  | 76/100 [05:36<01:44,  4.36s/it] 77%|███████▋  | 77/100 [05:41<01:39,  4.33s/it] 78%|███████▊  | 78/100 [05:45<01:34,  4.28s/it] 79%|███████▉  | 79/100 [05:49<01:30,  4.30s/it] 80%|████████  | 80/100 [05:54<01:27,  4.38s/it] 81%|████████  | 81/100 [05:58<01:25,  4.47s/it] 82%|████████▏ | 82/100 [06:03<01:20,  4.47s/it] 83%|████████▎ | 83/100 [06:07<01:15,  4.42s/it] 84%|████████▍ | 84/100 [06:12<01:10,  4.42s/it] 85%|████████▌ | 85/100 [06:16<01:07,  4.49s/it] 86%|████████▌ | 86/100 [06:21<01:03,  4.50s/it] 87%|████████▋ | 87/100 [06:25<00:57,  4.42s/it] 88%|████████▊ | 88/100 [06:29<00:52,  4.38s/it] 89%|████████▉ | 89/100 [06:34<00:48,  4.37s/it] 90%|█████████ | 90/100 [06:38<00:44,  4.41s/it] 91%|█████████ | 91/100 [06:43<00:39,  4.42s/it] 92%|█████████▏| 92/100 [06:47<00:35,  4.40s/it] 93%|█████████▎| 93/100 [06:51<00:30,  4.39s/it] 94%|█████████▍| 94/100 [06:56<00:26,  4.45s/it] 95%|█████████▌| 95/100 [07:00<00:22,  4.45s/it] 96%|█████████▌| 96/100 [07:05<00:17,  4.39s/it] 97%|█████████▋| 97/100 [07:09<00:13,  4.43s/it] 98%|█████████▊| 98/100 [07:14<00:08,  4.48s/it] 99%|█████████▉| 99/100 [07:18<00:04,  4.40s/it]100%|██████████| 100/100 [07:22<00:00,  4.42s/it]100%|██████████| 100/100 [07:22<00:00,  4.43s/it]
[0/100] loss: 3.018761396408081 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 0.7648107409477234
[1/100] loss: 2.302818775177002 loss_joints: 1.952919363975525 loss_collision: 0.0 loss_jerk: 0.07439745217561722 loss_floor_contact: 0.6254011988639832
[2/100] loss: 0.6144314408302307 loss_joints: 0.5027137994766235 loss_collision: 0.0 loss_jerk: 0.09852539747953415 loss_floor_contact: 0.12490985542535782
[3/100] loss: 0.09109582751989365 loss_joints: 0.04964321851730347 loss_collision: 0.0006837352411821485 loss_jerk: 0.08276847004890442 loss_floor_contact: 0.0
[4/100] loss: 0.4027253985404968 loss_joints: 0.353011816740036 loss_collision: 0.015402215532958508 loss_jerk: 0.09634671360254288 loss_floor_contact: 0.0
[5/100] loss: 0.2822299599647522 loss_joints: 0.23550574481487274 loss_collision: 0.005085221026092768 loss_jerk: 0.09243141114711761 loss_floor_contact: 0.0
[6/100] loss: 0.07097926735877991 loss_joints: 0.028390442952513695 loss_collision: 0.0 loss_jerk: 0.08517765253782272 loss_floor_contact: 0.0
[7/100] loss: 0.1224595457315445 loss_joints: 0.08694299310445786 loss_collision: 0.0002789188001770526 loss_jerk: 0.07097731530666351 loss_floor_contact: 0.0
[8/100] loss: 0.1411789357662201 loss_joints: 0.1090683862566948 loss_collision: 0.0 loss_jerk: 0.06422111392021179 loss_floor_contact: 0.0
[9/100] loss: 0.09391774237155914 loss_joints: 0.0611727237701416 loss_collision: 0.0008482807315886021 loss_jerk: 0.06532038748264313 loss_floor_contact: 0.0
[10/100] loss: 0.057849396020174026 loss_joints: 0.025857409462332726 loss_collision: 0.0015429683262482285 loss_jerk: 0.06367538124322891 loss_floor_contact: 0.0
[11/100] loss: 0.05015029013156891 loss_joints: 0.01666206493973732 loss_collision: 0.0 loss_jerk: 0.06697645038366318 loss_floor_contact: 0.0
[12/100] loss: 0.05152982100844383 loss_joints: 0.017038840800523758 loss_collision: 0.0 loss_jerk: 0.06898196041584015 loss_floor_contact: 0.0
[13/100] loss: 0.04560547322034836 loss_joints: 0.012716326862573624 loss_collision: 0.0 loss_jerk: 0.06577829271554947 loss_floor_contact: 0.0
[14/100] loss: 0.04137823358178139 loss_joints: 0.010388326831161976 loss_collision: 0.0005637567956000566 loss_jerk: 0.061867062002420425 loss_floor_contact: 0.0
[15/100] loss: 0.03185616433620453 loss_joints: 0.003736077807843685 loss_collision: 0.00041002954822033644 loss_jerk: 0.056158166378736496 loss_floor_contact: 0.0
[16/100] loss: 0.03187985718250275 loss_joints: 0.004869708325713873 loss_collision: 0.00025601458037272096 loss_jerk: 0.053969092667102814 loss_floor_contact: 0.0
[17/100] loss: 0.0340094268321991 loss_joints: 0.008217813447117805 loss_collision: 0.00019661051919683814 loss_jerk: 0.05154390633106232 loss_floor_contact: 0.0
[18/100] loss: 0.029063411056995392 loss_joints: 0.003630570601671934 loss_collision: 0.0001607732119737193 loss_jerk: 0.050833526998758316 loss_floor_contact: 0.0
[19/100] loss: 0.026327282190322876 loss_joints: 0.00027701276121661067 loss_collision: 0.00020293548004701734 loss_jerk: 0.052059952169656754 loss_floor_contact: 0.0
[20/100] loss: 0.027010831981897354 loss_joints: 0.0011244371999055147 loss_collision: 0.00011365918180672452 loss_jerk: 0.0517500564455986 loss_floor_contact: 0.0
[21/100] loss: 0.02387589029967785 loss_joints: 0.00018620461924001575 loss_collision: 5.9727295592892915e-05 loss_jerk: 0.04736742749810219 loss_floor_contact: 0.0
[22/100] loss: 0.02417975850403309 loss_joints: 0.0012959814630448818 loss_collision: 0.0 loss_jerk: 0.04576755315065384 loss_floor_contact: 0.0
[23/100] loss: 0.023759663105010986 loss_joints: 0.0012051656376570463 loss_collision: 0.00012047130439896137 loss_jerk: 0.04508490115404129 loss_floor_contact: 0.0
[24/100] loss: 0.021500494331121445 loss_joints: 0.00030480651184916496 loss_collision: 0.00018042325973510742 loss_jerk: 0.04235529154539108 loss_floor_contact: 0.0
[25/100] loss: 0.021269798278808594 loss_joints: 0.0004950651782564819 loss_collision: 0.0002853274345397949 loss_jerk: 0.04149240255355835 loss_floor_contact: 0.0
[26/100] loss: 0.02080344222486019 loss_joints: 0.00020200111612211913 loss_collision: 0.0002965869789477438 loss_jerk: 0.041143566370010376 loss_floor_contact: 0.0
[27/100] loss: 0.020126091316342354 loss_joints: 0.0003770575567614287 loss_collision: 7.722125883447006e-05 loss_jerk: 0.03948262333869934 loss_floor_contact: 0.0
[28/100] loss: 0.018946994096040726 loss_joints: 0.00039363207179121673 loss_collision: 0.00012652920850086957 loss_jerk: 0.03708141669631004 loss_floor_contact: 0.0
[29/100] loss: 0.018174367025494576 loss_joints: 7.792235555825755e-05 loss_collision: 0.0 loss_jerk: 0.036192890256643295 loss_floor_contact: 0.0
[30/100] loss: 0.017196115106344223 loss_joints: 3.6525372706819326e-05 loss_collision: 0.0 loss_jerk: 0.034319180995225906 loss_floor_contact: 0.0
[31/100] loss: 0.01787308044731617 loss_joints: 0.000773994717746973 loss_collision: 0.0 loss_jerk: 0.03419817239046097 loss_floor_contact: 0.0
[32/100] loss: 0.016923196613788605 loss_joints: 0.000328662630636245 loss_collision: 0.0 loss_jerk: 0.0331890694797039 loss_floor_contact: 0.0
[33/100] loss: 0.017547165974974632 loss_joints: 0.0013287983601912856 loss_collision: 0.0 loss_jerk: 0.032436735928058624 loss_floor_contact: 0.0
[34/100] loss: 0.0170513316988945 loss_joints: 0.001536768744699657 loss_collision: 0.0 loss_jerk: 0.031029127538204193 loss_floor_contact: 0.0
[35/100] loss: 0.015620498917996883 loss_joints: 0.0002683639759197831 loss_collision: 0.0 loss_jerk: 0.03070426918566227 loss_floor_contact: 0.0
[36/100] loss: 0.015666447579860687 loss_joints: 0.0006770083564333618 loss_collision: 0.0 loss_jerk: 0.029978878796100616 loss_floor_contact: 0.0
[37/100] loss: 0.015623820945620537 loss_joints: 0.0009336781222373247 loss_collision: 0.0 loss_jerk: 0.02938028611242771 loss_floor_contact: 0.0
[38/100] loss: 0.015921244397759438 loss_joints: 0.000807407486718148 loss_collision: 0.0 loss_jerk: 0.030227672308683395 loss_floor_contact: 0.0
[39/100] loss: 0.015165810473263264 loss_joints: 0.00034467526711523533 loss_collision: 0.0 loss_jerk: 0.029642270877957344 loss_floor_contact: 0.0
[40/100] loss: 0.01575329527258873 loss_joints: 0.0005182054592296481 loss_collision: 0.0 loss_jerk: 0.03047018125653267 loss_floor_contact: 0.0
[41/100] loss: 0.0151224909350276 loss_joints: 0.0004720145370811224 loss_collision: 0.0 loss_jerk: 0.029300952330231667 loss_floor_contact: 0.0
[42/100] loss: 0.014331389218568802 loss_joints: 6.958316953387111e-05 loss_collision: 0.00016816420247778296 loss_jerk: 0.0284899789839983 loss_floor_contact: 0.0
[43/100] loss: 0.013737441971898079 loss_joints: 8.605908078607172e-05 loss_collision: 0.0001390656689181924 loss_jerk: 0.027274953201413155 loss_floor_contact: 0.0
[44/100] loss: 0.014024836011230946 loss_joints: 0.00013010634575039148 loss_collision: 0.0005123810260556638 loss_jerk: 0.027686983346939087 loss_floor_contact: 0.0
[45/100] loss: 0.013603245839476585 loss_joints: 0.00017241484601981938 loss_collision: 0.00027430974296294153 loss_jerk: 0.026806799694895744 loss_floor_contact: 0.0
[46/100] loss: 0.013779597356915474 loss_joints: 9.658816270530224e-05 loss_collision: 2.086391941702459e-05 loss_jerk: 0.02736184559762478 loss_floor_contact: 0.0
[47/100] loss: 0.013636479154229164 loss_joints: 0.00018826653831638396 loss_collision: 0.0 loss_jerk: 0.02689642459154129 loss_floor_contact: 0.0
[48/100] loss: 0.013253256678581238 loss_joints: 0.0001876999158412218 loss_collision: 0.00016073769074864686 loss_jerk: 0.026098966598510742 loss_floor_contact: 0.0
[49/100] loss: 0.013193485327064991 loss_joints: 7.268426270456985e-05 loss_collision: 0.0005057890084572136 loss_jerk: 0.026140443980693817 loss_floor_contact: 0.0
[50/100] loss: 0.013170077465474606 loss_joints: 0.00010545250552240759 loss_collision: 0.000443215569248423 loss_jerk: 0.026040606200695038 loss_floor_contact: 0.0
[51/100] loss: 0.013074461370706558 loss_joints: 0.00014000297232996672 loss_collision: 0.0003680472436826676 loss_jerk: 0.025795307010412216 loss_floor_contact: 0.0
[52/100] loss: 0.013151289895176888 loss_joints: 0.0002197600551880896 loss_collision: 0.000470485829282552 loss_jerk: 0.025768961757421494 loss_floor_contact: 0.0
[53/100] loss: 0.012820165604352951 loss_joints: 3.907014615833759e-05 loss_collision: 0.00023885874543339014 loss_jerk: 0.02551441825926304 loss_floor_contact: 0.0
[54/100] loss: 0.012647618539631367 loss_joints: 0.0004223202704451978 loss_collision: 5.732706267735921e-05 loss_jerk: 0.0244391318410635 loss_floor_contact: 0.0
[55/100] loss: 0.012436790391802788 loss_joints: 0.00051949976477772 loss_collision: 0.0 loss_jerk: 0.023834580555558205 loss_floor_contact: 0.0
[56/100] loss: 0.011985422112047672 loss_joints: 0.00012457075354177505 loss_collision: 0.0 loss_jerk: 0.02372170239686966 loss_floor_contact: 0.0
[57/100] loss: 0.012854618020355701 loss_joints: 0.00040634602191857994 loss_collision: 0.0 loss_jerk: 0.024896543473005295 loss_floor_contact: 0.0
[58/100] loss: 0.01256437785923481 loss_joints: 0.0004051322757732123 loss_collision: 0.0 loss_jerk: 0.02431849204003811 loss_floor_contact: 0.0
[59/100] loss: 0.01187183614820242 loss_joints: 8.724620420252904e-05 loss_collision: 0.0 loss_jerk: 0.023569179698824883 loss_floor_contact: 0.0
[60/100] loss: 0.011885765939950943 loss_joints: 0.00023940262326505035 loss_collision: 0.0 loss_jerk: 0.023292725905776024 loss_floor_contact: 0.0
[61/100] loss: 0.011746063828468323 loss_joints: 0.0002672002883628011 loss_collision: 0.0 loss_jerk: 0.022957727313041687 loss_floor_contact: 0.0
[62/100] loss: 0.011654154397547245 loss_joints: 0.000136156304506585 loss_collision: 0.0 loss_jerk: 0.023035995662212372 loss_floor_contact: 0.0
[63/100] loss: 0.011701409704983234 loss_joints: 4.403109414852224e-05 loss_collision: 0.0 loss_jerk: 0.023314757272601128 loss_floor_contact: 0.0
[64/100] loss: 0.011624854989349842 loss_joints: 0.00020473243785090744 loss_collision: 0.0 loss_jerk: 0.022840244695544243 loss_floor_contact: 0.0
[65/100] loss: 0.011767532676458359 loss_joints: 0.00026675232220441103 loss_collision: 0.0 loss_jerk: 0.02300156094133854 loss_floor_contact: 0.0
[66/100] loss: 0.011642134748399258 loss_joints: 2.5562030714354478e-05 loss_collision: 0.0 loss_jerk: 0.023233145475387573 loss_floor_contact: 0.0
[67/100] loss: 0.011740042828023434 loss_joints: 0.00022192571486812085 loss_collision: 0.0 loss_jerk: 0.023036234080791473 loss_floor_contact: 0.0
[68/100] loss: 0.011717131361365318 loss_joints: 0.0003396001411601901 loss_collision: 0.0 loss_jerk: 0.022755062207579613 loss_floor_contact: 0.0
[69/100] loss: 0.011245574802160263 loss_joints: 0.00010659170220606029 loss_collision: 0.0 loss_jerk: 0.022277966141700745 loss_floor_contact: 0.0
[70/100] loss: 0.011288047768175602 loss_joints: 0.00014479769743047655 loss_collision: 0.0 loss_jerk: 0.02228650078177452 loss_floor_contact: 0.0
[71/100] loss: 0.01134646125137806 loss_joints: 0.00020058975496795028 loss_collision: 0.0 loss_jerk: 0.022291742265224457 loss_floor_contact: 0.0
[72/100] loss: 0.011101880110800266 loss_joints: 0.00011964872101088986 loss_collision: 0.0 loss_jerk: 0.021964462473988533 loss_floor_contact: 0.0
[73/100] loss: 0.0109871132299304 loss_joints: 0.00017275560821872205 loss_collision: 0.0 loss_jerk: 0.021628715097904205 loss_floor_contact: 0.0
[74/100] loss: 0.010699920356273651 loss_joints: 0.0001721264998195693 loss_collision: 0.0 loss_jerk: 0.021055588498711586 loss_floor_contact: 0.0
[75/100] loss: 0.010866199620068073 loss_joints: 0.00019618688384070992 loss_collision: 0.0 loss_jerk: 0.02134002558887005 loss_floor_contact: 0.0
[76/100] loss: 0.01072060689330101 loss_joints: 0.00017646956257522106 loss_collision: 0.0 loss_jerk: 0.02108827419579029 loss_floor_contact: 0.0
[77/100] loss: 0.010782088153064251 loss_joints: 6.09823691775091e-05 loss_collision: 0.0 loss_jerk: 0.021442212164402008 loss_floor_contact: 0.0
[78/100] loss: 0.010783984325826168 loss_joints: 0.0001147622533608228 loss_collision: 0.0 loss_jerk: 0.02133844420313835 loss_floor_contact: 0.0
[79/100] loss: 0.010596109554171562 loss_joints: 0.0002080775157082826 loss_collision: 0.0 loss_jerk: 0.020776063203811646 loss_floor_contact: 0.0
[80/100] loss: 0.01031824853271246 loss_joints: 9.712419705465436e-05 loss_collision: 0.0 loss_jerk: 0.02044224925339222 loss_floor_contact: 0.0
[81/100] loss: 0.010246187448501587 loss_joints: 4.465082383831032e-06 loss_collision: 0.0 loss_jerk: 0.02048344537615776 loss_floor_contact: 0.0
[82/100] loss: 0.01023019663989544 loss_joints: 6.285778363235295e-05 loss_collision: 0.0 loss_jerk: 0.020334677770733833 loss_floor_contact: 0.0
[83/100] loss: 0.01026215497404337 loss_joints: 4.739913856610656e-05 loss_collision: 0.0 loss_jerk: 0.020429512485861778 loss_floor_contact: 0.0
[84/100] loss: 0.010079942643642426 loss_joints: 1.0376850696047768e-05 loss_collision: 0.0 loss_jerk: 0.02013913169503212 loss_floor_contact: 0.0
[85/100] loss: 0.010055405087769032 loss_joints: 3.3380369131918997e-05 loss_collision: 0.0 loss_jerk: 0.020044049248099327 loss_floor_contact: 0.0
[86/100] loss: 0.009993452578783035 loss_joints: 1.8881928554037586e-05 loss_collision: 0.0 loss_jerk: 0.019949141889810562 loss_floor_contact: 0.0
[87/100] loss: 0.009964830242097378 loss_joints: 1.7724845520206145e-06 loss_collision: 0.0 loss_jerk: 0.01992611587047577 loss_floor_contact: 0.0
[88/100] loss: 0.009889688342809677 loss_joints: 3.2850352909008507e-06 loss_collision: 0.0 loss_jerk: 0.019772807136178017 loss_floor_contact: 0.0
[89/100] loss: 0.009920194745063782 loss_joints: 3.0856818966640276e-07 loss_collision: 0.0 loss_jerk: 0.019839772954583168 loss_floor_contact: 0.0
[90/100] loss: 0.009926960803568363 loss_joints: 1.5881196304690093e-06 loss_collision: 0.0 loss_jerk: 0.019850745797157288 loss_floor_contact: 0.0
[91/100] loss: 0.009916514158248901 loss_joints: 2.580540012786514e-06 loss_collision: 0.0 loss_jerk: 0.019827866926789284 loss_floor_contact: 0.0
[92/100] loss: 0.009779511019587517 loss_joints: 1.3922316384196165e-06 loss_collision: 0.0 loss_jerk: 0.019556237384676933 loss_floor_contact: 0.0
[93/100] loss: 0.009791363961994648 loss_joints: 5.141238034411799e-06 loss_collision: 0.0 loss_jerk: 0.01957244612276554 loss_floor_contact: 0.0
[94/100] loss: 0.009727760218083858 loss_joints: 2.9237876333354507e-06 loss_collision: 0.0 loss_jerk: 0.01944967359304428 loss_floor_contact: 0.0
[95/100] loss: 0.009581600315868855 loss_joints: 7.247962798828667e-07 loss_collision: 0.0 loss_jerk: 0.019161751493811607 loss_floor_contact: 0.0
[96/100] loss: 0.009510711766779423 loss_joints: 4.280133907741401e-06 loss_collision: 0.0 loss_jerk: 0.01901286281645298 loss_floor_contact: 0.0
[97/100] loss: 0.009539657272398472 loss_joints: 4.937616722600069e-06 loss_collision: 0.0 loss_jerk: 0.01906943880021572 loss_floor_contact: 0.0
[98/100] loss: 0.009492680430412292 loss_joints: 1.5426070376634016e-06 loss_collision: 0.0 loss_jerk: 0.01898227632045746 loss_floor_contact: 0.0
[99/100] loss: 0.00948211457580328 loss_joints: 1.2265513760212343e-07 loss_collision: 0.0 loss_jerk: 0.01896398328244686 loss_floor_contact: 0.0
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.25/contact_thresh_0.75/cabE-path3-run12-4000_collision0.1_contact0.5_jerk0.5_skate0.5]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 442.96289                                                    ║
    ║     rollout = 197.69197                                                    ║
    ║     sdf     = 20.42371                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00948211                                                 ║
    ║     joints    = 0.00000012                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.01896398                                                 ║
    ║     floor     = 0.00000000                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	7m40.140s
user	6m47.962s
sys	0m16.874s
[INFO] Running with collision=0.1, contact=0.5, jerk=0.5, skate=1.0
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<07:18,  4.43s/it]  2%|▏         | 2/100 [00:08<07:08,  4.38s/it]  3%|▎         | 3/100 [00:13<07:21,  4.55s/it]  4%|▍         | 4/100 [00:17<07:04,  4.42s/it]  5%|▌         | 5/100 [00:22<06:57,  4.40s/it]  6%|▌         | 6/100 [00:26<06:48,  4.35s/it]  7%|▋         | 7/100 [00:30<06:44,  4.35s/it]  8%|▊         | 8/100 [00:35<06:38,  4.34s/it]  9%|▉         | 9/100 [00:39<06:30,  4.29s/it] 10%|█         | 10/100 [00:43<06:22,  4.26s/it] 11%|█         | 11/100 [00:47<06:25,  4.33s/it] 12%|█▏        | 12/100 [00:52<06:17,  4.30s/it] 13%|█▎        | 13/100 [00:56<06:09,  4.25s/it] 14%|█▍        | 14/100 [01:00<06:02,  4.22s/it] 15%|█▌        | 15/100 [01:04<05:56,  4.20s/it] 16%|█▌        | 16/100 [01:08<05:49,  4.16s/it] 17%|█▋        | 17/100 [01:12<05:49,  4.21s/it] 18%|█▊        | 18/100 [01:17<05:49,  4.27s/it] 19%|█▉        | 19/100 [01:21<05:42,  4.23s/it] 20%|██        | 20/100 [01:25<05:41,  4.27s/it] 21%|██        | 21/100 [01:30<05:38,  4.28s/it] 22%|██▏       | 22/100 [01:34<05:34,  4.29s/it] 23%|██▎       | 23/100 [01:38<05:31,  4.31s/it] 24%|██▍       | 24/100 [01:43<05:27,  4.31s/it] 25%|██▌       | 25/100 [01:47<05:22,  4.30s/it] 26%|██▌       | 26/100 [01:52<05:27,  4.42s/it] 27%|██▋       | 27/100 [01:56<05:22,  4.42s/it] 28%|██▊       | 28/100 [02:01<05:25,  4.52s/it] 29%|██▉       | 29/100 [02:06<05:25,  4.58s/it] 30%|███       | 30/100 [02:10<05:19,  4.56s/it] 31%|███       | 31/100 [02:15<05:13,  4.54s/it] 32%|███▏      | 32/100 [02:19<05:11,  4.57s/it] 33%|███▎      | 33/100 [02:24<05:06,  4.58s/it] 34%|███▍      | 34/100 [02:28<05:00,  4.56s/it] 35%|███▌      | 35/100 [02:33<04:55,  4.55s/it] 36%|███▌      | 36/100 [02:37<04:49,  4.52s/it] 37%|███▋      | 37/100 [02:42<04:40,  4.46s/it] 38%|███▊      | 38/100 [02:46<04:33,  4.41s/it] 39%|███▉      | 39/100 [02:50<04:32,  4.47s/it] 40%|████      | 40/100 [02:55<04:23,  4.39s/it] 41%|████      | 41/100 [02:59<04:18,  4.39s/it] 42%|████▏     | 42/100 [03:04<04:18,  4.45s/it] 43%|████▎     | 43/100 [03:08<04:15,  4.48s/it] 44%|████▍     | 44/100 [03:13<04:09,  4.46s/it] 45%|████▌     | 45/100 [03:17<04:01,  4.40s/it] 46%|████▌     | 46/100 [03:21<03:56,  4.38s/it] 47%|████▋     | 47/100 [03:26<03:56,  4.46s/it] 48%|████▊     | 48/100 [03:30<03:51,  4.45s/it] 49%|████▉     | 49/100 [03:35<03:47,  4.45s/it] 50%|█████     | 50/100 [03:39<03:42,  4.45s/it] 51%|█████     | 51/100 [03:44<03:38,  4.47s/it] 52%|█████▏    | 52/100 [03:48<03:34,  4.47s/it] 53%|█████▎    | 53/100 [03:53<03:30,  4.49s/it] 54%|█████▍    | 54/100 [03:57<03:22,  4.41s/it] 55%|█████▌    | 55/100 [04:01<03:16,  4.36s/it] 56%|█████▌    | 56/100 [04:06<03:12,  4.37s/it] 57%|█████▋    | 57/100 [04:10<03:06,  4.33s/it] 58%|█████▊    | 58/100 [04:14<03:01,  4.32s/it] 59%|█████▉    | 59/100 [04:18<02:58,  4.34s/it] 60%|██████    | 60/100 [04:23<02:57,  4.43s/it] 61%|██████    | 61/100 [04:28<02:53,  4.44s/it] 62%|██████▏   | 62/100 [04:32<02:49,  4.46s/it] 63%|██████▎   | 63/100 [04:37<02:45,  4.48s/it] 64%|██████▍   | 64/100 [04:41<02:40,  4.46s/it] 65%|██████▌   | 65/100 [04:45<02:35,  4.43s/it] 66%|██████▌   | 66/100 [04:50<02:29,  4.39s/it] 67%|██████▋   | 67/100 [04:54<02:25,  4.41s/it] 68%|██████▊   | 68/100 [04:59<02:22,  4.46s/it] 69%|██████▉   | 69/100 [05:03<02:16,  4.40s/it] 70%|███████   | 70/100 [05:07<02:11,  4.38s/it] 71%|███████   | 71/100 [05:12<02:05,  4.33s/it] 72%|███████▏  | 72/100 [05:16<02:01,  4.35s/it] 73%|███████▎  | 73/100 [05:20<01:58,  4.40s/it] 74%|███████▍  | 74/100 [05:25<01:56,  4.46s/it] 75%|███████▌  | 75/100 [05:29<01:49,  4.38s/it] 76%|███████▌  | 76/100 [05:34<01:46,  4.44s/it] 77%|███████▋  | 77/100 [05:38<01:41,  4.40s/it] 78%|███████▊  | 78/100 [05:42<01:36,  4.39s/it] 79%|███████▉  | 79/100 [05:47<01:33,  4.46s/it] 80%|████████  | 80/100 [05:52<01:32,  4.60s/it] 81%|████████  | 81/100 [05:57<01:29,  4.72s/it] 82%|████████▏ | 82/100 [06:02<01:25,  4.75s/it] 83%|████████▎ | 83/100 [06:07<01:20,  4.76s/it] 84%|████████▍ | 84/100 [06:11<01:16,  4.75s/it] 85%|████████▌ | 85/100 [06:16<01:10,  4.73s/it] 86%|████████▌ | 86/100 [06:21<01:06,  4.76s/it] 87%|████████▋ | 87/100 [06:26<01:01,  4.74s/it] 88%|████████▊ | 88/100 [06:30<00:57,  4.76s/it] 89%|████████▉ | 89/100 [06:35<00:52,  4.77s/it] 90%|█████████ | 90/100 [06:40<00:47,  4.76s/it] 91%|█████████ | 91/100 [06:44<00:42,  4.71s/it] 92%|█████████▏| 92/100 [06:49<00:38,  4.78s/it] 93%|█████████▎| 93/100 [06:55<00:34,  4.89s/it] 94%|█████████▍| 94/100 [06:59<00:29,  4.88s/it] 95%|█████████▌| 95/100 [07:04<00:24,  4.90s/it] 96%|█████████▌| 96/100 [07:09<00:19,  4.85s/it] 97%|█████████▋| 97/100 [07:14<00:14,  4.80s/it] 98%|█████████▊| 98/100 [07:18<00:09,  4.73s/it] 99%|█████████▉| 99/100 [07:23<00:04,  4.73s/it]100%|██████████| 100/100 [07:28<00:00,  4.73s/it]100%|██████████| 100/100 [07:28<00:00,  4.48s/it]
[0/100] loss: 3.018761396408081 loss_joints: 2.5921032428741455 loss_collision: 0.0004487381665967405 loss_jerk: 0.08841615915298462 loss_floor_contact: 0.7648107409477234
[1/100] loss: 2.302818775177002 loss_joints: 1.952919363975525 loss_collision: 0.0 loss_jerk: 0.07439745217561722 loss_floor_contact: 0.6254011988639832
[2/100] loss: 0.6144314408302307 loss_joints: 0.5027137994766235 loss_collision: 0.0 loss_jerk: 0.09852539747953415 loss_floor_contact: 0.12490985542535782
[3/100] loss: 0.09109582751989365 loss_joints: 0.04964321851730347 loss_collision: 0.0006837352411821485 loss_jerk: 0.08276847004890442 loss_floor_contact: 0.0
[4/100] loss: 0.4027253985404968 loss_joints: 0.353011816740036 loss_collision: 0.015402215532958508 loss_jerk: 0.09634671360254288 loss_floor_contact: 0.0
[5/100] loss: 0.2822299599647522 loss_joints: 0.23550574481487274 loss_collision: 0.005085221026092768 loss_jerk: 0.09243141114711761 loss_floor_contact: 0.0
[6/100] loss: 0.07097926735877991 loss_joints: 0.028390442952513695 loss_collision: 0.0 loss_jerk: 0.08517765253782272 loss_floor_contact: 0.0
[7/100] loss: 0.1224595457315445 loss_joints: 0.08694299310445786 loss_collision: 0.0002789188001770526 loss_jerk: 0.07097731530666351 loss_floor_contact: 0.0
[8/100] loss: 0.1411789357662201 loss_joints: 0.1090683862566948 loss_collision: 0.0 loss_jerk: 0.06422111392021179 loss_floor_contact: 0.0
[9/100] loss: 0.09391774237155914 loss_joints: 0.0611727237701416 loss_collision: 0.0008482807315886021 loss_jerk: 0.06532038748264313 loss_floor_contact: 0.0
[10/100] loss: 0.057849396020174026 loss_joints: 0.025857409462332726 loss_collision: 0.0015429683262482285 loss_jerk: 0.06367538124322891 loss_floor_contact: 0.0
[11/100] loss: 0.05015029013156891 loss_joints: 0.01666206493973732 loss_collision: 0.0 loss_jerk: 0.06697645038366318 loss_floor_contact: 0.0
[12/100] loss: 0.05152982100844383 loss_joints: 0.017038840800523758 loss_collision: 0.0 loss_jerk: 0.06898196041584015 loss_floor_contact: 0.0
[13/100] loss: 0.04560547322034836 loss_joints: 0.012716326862573624 loss_collision: 0.0 loss_jerk: 0.06577829271554947 loss_floor_contact: 0.0
[14/100] loss: 0.04137823358178139 loss_joints: 0.010388326831161976 loss_collision: 0.0005637567956000566 loss_jerk: 0.061867062002420425 loss_floor_contact: 0.0
[15/100] loss: 0.03185616433620453 loss_joints: 0.003736077807843685 loss_collision: 0.00041002954822033644 loss_jerk: 0.056158166378736496 loss_floor_contact: 0.0
[16/100] loss: 0.03187985718250275 loss_joints: 0.004869708325713873 loss_collision: 0.00025601458037272096 loss_jerk: 0.053969092667102814 loss_floor_contact: 0.0
[17/100] loss: 0.0340094268321991 loss_joints: 0.008217813447117805 loss_collision: 0.00019661051919683814 loss_jerk: 0.05154390633106232 loss_floor_contact: 0.0
[18/100] loss: 0.029063411056995392 loss_joints: 0.003630570601671934 loss_collision: 0.0001607732119737193 loss_jerk: 0.050833526998758316 loss_floor_contact: 0.0
[19/100] loss: 0.026327282190322876 loss_joints: 0.00027701276121661067 loss_collision: 0.00020293548004701734 loss_jerk: 0.052059952169656754 loss_floor_contact: 0.0
[20/100] loss: 0.027010831981897354 loss_joints: 0.0011244371999055147 loss_collision: 0.00011365918180672452 loss_jerk: 0.0517500564455986 loss_floor_contact: 0.0
[21/100] loss: 0.02387589029967785 loss_joints: 0.00018620461924001575 loss_collision: 5.9727295592892915e-05 loss_jerk: 0.04736742749810219 loss_floor_contact: 0.0
[22/100] loss: 0.02417975850403309 loss_joints: 0.0012959814630448818 loss_collision: 0.0 loss_jerk: 0.04576755315065384 loss_floor_contact: 0.0
[23/100] loss: 0.023759663105010986 loss_joints: 0.0012051656376570463 loss_collision: 0.00012047130439896137 loss_jerk: 0.04508490115404129 loss_floor_contact: 0.0
[24/100] loss: 0.021500494331121445 loss_joints: 0.00030480651184916496 loss_collision: 0.00018042325973510742 loss_jerk: 0.04235529154539108 loss_floor_contact: 0.0
[25/100] loss: 0.021269798278808594 loss_joints: 0.0004950651782564819 loss_collision: 0.0002853274345397949 loss_jerk: 0.04149240255355835 loss_floor_contact: 0.0
[26/100] loss: 0.02080344222486019 loss_joints: 0.00020200111612211913 loss_collision: 0.0002965869789477438 loss_jerk: 0.041143566370010376 loss_floor_contact: 0.0
[27/100] loss: 0.020126091316342354 loss_joints: 0.0003770575567614287 loss_collision: 7.722125883447006e-05 loss_jerk: 0.03948262333869934 loss_floor_contact: 0.0
[28/100] loss: 0.018946994096040726 loss_joints: 0.00039363207179121673 loss_collision: 0.00012652920850086957 loss_jerk: 0.03708141669631004 loss_floor_contact: 0.0
[29/100] loss: 0.018174367025494576 loss_joints: 7.792235555825755e-05 loss_collision: 0.0 loss_jerk: 0.036192890256643295 loss_floor_contact: 0.0
[30/100] loss: 0.017196115106344223 loss_joints: 3.6525372706819326e-05 loss_collision: 0.0 loss_jerk: 0.034319180995225906 loss_floor_contact: 0.0
[31/100] loss: 0.01787308044731617 loss_joints: 0.000773994717746973 loss_collision: 0.0 loss_jerk: 0.03419817239046097 loss_floor_contact: 0.0
[32/100] loss: 0.016923196613788605 loss_joints: 0.000328662630636245 loss_collision: 0.0 loss_jerk: 0.0331890694797039 loss_floor_contact: 0.0
[33/100] loss: 0.017547165974974632 loss_joints: 0.0013287983601912856 loss_collision: 0.0 loss_jerk: 0.032436735928058624 loss_floor_contact: 0.0
[34/100] loss: 0.0170513316988945 loss_joints: 0.001536768744699657 loss_collision: 0.0 loss_jerk: 0.031029127538204193 loss_floor_contact: 0.0
[35/100] loss: 0.015620498917996883 loss_joints: 0.0002683639759197831 loss_collision: 0.0 loss_jerk: 0.03070426918566227 loss_floor_contact: 0.0
[36/100] loss: 0.015666447579860687 loss_joints: 0.0006770083564333618 loss_collision: 0.0 loss_jerk: 0.029978878796100616 loss_floor_contact: 0.0
[37/100] loss: 0.015623820945620537 loss_joints: 0.0009336781222373247 loss_collision: 0.0 loss_jerk: 0.02938028611242771 loss_floor_contact: 0.0
[38/100] loss: 0.015921244397759438 loss_joints: 0.000807407486718148 loss_collision: 0.0 loss_jerk: 0.030227672308683395 loss_floor_contact: 0.0
[39/100] loss: 0.015165810473263264 loss_joints: 0.00034467526711523533 loss_collision: 0.0 loss_jerk: 0.029642270877957344 loss_floor_contact: 0.0
[40/100] loss: 0.01575329527258873 loss_joints: 0.0005182054592296481 loss_collision: 0.0 loss_jerk: 0.03047018125653267 loss_floor_contact: 0.0
[41/100] loss: 0.0151224909350276 loss_joints: 0.0004720145370811224 loss_collision: 0.0 loss_jerk: 0.029300952330231667 loss_floor_contact: 0.0
[42/100] loss: 0.014331389218568802 loss_joints: 6.958316953387111e-05 loss_collision: 0.00016816420247778296 loss_jerk: 0.0284899789839983 loss_floor_contact: 0.0
[43/100] loss: 0.013737441971898079 loss_joints: 8.605908078607172e-05 loss_collision: 0.0001390656689181924 loss_jerk: 0.027274953201413155 loss_floor_contact: 0.0
[44/100] loss: 0.014024836011230946 loss_joints: 0.00013010634575039148 loss_collision: 0.0005123810260556638 loss_jerk: 0.027686983346939087 loss_floor_contact: 0.0
[45/100] loss: 0.013603245839476585 loss_joints: 0.00017241484601981938 loss_collision: 0.00027430974296294153 loss_jerk: 0.026806799694895744 loss_floor_contact: 0.0
[46/100] loss: 0.013779597356915474 loss_joints: 9.658816270530224e-05 loss_collision: 2.086391941702459e-05 loss_jerk: 0.02736184559762478 loss_floor_contact: 0.0
[47/100] loss: 0.013636479154229164 loss_joints: 0.00018826653831638396 loss_collision: 0.0 loss_jerk: 0.02689642459154129 loss_floor_contact: 0.0
[48/100] loss: 0.013253256678581238 loss_joints: 0.0001876999158412218 loss_collision: 0.00016073769074864686 loss_jerk: 0.026098966598510742 loss_floor_contact: 0.0
[49/100] loss: 0.013193485327064991 loss_joints: 7.268426270456985e-05 loss_collision: 0.0005057890084572136 loss_jerk: 0.026140443980693817 loss_floor_contact: 0.0
[50/100] loss: 0.013170077465474606 loss_joints: 0.00010545250552240759 loss_collision: 0.000443215569248423 loss_jerk: 0.026040606200695038 loss_floor_contact: 0.0
[51/100] loss: 0.013074461370706558 loss_joints: 0.00014000297232996672 loss_collision: 0.0003680472436826676 loss_jerk: 0.025795307010412216 loss_floor_contact: 0.0
[52/100] loss: 0.013151289895176888 loss_joints: 0.0002197600551880896 loss_collision: 0.000470485829282552 loss_jerk: 0.025768961757421494 loss_floor_contact: 0.0
[53/100] loss: 0.012820165604352951 loss_joints: 3.907014615833759e-05 loss_collision: 0.00023885874543339014 loss_jerk: 0.02551441825926304 loss_floor_contact: 0.0
[54/100] loss: 0.012647618539631367 loss_joints: 0.0004223202704451978 loss_collision: 5.732706267735921e-05 loss_jerk: 0.0244391318410635 loss_floor_contact: 0.0
[55/100] loss: 0.012436790391802788 loss_joints: 0.00051949976477772 loss_collision: 0.0 loss_jerk: 0.023834580555558205 loss_floor_contact: 0.0
[56/100] loss: 0.011985422112047672 loss_joints: 0.00012457075354177505 loss_collision: 0.0 loss_jerk: 0.02372170239686966 loss_floor_contact: 0.0
[57/100] loss: 0.012854618020355701 loss_joints: 0.00040634602191857994 loss_collision: 0.0 loss_jerk: 0.024896543473005295 loss_floor_contact: 0.0
[58/100] loss: 0.01256437785923481 loss_joints: 0.0004051322757732123 loss_collision: 0.0 loss_jerk: 0.02431849204003811 loss_floor_contact: 0.0
[59/100] loss: 0.01187183614820242 loss_joints: 8.724620420252904e-05 loss_collision: 0.0 loss_jerk: 0.023569179698824883 loss_floor_contact: 0.0
[60/100] loss: 0.011885765939950943 loss_joints: 0.00023940262326505035 loss_collision: 0.0 loss_jerk: 0.023292725905776024 loss_floor_contact: 0.0
[61/100] loss: 0.011746063828468323 loss_joints: 0.0002672002883628011 loss_collision: 0.0 loss_jerk: 0.022957727313041687 loss_floor_contact: 0.0
[62/100] loss: 0.011654154397547245 loss_joints: 0.000136156304506585 loss_collision: 0.0 loss_jerk: 0.023035995662212372 loss_floor_contact: 0.0
[63/100] loss: 0.011701409704983234 loss_joints: 4.403109414852224e-05 loss_collision: 0.0 loss_jerk: 0.023314757272601128 loss_floor_contact: 0.0
[64/100] loss: 0.011624854989349842 loss_joints: 0.00020473243785090744 loss_collision: 0.0 loss_jerk: 0.022840244695544243 loss_floor_contact: 0.0
[65/100] loss: 0.011767532676458359 loss_joints: 0.00026675232220441103 loss_collision: 0.0 loss_jerk: 0.02300156094133854 loss_floor_contact: 0.0
[66/100] loss: 0.011642134748399258 loss_joints: 2.5562030714354478e-05 loss_collision: 0.0 loss_jerk: 0.023233145475387573 loss_floor_contact: 0.0
[67/100] loss: 0.011740042828023434 loss_joints: 0.00022192571486812085 loss_collision: 0.0 loss_jerk: 0.023036234080791473 loss_floor_contact: 0.0
[68/100] loss: 0.011717131361365318 loss_joints: 0.0003396001411601901 loss_collision: 0.0 loss_jerk: 0.022755062207579613 loss_floor_contact: 0.0
[69/100] loss: 0.011245574802160263 loss_joints: 0.00010659170220606029 loss_collision: 0.0 loss_jerk: 0.022277966141700745 loss_floor_contact: 0.0
[70/100] loss: 0.011288047768175602 loss_joints: 0.00014479769743047655 loss_collision: 0.0 loss_jerk: 0.02228650078177452 loss_floor_contact: 0.0
[71/100] loss: 0.01134646125137806 loss_joints: 0.00020058975496795028 loss_collision: 0.0 loss_jerk: 0.022291742265224457 loss_floor_contact: 0.0
[72/100] loss: 0.011101880110800266 loss_joints: 0.00011964872101088986 loss_collision: 0.0 loss_jerk: 0.021964462473988533 loss_floor_contact: 0.0
[73/100] loss: 0.0109871132299304 loss_joints: 0.00017275560821872205 loss_collision: 0.0 loss_jerk: 0.021628715097904205 loss_floor_contact: 0.0
[74/100] loss: 0.010699920356273651 loss_joints: 0.0001721264998195693 loss_collision: 0.0 loss_jerk: 0.021055588498711586 loss_floor_contact: 0.0
[75/100] loss: 0.010866199620068073 loss_joints: 0.00019618688384070992 loss_collision: 0.0 loss_jerk: 0.02134002558887005 loss_floor_contact: 0.0
[76/100] loss: 0.01072060689330101 loss_joints: 0.00017646956257522106 loss_collision: 0.0 loss_jerk: 0.02108827419579029 loss_floor_contact: 0.0
[77/100] loss: 0.010782088153064251 loss_joints: 6.09823691775091e-05 loss_collision: 0.0 loss_jerk: 0.021442212164402008 loss_floor_contact: 0.0
[78/100] loss: 0.010783984325826168 loss_joints: 0.0001147622533608228 loss_collision: 0.0 loss_jerk: 0.02133844420313835 loss_floor_contact: 0.0
[79/100] loss: 0.010596109554171562 loss_joints: 0.0002080775157082826 loss_collision: 0.0 loss_jerk: 0.020776063203811646 loss_floor_contact: 0.0
[80/100] loss: 0.01031824853271246 loss_joints: 9.712419705465436e-05 loss_collision: 0.0 loss_jerk: 0.02044224925339222 loss_floor_contact: 0.0
[81/100] loss: 0.010246187448501587 loss_joints: 4.465082383831032e-06 loss_collision: 0.0 loss_jerk: 0.02048344537615776 loss_floor_contact: 0.0
[82/100] loss: 0.01023019663989544 loss_joints: 6.285778363235295e-05 loss_collision: 0.0 loss_jerk: 0.020334677770733833 loss_floor_contact: 0.0
[83/100] loss: 0.01026215497404337 loss_joints: 4.739913856610656e-05 loss_collision: 0.0 loss_jerk: 0.020429512485861778 loss_floor_contact: 0.0
[84/100] loss: 0.010079942643642426 loss_joints: 1.0376850696047768e-05 loss_collision: 0.0 loss_jerk: 0.02013913169503212 loss_floor_contact: 0.0
[85/100] loss: 0.010055405087769032 loss_joints: 3.3380369131918997e-05 loss_collision: 0.0 loss_jerk: 0.020044049248099327 loss_floor_contact: 0.0
[86/100] loss: 0.009993452578783035 loss_joints: 1.8881928554037586e-05 loss_collision: 0.0 loss_jerk: 0.019949141889810562 loss_floor_contact: 0.0
[87/100] loss: 0.009964830242097378 loss_joints: 1.7724845520206145e-06 loss_collision: 0.0 loss_jerk: 0.01992611587047577 loss_floor_contact: 0.0
[88/100] loss: 0.009889688342809677 loss_joints: 3.2850352909008507e-06 loss_collision: 0.0 loss_jerk: 0.019772807136178017 loss_floor_contact: 0.0
[89/100] loss: 0.009920194745063782 loss_joints: 3.0856818966640276e-07 loss_collision: 0.0 loss_jerk: 0.019839772954583168 loss_floor_contact: 0.0
[90/100] loss: 0.009926960803568363 loss_joints: 1.5881196304690093e-06 loss_collision: 0.0 loss_jerk: 0.019850745797157288 loss_floor_contact: 0.0
[91/100] loss: 0.009916514158248901 loss_joints: 2.580540012786514e-06 loss_collision: 0.0 loss_jerk: 0.019827866926789284 loss_floor_contact: 0.0
[92/100] loss: 0.009779511019587517 loss_joints: 1.3922316384196165e-06 loss_collision: 0.0 loss_jerk: 0.019556237384676933 loss_floor_contact: 0.0
[93/100] loss: 0.009791363961994648 loss_joints: 5.141238034411799e-06 loss_collision: 0.0 loss_jerk: 0.01957244612276554 loss_floor_contact: 0.0
[94/100] loss: 0.009727760218083858 loss_joints: 2.9237876333354507e-06 loss_collision: 0.0 loss_jerk: 0.01944967359304428 loss_floor_contact: 0.0
[95/100] loss: 0.009581600315868855 loss_joints: 7.247962798828667e-07 loss_collision: 0.0 loss_jerk: 0.019161751493811607 loss_floor_contact: 0.0
[96/100] loss: 0.009510711766779423 loss_joints: 4.280133907741401e-06 loss_collision: 0.0 loss_jerk: 0.01901286281645298 loss_floor_contact: 0.0
[97/100] loss: 0.009539657272398472 loss_joints: 4.937616722600069e-06 loss_collision: 0.0 loss_jerk: 0.01906943880021572 loss_floor_contact: 0.0
[98/100] loss: 0.009492680430412292 loss_joints: 1.5426070376634016e-06 loss_collision: 0.0 loss_jerk: 0.01898227632045746 loss_floor_contact: 0.0
[99/100] loss: 0.00948211457580328 loss_joints: 1.2265513760212343e-07 loss_collision: 0.0 loss_jerk: 0.01896398328244686 loss_floor_contact: 0.0
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.25/contact_thresh_0.75/cabE-path3-run12-4000_collision0.1_contact0.5_jerk0.5_skate1.0]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 448.35115                                                    ║
    ║     rollout = 205.92219                                                    ║
    ║     sdf     = 20.07170                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00948211                                                 ║
    ║     joints    = 0.00000012                                                 ║
    ║     collision = 0.00000000                                                 ║
    ║     jerk      = 0.01896398                                                 ║
    ║     floor     = 0.00000000                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	7m47.566s
user	6m53.732s
sys	0m18.358s
[INFO] Running with collision=0.1, contact=0.5, jerk=1.0, skate=0.1
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 98 = (8*12 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:04<07:30,  4.55s/it]  2%|▏         | 2/100 [00:09<07:30,  4.60s/it]  3%|▎         | 3/100 [00:14<07:57,  4.92s/it]  4%|▍         | 4/100 [00:19<07:47,  4.87s/it]  5%|▌         | 5/100 [00:24<07:50,  4.95s/it]  6%|▌         | 6/100 [00:29<07:40,  4.90s/it]  7%|▋         | 7/100 [00:33<07:23,  4.76s/it]  8%|▊         | 8/100 [00:38<07:18,  4.77s/it]  9%|▉         | 9/100 [00:43<07:18,  4.82s/it] 10%|█         | 10/100 [00:47<07:07,  4.75s/it] 11%|█         | 11/100 [00:52<07:01,  4.73s/it] 12%|█▏        | 12/100 [00:57<06:50,  4.67s/it] 13%|█▎        | 13/100 [01:01<06:45,  4.66s/it] 14%|█▍        | 14/100 [01:06<06:45,  4.72s/it] 15%|█▌        | 15/100 [01:11<06:40,  4.71s/it] 16%|█▌        | 16/100 [01:16<06:47,  4.85s/it] 17%|█▋        | 17/100 [01:21<06:39,  4.81s/it] 18%|█▊        | 18/100 [01:26<06:34,  4.82s/it] 19%|█▉        | 19/100 [01:30<06:28,  4.80s/it] 20%|██        | 20/100 [01:35<06:23,  4.79s/it] 21%|██        | 21/100 [01:40<06:24,  4.86s/it] 22%|██▏       | 22/100 [01:45<06:18,  4.86s/it] 23%|██▎       | 23/100 [01:50<06:12,  4.84s/it] 24%|██▍       | 24/100 [01:54<06:02,  4.78s/it] 25%|██▌       | 25/100 [02:00<06:05,  4.87s/it] 26%|██▌       | 26/100 [02:05<06:05,  4.94s/it] 27%|██▋       | 27/100 [02:09<05:57,  4.90s/it] 28%|██▊       | 28/100 [02:15<06:02,  5.03s/it] 29%|██▉       | 29/100 [02:20<06:00,  5.08s/it] 30%|███       | 30/100 [02:25<05:45,  4.94s/it] 31%|███       | 31/100 [02:29<05:37,  4.90s/it] 32%|███▏      | 32/100 [02:34<05:31,  4.87s/it] 33%|███▎      | 33/100 [02:39<05:24,  4.84s/it] 34%|███▍      | 34/100 [02:44<05:17,  4.80s/it] 35%|███▌      | 35/100 [02:48<05:07,  4.74s/it] 36%|███▌      | 36/100 [02:53<05:04,  4.75s/it] 37%|███▋      | 37/100 [02:58<05:05,  4.86s/it] 38%|███▊      | 38/100 [03:03<05:03,  4.89s/it]slurmstepd: error: *** JOB 45461 ON studgpu-node02 CANCELLED AT 2025-05-28T18:54:28 DUE TO TIME LIMIT ***
