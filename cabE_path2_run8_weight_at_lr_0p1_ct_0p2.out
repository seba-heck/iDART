[INFO] Running interaction: run_8
[INFO] Running optimization with learning rate: 0.1
[INFO] Running with contact threshold: 0.2
[INFO] Running with collision=0.1, contact=0.1, jerk=0.1, skate=0.1
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:05<08:17,  5.02s/it]  2%|▏         | 2/100 [00:08<06:32,  4.00s/it]  3%|▎         | 3/100 [00:11<06:03,  3.75s/it]  4%|▍         | 4/100 [00:14<05:33,  3.48s/it]  5%|▌         | 5/100 [00:17<05:08,  3.25s/it]  6%|▌         | 6/100 [00:20<04:56,  3.15s/it]  7%|▋         | 7/100 [00:23<04:40,  3.02s/it]  8%|▊         | 8/100 [00:26<04:29,  2.93s/it]  9%|▉         | 9/100 [00:28<04:22,  2.88s/it] 10%|█         | 10/100 [00:31<04:12,  2.81s/it] 11%|█         | 11/100 [00:34<04:06,  2.77s/it] 12%|█▏        | 12/100 [00:36<04:02,  2.76s/it] 13%|█▎        | 13/100 [00:40<04:08,  2.86s/it] 14%|█▍        | 14/100 [00:43<04:18,  3.01s/it] 15%|█▌        | 15/100 [00:46<04:16,  3.02s/it] 16%|█▌        | 16/100 [00:49<04:13,  3.01s/it] 17%|█▋        | 17/100 [00:52<04:13,  3.05s/it] 18%|█▊        | 18/100 [00:55<04:11,  3.06s/it] 19%|█▉        | 19/100 [00:58<04:05,  3.03s/it] 20%|██        | 20/100 [01:01<04:09,  3.12s/it] 21%|██        | 21/100 [01:05<04:07,  3.13s/it] 22%|██▏       | 22/100 [01:07<03:55,  3.02s/it] 23%|██▎       | 23/100 [01:10<03:49,  2.98s/it] 24%|██▍       | 24/100 [01:13<03:44,  2.96s/it] 25%|██▌       | 25/100 [01:16<03:39,  2.92s/it] 26%|██▌       | 26/100 [01:19<03:37,  2.95s/it] 27%|██▋       | 27/100 [01:22<03:43,  3.06s/it] 28%|██▊       | 28/100 [01:26<03:44,  3.11s/it] 29%|██▉       | 29/100 [01:29<03:42,  3.13s/it] 30%|███       | 30/100 [01:32<03:35,  3.08s/it] 31%|███       | 31/100 [01:35<03:27,  3.00s/it] 32%|███▏      | 32/100 [01:37<03:21,  2.97s/it] 33%|███▎      | 33/100 [01:41<03:26,  3.08s/it] 34%|███▍      | 34/100 [01:44<03:18,  3.00s/it] 35%|███▌      | 35/100 [01:47<03:15,  3.01s/it] 36%|███▌      | 36/100 [01:50<03:12,  3.00s/it] 37%|███▋      | 37/100 [01:52<03:05,  2.95s/it] 38%|███▊      | 38/100 [01:55<03:04,  2.98s/it] 39%|███▉      | 39/100 [01:58<02:58,  2.93s/it] 40%|████      | 40/100 [02:01<02:54,  2.91s/it] 41%|████      | 41/100 [02:04<02:50,  2.89s/it] 42%|████▏     | 42/100 [02:08<02:59,  3.10s/it] 43%|████▎     | 43/100 [02:11<03:00,  3.18s/it] 44%|████▍     | 44/100 [02:15<03:05,  3.31s/it] 45%|████▌     | 45/100 [02:18<03:05,  3.37s/it] 46%|████▌     | 46/100 [02:21<03:02,  3.39s/it] 47%|████▋     | 47/100 [02:25<03:01,  3.42s/it] 48%|████▊     | 48/100 [02:28<02:56,  3.40s/it] 49%|████▉     | 49/100 [02:32<02:51,  3.37s/it] 50%|█████     | 50/100 [02:35<02:47,  3.35s/it] 51%|█████     | 51/100 [02:38<02:43,  3.34s/it] 52%|█████▏    | 52/100 [02:41<02:37,  3.28s/it] 53%|█████▎    | 53/100 [02:45<02:32,  3.25s/it] 54%|█████▍    | 54/100 [02:48<02:25,  3.17s/it] 55%|█████▌    | 55/100 [02:51<02:24,  3.21s/it] 56%|█████▌    | 56/100 [02:54<02:23,  3.25s/it] 57%|█████▋    | 57/100 [02:57<02:19,  3.25s/it] 58%|█████▊    | 58/100 [03:01<02:16,  3.26s/it] 59%|█████▉    | 59/100 [03:04<02:12,  3.24s/it] 60%|██████    | 60/100 [03:07<02:08,  3.20s/it] 61%|██████    | 61/100 [03:10<02:03,  3.18s/it] 62%|██████▏   | 62/100 [03:13<01:59,  3.14s/it] 63%|██████▎   | 63/100 [03:16<01:55,  3.12s/it] 64%|██████▍   | 64/100 [03:19<01:53,  3.14s/it] 65%|██████▌   | 65/100 [03:23<01:51,  3.18s/it] 66%|██████▌   | 66/100 [03:26<01:47,  3.16s/it] 67%|██████▋   | 67/100 [03:29<01:45,  3.21s/it] 68%|██████▊   | 68/100 [03:33<01:43,  3.24s/it] 69%|██████▉   | 69/100 [03:36<01:41,  3.28s/it] 70%|███████   | 70/100 [03:39<01:38,  3.29s/it] 71%|███████   | 71/100 [03:42<01:34,  3.25s/it] 72%|███████▏  | 72/100 [03:46<01:31,  3.25s/it] 73%|███████▎  | 73/100 [03:49<01:28,  3.26s/it] 74%|███████▍  | 74/100 [03:52<01:22,  3.19s/it] 75%|███████▌  | 75/100 [03:55<01:18,  3.15s/it] 76%|███████▌  | 76/100 [03:58<01:15,  3.14s/it] 77%|███████▋  | 77/100 [04:01<01:10,  3.09s/it] 78%|███████▊  | 78/100 [04:04<01:07,  3.08s/it] 79%|███████▉  | 79/100 [04:07<01:05,  3.11s/it] 80%|████████  | 80/100 [04:11<01:02,  3.14s/it] 81%|████████  | 81/100 [04:14<01:00,  3.20s/it] 82%|████████▏ | 82/100 [04:17<00:57,  3.18s/it] 83%|████████▎ | 83/100 [04:20<00:54,  3.21s/it] 84%|████████▍ | 84/100 [04:24<00:52,  3.26s/it] 85%|████████▌ | 85/100 [04:27<00:48,  3.24s/it] 86%|████████▌ | 86/100 [04:30<00:46,  3.29s/it] 87%|████████▋ | 87/100 [04:34<00:42,  3.30s/it] 88%|████████▊ | 88/100 [04:37<00:39,  3.25s/it] 89%|████████▉ | 89/100 [04:40<00:35,  3.27s/it] 90%|█████████ | 90/100 [04:43<00:32,  3.26s/it] 91%|█████████ | 91/100 [04:47<00:29,  3.31s/it] 92%|█████████▏| 92/100 [04:50<00:26,  3.28s/it] 93%|█████████▎| 93/100 [04:53<00:22,  3.27s/it] 94%|█████████▍| 94/100 [04:56<00:19,  3.20s/it] 95%|█████████▌| 95/100 [04:59<00:15,  3.16s/it] 96%|█████████▌| 96/100 [05:02<00:12,  3.19s/it] 97%|█████████▋| 97/100 [05:06<00:09,  3.24s/it] 98%|█████████▊| 98/100 [05:09<00:06,  3.27s/it] 99%|█████████▉| 99/100 [05:13<00:03,  3.29s/it]100%|██████████| 100/100 [05:16<00:00,  3.29s/it]100%|██████████| 100/100 [05:16<00:00,  3.16s/it]
[0/100] loss: 2.6899635791778564 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.4818742275238037 loss_joints: 2.4042022228240967 loss_collision: 0.15364891290664673 loss_jerk: 0.06821777671575546 loss_floor_contact: 0.5548513531684875
[2/100] loss: 2.0643036365509033 loss_joints: 1.9638667106628418 loss_collision: 0.2373698502779007 loss_jerk: 0.09598477184772491 loss_floor_contact: 0.671014130115509
[3/100] loss: 1.352412223815918 loss_joints: 1.2822901010513306 loss_collision: 0.2347494512796402 loss_jerk: 0.10437574237585068 loss_floor_contact: 0.36209583282470703
[4/100] loss: 0.8025346398353577 loss_joints: 0.7756139636039734 loss_collision: 0.14860790967941284 loss_jerk: 0.09187738597393036 loss_floor_contact: 0.02872098796069622
[5/100] loss: 0.4329168498516083 loss_joints: 0.39137002825737 loss_collision: 0.2890177369117737 loss_jerk: 0.10514625906944275 loss_floor_contact: 0.021304097026586533
[6/100] loss: 0.16943925619125366 loss_joints: 0.14529895782470703 loss_collision: 0.12084787338972092 loss_jerk: 0.098981574177742 loss_floor_contact: 0.02157355658710003
[7/100] loss: 0.05287057161331177 loss_joints: 0.03900299593806267 loss_collision: 0.027674704790115356 loss_jerk: 0.08959053456783295 loss_floor_contact: 0.02141050435602665
[8/100] loss: 0.05096344277262688 loss_joints: 0.03639831393957138 loss_collision: 0.02351684495806694 loss_jerk: 0.10067141056060791 loss_floor_contact: 0.021463003009557724
[9/100] loss: 0.0669836699962616 loss_joints: 0.05139805004000664 loss_collision: 0.016828006133437157 loss_jerk: 0.11775694042444229 loss_floor_contact: 0.021271254867315292
[10/100] loss: 0.06427668780088425 loss_joints: 0.04644116386771202 loss_collision: 0.031338758766651154 loss_jerk: 0.12322396785020828 loss_floor_contact: 0.023792551830410957
[11/100] loss: 0.03937244787812233 loss_joints: 0.01903996616601944 loss_collision: 0.05097923055291176 loss_jerk: 0.13204322755336761 loss_floor_contact: 0.020302359014749527
[12/100] loss: 0.03145614638924599 loss_joints: 0.007376819383352995 loss_collision: 0.09642252326011658 loss_jerk: 0.1246730163693428 loss_floor_contact: 0.019697746261954308
[13/100] loss: 0.035162653774023056 loss_joints: 0.00573324877768755 loss_collision: 0.1617206484079361 loss_jerk: 0.11291579157114029 loss_floor_contact: 0.01965760998427868
[14/100] loss: 0.03309328854084015 loss_joints: 0.00542735680937767 loss_collision: 0.1603212058544159 loss_jerk: 0.09552307426929474 loss_floor_contact: 0.02081502601504326
[15/100] loss: 0.025147872045636177 loss_joints: 0.004840065725147724 loss_collision: 0.09500335901975632 loss_jerk: 0.08893606811761856 loss_floor_contact: 0.01913861744105816
[16/100] loss: 0.02279241941869259 loss_joints: 0.007471015676856041 loss_collision: 0.04719056561589241 loss_jerk: 0.08682025969028473 loss_floor_contact: 0.019203219562768936
[17/100] loss: 0.020679188892245293 loss_joints: 0.00639039371162653 loss_collision: 0.03906403109431267 loss_jerk: 0.08470650017261505 loss_floor_contact: 0.01911742426455021
[18/100] loss: 0.01881275698542595 loss_joints: 0.0036585095804184675 loss_collision: 0.05062234401702881 loss_jerk: 0.08197112381458282 loss_floor_contact: 0.018948985263705254
[19/100] loss: 0.017552625387907028 loss_joints: 0.002000828506425023 loss_collision: 0.056160278618335724 loss_jerk: 0.0805319994688034 loss_floor_contact: 0.01882568746805191
[20/100] loss: 0.01648223027586937 loss_joints: 0.002246338874101639 loss_collision: 0.0436873584985733 loss_jerk: 0.07990337163209915 loss_floor_contact: 0.01876818761229515
[21/100] loss: 0.016646597534418106 loss_joints: 0.0036285133101046085 loss_collision: 0.035606659948825836 loss_jerk: 0.07578208297491074 loss_floor_contact: 0.01879209280014038
[22/100] loss: 0.014108697883784771 loss_joints: 0.0016877440502867103 loss_collision: 0.03080800548195839 loss_jerk: 0.07463959604501724 loss_floor_contact: 0.018761932849884033
[23/100] loss: 0.012953223660588264 loss_joints: 0.0013347459025681019 loss_collision: 0.02437290921807289 loss_jerk: 0.07307685166597366 loss_floor_contact: 0.018735017627477646
[24/100] loss: 0.013055870309472084 loss_joints: 0.0019950068090111017 loss_collision: 0.020829420536756516 loss_jerk: 0.07104383409023285 loss_floor_contact: 0.018735378980636597
[25/100] loss: 0.011148277670145035 loss_joints: 0.0005050987238064408 loss_collision: 0.017151961103081703 loss_jerk: 0.07048565149307251 loss_floor_contact: 0.01879417523741722
[26/100] loss: 0.012642741203308105 loss_joints: 0.001345115015283227 loss_collision: 0.025487450882792473 loss_jerk: 0.0680779367685318 loss_floor_contact: 0.019410867244005203
[27/100] loss: 0.012809795327484608 loss_joints: 0.002212165854871273 loss_collision: 0.019275762140750885 loss_jerk: 0.06743134558200836 loss_floor_contact: 0.01926918886601925
[28/100] loss: 0.012557699345052242 loss_joints: 0.0022456981241703033 loss_collision: 0.01721353270113468 loss_jerk: 0.06648743152618408 loss_floor_contact: 0.019419055432081223
[29/100] loss: 0.01235467940568924 loss_joints: 0.0016739501152187586 loss_collision: 0.021684397011995316 loss_jerk: 0.06550019234418869 loss_floor_contact: 0.01962270215153694
[30/100] loss: 0.01099724043160677 loss_joints: 0.0004144093836657703 loss_collision: 0.02093920111656189 loss_jerk: 0.0648217499256134 loss_floor_contact: 0.020067352801561356
[31/100] loss: 0.011469496414065361 loss_joints: 0.0008745621889829636 loss_collision: 0.021012423560023308 loss_jerk: 0.06421957165002823 loss_floor_contact: 0.02071734145283699
[32/100] loss: 0.012533633038401604 loss_joints: 0.0021001407876610756 loss_collision: 0.0209006629884243 loss_jerk: 0.06329421699047089 loss_floor_contact: 0.0201400313526392
[33/100] loss: 0.011316877789795399 loss_joints: 0.0011695571010932326 loss_collision: 0.018301885575056076 loss_jerk: 0.06310845911502838 loss_floor_contact: 0.02006285823881626
[34/100] loss: 0.00994052179157734 loss_joints: 0.00010867142555071041 loss_collision: 0.016303252428770065 loss_jerk: 0.06272708624601364 loss_floor_contact: 0.019288161769509315
[35/100] loss: 0.010538787581026554 loss_joints: 0.0009756699437275529 loss_collision: 0.016496658325195312 loss_jerk: 0.06006930395960808 loss_floor_contact: 0.019065210595726967
[36/100] loss: 0.01080648135393858 loss_joints: 0.001390143297612667 loss_collision: 0.016184264793992043 loss_jerk: 0.05918008089065552 loss_floor_contact: 0.018799033015966415
[37/100] loss: 0.009984098374843597 loss_joints: 0.0007061189389787614 loss_collision: 0.015152265317738056 loss_jerk: 0.058781854808330536 loss_floor_contact: 0.01884567365050316
[38/100] loss: 0.0097367437556386 loss_joints: 0.00016647651500534266 loss_collision: 0.018092643469572067 loss_jerk: 0.05870125815272331 loss_floor_contact: 0.018908776342868805
[39/100] loss: 0.010389413684606552 loss_joints: 0.0009071356616914272 loss_collision: 0.017074352130293846 loss_jerk: 0.058821674436330795 loss_floor_contact: 0.018926749005913734
[40/100] loss: 0.010256225243210793 loss_joints: 0.0011753045255318284 loss_collision: 0.01356881856918335 loss_jerk: 0.05830233171582222 loss_floor_contact: 0.018938051536679268
[41/100] loss: 0.009061387740075588 loss_joints: 0.0003402019792702049 loss_collision: 0.010174289345741272 loss_jerk: 0.05809815600514412 loss_floor_contact: 0.018939414992928505
[42/100] loss: 0.009065537713468075 loss_joints: 0.0003117678570561111 loss_collision: 0.011156192980706692 loss_jerk: 0.05742984637618065 loss_floor_contact: 0.0189516618847847
[43/100] loss: 0.009198359213769436 loss_joints: 0.0006574973231181502 loss_collision: 0.009793641045689583 loss_jerk: 0.0566665455698967 loss_floor_contact: 0.01894843578338623
[44/100] loss: 0.00914827547967434 loss_joints: 0.00034781749127432704 loss_collision: 0.010925743728876114 loss_jerk: 0.05814802646636963 loss_floor_contact: 0.018930809572339058
[45/100] loss: 0.008814573287963867 loss_joints: 0.0001666279713390395 loss_collision: 0.009235622361302376 loss_jerk: 0.05830024927854538 loss_floor_contact: 0.018943585455417633
[46/100] loss: 0.008337637409567833 loss_joints: 0.0001550147426314652 loss_collision: 0.005746084731072187 loss_jerk: 0.05709487199783325 loss_floor_contact: 0.018985265865921974
[47/100] loss: 0.008520442992448807 loss_joints: 0.00033910758793354034 loss_collision: 0.006972178816795349 loss_jerk: 0.0558578297495842 loss_floor_contact: 0.018983347341418266
[48/100] loss: 0.008143210783600807 loss_joints: 5.25953910255339e-05 loss_collision: 0.0062503996305167675 loss_jerk: 0.05572367459535599 loss_floor_contact: 0.018932074308395386
[49/100] loss: 0.008538338355720043 loss_joints: 0.00020468966977205127 loss_collision: 0.009281019680202007 loss_jerk: 0.05519671365618706 loss_floor_contact: 0.01885875128209591
[50/100] loss: 0.008694373071193695 loss_joints: 0.0001848033571150154 loss_collision: 0.012052047997713089 loss_jerk: 0.054198116064071655 loss_floor_contact: 0.018845535814762115
[51/100] loss: 0.008456667885184288 loss_joints: 8.421708480454981e-05 loss_collision: 0.010572132654488087 loss_jerk: 0.05431923642754555 loss_floor_contact: 0.018833139911293983
[52/100] loss: 0.00817069225013256 loss_joints: 1.4255603673518635e-05 loss_collision: 0.007941356860101223 loss_jerk: 0.05479826778173447 loss_floor_contact: 0.018824739381670952
[53/100] loss: 0.008227583952248096 loss_joints: 3.075211134273559e-05 loss_collision: 0.007798304315656424 loss_jerk: 0.05534772202372551 loss_floor_contact: 0.018822290003299713
[54/100] loss: 0.00838247686624527 loss_joints: 0.00011339504271745682 loss_collision: 0.008419477380812168 loss_jerk: 0.05545222759246826 loss_floor_contact: 0.018819117918610573
[55/100] loss: 0.0081851901486516 loss_joints: 5.8447867559152655e-06 loss_collision: 0.007089951075613499 loss_jerk: 0.05592751130461693 loss_floor_contact: 0.01877598650753498
[56/100] loss: 0.008514061570167542 loss_joints: 0.00014619663124904037 loss_collision: 0.009273714385926723 loss_jerk: 0.055695053189992905 loss_floor_contact: 0.018709875643253326
[57/100] loss: 0.008531030267477036 loss_joints: 0.00014616758562624454 loss_collision: 0.009646043181419373 loss_jerk: 0.055528659373521805 loss_floor_contact: 0.018673917278647423
[58/100] loss: 0.008355523459613323 loss_joints: 8.100183913484216e-05 loss_collision: 0.008647888898849487 loss_jerk: 0.05544638633728027 loss_floor_contact: 0.01865093968808651
[59/100] loss: 0.008138668723404408 loss_joints: 8.328536932822317e-05 loss_collision: 0.006455909926444292 loss_jerk: 0.05549108237028122 loss_floor_contact: 0.018606841564178467
[60/100] loss: 0.008082590997219086 loss_joints: 9.227915143128484e-05 loss_collision: 0.005556818563491106 loss_jerk: 0.05580359697341919 loss_floor_contact: 0.0185426976531744
[61/100] loss: 0.00795195996761322 loss_joints: 2.5094803277170286e-05 loss_collision: 0.0052026743069291115 loss_jerk: 0.05554988980293274 loss_floor_contact: 0.018516087904572487
[62/100] loss: 0.007946598343551159 loss_joints: 4.884088411927223e-05 loss_collision: 0.0055935862474143505 loss_jerk: 0.05486419424414635 loss_floor_contact: 0.018519792705774307
[63/100] loss: 0.007964533753693104 loss_joints: 2.2480611733044498e-05 loss_collision: 0.006167056038975716 loss_jerk: 0.05475606024265289 loss_floor_contact: 0.018497411161661148
[64/100] loss: 0.008098248392343521 loss_joints: 4.727033228846267e-05 loss_collision: 0.007352665066719055 loss_jerk: 0.05470215529203415 loss_floor_contact: 0.018454955890774727
[65/100] loss: 0.007915114052593708 loss_joints: 7.649733561265748e-06 loss_collision: 0.006569491699337959 loss_jerk: 0.05407917872071266 loss_floor_contact: 0.01842597872018814
[66/100] loss: 0.008005036972463131 loss_joints: 8.250444079749286e-05 loss_collision: 0.006480839569121599 loss_jerk: 0.05436071753501892 loss_floor_contact: 0.018383771181106567
[67/100] loss: 0.008023358881473541 loss_joints: 2.9917331630713306e-05 loss_collision: 0.007259948644787073 loss_jerk: 0.054361481219530106 loss_floor_contact: 0.018312985077500343
[68/100] loss: 0.0080168591812253 loss_joints: 8.375440665986389e-05 loss_collision: 0.007169819436967373 loss_jerk: 0.053906187415122986 loss_floor_contact: 0.018255041912198067
[69/100] loss: 0.008028769865632057 loss_joints: 0.00011580081627471372 loss_collision: 0.006800481118261814 loss_jerk: 0.054097626358270645 loss_floor_contact: 0.018231583759188652
[70/100] loss: 0.007824482396245003 loss_joints: 2.6432695449329913e-05 loss_collision: 0.005745801609009504 loss_jerk: 0.05399128794670105 loss_floor_contact: 0.01824340596795082
[71/100] loss: 0.0076958853751420975 loss_joints: 4.5868800953030586e-05 loss_collision: 0.004536761436611414 loss_jerk: 0.05370192974805832 loss_floor_contact: 0.018261469900608063
[72/100] loss: 0.007591306231915951 loss_joints: 2.0540128389257006e-05 loss_collision: 0.004056925419718027 loss_jerk: 0.053372591733932495 loss_floor_contact: 0.01827813871204853
[73/100] loss: 0.007555737160146236 loss_joints: 2.8179609216749668e-05 loss_collision: 0.00414396682754159 loss_jerk: 0.05284079164266586 loss_floor_contact: 0.018290817737579346
[74/100] loss: 0.0076095229014754295 loss_joints: 3.0672308639623225e-05 loss_collision: 0.004637549165636301 loss_jerk: 0.05283409729599953 loss_floor_contact: 0.018316859379410744
[75/100] loss: 0.0075774784199893475 loss_joints: 6.954457057872787e-05 loss_collision: 0.004143749829381704 loss_jerk: 0.052594397217035294 loss_floor_contact: 0.018341191112995148
[76/100] loss: 0.0074916197918355465 loss_joints: 5.398920620791614e-05 loss_collision: 0.0038788632955402136 loss_jerk: 0.052160657942295074 loss_floor_contact: 0.018336785957217216
[77/100] loss: 0.007401539012789726 loss_joints: 3.81237841793336e-05 loss_collision: 0.0034114073496311903 loss_jerk: 0.05190335586667061 loss_floor_contact: 0.0183193888515234
[78/100] loss: 0.007323595695197582 loss_joints: 1.3269653209135868e-05 loss_collision: 0.003148969728499651 loss_jerk: 0.051643431186676025 loss_floor_contact: 0.018310852348804474
[79/100] loss: 0.007381822448223829 loss_joints: 2.8954780646017753e-05 loss_collision: 0.0037834378890693188 loss_jerk: 0.051460087299346924 loss_floor_contact: 0.018285149708390236
[80/100] loss: 0.0073067727498710155 loss_joints: 2.5875491701299325e-05 loss_collision: 0.0033721807412803173 loss_jerk: 0.05116741731762886 loss_floor_contact: 0.018269376829266548
[81/100] loss: 0.007264021784067154 loss_joints: 8.563030860386789e-06 loss_collision: 0.003068634308874607 loss_jerk: 0.05122330039739609 loss_floor_contact: 0.018262654542922974
[82/100] loss: 0.0072608147747814655 loss_joints: 1.0367917639086954e-05 loss_collision: 0.0033939266577363014 loss_jerk: 0.05086841061711311 loss_floor_contact: 0.018242130056023598
[83/100] loss: 0.007198694162070751 loss_joints: 9.914412657963112e-06 loss_collision: 0.003380392910912633 loss_jerk: 0.050299759954214096 loss_floor_contact: 0.018207646906375885
[84/100] loss: 0.007168118376284838 loss_joints: 5.107510332891252e-06 loss_collision: 0.0034587415866553783 loss_jerk: 0.049990568310022354 loss_floor_contact: 0.01818080060184002
[85/100] loss: 0.007216497790068388 loss_joints: 1.3389901141636074e-05 loss_collision: 0.00377430347725749 loss_jerk: 0.05010001361370087 loss_floor_contact: 0.018156763166189194
[86/100] loss: 0.007181207183748484 loss_joints: 2.3343198336078785e-05 loss_collision: 0.003552958369255066 loss_jerk: 0.04988870397210121 loss_floor_contact: 0.018136974424123764
[87/100] loss: 0.007147038821130991 loss_joints: 1.5669400454498827e-05 loss_collision: 0.0037675003986805677 loss_jerk: 0.04943176358938217 loss_floor_contact: 0.018114427104592323
[88/100] loss: 0.0070882271975278854 loss_joints: 1.2537171642179601e-05 loss_collision: 0.003733777441084385 loss_jerk: 0.04892195388674736 loss_floor_contact: 0.018101168796420097
[89/100] loss: 0.0070412238128483295 loss_joints: 6.801314157200977e-06 loss_collision: 0.003352544503286481 loss_jerk: 0.048899296671152115 loss_floor_contact: 0.018092384561896324
[90/100] loss: 0.0070195687003433704 loss_joints: 2.1604006178677082e-05 loss_collision: 0.0031655547209084034 loss_jerk: 0.04872670769691467 loss_floor_contact: 0.01808738149702549
[91/100] loss: 0.007058925461024046 loss_joints: 2.6825166060007177e-05 loss_collision: 0.003564814804121852 loss_jerk: 0.04867614060640335 loss_floor_contact: 0.01808004267513752
[92/100] loss: 0.006991151720285416 loss_joints: 1.3844338354829233e-05 loss_collision: 0.0029998619575053453 loss_jerk: 0.048699766397476196 loss_floor_contact: 0.018073443323373795
[93/100] loss: 0.006991644389927387 loss_joints: 5.043460987508297e-06 loss_collision: 0.00311265722848475 loss_jerk: 0.048689112067222595 loss_floor_contact: 0.018064239993691444
[94/100] loss: 0.006923711858689785 loss_joints: 2.279927684867289e-06 loss_collision: 0.002556148450821638 loss_jerk: 0.04860236123204231 loss_floor_contact: 0.018055805936455727
[95/100] loss: 0.0069271232932806015 loss_joints: 7.701922186242882e-06 loss_collision: 0.002614435274153948 loss_jerk: 0.048531293869018555 loss_floor_contact: 0.01804848574101925
[96/100] loss: 0.006912486627697945 loss_joints: 1.0024911716755014e-05 loss_collision: 0.002548838732764125 loss_jerk: 0.04843662306666374 loss_floor_contact: 0.018039153888821602
[97/100] loss: 0.006891088560223579 loss_joints: 5.79113020648947e-06 loss_collision: 0.0025243775453418493 loss_jerk: 0.048300229012966156 loss_floor_contact: 0.018028369173407555
[98/100] loss: 0.006868712604045868 loss_joints: 2.6734494440461276e-06 loss_collision: 0.002397283911705017 loss_jerk: 0.048244453966617584 loss_floor_contact: 0.018018653616309166
[99/100] loss: 0.006870865356177092 loss_joints: 1.7175798348034732e-06 loss_collision: 0.0024931877851486206 loss_jerk: 0.048185087740421295 loss_floor_contact: 0.018013199791312218
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk0.1_skate0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 316.33719                                                    ║
    ║     rollout = 139.86426                                                    ║
    ║     sdf     = 20.14957                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00687087                                                 ║
    ║     joints    = 0.00000172                                                 ║
    ║     collision = 0.00249319                                                 ║
    ║     jerk      = 0.04818509                                                 ║
    ║     floor     = 0.01801320                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m58.743s
user	4m45.084s
sys	0m19.036s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.1, skate=0.25
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:06,  3.09s/it]  2%|▏         | 2/100 [00:05<04:35,  2.81s/it]  3%|▎         | 3/100 [00:08<04:52,  3.02s/it]  4%|▍         | 4/100 [00:11<04:38,  2.90s/it]  5%|▌         | 5/100 [00:14<04:29,  2.84s/it]  6%|▌         | 6/100 [00:17<04:31,  2.89s/it]  7%|▋         | 7/100 [00:20<04:24,  2.84s/it]  8%|▊         | 8/100 [00:22<04:19,  2.82s/it]  9%|▉         | 9/100 [00:25<04:16,  2.82s/it] 10%|█         | 10/100 [00:28<04:10,  2.78s/it] 11%|█         | 11/100 [00:31<04:05,  2.75s/it] 12%|█▏        | 12/100 [00:33<04:02,  2.75s/it] 13%|█▎        | 13/100 [00:36<03:56,  2.71s/it] 14%|█▍        | 14/100 [00:39<03:53,  2.71s/it] 15%|█▌        | 15/100 [00:41<03:46,  2.67s/it] 16%|█▌        | 16/100 [00:44<03:43,  2.66s/it] 17%|█▋        | 17/100 [00:47<03:39,  2.65s/it] 18%|█▊        | 18/100 [00:49<03:37,  2.65s/it] 19%|█▉        | 19/100 [00:52<03:32,  2.62s/it] 20%|██        | 20/100 [00:55<03:37,  2.72s/it] 21%|██        | 21/100 [00:57<03:32,  2.69s/it] 22%|██▏       | 22/100 [01:00<03:28,  2.68s/it] 23%|██▎       | 23/100 [01:03<03:24,  2.66s/it] 24%|██▍       | 24/100 [01:06<03:28,  2.74s/it] 25%|██▌       | 25/100 [01:08<03:25,  2.74s/it] 26%|██▌       | 26/100 [01:11<03:22,  2.74s/it] 27%|██▋       | 27/100 [01:14<03:21,  2.77s/it] 28%|██▊       | 28/100 [01:17<03:19,  2.77s/it] 29%|██▉       | 29/100 [01:19<03:15,  2.75s/it] 30%|███       | 30/100 [01:22<03:10,  2.72s/it] 31%|███       | 31/100 [01:25<03:06,  2.71s/it] 32%|███▏      | 32/100 [01:27<03:07,  2.76s/it] 33%|███▎      | 33/100 [01:30<03:06,  2.79s/it] 34%|███▍      | 34/100 [01:33<03:01,  2.75s/it] 35%|███▌      | 35/100 [01:36<02:57,  2.73s/it] 36%|███▌      | 36/100 [01:38<02:53,  2.70s/it] 37%|███▋      | 37/100 [01:41<02:51,  2.72s/it] 38%|███▊      | 38/100 [01:44<02:48,  2.71s/it] 39%|███▉      | 39/100 [01:46<02:44,  2.70s/it] 40%|████      | 40/100 [01:49<02:41,  2.68s/it] 41%|████      | 41/100 [01:52<02:37,  2.67s/it] 42%|████▏     | 42/100 [01:55<02:36,  2.70s/it] 43%|████▎     | 43/100 [01:57<02:34,  2.72s/it] 44%|████▍     | 44/100 [02:00<02:36,  2.79s/it] 45%|████▌     | 45/100 [02:03<02:34,  2.80s/it] 46%|████▌     | 46/100 [02:06<02:37,  2.92s/it] 47%|████▋     | 47/100 [02:11<02:56,  3.33s/it] 48%|████▊     | 48/100 [02:13<02:43,  3.14s/it] 49%|████▉     | 49/100 [02:16<02:34,  3.02s/it] 50%|█████     | 50/100 [02:19<02:26,  2.93s/it] 51%|█████     | 51/100 [02:21<02:18,  2.84s/it] 52%|█████▏    | 52/100 [02:24<02:14,  2.80s/it] 53%|█████▎    | 53/100 [02:27<02:09,  2.74s/it] 54%|█████▍    | 54/100 [02:29<02:06,  2.75s/it] 55%|█████▌    | 55/100 [02:32<02:02,  2.72s/it] 56%|█████▌    | 56/100 [02:35<01:58,  2.69s/it] 57%|█████▋    | 57/100 [02:37<01:56,  2.71s/it] 58%|█████▊    | 58/100 [02:41<01:58,  2.83s/it] 59%|█████▉    | 59/100 [02:44<01:58,  2.89s/it] 60%|██████    | 60/100 [02:46<01:53,  2.85s/it] 61%|██████    | 61/100 [02:49<01:48,  2.79s/it] 62%|██████▏   | 62/100 [02:52<01:44,  2.74s/it] 63%|██████▎   | 63/100 [02:54<01:42,  2.76s/it] 64%|██████▍   | 64/100 [02:57<01:40,  2.78s/it] 65%|██████▌   | 65/100 [03:00<01:34,  2.71s/it] 66%|██████▌   | 66/100 [03:02<01:30,  2.67s/it] 67%|██████▋   | 67/100 [03:05<01:27,  2.65s/it] 68%|██████▊   | 68/100 [03:08<01:24,  2.63s/it] 69%|██████▉   | 69/100 [03:10<01:21,  2.64s/it] 70%|███████   | 70/100 [03:13<01:20,  2.67s/it] 71%|███████   | 71/100 [03:16<01:18,  2.71s/it] 72%|███████▏  | 72/100 [03:19<01:17,  2.78s/it] 73%|███████▎  | 73/100 [03:21<01:13,  2.73s/it] 74%|███████▍  | 74/100 [03:24<01:11,  2.73s/it] 75%|███████▌  | 75/100 [03:27<01:08,  2.73s/it] 76%|███████▌  | 76/100 [03:30<01:07,  2.80s/it] 77%|███████▋  | 77/100 [03:33<01:05,  2.83s/it] 78%|███████▊  | 78/100 [03:36<01:02,  2.85s/it] 79%|███████▉  | 79/100 [03:39<01:02,  3.00s/it] 80%|████████  | 80/100 [03:42<01:01,  3.06s/it] 81%|████████  | 81/100 [03:45<00:58,  3.06s/it] 82%|████████▏ | 82/100 [03:48<00:53,  2.97s/it] 83%|████████▎ | 83/100 [03:51<00:48,  2.88s/it] 84%|████████▍ | 84/100 [03:54<00:46,  2.90s/it] 85%|████████▌ | 85/100 [03:56<00:43,  2.89s/it] 86%|████████▌ | 86/100 [03:59<00:39,  2.85s/it] 87%|████████▋ | 87/100 [04:02<00:36,  2.83s/it] 88%|████████▊ | 88/100 [04:05<00:33,  2.78s/it] 89%|████████▉ | 89/100 [04:07<00:30,  2.77s/it] 90%|█████████ | 90/100 [04:10<00:28,  2.80s/it] 91%|█████████ | 91/100 [04:13<00:25,  2.78s/it] 92%|█████████▏| 92/100 [04:16<00:22,  2.84s/it] 93%|█████████▎| 93/100 [04:19<00:20,  2.92s/it] 94%|█████████▍| 94/100 [04:22<00:17,  2.87s/it] 95%|█████████▌| 95/100 [04:25<00:14,  2.86s/it] 96%|█████████▌| 96/100 [04:27<00:11,  2.83s/it] 97%|█████████▋| 97/100 [04:30<00:08,  2.84s/it] 98%|█████████▊| 98/100 [04:33<00:05,  2.89s/it] 99%|█████████▉| 99/100 [04:36<00:02,  2.97s/it]100%|██████████| 100/100 [04:39<00:00,  2.91s/it]100%|██████████| 100/100 [04:39<00:00,  2.80s/it]
[0/100] loss: 2.6899635791778564 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.4818742275238037 loss_joints: 2.4042022228240967 loss_collision: 0.15364891290664673 loss_jerk: 0.06821777671575546 loss_floor_contact: 0.5548513531684875
[2/100] loss: 2.0643036365509033 loss_joints: 1.9638667106628418 loss_collision: 0.2373698502779007 loss_jerk: 0.09598477184772491 loss_floor_contact: 0.671014130115509
[3/100] loss: 1.352412223815918 loss_joints: 1.2822901010513306 loss_collision: 0.2347494512796402 loss_jerk: 0.10437574237585068 loss_floor_contact: 0.36209583282470703
[4/100] loss: 0.8025346398353577 loss_joints: 0.7756139636039734 loss_collision: 0.14860790967941284 loss_jerk: 0.09187738597393036 loss_floor_contact: 0.02872098796069622
[5/100] loss: 0.4329168498516083 loss_joints: 0.39137002825737 loss_collision: 0.2890177369117737 loss_jerk: 0.10514625906944275 loss_floor_contact: 0.021304097026586533
[6/100] loss: 0.16943925619125366 loss_joints: 0.14529895782470703 loss_collision: 0.12084787338972092 loss_jerk: 0.098981574177742 loss_floor_contact: 0.02157355658710003
[7/100] loss: 0.05287057161331177 loss_joints: 0.03900299593806267 loss_collision: 0.027674704790115356 loss_jerk: 0.08959053456783295 loss_floor_contact: 0.02141050435602665
[8/100] loss: 0.05096344277262688 loss_joints: 0.03639831393957138 loss_collision: 0.02351684495806694 loss_jerk: 0.10067141056060791 loss_floor_contact: 0.021463003009557724
[9/100] loss: 0.0669836699962616 loss_joints: 0.05139805004000664 loss_collision: 0.016828006133437157 loss_jerk: 0.11775694042444229 loss_floor_contact: 0.021271254867315292
[10/100] loss: 0.06427668780088425 loss_joints: 0.04644116386771202 loss_collision: 0.031338758766651154 loss_jerk: 0.12322396785020828 loss_floor_contact: 0.023792551830410957
[11/100] loss: 0.03937244787812233 loss_joints: 0.01903996616601944 loss_collision: 0.05097923055291176 loss_jerk: 0.13204322755336761 loss_floor_contact: 0.020302359014749527
[12/100] loss: 0.03145614638924599 loss_joints: 0.007376819383352995 loss_collision: 0.09642252326011658 loss_jerk: 0.1246730163693428 loss_floor_contact: 0.019697746261954308
[13/100] loss: 0.035162653774023056 loss_joints: 0.00573324877768755 loss_collision: 0.1617206484079361 loss_jerk: 0.11291579157114029 loss_floor_contact: 0.01965760998427868
[14/100] loss: 0.03309328854084015 loss_joints: 0.00542735680937767 loss_collision: 0.1603212058544159 loss_jerk: 0.09552307426929474 loss_floor_contact: 0.02081502601504326
[15/100] loss: 0.025147872045636177 loss_joints: 0.004840065725147724 loss_collision: 0.09500335901975632 loss_jerk: 0.08893606811761856 loss_floor_contact: 0.01913861744105816
[16/100] loss: 0.02279241941869259 loss_joints: 0.007471015676856041 loss_collision: 0.04719056561589241 loss_jerk: 0.08682025969028473 loss_floor_contact: 0.019203219562768936
[17/100] loss: 0.020679188892245293 loss_joints: 0.00639039371162653 loss_collision: 0.03906403109431267 loss_jerk: 0.08470650017261505 loss_floor_contact: 0.01911742426455021
[18/100] loss: 0.01881275698542595 loss_joints: 0.0036585095804184675 loss_collision: 0.05062234401702881 loss_jerk: 0.08197112381458282 loss_floor_contact: 0.018948985263705254
[19/100] loss: 0.017552625387907028 loss_joints: 0.002000828506425023 loss_collision: 0.056160278618335724 loss_jerk: 0.0805319994688034 loss_floor_contact: 0.01882568746805191
[20/100] loss: 0.01648223027586937 loss_joints: 0.002246338874101639 loss_collision: 0.0436873584985733 loss_jerk: 0.07990337163209915 loss_floor_contact: 0.01876818761229515
[21/100] loss: 0.016646597534418106 loss_joints: 0.0036285133101046085 loss_collision: 0.035606659948825836 loss_jerk: 0.07578208297491074 loss_floor_contact: 0.01879209280014038
[22/100] loss: 0.014108697883784771 loss_joints: 0.0016877440502867103 loss_collision: 0.03080800548195839 loss_jerk: 0.07463959604501724 loss_floor_contact: 0.018761932849884033
[23/100] loss: 0.012953223660588264 loss_joints: 0.0013347459025681019 loss_collision: 0.02437290921807289 loss_jerk: 0.07307685166597366 loss_floor_contact: 0.018735017627477646
[24/100] loss: 0.013055870309472084 loss_joints: 0.0019950068090111017 loss_collision: 0.020829420536756516 loss_jerk: 0.07104383409023285 loss_floor_contact: 0.018735378980636597
[25/100] loss: 0.011148277670145035 loss_joints: 0.0005050987238064408 loss_collision: 0.017151961103081703 loss_jerk: 0.07048565149307251 loss_floor_contact: 0.01879417523741722
[26/100] loss: 0.012642741203308105 loss_joints: 0.001345115015283227 loss_collision: 0.025487450882792473 loss_jerk: 0.0680779367685318 loss_floor_contact: 0.019410867244005203
[27/100] loss: 0.012809795327484608 loss_joints: 0.002212165854871273 loss_collision: 0.019275762140750885 loss_jerk: 0.06743134558200836 loss_floor_contact: 0.01926918886601925
[28/100] loss: 0.012557699345052242 loss_joints: 0.0022456981241703033 loss_collision: 0.01721353270113468 loss_jerk: 0.06648743152618408 loss_floor_contact: 0.019419055432081223
[29/100] loss: 0.01235467940568924 loss_joints: 0.0016739501152187586 loss_collision: 0.021684397011995316 loss_jerk: 0.06550019234418869 loss_floor_contact: 0.01962270215153694
[30/100] loss: 0.01099724043160677 loss_joints: 0.0004144093836657703 loss_collision: 0.02093920111656189 loss_jerk: 0.0648217499256134 loss_floor_contact: 0.020067352801561356
[31/100] loss: 0.011469496414065361 loss_joints: 0.0008745621889829636 loss_collision: 0.021012423560023308 loss_jerk: 0.06421957165002823 loss_floor_contact: 0.02071734145283699
[32/100] loss: 0.012533633038401604 loss_joints: 0.0021001407876610756 loss_collision: 0.0209006629884243 loss_jerk: 0.06329421699047089 loss_floor_contact: 0.0201400313526392
[33/100] loss: 0.011316877789795399 loss_joints: 0.0011695571010932326 loss_collision: 0.018301885575056076 loss_jerk: 0.06310845911502838 loss_floor_contact: 0.02006285823881626
[34/100] loss: 0.00994052179157734 loss_joints: 0.00010867142555071041 loss_collision: 0.016303252428770065 loss_jerk: 0.06272708624601364 loss_floor_contact: 0.019288161769509315
[35/100] loss: 0.010538787581026554 loss_joints: 0.0009756699437275529 loss_collision: 0.016496658325195312 loss_jerk: 0.06006930395960808 loss_floor_contact: 0.019065210595726967
[36/100] loss: 0.01080648135393858 loss_joints: 0.001390143297612667 loss_collision: 0.016184264793992043 loss_jerk: 0.05918008089065552 loss_floor_contact: 0.018799033015966415
[37/100] loss: 0.009984098374843597 loss_joints: 0.0007061189389787614 loss_collision: 0.015152265317738056 loss_jerk: 0.058781854808330536 loss_floor_contact: 0.01884567365050316
[38/100] loss: 0.0097367437556386 loss_joints: 0.00016647651500534266 loss_collision: 0.018092643469572067 loss_jerk: 0.05870125815272331 loss_floor_contact: 0.018908776342868805
[39/100] loss: 0.010389413684606552 loss_joints: 0.0009071356616914272 loss_collision: 0.017074352130293846 loss_jerk: 0.058821674436330795 loss_floor_contact: 0.018926749005913734
[40/100] loss: 0.010256225243210793 loss_joints: 0.0011753045255318284 loss_collision: 0.01356881856918335 loss_jerk: 0.05830233171582222 loss_floor_contact: 0.018938051536679268
[41/100] loss: 0.009061387740075588 loss_joints: 0.0003402019792702049 loss_collision: 0.010174289345741272 loss_jerk: 0.05809815600514412 loss_floor_contact: 0.018939414992928505
[42/100] loss: 0.009065537713468075 loss_joints: 0.0003117678570561111 loss_collision: 0.011156192980706692 loss_jerk: 0.05742984637618065 loss_floor_contact: 0.0189516618847847
[43/100] loss: 0.009198359213769436 loss_joints: 0.0006574973231181502 loss_collision: 0.009793641045689583 loss_jerk: 0.0566665455698967 loss_floor_contact: 0.01894843578338623
[44/100] loss: 0.00914827547967434 loss_joints: 0.00034781749127432704 loss_collision: 0.010925743728876114 loss_jerk: 0.05814802646636963 loss_floor_contact: 0.018930809572339058
[45/100] loss: 0.008814573287963867 loss_joints: 0.0001666279713390395 loss_collision: 0.009235622361302376 loss_jerk: 0.05830024927854538 loss_floor_contact: 0.018943585455417633
[46/100] loss: 0.008337637409567833 loss_joints: 0.0001550147426314652 loss_collision: 0.005746084731072187 loss_jerk: 0.05709487199783325 loss_floor_contact: 0.018985265865921974
[47/100] loss: 0.008520442992448807 loss_joints: 0.00033910758793354034 loss_collision: 0.006972178816795349 loss_jerk: 0.0558578297495842 loss_floor_contact: 0.018983347341418266
[48/100] loss: 0.008143210783600807 loss_joints: 5.25953910255339e-05 loss_collision: 0.0062503996305167675 loss_jerk: 0.05572367459535599 loss_floor_contact: 0.018932074308395386
[49/100] loss: 0.008538338355720043 loss_joints: 0.00020468966977205127 loss_collision: 0.009281019680202007 loss_jerk: 0.05519671365618706 loss_floor_contact: 0.01885875128209591
[50/100] loss: 0.008694373071193695 loss_joints: 0.0001848033571150154 loss_collision: 0.012052047997713089 loss_jerk: 0.054198116064071655 loss_floor_contact: 0.018845535814762115
[51/100] loss: 0.008456667885184288 loss_joints: 8.421708480454981e-05 loss_collision: 0.010572132654488087 loss_jerk: 0.05431923642754555 loss_floor_contact: 0.018833139911293983
[52/100] loss: 0.00817069225013256 loss_joints: 1.4255603673518635e-05 loss_collision: 0.007941356860101223 loss_jerk: 0.05479826778173447 loss_floor_contact: 0.018824739381670952
[53/100] loss: 0.008227583952248096 loss_joints: 3.075211134273559e-05 loss_collision: 0.007798304315656424 loss_jerk: 0.05534772202372551 loss_floor_contact: 0.018822290003299713
[54/100] loss: 0.00838247686624527 loss_joints: 0.00011339504271745682 loss_collision: 0.008419477380812168 loss_jerk: 0.05545222759246826 loss_floor_contact: 0.018819117918610573
[55/100] loss: 0.0081851901486516 loss_joints: 5.8447867559152655e-06 loss_collision: 0.007089951075613499 loss_jerk: 0.05592751130461693 loss_floor_contact: 0.01877598650753498
[56/100] loss: 0.008514061570167542 loss_joints: 0.00014619663124904037 loss_collision: 0.009273714385926723 loss_jerk: 0.055695053189992905 loss_floor_contact: 0.018709875643253326
[57/100] loss: 0.008531030267477036 loss_joints: 0.00014616758562624454 loss_collision: 0.009646043181419373 loss_jerk: 0.055528659373521805 loss_floor_contact: 0.018673917278647423
[58/100] loss: 0.008355523459613323 loss_joints: 8.100183913484216e-05 loss_collision: 0.008647888898849487 loss_jerk: 0.05544638633728027 loss_floor_contact: 0.01865093968808651
[59/100] loss: 0.008138668723404408 loss_joints: 8.328536932822317e-05 loss_collision: 0.006455909926444292 loss_jerk: 0.05549108237028122 loss_floor_contact: 0.018606841564178467
[60/100] loss: 0.008082590997219086 loss_joints: 9.227915143128484e-05 loss_collision: 0.005556818563491106 loss_jerk: 0.05580359697341919 loss_floor_contact: 0.0185426976531744
[61/100] loss: 0.00795195996761322 loss_joints: 2.5094803277170286e-05 loss_collision: 0.0052026743069291115 loss_jerk: 0.05554988980293274 loss_floor_contact: 0.018516087904572487
[62/100] loss: 0.007946598343551159 loss_joints: 4.884088411927223e-05 loss_collision: 0.0055935862474143505 loss_jerk: 0.05486419424414635 loss_floor_contact: 0.018519792705774307
[63/100] loss: 0.007964533753693104 loss_joints: 2.2480611733044498e-05 loss_collision: 0.006167056038975716 loss_jerk: 0.05475606024265289 loss_floor_contact: 0.018497411161661148
[64/100] loss: 0.008098248392343521 loss_joints: 4.727033228846267e-05 loss_collision: 0.007352665066719055 loss_jerk: 0.05470215529203415 loss_floor_contact: 0.018454955890774727
[65/100] loss: 0.007915114052593708 loss_joints: 7.649733561265748e-06 loss_collision: 0.006569491699337959 loss_jerk: 0.05407917872071266 loss_floor_contact: 0.01842597872018814
[66/100] loss: 0.008005036972463131 loss_joints: 8.250444079749286e-05 loss_collision: 0.006480839569121599 loss_jerk: 0.05436071753501892 loss_floor_contact: 0.018383771181106567
[67/100] loss: 0.008023358881473541 loss_joints: 2.9917331630713306e-05 loss_collision: 0.007259948644787073 loss_jerk: 0.054361481219530106 loss_floor_contact: 0.018312985077500343
[68/100] loss: 0.0080168591812253 loss_joints: 8.375440665986389e-05 loss_collision: 0.007169819436967373 loss_jerk: 0.053906187415122986 loss_floor_contact: 0.018255041912198067
[69/100] loss: 0.008028769865632057 loss_joints: 0.00011580081627471372 loss_collision: 0.006800481118261814 loss_jerk: 0.054097626358270645 loss_floor_contact: 0.018231583759188652
[70/100] loss: 0.007824482396245003 loss_joints: 2.6432695449329913e-05 loss_collision: 0.005745801609009504 loss_jerk: 0.05399128794670105 loss_floor_contact: 0.01824340596795082
[71/100] loss: 0.0076958853751420975 loss_joints: 4.5868800953030586e-05 loss_collision: 0.004536761436611414 loss_jerk: 0.05370192974805832 loss_floor_contact: 0.018261469900608063
[72/100] loss: 0.007591306231915951 loss_joints: 2.0540128389257006e-05 loss_collision: 0.004056925419718027 loss_jerk: 0.053372591733932495 loss_floor_contact: 0.01827813871204853
[73/100] loss: 0.007555737160146236 loss_joints: 2.8179609216749668e-05 loss_collision: 0.00414396682754159 loss_jerk: 0.05284079164266586 loss_floor_contact: 0.018290817737579346
[74/100] loss: 0.0076095229014754295 loss_joints: 3.0672308639623225e-05 loss_collision: 0.004637549165636301 loss_jerk: 0.05283409729599953 loss_floor_contact: 0.018316859379410744
[75/100] loss: 0.0075774784199893475 loss_joints: 6.954457057872787e-05 loss_collision: 0.004143749829381704 loss_jerk: 0.052594397217035294 loss_floor_contact: 0.018341191112995148
[76/100] loss: 0.0074916197918355465 loss_joints: 5.398920620791614e-05 loss_collision: 0.0038788632955402136 loss_jerk: 0.052160657942295074 loss_floor_contact: 0.018336785957217216
[77/100] loss: 0.007401539012789726 loss_joints: 3.81237841793336e-05 loss_collision: 0.0034114073496311903 loss_jerk: 0.05190335586667061 loss_floor_contact: 0.0183193888515234
[78/100] loss: 0.007323595695197582 loss_joints: 1.3269653209135868e-05 loss_collision: 0.003148969728499651 loss_jerk: 0.051643431186676025 loss_floor_contact: 0.018310852348804474
[79/100] loss: 0.007381822448223829 loss_joints: 2.8954780646017753e-05 loss_collision: 0.0037834378890693188 loss_jerk: 0.051460087299346924 loss_floor_contact: 0.018285149708390236
[80/100] loss: 0.0073067727498710155 loss_joints: 2.5875491701299325e-05 loss_collision: 0.0033721807412803173 loss_jerk: 0.05116741731762886 loss_floor_contact: 0.018269376829266548
[81/100] loss: 0.007264021784067154 loss_joints: 8.563030860386789e-06 loss_collision: 0.003068634308874607 loss_jerk: 0.05122330039739609 loss_floor_contact: 0.018262654542922974
[82/100] loss: 0.0072608147747814655 loss_joints: 1.0367917639086954e-05 loss_collision: 0.0033939266577363014 loss_jerk: 0.05086841061711311 loss_floor_contact: 0.018242130056023598
[83/100] loss: 0.007198694162070751 loss_joints: 9.914412657963112e-06 loss_collision: 0.003380392910912633 loss_jerk: 0.050299759954214096 loss_floor_contact: 0.018207646906375885
[84/100] loss: 0.007168118376284838 loss_joints: 5.107510332891252e-06 loss_collision: 0.0034587415866553783 loss_jerk: 0.049990568310022354 loss_floor_contact: 0.01818080060184002
[85/100] loss: 0.007216497790068388 loss_joints: 1.3389901141636074e-05 loss_collision: 0.00377430347725749 loss_jerk: 0.05010001361370087 loss_floor_contact: 0.018156763166189194
[86/100] loss: 0.007181207183748484 loss_joints: 2.3343198336078785e-05 loss_collision: 0.003552958369255066 loss_jerk: 0.04988870397210121 loss_floor_contact: 0.018136974424123764
[87/100] loss: 0.007147038821130991 loss_joints: 1.5669400454498827e-05 loss_collision: 0.0037675003986805677 loss_jerk: 0.04943176358938217 loss_floor_contact: 0.018114427104592323
[88/100] loss: 0.0070882271975278854 loss_joints: 1.2537171642179601e-05 loss_collision: 0.003733777441084385 loss_jerk: 0.04892195388674736 loss_floor_contact: 0.018101168796420097
[89/100] loss: 0.0070412238128483295 loss_joints: 6.801314157200977e-06 loss_collision: 0.003352544503286481 loss_jerk: 0.048899296671152115 loss_floor_contact: 0.018092384561896324
[90/100] loss: 0.0070195687003433704 loss_joints: 2.1604006178677082e-05 loss_collision: 0.0031655547209084034 loss_jerk: 0.04872670769691467 loss_floor_contact: 0.01808738149702549
[91/100] loss: 0.007058925461024046 loss_joints: 2.6825166060007177e-05 loss_collision: 0.003564814804121852 loss_jerk: 0.04867614060640335 loss_floor_contact: 0.01808004267513752
[92/100] loss: 0.006991151720285416 loss_joints: 1.3844338354829233e-05 loss_collision: 0.0029998619575053453 loss_jerk: 0.048699766397476196 loss_floor_contact: 0.018073443323373795
[93/100] loss: 0.006991644389927387 loss_joints: 5.043460987508297e-06 loss_collision: 0.00311265722848475 loss_jerk: 0.048689112067222595 loss_floor_contact: 0.018064239993691444
[94/100] loss: 0.006923711858689785 loss_joints: 2.279927684867289e-06 loss_collision: 0.002556148450821638 loss_jerk: 0.04860236123204231 loss_floor_contact: 0.018055805936455727
[95/100] loss: 0.0069271232932806015 loss_joints: 7.701922186242882e-06 loss_collision: 0.002614435274153948 loss_jerk: 0.048531293869018555 loss_floor_contact: 0.01804848574101925
[96/100] loss: 0.006912486627697945 loss_joints: 1.0024911716755014e-05 loss_collision: 0.002548838732764125 loss_jerk: 0.04843662306666374 loss_floor_contact: 0.018039153888821602
[97/100] loss: 0.006891088560223579 loss_joints: 5.79113020648947e-06 loss_collision: 0.0025243775453418493 loss_jerk: 0.048300229012966156 loss_floor_contact: 0.018028369173407555
[98/100] loss: 0.006868712604045868 loss_joints: 2.6734494440461276e-06 loss_collision: 0.002397283911705017 loss_jerk: 0.048244453966617584 loss_floor_contact: 0.018018653616309166
[99/100] loss: 0.006870865356177092 loss_joints: 1.7175798348034732e-06 loss_collision: 0.0024931877851486206 loss_jerk: 0.048185087740421295 loss_floor_contact: 0.018013199791312218
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk0.1_skate0.25]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 279.69315                                                    ║
    ║     rollout = 124.37792                                                    ║
    ║     sdf     = 14.97965                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00687087                                                 ║
    ║     joints    = 0.00000172                                                 ║
    ║     collision = 0.00249319                                                 ║
    ║     jerk      = 0.04818509                                                 ║
    ║     floor     = 0.01801320                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m0.658s
user	4m21.233s
sys	0m17.106s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.1, skate=0.5
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:32,  2.75s/it]  2%|▏         | 2/100 [00:05<04:27,  2.73s/it]  3%|▎         | 3/100 [00:08<04:52,  3.01s/it]  4%|▍         | 4/100 [00:11<04:35,  2.87s/it]  5%|▌         | 5/100 [00:14<04:26,  2.81s/it]  6%|▌         | 6/100 [00:17<04:27,  2.85s/it]  7%|▋         | 7/100 [00:19<04:21,  2.81s/it]  8%|▊         | 8/100 [00:22<04:24,  2.87s/it]  9%|▉         | 9/100 [00:25<04:25,  2.92s/it] 10%|█         | 10/100 [00:28<04:21,  2.90s/it] 11%|█         | 11/100 [00:31<04:19,  2.92s/it] 12%|█▏        | 12/100 [00:34<04:20,  2.96s/it] 13%|█▎        | 13/100 [00:37<04:20,  2.99s/it] 14%|█▍        | 14/100 [00:40<04:14,  2.96s/it] 15%|█▌        | 15/100 [00:43<04:08,  2.93s/it] 16%|█▌        | 16/100 [00:46<04:09,  2.97s/it] 17%|█▋        | 17/100 [00:49<04:07,  2.99s/it] 18%|█▊        | 18/100 [00:52<04:00,  2.93s/it] 19%|█▉        | 19/100 [00:55<03:57,  2.93s/it] 20%|██        | 20/100 [00:58<03:58,  2.98s/it] 21%|██        | 21/100 [01:01<03:57,  3.01s/it] 22%|██▏       | 22/100 [01:04<04:00,  3.08s/it] 23%|██▎       | 23/100 [01:08<04:00,  3.13s/it] 24%|██▍       | 24/100 [01:11<03:54,  3.09s/it] 25%|██▌       | 25/100 [01:13<03:45,  3.01s/it] 26%|██▌       | 26/100 [01:16<03:43,  3.02s/it] 27%|██▋       | 27/100 [01:19<03:42,  3.05s/it] 28%|██▊       | 28/100 [01:23<03:42,  3.09s/it] 29%|██▉       | 29/100 [01:26<03:39,  3.10s/it] 30%|███       | 30/100 [01:29<03:46,  3.23s/it] 31%|███       | 31/100 [01:33<03:42,  3.23s/it] 32%|███▏      | 32/100 [01:36<03:39,  3.23s/it] 33%|███▎      | 33/100 [01:39<03:35,  3.22s/it] 34%|███▍      | 34/100 [01:42<03:30,  3.19s/it] 35%|███▌      | 35/100 [01:45<03:26,  3.17s/it] 36%|███▌      | 36/100 [01:48<03:21,  3.15s/it] 37%|███▋      | 37/100 [01:51<03:16,  3.12s/it] 38%|███▊      | 38/100 [01:55<03:14,  3.13s/it] 39%|███▉      | 39/100 [01:58<03:14,  3.19s/it] 40%|████      | 40/100 [02:01<03:11,  3.19s/it] 41%|████      | 41/100 [02:04<03:10,  3.24s/it] 42%|████▏     | 42/100 [02:08<03:14,  3.35s/it] 43%|████▎     | 43/100 [02:11<03:10,  3.35s/it] 44%|████▍     | 44/100 [02:15<03:11,  3.41s/it] 45%|████▌     | 45/100 [02:18<03:03,  3.34s/it] 46%|████▌     | 46/100 [02:21<02:54,  3.24s/it] 47%|████▋     | 47/100 [02:24<02:51,  3.23s/it] 48%|████▊     | 48/100 [02:27<02:45,  3.19s/it] 49%|████▉     | 49/100 [02:30<02:39,  3.12s/it] 50%|█████     | 50/100 [02:33<02:35,  3.11s/it] 51%|█████     | 51/100 [02:36<02:30,  3.07s/it] 52%|█████▏    | 52/100 [02:39<02:25,  3.04s/it] 53%|█████▎    | 53/100 [02:42<02:22,  3.04s/it] 54%|█████▍    | 54/100 [02:45<02:18,  3.01s/it] 55%|█████▌    | 55/100 [02:48<02:14,  3.00s/it] 56%|█████▌    | 56/100 [02:51<02:11,  2.99s/it] 57%|█████▋    | 57/100 [02:54<02:09,  3.02s/it] 58%|█████▊    | 58/100 [02:57<02:06,  3.01s/it] 59%|█████▉    | 59/100 [03:01<02:05,  3.06s/it] 60%|██████    | 60/100 [03:04<02:01,  3.03s/it] 61%|██████    | 61/100 [03:06<01:57,  3.01s/it] 62%|██████▏   | 62/100 [03:09<01:54,  3.01s/it] 63%|██████▎   | 63/100 [03:12<01:50,  3.00s/it] 64%|██████▍   | 64/100 [03:15<01:47,  2.98s/it] 65%|██████▌   | 65/100 [03:18<01:44,  3.00s/it] 66%|██████▌   | 66/100 [03:21<01:40,  2.96s/it] 67%|██████▋   | 67/100 [03:24<01:35,  2.88s/it] 68%|██████▊   | 68/100 [03:27<01:31,  2.85s/it] 69%|██████▉   | 69/100 [03:30<01:27,  2.81s/it] 70%|███████   | 70/100 [03:32<01:23,  2.79s/it] 71%|███████   | 71/100 [03:35<01:20,  2.79s/it] 72%|███████▏  | 72/100 [03:38<01:19,  2.85s/it] 73%|███████▎  | 73/100 [03:41<01:15,  2.81s/it] 74%|███████▍  | 74/100 [03:44<01:13,  2.82s/it] 75%|███████▌  | 75/100 [03:46<01:10,  2.83s/it] 76%|███████▌  | 76/100 [03:49<01:07,  2.80s/it] 77%|███████▋  | 77/100 [03:52<01:03,  2.78s/it] 78%|███████▊  | 78/100 [03:55<01:00,  2.77s/it] 79%|███████▉  | 79/100 [03:57<00:57,  2.76s/it] 80%|████████  | 80/100 [04:00<00:55,  2.75s/it] 81%|████████  | 81/100 [04:03<00:53,  2.79s/it] 82%|████████▏ | 82/100 [04:06<00:50,  2.78s/it] 83%|████████▎ | 83/100 [04:09<00:47,  2.78s/it] 84%|████████▍ | 84/100 [04:11<00:45,  2.83s/it] 85%|████████▌ | 85/100 [04:14<00:41,  2.80s/it] 86%|████████▌ | 86/100 [04:17<00:38,  2.78s/it] 87%|████████▋ | 87/100 [04:20<00:36,  2.77s/it] 88%|████████▊ | 88/100 [04:23<00:33,  2.80s/it] 89%|████████▉ | 89/100 [04:25<00:30,  2.81s/it] 90%|█████████ | 90/100 [04:28<00:28,  2.84s/it] 91%|█████████ | 91/100 [04:31<00:25,  2.82s/it] 92%|█████████▏| 92/100 [04:34<00:22,  2.83s/it] 93%|█████████▎| 93/100 [04:37<00:19,  2.81s/it] 94%|█████████▍| 94/100 [04:40<00:16,  2.83s/it] 95%|█████████▌| 95/100 [04:43<00:14,  2.89s/it] 96%|█████████▌| 96/100 [04:46<00:11,  3.00s/it] 97%|█████████▋| 97/100 [04:49<00:08,  2.95s/it] 98%|█████████▊| 98/100 [04:52<00:05,  2.98s/it] 99%|█████████▉| 99/100 [04:55<00:02,  2.93s/it]100%|██████████| 100/100 [04:57<00:00,  2.89s/it]100%|██████████| 100/100 [04:57<00:00,  2.98s/it]
[0/100] loss: 2.6899635791778564 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.4818742275238037 loss_joints: 2.4042022228240967 loss_collision: 0.15364891290664673 loss_jerk: 0.06821777671575546 loss_floor_contact: 0.5548513531684875
[2/100] loss: 2.0643036365509033 loss_joints: 1.9638667106628418 loss_collision: 0.2373698502779007 loss_jerk: 0.09598477184772491 loss_floor_contact: 0.671014130115509
[3/100] loss: 1.352412223815918 loss_joints: 1.2822901010513306 loss_collision: 0.2347494512796402 loss_jerk: 0.10437574237585068 loss_floor_contact: 0.36209583282470703
[4/100] loss: 0.8025346398353577 loss_joints: 0.7756139636039734 loss_collision: 0.14860790967941284 loss_jerk: 0.09187738597393036 loss_floor_contact: 0.02872098796069622
[5/100] loss: 0.4329168498516083 loss_joints: 0.39137002825737 loss_collision: 0.2890177369117737 loss_jerk: 0.10514625906944275 loss_floor_contact: 0.021304097026586533
[6/100] loss: 0.16943925619125366 loss_joints: 0.14529895782470703 loss_collision: 0.12084787338972092 loss_jerk: 0.098981574177742 loss_floor_contact: 0.02157355658710003
[7/100] loss: 0.05287057161331177 loss_joints: 0.03900299593806267 loss_collision: 0.027674704790115356 loss_jerk: 0.08959053456783295 loss_floor_contact: 0.02141050435602665
[8/100] loss: 0.05096344277262688 loss_joints: 0.03639831393957138 loss_collision: 0.02351684495806694 loss_jerk: 0.10067141056060791 loss_floor_contact: 0.021463003009557724
[9/100] loss: 0.0669836699962616 loss_joints: 0.05139805004000664 loss_collision: 0.016828006133437157 loss_jerk: 0.11775694042444229 loss_floor_contact: 0.021271254867315292
[10/100] loss: 0.06427668780088425 loss_joints: 0.04644116386771202 loss_collision: 0.031338758766651154 loss_jerk: 0.12322396785020828 loss_floor_contact: 0.023792551830410957
[11/100] loss: 0.03937244787812233 loss_joints: 0.01903996616601944 loss_collision: 0.05097923055291176 loss_jerk: 0.13204322755336761 loss_floor_contact: 0.020302359014749527
[12/100] loss: 0.03145614638924599 loss_joints: 0.007376819383352995 loss_collision: 0.09642252326011658 loss_jerk: 0.1246730163693428 loss_floor_contact: 0.019697746261954308
[13/100] loss: 0.035162653774023056 loss_joints: 0.00573324877768755 loss_collision: 0.1617206484079361 loss_jerk: 0.11291579157114029 loss_floor_contact: 0.01965760998427868
[14/100] loss: 0.03309328854084015 loss_joints: 0.00542735680937767 loss_collision: 0.1603212058544159 loss_jerk: 0.09552307426929474 loss_floor_contact: 0.02081502601504326
[15/100] loss: 0.025147872045636177 loss_joints: 0.004840065725147724 loss_collision: 0.09500335901975632 loss_jerk: 0.08893606811761856 loss_floor_contact: 0.01913861744105816
[16/100] loss: 0.02279241941869259 loss_joints: 0.007471015676856041 loss_collision: 0.04719056561589241 loss_jerk: 0.08682025969028473 loss_floor_contact: 0.019203219562768936
[17/100] loss: 0.020679188892245293 loss_joints: 0.00639039371162653 loss_collision: 0.03906403109431267 loss_jerk: 0.08470650017261505 loss_floor_contact: 0.01911742426455021
[18/100] loss: 0.01881275698542595 loss_joints: 0.0036585095804184675 loss_collision: 0.05062234401702881 loss_jerk: 0.08197112381458282 loss_floor_contact: 0.018948985263705254
[19/100] loss: 0.017552625387907028 loss_joints: 0.002000828506425023 loss_collision: 0.056160278618335724 loss_jerk: 0.0805319994688034 loss_floor_contact: 0.01882568746805191
[20/100] loss: 0.01648223027586937 loss_joints: 0.002246338874101639 loss_collision: 0.0436873584985733 loss_jerk: 0.07990337163209915 loss_floor_contact: 0.01876818761229515
[21/100] loss: 0.016646597534418106 loss_joints: 0.0036285133101046085 loss_collision: 0.035606659948825836 loss_jerk: 0.07578208297491074 loss_floor_contact: 0.01879209280014038
[22/100] loss: 0.014108697883784771 loss_joints: 0.0016877440502867103 loss_collision: 0.03080800548195839 loss_jerk: 0.07463959604501724 loss_floor_contact: 0.018761932849884033
[23/100] loss: 0.012953223660588264 loss_joints: 0.0013347459025681019 loss_collision: 0.02437290921807289 loss_jerk: 0.07307685166597366 loss_floor_contact: 0.018735017627477646
[24/100] loss: 0.013055870309472084 loss_joints: 0.0019950068090111017 loss_collision: 0.020829420536756516 loss_jerk: 0.07104383409023285 loss_floor_contact: 0.018735378980636597
[25/100] loss: 0.011148277670145035 loss_joints: 0.0005050987238064408 loss_collision: 0.017151961103081703 loss_jerk: 0.07048565149307251 loss_floor_contact: 0.01879417523741722
[26/100] loss: 0.012642741203308105 loss_joints: 0.001345115015283227 loss_collision: 0.025487450882792473 loss_jerk: 0.0680779367685318 loss_floor_contact: 0.019410867244005203
[27/100] loss: 0.012809795327484608 loss_joints: 0.002212165854871273 loss_collision: 0.019275762140750885 loss_jerk: 0.06743134558200836 loss_floor_contact: 0.01926918886601925
[28/100] loss: 0.012557699345052242 loss_joints: 0.0022456981241703033 loss_collision: 0.01721353270113468 loss_jerk: 0.06648743152618408 loss_floor_contact: 0.019419055432081223
[29/100] loss: 0.01235467940568924 loss_joints: 0.0016739501152187586 loss_collision: 0.021684397011995316 loss_jerk: 0.06550019234418869 loss_floor_contact: 0.01962270215153694
[30/100] loss: 0.01099724043160677 loss_joints: 0.0004144093836657703 loss_collision: 0.02093920111656189 loss_jerk: 0.0648217499256134 loss_floor_contact: 0.020067352801561356
[31/100] loss: 0.011469496414065361 loss_joints: 0.0008745621889829636 loss_collision: 0.021012423560023308 loss_jerk: 0.06421957165002823 loss_floor_contact: 0.02071734145283699
[32/100] loss: 0.012533633038401604 loss_joints: 0.0021001407876610756 loss_collision: 0.0209006629884243 loss_jerk: 0.06329421699047089 loss_floor_contact: 0.0201400313526392
[33/100] loss: 0.011316877789795399 loss_joints: 0.0011695571010932326 loss_collision: 0.018301885575056076 loss_jerk: 0.06310845911502838 loss_floor_contact: 0.02006285823881626
[34/100] loss: 0.00994052179157734 loss_joints: 0.00010867142555071041 loss_collision: 0.016303252428770065 loss_jerk: 0.06272708624601364 loss_floor_contact: 0.019288161769509315
[35/100] loss: 0.010538787581026554 loss_joints: 0.0009756699437275529 loss_collision: 0.016496658325195312 loss_jerk: 0.06006930395960808 loss_floor_contact: 0.019065210595726967
[36/100] loss: 0.01080648135393858 loss_joints: 0.001390143297612667 loss_collision: 0.016184264793992043 loss_jerk: 0.05918008089065552 loss_floor_contact: 0.018799033015966415
[37/100] loss: 0.009984098374843597 loss_joints: 0.0007061189389787614 loss_collision: 0.015152265317738056 loss_jerk: 0.058781854808330536 loss_floor_contact: 0.01884567365050316
[38/100] loss: 0.0097367437556386 loss_joints: 0.00016647651500534266 loss_collision: 0.018092643469572067 loss_jerk: 0.05870125815272331 loss_floor_contact: 0.018908776342868805
[39/100] loss: 0.010389413684606552 loss_joints: 0.0009071356616914272 loss_collision: 0.017074352130293846 loss_jerk: 0.058821674436330795 loss_floor_contact: 0.018926749005913734
[40/100] loss: 0.010256225243210793 loss_joints: 0.0011753045255318284 loss_collision: 0.01356881856918335 loss_jerk: 0.05830233171582222 loss_floor_contact: 0.018938051536679268
[41/100] loss: 0.009061387740075588 loss_joints: 0.0003402019792702049 loss_collision: 0.010174289345741272 loss_jerk: 0.05809815600514412 loss_floor_contact: 0.018939414992928505
[42/100] loss: 0.009065537713468075 loss_joints: 0.0003117678570561111 loss_collision: 0.011156192980706692 loss_jerk: 0.05742984637618065 loss_floor_contact: 0.0189516618847847
[43/100] loss: 0.009198359213769436 loss_joints: 0.0006574973231181502 loss_collision: 0.009793641045689583 loss_jerk: 0.0566665455698967 loss_floor_contact: 0.01894843578338623
[44/100] loss: 0.00914827547967434 loss_joints: 0.00034781749127432704 loss_collision: 0.010925743728876114 loss_jerk: 0.05814802646636963 loss_floor_contact: 0.018930809572339058
[45/100] loss: 0.008814573287963867 loss_joints: 0.0001666279713390395 loss_collision: 0.009235622361302376 loss_jerk: 0.05830024927854538 loss_floor_contact: 0.018943585455417633
[46/100] loss: 0.008337637409567833 loss_joints: 0.0001550147426314652 loss_collision: 0.005746084731072187 loss_jerk: 0.05709487199783325 loss_floor_contact: 0.018985265865921974
[47/100] loss: 0.008520442992448807 loss_joints: 0.00033910758793354034 loss_collision: 0.006972178816795349 loss_jerk: 0.0558578297495842 loss_floor_contact: 0.018983347341418266
[48/100] loss: 0.008143210783600807 loss_joints: 5.25953910255339e-05 loss_collision: 0.0062503996305167675 loss_jerk: 0.05572367459535599 loss_floor_contact: 0.018932074308395386
[49/100] loss: 0.008538338355720043 loss_joints: 0.00020468966977205127 loss_collision: 0.009281019680202007 loss_jerk: 0.05519671365618706 loss_floor_contact: 0.01885875128209591
[50/100] loss: 0.008694373071193695 loss_joints: 0.0001848033571150154 loss_collision: 0.012052047997713089 loss_jerk: 0.054198116064071655 loss_floor_contact: 0.018845535814762115
[51/100] loss: 0.008456667885184288 loss_joints: 8.421708480454981e-05 loss_collision: 0.010572132654488087 loss_jerk: 0.05431923642754555 loss_floor_contact: 0.018833139911293983
[52/100] loss: 0.00817069225013256 loss_joints: 1.4255603673518635e-05 loss_collision: 0.007941356860101223 loss_jerk: 0.05479826778173447 loss_floor_contact: 0.018824739381670952
[53/100] loss: 0.008227583952248096 loss_joints: 3.075211134273559e-05 loss_collision: 0.007798304315656424 loss_jerk: 0.05534772202372551 loss_floor_contact: 0.018822290003299713
[54/100] loss: 0.00838247686624527 loss_joints: 0.00011339504271745682 loss_collision: 0.008419477380812168 loss_jerk: 0.05545222759246826 loss_floor_contact: 0.018819117918610573
[55/100] loss: 0.0081851901486516 loss_joints: 5.8447867559152655e-06 loss_collision: 0.007089951075613499 loss_jerk: 0.05592751130461693 loss_floor_contact: 0.01877598650753498
[56/100] loss: 0.008514061570167542 loss_joints: 0.00014619663124904037 loss_collision: 0.009273714385926723 loss_jerk: 0.055695053189992905 loss_floor_contact: 0.018709875643253326
[57/100] loss: 0.008531030267477036 loss_joints: 0.00014616758562624454 loss_collision: 0.009646043181419373 loss_jerk: 0.055528659373521805 loss_floor_contact: 0.018673917278647423
[58/100] loss: 0.008355523459613323 loss_joints: 8.100183913484216e-05 loss_collision: 0.008647888898849487 loss_jerk: 0.05544638633728027 loss_floor_contact: 0.01865093968808651
[59/100] loss: 0.008138668723404408 loss_joints: 8.328536932822317e-05 loss_collision: 0.006455909926444292 loss_jerk: 0.05549108237028122 loss_floor_contact: 0.018606841564178467
[60/100] loss: 0.008082590997219086 loss_joints: 9.227915143128484e-05 loss_collision: 0.005556818563491106 loss_jerk: 0.05580359697341919 loss_floor_contact: 0.0185426976531744
[61/100] loss: 0.00795195996761322 loss_joints: 2.5094803277170286e-05 loss_collision: 0.0052026743069291115 loss_jerk: 0.05554988980293274 loss_floor_contact: 0.018516087904572487
[62/100] loss: 0.007946598343551159 loss_joints: 4.884088411927223e-05 loss_collision: 0.0055935862474143505 loss_jerk: 0.05486419424414635 loss_floor_contact: 0.018519792705774307
[63/100] loss: 0.007964533753693104 loss_joints: 2.2480611733044498e-05 loss_collision: 0.006167056038975716 loss_jerk: 0.05475606024265289 loss_floor_contact: 0.018497411161661148
[64/100] loss: 0.008098248392343521 loss_joints: 4.727033228846267e-05 loss_collision: 0.007352665066719055 loss_jerk: 0.05470215529203415 loss_floor_contact: 0.018454955890774727
[65/100] loss: 0.007915114052593708 loss_joints: 7.649733561265748e-06 loss_collision: 0.006569491699337959 loss_jerk: 0.05407917872071266 loss_floor_contact: 0.01842597872018814
[66/100] loss: 0.008005036972463131 loss_joints: 8.250444079749286e-05 loss_collision: 0.006480839569121599 loss_jerk: 0.05436071753501892 loss_floor_contact: 0.018383771181106567
[67/100] loss: 0.008023358881473541 loss_joints: 2.9917331630713306e-05 loss_collision: 0.007259948644787073 loss_jerk: 0.054361481219530106 loss_floor_contact: 0.018312985077500343
[68/100] loss: 0.0080168591812253 loss_joints: 8.375440665986389e-05 loss_collision: 0.007169819436967373 loss_jerk: 0.053906187415122986 loss_floor_contact: 0.018255041912198067
[69/100] loss: 0.008028769865632057 loss_joints: 0.00011580081627471372 loss_collision: 0.006800481118261814 loss_jerk: 0.054097626358270645 loss_floor_contact: 0.018231583759188652
[70/100] loss: 0.007824482396245003 loss_joints: 2.6432695449329913e-05 loss_collision: 0.005745801609009504 loss_jerk: 0.05399128794670105 loss_floor_contact: 0.01824340596795082
[71/100] loss: 0.0076958853751420975 loss_joints: 4.5868800953030586e-05 loss_collision: 0.004536761436611414 loss_jerk: 0.05370192974805832 loss_floor_contact: 0.018261469900608063
[72/100] loss: 0.007591306231915951 loss_joints: 2.0540128389257006e-05 loss_collision: 0.004056925419718027 loss_jerk: 0.053372591733932495 loss_floor_contact: 0.01827813871204853
[73/100] loss: 0.007555737160146236 loss_joints: 2.8179609216749668e-05 loss_collision: 0.00414396682754159 loss_jerk: 0.05284079164266586 loss_floor_contact: 0.018290817737579346
[74/100] loss: 0.0076095229014754295 loss_joints: 3.0672308639623225e-05 loss_collision: 0.004637549165636301 loss_jerk: 0.05283409729599953 loss_floor_contact: 0.018316859379410744
[75/100] loss: 0.0075774784199893475 loss_joints: 6.954457057872787e-05 loss_collision: 0.004143749829381704 loss_jerk: 0.052594397217035294 loss_floor_contact: 0.018341191112995148
[76/100] loss: 0.0074916197918355465 loss_joints: 5.398920620791614e-05 loss_collision: 0.0038788632955402136 loss_jerk: 0.052160657942295074 loss_floor_contact: 0.018336785957217216
[77/100] loss: 0.007401539012789726 loss_joints: 3.81237841793336e-05 loss_collision: 0.0034114073496311903 loss_jerk: 0.05190335586667061 loss_floor_contact: 0.0183193888515234
[78/100] loss: 0.007323595695197582 loss_joints: 1.3269653209135868e-05 loss_collision: 0.003148969728499651 loss_jerk: 0.051643431186676025 loss_floor_contact: 0.018310852348804474
[79/100] loss: 0.007381822448223829 loss_joints: 2.8954780646017753e-05 loss_collision: 0.0037834378890693188 loss_jerk: 0.051460087299346924 loss_floor_contact: 0.018285149708390236
[80/100] loss: 0.0073067727498710155 loss_joints: 2.5875491701299325e-05 loss_collision: 0.0033721807412803173 loss_jerk: 0.05116741731762886 loss_floor_contact: 0.018269376829266548
[81/100] loss: 0.007264021784067154 loss_joints: 8.563030860386789e-06 loss_collision: 0.003068634308874607 loss_jerk: 0.05122330039739609 loss_floor_contact: 0.018262654542922974
[82/100] loss: 0.0072608147747814655 loss_joints: 1.0367917639086954e-05 loss_collision: 0.0033939266577363014 loss_jerk: 0.05086841061711311 loss_floor_contact: 0.018242130056023598
[83/100] loss: 0.007198694162070751 loss_joints: 9.914412657963112e-06 loss_collision: 0.003380392910912633 loss_jerk: 0.050299759954214096 loss_floor_contact: 0.018207646906375885
[84/100] loss: 0.007168118376284838 loss_joints: 5.107510332891252e-06 loss_collision: 0.0034587415866553783 loss_jerk: 0.049990568310022354 loss_floor_contact: 0.01818080060184002
[85/100] loss: 0.007216497790068388 loss_joints: 1.3389901141636074e-05 loss_collision: 0.00377430347725749 loss_jerk: 0.05010001361370087 loss_floor_contact: 0.018156763166189194
[86/100] loss: 0.007181207183748484 loss_joints: 2.3343198336078785e-05 loss_collision: 0.003552958369255066 loss_jerk: 0.04988870397210121 loss_floor_contact: 0.018136974424123764
[87/100] loss: 0.007147038821130991 loss_joints: 1.5669400454498827e-05 loss_collision: 0.0037675003986805677 loss_jerk: 0.04943176358938217 loss_floor_contact: 0.018114427104592323
[88/100] loss: 0.0070882271975278854 loss_joints: 1.2537171642179601e-05 loss_collision: 0.003733777441084385 loss_jerk: 0.04892195388674736 loss_floor_contact: 0.018101168796420097
[89/100] loss: 0.0070412238128483295 loss_joints: 6.801314157200977e-06 loss_collision: 0.003352544503286481 loss_jerk: 0.048899296671152115 loss_floor_contact: 0.018092384561896324
[90/100] loss: 0.0070195687003433704 loss_joints: 2.1604006178677082e-05 loss_collision: 0.0031655547209084034 loss_jerk: 0.04872670769691467 loss_floor_contact: 0.01808738149702549
[91/100] loss: 0.007058925461024046 loss_joints: 2.6825166060007177e-05 loss_collision: 0.003564814804121852 loss_jerk: 0.04867614060640335 loss_floor_contact: 0.01808004267513752
[92/100] loss: 0.006991151720285416 loss_joints: 1.3844338354829233e-05 loss_collision: 0.0029998619575053453 loss_jerk: 0.048699766397476196 loss_floor_contact: 0.018073443323373795
[93/100] loss: 0.006991644389927387 loss_joints: 5.043460987508297e-06 loss_collision: 0.00311265722848475 loss_jerk: 0.048689112067222595 loss_floor_contact: 0.018064239993691444
[94/100] loss: 0.006923711858689785 loss_joints: 2.279927684867289e-06 loss_collision: 0.002556148450821638 loss_jerk: 0.04860236123204231 loss_floor_contact: 0.018055805936455727
[95/100] loss: 0.0069271232932806015 loss_joints: 7.701922186242882e-06 loss_collision: 0.002614435274153948 loss_jerk: 0.048531293869018555 loss_floor_contact: 0.01804848574101925
[96/100] loss: 0.006912486627697945 loss_joints: 1.0024911716755014e-05 loss_collision: 0.002548838732764125 loss_jerk: 0.04843662306666374 loss_floor_contact: 0.018039153888821602
[97/100] loss: 0.006891088560223579 loss_joints: 5.79113020648947e-06 loss_collision: 0.0025243775453418493 loss_jerk: 0.048300229012966156 loss_floor_contact: 0.018028369173407555
[98/100] loss: 0.006868712604045868 loss_joints: 2.6734494440461276e-06 loss_collision: 0.002397283911705017 loss_jerk: 0.048244453966617584 loss_floor_contact: 0.018018653616309166
[99/100] loss: 0.006870865356177092 loss_joints: 1.7175798348034732e-06 loss_collision: 0.0024931877851486206 loss_jerk: 0.048185087740421295 loss_floor_contact: 0.018013199791312218
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk0.1_skate0.5]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 297.86421                                                    ║
    ║     rollout = 136.11994                                                    ║
    ║     sdf     = 14.61004                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00687087                                                 ║
    ║     joints    = 0.00000172                                                 ║
    ║     collision = 0.00249319                                                 ║
    ║     jerk      = 0.04818509                                                 ║
    ║     floor     = 0.01801320                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m26.872s
user	4m48.840s
sys	0m15.727s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.1, skate=1.0
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:16,  3.20s/it]  2%|▏         | 2/100 [00:06<04:57,  3.04s/it]  3%|▎         | 3/100 [00:10<05:34,  3.45s/it]  4%|▍         | 4/100 [00:13<05:15,  3.29s/it]  5%|▌         | 5/100 [00:16<05:05,  3.21s/it]  6%|▌         | 6/100 [00:19<04:59,  3.18s/it]  7%|▋         | 7/100 [00:22<04:57,  3.20s/it]  8%|▊         | 8/100 [00:25<04:55,  3.21s/it]  9%|▉         | 9/100 [00:28<04:52,  3.21s/it] 10%|█         | 10/100 [00:32<04:50,  3.23s/it] 11%|█         | 11/100 [00:35<04:43,  3.19s/it] 12%|█▏        | 12/100 [00:38<04:35,  3.13s/it] 13%|█▎        | 13/100 [00:41<04:33,  3.14s/it] 14%|█▍        | 14/100 [00:44<04:28,  3.12s/it] 15%|█▌        | 15/100 [00:47<04:21,  3.07s/it] 16%|█▌        | 16/100 [00:50<04:21,  3.12s/it] 17%|█▋        | 17/100 [00:53<04:11,  3.04s/it] 18%|█▊        | 18/100 [00:56<04:10,  3.06s/it] 19%|█▉        | 19/100 [00:59<04:07,  3.05s/it] 20%|██        | 20/100 [01:02<04:07,  3.09s/it] 21%|██        | 21/100 [01:05<04:00,  3.04s/it] 22%|██▏       | 22/100 [01:08<03:54,  3.01s/it] 23%|██▎       | 23/100 [01:11<03:51,  3.01s/it] 24%|██▍       | 24/100 [01:14<03:50,  3.03s/it] 25%|██▌       | 25/100 [01:18<03:51,  3.08s/it] 26%|██▌       | 26/100 [01:21<03:51,  3.13s/it] 27%|██▋       | 27/100 [01:24<03:52,  3.19s/it] 28%|██▊       | 28/100 [01:27<03:45,  3.13s/it] 29%|██▉       | 29/100 [01:30<03:37,  3.07s/it] 30%|███       | 30/100 [01:33<03:32,  3.03s/it] 31%|███       | 31/100 [01:36<03:29,  3.03s/it] 32%|███▏      | 32/100 [01:39<03:25,  3.02s/it] 33%|███▎      | 33/100 [01:42<03:23,  3.03s/it] 34%|███▍      | 34/100 [01:45<03:23,  3.08s/it] 35%|███▌      | 35/100 [01:48<03:21,  3.10s/it] 36%|███▌      | 36/100 [01:52<03:18,  3.11s/it] 37%|███▋      | 37/100 [01:55<03:13,  3.06s/it] 38%|███▊      | 38/100 [01:58<03:08,  3.04s/it] 39%|███▉      | 39/100 [02:01<03:04,  3.03s/it] 40%|████      | 40/100 [02:04<03:04,  3.07s/it] 41%|████      | 41/100 [02:07<02:58,  3.02s/it] 42%|████▏     | 42/100 [02:10<02:58,  3.09s/it] 43%|████▎     | 43/100 [02:13<02:55,  3.08s/it] 44%|████▍     | 44/100 [02:16<02:51,  3.06s/it] 45%|████▌     | 45/100 [02:19<02:46,  3.03s/it] 46%|████▌     | 46/100 [02:22<02:43,  3.03s/it] 47%|████▋     | 47/100 [02:25<02:41,  3.04s/it] 48%|████▊     | 48/100 [02:28<02:36,  3.02s/it] 49%|████▉     | 49/100 [02:31<02:34,  3.02s/it] 50%|█████     | 50/100 [02:34<02:29,  3.00s/it] 51%|█████     | 51/100 [02:37<02:25,  2.97s/it] 52%|█████▏    | 52/100 [02:40<02:26,  3.05s/it] 53%|█████▎    | 53/100 [02:43<02:23,  3.06s/it] 54%|█████▍    | 54/100 [02:46<02:17,  2.99s/it] 55%|█████▌    | 55/100 [02:49<02:13,  2.96s/it] 56%|█████▌    | 56/100 [02:52<02:09,  2.94s/it] 57%|█████▋    | 57/100 [02:55<02:06,  2.95s/it] 58%|█████▊    | 58/100 [02:58<02:05,  2.99s/it] 59%|█████▉    | 59/100 [03:01<02:04,  3.04s/it] 60%|██████    | 60/100 [03:04<02:03,  3.09s/it] 61%|██████    | 61/100 [03:07<01:58,  3.04s/it] 62%|██████▏   | 62/100 [03:10<01:54,  3.02s/it] 63%|██████▎   | 63/100 [03:13<01:51,  3.01s/it] 64%|██████▍   | 64/100 [03:16<01:50,  3.08s/it] 65%|██████▌   | 65/100 [03:19<01:48,  3.09s/it] 66%|██████▌   | 66/100 [03:22<01:44,  3.08s/it] 67%|██████▋   | 67/100 [03:25<01:40,  3.04s/it] 68%|██████▊   | 68/100 [03:28<01:36,  3.03s/it] 69%|██████▉   | 69/100 [03:32<01:35,  3.09s/it] 70%|███████   | 70/100 [03:35<01:32,  3.08s/it] 71%|███████   | 71/100 [03:38<01:28,  3.04s/it] 72%|███████▏  | 72/100 [03:41<01:26,  3.09s/it] 73%|███████▎  | 73/100 [03:44<01:23,  3.10s/it] 74%|███████▍  | 74/100 [03:47<01:19,  3.08s/it] 75%|███████▌  | 75/100 [03:50<01:17,  3.11s/it] 76%|███████▌  | 76/100 [03:53<01:15,  3.13s/it] 77%|███████▋  | 77/100 [03:57<01:12,  3.14s/it] 78%|███████▊  | 78/100 [04:00<01:09,  3.14s/it] 79%|███████▉  | 79/100 [04:03<01:05,  3.14s/it] 80%|████████  | 80/100 [04:06<01:02,  3.14s/it] 81%|████████  | 81/100 [04:09<00:59,  3.11s/it] 82%|████████▏ | 82/100 [04:12<00:55,  3.10s/it] 83%|████████▎ | 83/100 [04:15<00:52,  3.11s/it] 84%|████████▍ | 84/100 [04:18<00:50,  3.13s/it] 85%|████████▌ | 85/100 [04:22<00:47,  3.20s/it] 86%|████████▌ | 86/100 [04:25<00:44,  3.21s/it] 87%|████████▋ | 87/100 [04:28<00:42,  3.24s/it] 88%|████████▊ | 88/100 [04:31<00:38,  3.20s/it] 89%|████████▉ | 89/100 [04:35<00:35,  3.18s/it] 90%|█████████ | 90/100 [04:38<00:31,  3.14s/it] 91%|█████████ | 91/100 [04:41<00:27,  3.11s/it] 92%|█████████▏| 92/100 [04:44<00:24,  3.12s/it] 93%|█████████▎| 93/100 [04:47<00:21,  3.09s/it] 94%|█████████▍| 94/100 [04:50<00:18,  3.07s/it] 95%|█████████▌| 95/100 [04:53<00:15,  3.09s/it] 96%|█████████▌| 96/100 [04:56<00:12,  3.11s/it] 97%|█████████▋| 97/100 [04:59<00:09,  3.15s/it] 98%|█████████▊| 98/100 [05:03<00:06,  3.20s/it] 99%|█████████▉| 99/100 [05:06<00:03,  3.20s/it]100%|██████████| 100/100 [05:09<00:00,  3.19s/it]100%|██████████| 100/100 [05:09<00:00,  3.10s/it]
[0/100] loss: 2.6899635791778564 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.4818742275238037 loss_joints: 2.4042022228240967 loss_collision: 0.15364891290664673 loss_jerk: 0.06821777671575546 loss_floor_contact: 0.5548513531684875
[2/100] loss: 2.0643036365509033 loss_joints: 1.9638667106628418 loss_collision: 0.2373698502779007 loss_jerk: 0.09598477184772491 loss_floor_contact: 0.671014130115509
[3/100] loss: 1.352412223815918 loss_joints: 1.2822901010513306 loss_collision: 0.2347494512796402 loss_jerk: 0.10437574237585068 loss_floor_contact: 0.36209583282470703
[4/100] loss: 0.8025346398353577 loss_joints: 0.7756139636039734 loss_collision: 0.14860790967941284 loss_jerk: 0.09187738597393036 loss_floor_contact: 0.02872098796069622
[5/100] loss: 0.4329168498516083 loss_joints: 0.39137002825737 loss_collision: 0.2890177369117737 loss_jerk: 0.10514625906944275 loss_floor_contact: 0.021304097026586533
[6/100] loss: 0.16943925619125366 loss_joints: 0.14529895782470703 loss_collision: 0.12084787338972092 loss_jerk: 0.098981574177742 loss_floor_contact: 0.02157355658710003
[7/100] loss: 0.05287057161331177 loss_joints: 0.03900299593806267 loss_collision: 0.027674704790115356 loss_jerk: 0.08959053456783295 loss_floor_contact: 0.02141050435602665
[8/100] loss: 0.05096344277262688 loss_joints: 0.03639831393957138 loss_collision: 0.02351684495806694 loss_jerk: 0.10067141056060791 loss_floor_contact: 0.021463003009557724
[9/100] loss: 0.0669836699962616 loss_joints: 0.05139805004000664 loss_collision: 0.016828006133437157 loss_jerk: 0.11775694042444229 loss_floor_contact: 0.021271254867315292
[10/100] loss: 0.06427668780088425 loss_joints: 0.04644116386771202 loss_collision: 0.031338758766651154 loss_jerk: 0.12322396785020828 loss_floor_contact: 0.023792551830410957
[11/100] loss: 0.03937244787812233 loss_joints: 0.01903996616601944 loss_collision: 0.05097923055291176 loss_jerk: 0.13204322755336761 loss_floor_contact: 0.020302359014749527
[12/100] loss: 0.03145614638924599 loss_joints: 0.007376819383352995 loss_collision: 0.09642252326011658 loss_jerk: 0.1246730163693428 loss_floor_contact: 0.019697746261954308
[13/100] loss: 0.035162653774023056 loss_joints: 0.00573324877768755 loss_collision: 0.1617206484079361 loss_jerk: 0.11291579157114029 loss_floor_contact: 0.01965760998427868
[14/100] loss: 0.03309328854084015 loss_joints: 0.00542735680937767 loss_collision: 0.1603212058544159 loss_jerk: 0.09552307426929474 loss_floor_contact: 0.02081502601504326
[15/100] loss: 0.025147872045636177 loss_joints: 0.004840065725147724 loss_collision: 0.09500335901975632 loss_jerk: 0.08893606811761856 loss_floor_contact: 0.01913861744105816
[16/100] loss: 0.02279241941869259 loss_joints: 0.007471015676856041 loss_collision: 0.04719056561589241 loss_jerk: 0.08682025969028473 loss_floor_contact: 0.019203219562768936
[17/100] loss: 0.020679188892245293 loss_joints: 0.00639039371162653 loss_collision: 0.03906403109431267 loss_jerk: 0.08470650017261505 loss_floor_contact: 0.01911742426455021
[18/100] loss: 0.01881275698542595 loss_joints: 0.0036585095804184675 loss_collision: 0.05062234401702881 loss_jerk: 0.08197112381458282 loss_floor_contact: 0.018948985263705254
[19/100] loss: 0.017552625387907028 loss_joints: 0.002000828506425023 loss_collision: 0.056160278618335724 loss_jerk: 0.0805319994688034 loss_floor_contact: 0.01882568746805191
[20/100] loss: 0.01648223027586937 loss_joints: 0.002246338874101639 loss_collision: 0.0436873584985733 loss_jerk: 0.07990337163209915 loss_floor_contact: 0.01876818761229515
[21/100] loss: 0.016646597534418106 loss_joints: 0.0036285133101046085 loss_collision: 0.035606659948825836 loss_jerk: 0.07578208297491074 loss_floor_contact: 0.01879209280014038
[22/100] loss: 0.014108697883784771 loss_joints: 0.0016877440502867103 loss_collision: 0.03080800548195839 loss_jerk: 0.07463959604501724 loss_floor_contact: 0.018761932849884033
[23/100] loss: 0.012953223660588264 loss_joints: 0.0013347459025681019 loss_collision: 0.02437290921807289 loss_jerk: 0.07307685166597366 loss_floor_contact: 0.018735017627477646
[24/100] loss: 0.013055870309472084 loss_joints: 0.0019950068090111017 loss_collision: 0.020829420536756516 loss_jerk: 0.07104383409023285 loss_floor_contact: 0.018735378980636597
[25/100] loss: 0.011148277670145035 loss_joints: 0.0005050987238064408 loss_collision: 0.017151961103081703 loss_jerk: 0.07048565149307251 loss_floor_contact: 0.01879417523741722
[26/100] loss: 0.012642741203308105 loss_joints: 0.001345115015283227 loss_collision: 0.025487450882792473 loss_jerk: 0.0680779367685318 loss_floor_contact: 0.019410867244005203
[27/100] loss: 0.012809795327484608 loss_joints: 0.002212165854871273 loss_collision: 0.019275762140750885 loss_jerk: 0.06743134558200836 loss_floor_contact: 0.01926918886601925
[28/100] loss: 0.012557699345052242 loss_joints: 0.0022456981241703033 loss_collision: 0.01721353270113468 loss_jerk: 0.06648743152618408 loss_floor_contact: 0.019419055432081223
[29/100] loss: 0.01235467940568924 loss_joints: 0.0016739501152187586 loss_collision: 0.021684397011995316 loss_jerk: 0.06550019234418869 loss_floor_contact: 0.01962270215153694
[30/100] loss: 0.01099724043160677 loss_joints: 0.0004144093836657703 loss_collision: 0.02093920111656189 loss_jerk: 0.0648217499256134 loss_floor_contact: 0.020067352801561356
[31/100] loss: 0.011469496414065361 loss_joints: 0.0008745621889829636 loss_collision: 0.021012423560023308 loss_jerk: 0.06421957165002823 loss_floor_contact: 0.02071734145283699
[32/100] loss: 0.012533633038401604 loss_joints: 0.0021001407876610756 loss_collision: 0.0209006629884243 loss_jerk: 0.06329421699047089 loss_floor_contact: 0.0201400313526392
[33/100] loss: 0.011316877789795399 loss_joints: 0.0011695571010932326 loss_collision: 0.018301885575056076 loss_jerk: 0.06310845911502838 loss_floor_contact: 0.02006285823881626
[34/100] loss: 0.00994052179157734 loss_joints: 0.00010867142555071041 loss_collision: 0.016303252428770065 loss_jerk: 0.06272708624601364 loss_floor_contact: 0.019288161769509315
[35/100] loss: 0.010538787581026554 loss_joints: 0.0009756699437275529 loss_collision: 0.016496658325195312 loss_jerk: 0.06006930395960808 loss_floor_contact: 0.019065210595726967
[36/100] loss: 0.01080648135393858 loss_joints: 0.001390143297612667 loss_collision: 0.016184264793992043 loss_jerk: 0.05918008089065552 loss_floor_contact: 0.018799033015966415
[37/100] loss: 0.009984098374843597 loss_joints: 0.0007061189389787614 loss_collision: 0.015152265317738056 loss_jerk: 0.058781854808330536 loss_floor_contact: 0.01884567365050316
[38/100] loss: 0.0097367437556386 loss_joints: 0.00016647651500534266 loss_collision: 0.018092643469572067 loss_jerk: 0.05870125815272331 loss_floor_contact: 0.018908776342868805
[39/100] loss: 0.010389413684606552 loss_joints: 0.0009071356616914272 loss_collision: 0.017074352130293846 loss_jerk: 0.058821674436330795 loss_floor_contact: 0.018926749005913734
[40/100] loss: 0.010256225243210793 loss_joints: 0.0011753045255318284 loss_collision: 0.01356881856918335 loss_jerk: 0.05830233171582222 loss_floor_contact: 0.018938051536679268
[41/100] loss: 0.009061387740075588 loss_joints: 0.0003402019792702049 loss_collision: 0.010174289345741272 loss_jerk: 0.05809815600514412 loss_floor_contact: 0.018939414992928505
[42/100] loss: 0.009065537713468075 loss_joints: 0.0003117678570561111 loss_collision: 0.011156192980706692 loss_jerk: 0.05742984637618065 loss_floor_contact: 0.0189516618847847
[43/100] loss: 0.009198359213769436 loss_joints: 0.0006574973231181502 loss_collision: 0.009793641045689583 loss_jerk: 0.0566665455698967 loss_floor_contact: 0.01894843578338623
[44/100] loss: 0.00914827547967434 loss_joints: 0.00034781749127432704 loss_collision: 0.010925743728876114 loss_jerk: 0.05814802646636963 loss_floor_contact: 0.018930809572339058
[45/100] loss: 0.008814573287963867 loss_joints: 0.0001666279713390395 loss_collision: 0.009235622361302376 loss_jerk: 0.05830024927854538 loss_floor_contact: 0.018943585455417633
[46/100] loss: 0.008337637409567833 loss_joints: 0.0001550147426314652 loss_collision: 0.005746084731072187 loss_jerk: 0.05709487199783325 loss_floor_contact: 0.018985265865921974
[47/100] loss: 0.008520442992448807 loss_joints: 0.00033910758793354034 loss_collision: 0.006972178816795349 loss_jerk: 0.0558578297495842 loss_floor_contact: 0.018983347341418266
[48/100] loss: 0.008143210783600807 loss_joints: 5.25953910255339e-05 loss_collision: 0.0062503996305167675 loss_jerk: 0.05572367459535599 loss_floor_contact: 0.018932074308395386
[49/100] loss: 0.008538338355720043 loss_joints: 0.00020468966977205127 loss_collision: 0.009281019680202007 loss_jerk: 0.05519671365618706 loss_floor_contact: 0.01885875128209591
[50/100] loss: 0.008694373071193695 loss_joints: 0.0001848033571150154 loss_collision: 0.012052047997713089 loss_jerk: 0.054198116064071655 loss_floor_contact: 0.018845535814762115
[51/100] loss: 0.008456667885184288 loss_joints: 8.421708480454981e-05 loss_collision: 0.010572132654488087 loss_jerk: 0.05431923642754555 loss_floor_contact: 0.018833139911293983
[52/100] loss: 0.00817069225013256 loss_joints: 1.4255603673518635e-05 loss_collision: 0.007941356860101223 loss_jerk: 0.05479826778173447 loss_floor_contact: 0.018824739381670952
[53/100] loss: 0.008227583952248096 loss_joints: 3.075211134273559e-05 loss_collision: 0.007798304315656424 loss_jerk: 0.05534772202372551 loss_floor_contact: 0.018822290003299713
[54/100] loss: 0.00838247686624527 loss_joints: 0.00011339504271745682 loss_collision: 0.008419477380812168 loss_jerk: 0.05545222759246826 loss_floor_contact: 0.018819117918610573
[55/100] loss: 0.0081851901486516 loss_joints: 5.8447867559152655e-06 loss_collision: 0.007089951075613499 loss_jerk: 0.05592751130461693 loss_floor_contact: 0.01877598650753498
[56/100] loss: 0.008514061570167542 loss_joints: 0.00014619663124904037 loss_collision: 0.009273714385926723 loss_jerk: 0.055695053189992905 loss_floor_contact: 0.018709875643253326
[57/100] loss: 0.008531030267477036 loss_joints: 0.00014616758562624454 loss_collision: 0.009646043181419373 loss_jerk: 0.055528659373521805 loss_floor_contact: 0.018673917278647423
[58/100] loss: 0.008355523459613323 loss_joints: 8.100183913484216e-05 loss_collision: 0.008647888898849487 loss_jerk: 0.05544638633728027 loss_floor_contact: 0.01865093968808651
[59/100] loss: 0.008138668723404408 loss_joints: 8.328536932822317e-05 loss_collision: 0.006455909926444292 loss_jerk: 0.05549108237028122 loss_floor_contact: 0.018606841564178467
[60/100] loss: 0.008082590997219086 loss_joints: 9.227915143128484e-05 loss_collision: 0.005556818563491106 loss_jerk: 0.05580359697341919 loss_floor_contact: 0.0185426976531744
[61/100] loss: 0.00795195996761322 loss_joints: 2.5094803277170286e-05 loss_collision: 0.0052026743069291115 loss_jerk: 0.05554988980293274 loss_floor_contact: 0.018516087904572487
[62/100] loss: 0.007946598343551159 loss_joints: 4.884088411927223e-05 loss_collision: 0.0055935862474143505 loss_jerk: 0.05486419424414635 loss_floor_contact: 0.018519792705774307
[63/100] loss: 0.007964533753693104 loss_joints: 2.2480611733044498e-05 loss_collision: 0.006167056038975716 loss_jerk: 0.05475606024265289 loss_floor_contact: 0.018497411161661148
[64/100] loss: 0.008098248392343521 loss_joints: 4.727033228846267e-05 loss_collision: 0.007352665066719055 loss_jerk: 0.05470215529203415 loss_floor_contact: 0.018454955890774727
[65/100] loss: 0.007915114052593708 loss_joints: 7.649733561265748e-06 loss_collision: 0.006569491699337959 loss_jerk: 0.05407917872071266 loss_floor_contact: 0.01842597872018814
[66/100] loss: 0.008005036972463131 loss_joints: 8.250444079749286e-05 loss_collision: 0.006480839569121599 loss_jerk: 0.05436071753501892 loss_floor_contact: 0.018383771181106567
[67/100] loss: 0.008023358881473541 loss_joints: 2.9917331630713306e-05 loss_collision: 0.007259948644787073 loss_jerk: 0.054361481219530106 loss_floor_contact: 0.018312985077500343
[68/100] loss: 0.0080168591812253 loss_joints: 8.375440665986389e-05 loss_collision: 0.007169819436967373 loss_jerk: 0.053906187415122986 loss_floor_contact: 0.018255041912198067
[69/100] loss: 0.008028769865632057 loss_joints: 0.00011580081627471372 loss_collision: 0.006800481118261814 loss_jerk: 0.054097626358270645 loss_floor_contact: 0.018231583759188652
[70/100] loss: 0.007824482396245003 loss_joints: 2.6432695449329913e-05 loss_collision: 0.005745801609009504 loss_jerk: 0.05399128794670105 loss_floor_contact: 0.01824340596795082
[71/100] loss: 0.0076958853751420975 loss_joints: 4.5868800953030586e-05 loss_collision: 0.004536761436611414 loss_jerk: 0.05370192974805832 loss_floor_contact: 0.018261469900608063
[72/100] loss: 0.007591306231915951 loss_joints: 2.0540128389257006e-05 loss_collision: 0.004056925419718027 loss_jerk: 0.053372591733932495 loss_floor_contact: 0.01827813871204853
[73/100] loss: 0.007555737160146236 loss_joints: 2.8179609216749668e-05 loss_collision: 0.00414396682754159 loss_jerk: 0.05284079164266586 loss_floor_contact: 0.018290817737579346
[74/100] loss: 0.0076095229014754295 loss_joints: 3.0672308639623225e-05 loss_collision: 0.004637549165636301 loss_jerk: 0.05283409729599953 loss_floor_contact: 0.018316859379410744
[75/100] loss: 0.0075774784199893475 loss_joints: 6.954457057872787e-05 loss_collision: 0.004143749829381704 loss_jerk: 0.052594397217035294 loss_floor_contact: 0.018341191112995148
[76/100] loss: 0.0074916197918355465 loss_joints: 5.398920620791614e-05 loss_collision: 0.0038788632955402136 loss_jerk: 0.052160657942295074 loss_floor_contact: 0.018336785957217216
[77/100] loss: 0.007401539012789726 loss_joints: 3.81237841793336e-05 loss_collision: 0.0034114073496311903 loss_jerk: 0.05190335586667061 loss_floor_contact: 0.0183193888515234
[78/100] loss: 0.007323595695197582 loss_joints: 1.3269653209135868e-05 loss_collision: 0.003148969728499651 loss_jerk: 0.051643431186676025 loss_floor_contact: 0.018310852348804474
[79/100] loss: 0.007381822448223829 loss_joints: 2.8954780646017753e-05 loss_collision: 0.0037834378890693188 loss_jerk: 0.051460087299346924 loss_floor_contact: 0.018285149708390236
[80/100] loss: 0.0073067727498710155 loss_joints: 2.5875491701299325e-05 loss_collision: 0.0033721807412803173 loss_jerk: 0.05116741731762886 loss_floor_contact: 0.018269376829266548
[81/100] loss: 0.007264021784067154 loss_joints: 8.563030860386789e-06 loss_collision: 0.003068634308874607 loss_jerk: 0.05122330039739609 loss_floor_contact: 0.018262654542922974
[82/100] loss: 0.0072608147747814655 loss_joints: 1.0367917639086954e-05 loss_collision: 0.0033939266577363014 loss_jerk: 0.05086841061711311 loss_floor_contact: 0.018242130056023598
[83/100] loss: 0.007198694162070751 loss_joints: 9.914412657963112e-06 loss_collision: 0.003380392910912633 loss_jerk: 0.050299759954214096 loss_floor_contact: 0.018207646906375885
[84/100] loss: 0.007168118376284838 loss_joints: 5.107510332891252e-06 loss_collision: 0.0034587415866553783 loss_jerk: 0.049990568310022354 loss_floor_contact: 0.01818080060184002
[85/100] loss: 0.007216497790068388 loss_joints: 1.3389901141636074e-05 loss_collision: 0.00377430347725749 loss_jerk: 0.05010001361370087 loss_floor_contact: 0.018156763166189194
[86/100] loss: 0.007181207183748484 loss_joints: 2.3343198336078785e-05 loss_collision: 0.003552958369255066 loss_jerk: 0.04988870397210121 loss_floor_contact: 0.018136974424123764
[87/100] loss: 0.007147038821130991 loss_joints: 1.5669400454498827e-05 loss_collision: 0.0037675003986805677 loss_jerk: 0.04943176358938217 loss_floor_contact: 0.018114427104592323
[88/100] loss: 0.0070882271975278854 loss_joints: 1.2537171642179601e-05 loss_collision: 0.003733777441084385 loss_jerk: 0.04892195388674736 loss_floor_contact: 0.018101168796420097
[89/100] loss: 0.0070412238128483295 loss_joints: 6.801314157200977e-06 loss_collision: 0.003352544503286481 loss_jerk: 0.048899296671152115 loss_floor_contact: 0.018092384561896324
[90/100] loss: 0.0070195687003433704 loss_joints: 2.1604006178677082e-05 loss_collision: 0.0031655547209084034 loss_jerk: 0.04872670769691467 loss_floor_contact: 0.01808738149702549
[91/100] loss: 0.007058925461024046 loss_joints: 2.6825166060007177e-05 loss_collision: 0.003564814804121852 loss_jerk: 0.04867614060640335 loss_floor_contact: 0.01808004267513752
[92/100] loss: 0.006991151720285416 loss_joints: 1.3844338354829233e-05 loss_collision: 0.0029998619575053453 loss_jerk: 0.048699766397476196 loss_floor_contact: 0.018073443323373795
[93/100] loss: 0.006991644389927387 loss_joints: 5.043460987508297e-06 loss_collision: 0.00311265722848475 loss_jerk: 0.048689112067222595 loss_floor_contact: 0.018064239993691444
[94/100] loss: 0.006923711858689785 loss_joints: 2.279927684867289e-06 loss_collision: 0.002556148450821638 loss_jerk: 0.04860236123204231 loss_floor_contact: 0.018055805936455727
[95/100] loss: 0.0069271232932806015 loss_joints: 7.701922186242882e-06 loss_collision: 0.002614435274153948 loss_jerk: 0.048531293869018555 loss_floor_contact: 0.01804848574101925
[96/100] loss: 0.006912486627697945 loss_joints: 1.0024911716755014e-05 loss_collision: 0.002548838732764125 loss_jerk: 0.04843662306666374 loss_floor_contact: 0.018039153888821602
[97/100] loss: 0.006891088560223579 loss_joints: 5.79113020648947e-06 loss_collision: 0.0025243775453418493 loss_jerk: 0.048300229012966156 loss_floor_contact: 0.018028369173407555
[98/100] loss: 0.006868712604045868 loss_joints: 2.6734494440461276e-06 loss_collision: 0.002397283911705017 loss_jerk: 0.048244453966617584 loss_floor_contact: 0.018018653616309166
[99/100] loss: 0.006870865356177092 loss_joints: 1.7175798348034732e-06 loss_collision: 0.0024931877851486206 loss_jerk: 0.048185087740421295 loss_floor_contact: 0.018013199791312218
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk0.1_skate1.0]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 309.50705                                                    ║
    ║     rollout = 140.07153                                                    ║
    ║     sdf     = 17.51950                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00687087                                                 ║
    ║     joints    = 0.00000172                                                 ║
    ║     collision = 0.00249319                                                 ║
    ║     jerk      = 0.04818509                                                 ║
    ║     floor     = 0.01801320                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m40.373s
user	4m52.617s
sys	0m16.277s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.25, skate=0.1
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:42,  2.85s/it]  2%|▏         | 2/100 [00:05<04:33,  2.80s/it]  3%|▎         | 3/100 [00:08<04:53,  3.02s/it]  4%|▍         | 4/100 [00:11<04:39,  2.91s/it]  5%|▌         | 5/100 [00:14<04:28,  2.83s/it]  6%|▌         | 6/100 [00:17<04:31,  2.89s/it]  7%|▋         | 7/100 [00:20<04:29,  2.90s/it]  8%|▊         | 8/100 [00:23<04:24,  2.88s/it]  9%|▉         | 9/100 [00:25<04:15,  2.81s/it] 10%|█         | 10/100 [00:28<04:08,  2.76s/it] 11%|█         | 11/100 [00:31<04:07,  2.78s/it] 12%|█▏        | 12/100 [00:34<04:05,  2.79s/it] 13%|█▎        | 13/100 [00:36<04:01,  2.77s/it] 14%|█▍        | 14/100 [00:39<03:58,  2.78s/it] 15%|█▌        | 15/100 [00:42<03:57,  2.80s/it] 16%|█▌        | 16/100 [00:45<03:53,  2.79s/it] 17%|█▋        | 17/100 [00:47<03:52,  2.80s/it] 18%|█▊        | 18/100 [00:50<03:49,  2.80s/it] 19%|█▉        | 19/100 [00:53<03:45,  2.78s/it] 20%|██        | 20/100 [00:56<03:50,  2.89s/it] 21%|██        | 21/100 [00:59<03:47,  2.88s/it] 22%|██▏       | 22/100 [01:02<03:41,  2.84s/it] 23%|██▎       | 23/100 [01:05<03:38,  2.84s/it] 24%|██▍       | 24/100 [01:07<03:35,  2.84s/it] 25%|██▌       | 25/100 [01:10<03:34,  2.86s/it] 26%|██▌       | 26/100 [01:13<03:31,  2.86s/it] 27%|██▋       | 27/100 [01:16<03:30,  2.88s/it] 28%|██▊       | 28/100 [01:19<03:25,  2.85s/it] 29%|██▉       | 29/100 [01:22<03:26,  2.91s/it] 30%|███       | 30/100 [01:25<03:21,  2.88s/it] 31%|███       | 31/100 [01:28<03:19,  2.89s/it] 32%|███▏      | 32/100 [01:30<03:14,  2.86s/it] 33%|███▎      | 33/100 [01:34<03:15,  2.92s/it] 34%|███▍      | 34/100 [01:36<03:12,  2.92s/it] 35%|███▌      | 35/100 [01:40<03:14,  2.99s/it] 36%|███▌      | 36/100 [01:43<03:11,  2.99s/it] 37%|███▋      | 37/100 [01:46<03:08,  2.99s/it] 38%|███▊      | 38/100 [01:49<03:05,  2.98s/it] 39%|███▉      | 39/100 [01:52<03:04,  3.02s/it] 40%|████      | 40/100 [01:55<03:04,  3.08s/it] 41%|████      | 41/100 [01:58<03:04,  3.13s/it] 42%|████▏     | 42/100 [02:01<03:01,  3.13s/it] 43%|████▎     | 43/100 [02:04<02:53,  3.04s/it] 44%|████▍     | 44/100 [02:07<02:53,  3.10s/it] 45%|████▌     | 45/100 [02:10<02:47,  3.04s/it] 46%|████▌     | 46/100 [02:13<02:42,  3.02s/it] 47%|████▋     | 47/100 [02:16<02:40,  3.03s/it] 48%|████▊     | 48/100 [02:19<02:36,  3.00s/it] 49%|████▉     | 49/100 [02:22<02:32,  2.98s/it] 50%|█████     | 50/100 [02:25<02:32,  3.05s/it] 51%|█████     | 51/100 [02:29<02:31,  3.09s/it] 52%|█████▏    | 52/100 [02:32<02:27,  3.07s/it] 53%|█████▎    | 53/100 [02:35<02:23,  3.06s/it] 54%|█████▍    | 54/100 [02:38<02:20,  3.04s/it] 55%|█████▌    | 55/100 [02:41<02:17,  3.05s/it] 56%|█████▌    | 56/100 [02:44<02:15,  3.08s/it] 57%|█████▋    | 57/100 [02:47<02:10,  3.03s/it] 58%|█████▊    | 58/100 [02:50<02:07,  3.03s/it] 59%|█████▉    | 59/100 [02:53<02:05,  3.07s/it] 60%|██████    | 60/100 [02:56<02:01,  3.03s/it] 61%|██████    | 61/100 [02:59<01:59,  3.08s/it] 62%|██████▏   | 62/100 [03:02<01:58,  3.13s/it] 63%|██████▎   | 63/100 [03:05<01:54,  3.10s/it] 64%|██████▍   | 64/100 [03:09<01:52,  3.13s/it] 65%|██████▌   | 65/100 [03:12<01:49,  3.14s/it] 66%|██████▌   | 66/100 [03:15<01:46,  3.13s/it] 67%|██████▋   | 67/100 [03:18<01:43,  3.15s/it] 68%|██████▊   | 68/100 [03:21<01:42,  3.19s/it] 69%|██████▉   | 69/100 [03:25<01:39,  3.20s/it] 70%|███████   | 70/100 [03:27<01:33,  3.13s/it] 71%|███████   | 71/100 [03:31<01:32,  3.19s/it] 72%|███████▏  | 72/100 [03:34<01:30,  3.24s/it] 73%|███████▎  | 73/100 [03:37<01:26,  3.21s/it] 74%|███████▍  | 74/100 [03:40<01:22,  3.17s/it] 75%|███████▌  | 75/100 [03:43<01:18,  3.14s/it] 76%|███████▌  | 76/100 [03:47<01:17,  3.25s/it] 77%|███████▋  | 77/100 [03:50<01:13,  3.19s/it] 78%|███████▊  | 78/100 [03:53<01:09,  3.18s/it] 79%|███████▉  | 79/100 [03:56<01:06,  3.17s/it] 80%|████████  | 80/100 [03:59<01:02,  3.14s/it] 81%|████████  | 81/100 [04:02<00:59,  3.13s/it] 82%|████████▏ | 82/100 [04:06<00:55,  3.11s/it] 83%|████████▎ | 83/100 [04:09<00:53,  3.14s/it] 84%|████████▍ | 84/100 [04:12<00:51,  3.24s/it] 85%|████████▌ | 85/100 [04:15<00:48,  3.22s/it] 86%|████████▌ | 86/100 [04:19<00:44,  3.20s/it] 87%|████████▋ | 87/100 [04:22<00:41,  3.16s/it] 88%|████████▊ | 88/100 [04:25<00:37,  3.12s/it] 89%|████████▉ | 89/100 [04:28<00:34,  3.16s/it] 90%|█████████ | 90/100 [04:31<00:31,  3.14s/it] 91%|█████████ | 91/100 [04:34<00:28,  3.12s/it] 92%|█████████▏| 92/100 [04:37<00:24,  3.11s/it] 93%|█████████▎| 93/100 [04:40<00:21,  3.04s/it] 94%|█████████▍| 94/100 [04:43<00:18,  3.06s/it] 95%|█████████▌| 95/100 [04:46<00:15,  3.03s/it] 96%|█████████▌| 96/100 [04:49<00:12,  3.06s/it] 97%|█████████▋| 97/100 [04:52<00:09,  3.08s/it] 98%|█████████▊| 98/100 [04:55<00:06,  3.09s/it] 99%|█████████▉| 99/100 [04:59<00:03,  3.07s/it]100%|██████████| 100/100 [05:02<00:00,  3.15s/it]100%|██████████| 100/100 [05:02<00:00,  3.02s/it]
[0/100] loss: 2.698545217514038 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.484813690185547 loss_joints: 2.3971898555755615 loss_collision: 0.15283770859241486 loss_jerk: 0.06899002939462662 loss_floor_contact: 0.5509257316589355
[2/100] loss: 1.963256597518921 loss_joints: 1.857539176940918 loss_collision: 0.21750009059906006 loss_jerk: 0.09256947040557861 loss_floor_contact: 0.6082508563995361
[3/100] loss: 1.2482507228851318 loss_joints: 1.1800949573516846 loss_collision: 0.17786850035190582 loss_jerk: 0.09191033989191055 loss_floor_contact: 0.27391308546066284
[4/100] loss: 0.7054537534713745 loss_joints: 0.6648609638214111 loss_collision: 0.13774548470973969 loss_jerk: 0.09880481660366058 loss_floor_contact: 0.021170321851968765
[5/100] loss: 0.33488425612449646 loss_joints: 0.29919278621673584 loss_collision: 0.07829996943473816 loss_jerk: 0.10288188606500626 loss_floor_contact: 0.021410102024674416
[6/100] loss: 0.12905599176883698 loss_joints: 0.09154573082923889 loss_collision: 0.11776655167341232 loss_jerk: 0.09426596015691757 loss_floor_contact: 0.021671155467629433
[7/100] loss: 0.08964761346578598 loss_joints: 0.06439447402954102 loss_collision: 0.014459757134318352 loss_jerk: 0.08650252223014832 loss_floor_contact: 0.021815264597535133
[8/100] loss: 0.10072564333677292 loss_joints: 0.06697963178157806 loss_collision: 0.0441012978553772 loss_jerk: 0.10859626531600952 loss_floor_contact: 0.021868092939257622
[9/100] loss: 0.1079295426607132 loss_joints: 0.06762844324111938 loss_collision: 0.025842657312750816 loss_jerk: 0.142075315117836 loss_floor_contact: 0.021980127319693565
[10/100] loss: 0.10495112091302872 loss_joints: 0.05910671874880791 loss_collision: 0.02165944129228592 loss_jerk: 0.16264241933822632 loss_floor_contact: 0.030178487300872803
[11/100] loss: 0.082058846950531 loss_joints: 0.03233519196510315 loss_collision: 0.046567484736442566 loss_jerk: 0.17117652297019958 loss_floor_contact: 0.022727757692337036
[12/100] loss: 0.06129316985607147 loss_joints: 0.011340100318193436 loss_collision: 0.057048823684453964 loss_jerk: 0.16858315467834473 loss_floor_contact: 0.021023958921432495
[13/100] loss: 0.06086919829249382 loss_joints: 0.007789328694343567 loss_collision: 0.1154046356678009 loss_jerk: 0.15787731111049652 loss_floor_contact: 0.020700769498944283
[14/100] loss: 0.0600428506731987 loss_joints: 0.008271901868283749 loss_collision: 0.1280326396226883 loss_jerk: 0.1477597951889038 loss_floor_contact: 0.020277341827750206
[15/100] loss: 0.0498516745865345 loss_joints: 0.005239642225205898 loss_collision: 0.09518064558506012 loss_jerk: 0.13232596218585968 loss_floor_contact: 0.020124778151512146
[16/100] loss: 0.04068787023425102 loss_joints: 0.003212484996765852 loss_collision: 0.07098972797393799 loss_jerk: 0.1128067597746849 loss_floor_contact: 0.021747255697846413
[17/100] loss: 0.0336420051753521 loss_joints: 0.004347885958850384 loss_collision: 0.04650206118822098 loss_jerk: 0.09035710990428925 loss_floor_contact: 0.02054634317755699
[18/100] loss: 0.03143180534243584 loss_joints: 0.003791623283177614 loss_collision: 0.04011531546711922 loss_jerk: 0.08660634607076645 loss_floor_contact: 0.01977062225341797
[19/100] loss: 0.029409732669591904 loss_joints: 0.0017990369815379381 loss_collision: 0.04573845863342285 loss_jerk: 0.08448584377765656 loss_floor_contact: 0.01915387623012066
[20/100] loss: 0.02858896367251873 loss_joints: 0.0017199944704771042 loss_collision: 0.04373685643076897 loss_jerk: 0.08236197382211685 loss_floor_contact: 0.019047893583774567
[21/100] loss: 0.030649233609437943 loss_joints: 0.003064913209527731 loss_collision: 0.04600028321146965 loss_jerk: 0.08434303849935532 loss_floor_contact: 0.01898532174527645
[22/100] loss: 0.029594041407108307 loss_joints: 0.0022678556852042675 loss_collision: 0.043885111808776855 loss_jerk: 0.08409720659255981 loss_floor_contact: 0.019133714959025383
[23/100] loss: 0.02669665962457657 loss_joints: 0.0011117362882941961 loss_collision: 0.03922092169523239 loss_jerk: 0.07902469485998154 loss_floor_contact: 0.019066570326685905
[24/100] loss: 0.024422792717814445 loss_joints: 0.00025006718351505697 loss_collision: 0.030346717685461044 loss_jerk: 0.07677411288022995 loss_floor_contact: 0.01944524608552456
[25/100] loss: 0.02274320274591446 loss_joints: 0.0003591216809581965 loss_collision: 0.01658863015472889 loss_jerk: 0.07523834705352783 loss_floor_contact: 0.019156312569975853
[26/100] loss: 0.022713657468557358 loss_joints: 0.0002313188015250489 loss_collision: 0.020500602200627327 loss_jerk: 0.073969267308712 loss_floor_contact: 0.019399607554078102
[27/100] loss: 0.02167489193379879 loss_joints: 0.0001999122032430023 loss_collision: 0.015474824234843254 loss_jerk: 0.07155024260282516 loss_floor_contact: 0.020399365574121475
[28/100] loss: 0.02209181897342205 loss_joints: 4.950258880853653e-05 loss_collision: 0.02532043121755123 loss_jerk: 0.07012612372636795 loss_floor_contact: 0.01978742517530918
[29/100] loss: 0.02175978571176529 loss_joints: 0.00017061535618267953 loss_collision: 0.025211811065673828 loss_jerk: 0.06836361438035965 loss_floor_contact: 0.019770869985222816
[30/100] loss: 0.020086608827114105 loss_joints: 0.0003968278178945184 loss_collision: 0.013048265129327774 loss_jerk: 0.06567142903804779 loss_floor_contact: 0.019670957699418068
[31/100] loss: 0.018953699618577957 loss_joints: 7.509288843721151e-05 loss_collision: 0.011575667187571526 loss_jerk: 0.06309481710195541 loss_floor_contact: 0.01947336457669735
[32/100] loss: 0.018652452155947685 loss_joints: 0.0005461953114718199 loss_collision: 0.009351772256195545 loss_jerk: 0.061203476041555405 loss_floor_contact: 0.018702110275626183
[33/100] loss: 0.01799030601978302 loss_joints: 0.00025459681637585163 loss_collision: 0.009822328574955463 loss_jerk: 0.05954104661941528 loss_floor_contact: 0.018682152032852173
[34/100] loss: 0.018509674817323685 loss_joints: 0.00039263369399122894 loss_collision: 0.013688985258340836 loss_jerk: 0.05945153906941414 loss_floor_contact: 0.018852578476071358
[35/100] loss: 0.01825474388897419 loss_joints: 0.0006044974434189498 loss_collision: 0.00961308367550373 loss_jerk: 0.05912238731980324 loss_floor_contact: 0.0190834179520607
[36/100] loss: 0.017568327486515045 loss_joints: 0.0001638229878153652 loss_collision: 0.007887721061706543 loss_jerk: 0.058753643184900284 loss_floor_contact: 0.019273221492767334
[37/100] loss: 0.01767549104988575 loss_joints: 0.0005708400276489556 loss_collision: 0.006462660152465105 loss_jerk: 0.05816300958395004 loss_floor_contact: 0.01917632855474949
[38/100] loss: 0.01743936724960804 loss_joints: 0.0003782178682740778 loss_collision: 0.008005759678781033 loss_jerk: 0.05738857388496399 loss_floor_contact: 0.01913430355489254
[39/100] loss: 0.017515650019049644 loss_joints: 0.000311738986056298 loss_collision: 0.011700534261763096 loss_jerk: 0.056474559009075165 loss_floor_contact: 0.019152184948325157
[40/100] loss: 0.01709749735891819 loss_joints: 0.0003525319916661829 loss_collision: 0.008857942186295986 loss_jerk: 0.05577997863292694 loss_floor_contact: 0.019141757860779762
[41/100] loss: 0.01661951094865799 loss_joints: 0.00010085967369377613 loss_collision: 0.008246324025094509 loss_jerk: 0.055131036788225174 loss_floor_contact: 0.019112594425678253
[42/100] loss: 0.016602305695414543 loss_joints: 0.00012856755347456783 loss_collision: 0.009903824888169765 loss_jerk: 0.05428135395050049 loss_floor_contact: 0.019130166620016098
[43/100] loss: 0.01647351309657097 loss_joints: 0.00035038322675973177 loss_collision: 0.009111765772104263 loss_jerk: 0.05319715291261673 loss_floor_contact: 0.0191266480833292
[44/100] loss: 0.01618531532585621 loss_joints: 0.0002166538906749338 loss_collision: 0.008614442311227322 loss_jerk: 0.05280066654086113 loss_floor_contact: 0.019070513546466827
[45/100] loss: 0.01566743291914463 loss_joints: 7.426277443300933e-05 loss_collision: 0.007639467716217041 loss_jerk: 0.05172830447554588 loss_floor_contact: 0.018971463665366173
[46/100] loss: 0.015627440065145493 loss_joints: 0.0003766353474929929 loss_collision: 0.005128181539475918 loss_jerk: 0.05139182507991791 loss_floor_contact: 0.018900305032730103
[47/100] loss: 0.015377901494503021 loss_joints: 0.00011218406143598258 loss_collision: 0.006758494768291712 loss_jerk: 0.05081653594970703 loss_floor_contact: 0.018857337534427643
[48/100] loss: 0.015546583570539951 loss_joints: 0.0002559106796979904 loss_collision: 0.009692249819636345 loss_jerk: 0.04975176975131035 loss_floor_contact: 0.01883505843579769
[49/100] loss: 0.01557164266705513 loss_joints: 0.0004253003862686455 loss_collision: 0.009028717875480652 loss_jerk: 0.049452200531959534 loss_floor_contact: 0.01880420185625553
[50/100] loss: 0.015219740569591522 loss_joints: 0.00024374706845264882 loss_collision: 0.007965457625687122 loss_jerk: 0.049219485372304916 loss_floor_contact: 0.018745766952633858
[51/100] loss: 0.01517527922987938 loss_joints: 0.0003034660476259887 loss_collision: 0.006596459541469812 loss_jerk: 0.04938282072544098 loss_floor_contact: 0.018664618954062462
[52/100] loss: 0.015002429485321045 loss_joints: 0.0002185347257182002 loss_collision: 0.00644804397597909 loss_jerk: 0.0490962490439415 loss_floor_contact: 0.01865028403699398
[53/100] loss: 0.014648225158452988 loss_joints: 0.00014602411829400808 loss_collision: 0.005686655640602112 loss_jerk: 0.04825889319181442 loss_floor_contact: 0.018688125535845757
[54/100] loss: 0.014608589000999928 loss_joints: 0.0003185643581673503 loss_collision: 0.004449041560292244 loss_jerk: 0.04787954315543175 loss_floor_contact: 0.01875234954059124
[55/100] loss: 0.01451805792748928 loss_joints: 0.00025648606242612004 loss_collision: 0.005039440467953682 loss_jerk: 0.047522783279418945 loss_floor_contact: 0.018769318237900734
[56/100] loss: 0.01413046009838581 loss_joints: 6.288784061325714e-05 loss_collision: 0.005151838064193726 loss_jerk: 0.04671114683151245 loss_floor_contact: 0.018746018409729004
[57/100] loss: 0.014011583290994167 loss_joints: 0.00026438047643750906 loss_collision: 0.005279963370412588 loss_jerk: 0.04539160430431366 loss_floor_contact: 0.018713051453232765
[58/100] loss: 0.013809357769787312 loss_joints: 0.00013647685409523547 loss_collision: 0.005535738542675972 loss_jerk: 0.04500150680541992 loss_floor_contact: 0.018689308315515518
[59/100] loss: 0.013870364986360073 loss_joints: 8.154549868777394e-05 loss_collision: 0.0075180912390351295 loss_jerk: 0.044668231159448624 loss_floor_contact: 0.01869952119886875
[60/100] loss: 0.013968450017273426 loss_joints: 0.00015673227608203888 loss_collision: 0.008005840703845024 loss_jerk: 0.044560085982084274 loss_floor_contact: 0.018711119890213013
[61/100] loss: 0.013447376899421215 loss_joints: 8.605396942584775e-06 loss_collision: 0.0048287478275597095 loss_jerk: 0.04433537274599075 loss_floor_contact: 0.018720537424087524
[62/100] loss: 0.013952839188277721 loss_joints: 0.0001959888031706214 loss_collision: 0.004793989937752485 loss_jerk: 0.04561437666416168 loss_floor_contact: 0.018738577142357826
[63/100] loss: 0.013990771025419235 loss_joints: 0.00016672152560204268 loss_collision: 0.005661058705300093 loss_jerk: 0.04553130269050598 loss_floor_contact: 0.01875118352472782
[64/100] loss: 0.013606113381683826 loss_joints: 2.3852797312429175e-05 loss_collision: 0.005024100188165903 loss_jerk: 0.044816579669713974 loss_floor_contact: 0.018757058307528496
[65/100] loss: 0.013580621220171452 loss_joints: 0.00015116533904802054 loss_collision: 0.004684658721089363 loss_jerk: 0.04433842748403549 loss_floor_contact: 0.018763834610581398
[66/100] loss: 0.013437267392873764 loss_joints: 0.00012174079893156886 loss_collision: 0.003830037312582135 loss_jerk: 0.04423297941684723 loss_floor_contact: 0.01874278299510479
[67/100] loss: 0.013381344266235828 loss_joints: 8.471921319141984e-05 loss_collision: 0.004036817234009504 loss_jerk: 0.04408693313598633 loss_floor_contact: 0.018712107092142105
[68/100] loss: 0.013322862796485424 loss_joints: 4.5110420614946634e-05 loss_collision: 0.00438872491940856 loss_jerk: 0.043886054307222366 loss_floor_contact: 0.01867365837097168
[69/100] loss: 0.013371295295655727 loss_joints: 0.00030538131250068545 loss_collision: 0.0032106025610119104 loss_jerk: 0.04352215677499771 loss_floor_contact: 0.018643153831362724
[70/100] loss: 0.013430964201688766 loss_joints: 0.00033625279320403934 loss_collision: 0.0035805620718747377 loss_jerk: 0.043493762612342834 loss_floor_contact: 0.01863214001059532
[71/100] loss: 0.013504630886018276 loss_joints: 0.00020135007798671722 loss_collision: 0.006680204067379236 loss_jerk: 0.04308735206723213 loss_floor_contact: 0.01863422431051731
[72/100] loss: 0.013312657363712788 loss_joints: 0.00013999114162288606 loss_collision: 0.006439372897148132 loss_jerk: 0.042659319937229156 loss_floor_contact: 0.018638985231518745
[73/100] loss: 0.012924020178616047 loss_joints: 6.124831270426512e-05 loss_collision: 0.004204470198601484 loss_jerk: 0.042310893535614014 loss_floor_contact: 0.01864602230489254
[74/100] loss: 0.012844919227063656 loss_joints: 1.0932408258668147e-05 loss_collision: 0.004431873559951782 loss_jerk: 0.042097099125385284 loss_floor_contact: 0.018665248528122902
[75/100] loss: 0.012912444770336151 loss_joints: 9.238517668563873e-05 loss_collision: 0.004405031446367502 loss_jerk: 0.04204707592725754 loss_floor_contact: 0.018677880987524986
[76/100] loss: 0.012785056605935097 loss_joints: 9.350396430818364e-05 loss_collision: 0.0036312872543931007 loss_jerk: 0.04183780774474144 loss_floor_contact: 0.0186897162348032
[77/100] loss: 0.012638432905077934 loss_joints: 6.539714377140626e-05 loss_collision: 0.002846230985596776 loss_jerk: 0.041678208857774734 loss_floor_contact: 0.018688609823584557
[78/100] loss: 0.012589745223522186 loss_joints: 3.5562952689360827e-06 loss_collision: 0.002735113026574254 loss_jerk: 0.04177466779947281 loss_floor_contact: 0.01869010366499424
[79/100] loss: 0.01260244008153677 loss_joints: 5.005267303204164e-05 loss_collision: 0.003399764420464635 loss_jerk: 0.041374024003744125 loss_floor_contact: 0.018689049407839775
[80/100] loss: 0.012464071623980999 loss_joints: 8.674604760017246e-05 loss_collision: 0.0023576850071549416 loss_jerk: 0.04108792543411255 loss_floor_contact: 0.018695758655667305
[81/100] loss: 0.012558961287140846 loss_joints: 5.169943324290216e-05 loss_collision: 0.003955072723329067 loss_jerk: 0.04096380993723869 loss_floor_contact: 0.018708014860749245
[82/100] loss: 0.012583217583596706 loss_joints: 1.9267383322585374e-05 loss_collision: 0.004777386784553528 loss_jerk: 0.04086019843816757 loss_floor_contact: 0.018711617216467857
[83/100] loss: 0.012439963407814503 loss_joints: 1.8595168285173713e-06 loss_collision: 0.003657336113974452 loss_jerk: 0.040805500000715256 loss_floor_contact: 0.018709953874349594
[84/100] loss: 0.012369554489850998 loss_joints: 1.4227846804715227e-05 loss_collision: 0.0026200248394161463 loss_jerk: 0.04089370742440224 loss_floor_contact: 0.018698977306485176
[85/100] loss: 0.012506355531513691 loss_joints: 1.4972441931604408e-05 loss_collision: 0.004125616513192654 loss_jerk: 0.04083842411637306 loss_floor_contact: 0.018692152574658394
[86/100] loss: 0.012494790367782116 loss_joints: 1.971760138985701e-05 loss_collision: 0.003847741521894932 loss_jerk: 0.0408848375082016 loss_floor_contact: 0.018690887838602066
[87/100] loss: 0.012647603638470173 loss_joints: 3.537699376465753e-05 loss_collision: 0.005674539599567652 loss_jerk: 0.040700871497392654 loss_floor_contact: 0.018695546314120293
[88/100] loss: 0.012653063982725143 loss_joints: 1.745516601658892e-05 loss_collision: 0.0057952734641730785 loss_jerk: 0.04074549674987793 loss_floor_contact: 0.018697069957852364
[89/100] loss: 0.012524964287877083 loss_joints: 8.423176041105762e-07 loss_collision: 0.004614353179931641 loss_jerk: 0.04077380150556564 loss_floor_contact: 0.018692364916205406
[90/100] loss: 0.012354616075754166 loss_joints: 3.480803934508003e-05 loss_collision: 0.002768776612356305 loss_jerk: 0.04069843888282776 loss_floor_contact: 0.018683208152651787
[91/100] loss: 0.012380813248455524 loss_joints: 7.399726018775254e-05 loss_collision: 0.002797701396048069 loss_jerk: 0.04063607007265091 loss_floor_contact: 0.018680283799767494
[92/100] loss: 0.012344091199338436 loss_joints: 7.140071829780936e-05 loss_collision: 0.0027973982505500317 loss_jerk: 0.04049946740269661 loss_floor_contact: 0.018680844455957413
[93/100] loss: 0.012265936471521854 loss_joints: 3.9912811189424247e-05 loss_collision: 0.0026251741219311953 loss_jerk: 0.04038055241107941 loss_floor_contact: 0.01868368126451969
[94/100] loss: 0.012170223519206047 loss_joints: 1.4191207810654305e-05 loss_collision: 0.002128336112946272 loss_jerk: 0.04029763862490654 loss_floor_contact: 0.018687887117266655
[95/100] loss: 0.012267664074897766 loss_joints: 1.2298714864300564e-05 loss_collision: 0.0035096474457532167 loss_jerk: 0.04014186933636665 loss_floor_contact: 0.018689334392547607
[96/100] loss: 0.012255426496267319 loss_joints: 1.729102586978115e-05 loss_collision: 0.003476412734016776 loss_jerk: 0.040086667984724045 loss_floor_contact: 0.018688274547457695
[97/100] loss: 0.012259623035788536 loss_joints: 1.651210550335236e-05 loss_collision: 0.003599319141358137 loss_jerk: 0.04005834832787514 loss_floor_contact: 0.01868591643869877
[98/100] loss: 0.012243688106536865 loss_joints: 1.035326476994669e-05 loss_collision: 0.003379868110641837 loss_jerk: 0.040108051151037216 loss_floor_contact: 0.018683357164263725
[99/100] loss: 0.012172291986644268 loss_joints: 5.2419582061702386e-06 loss_collision: 0.0026969180908054113 loss_jerk: 0.04011689871549606 loss_floor_contact: 0.01868133433163166
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk0.25_skate0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 302.34798                                                    ║
    ║     rollout = 136.43339                                                    ║
    ║     sdf     = 18.62850                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.01217229                                                 ║
    ║     joints    = 0.00000524                                                 ║
    ║     collision = 0.00269692                                                 ║
    ║     jerk      = 0.04011690                                                 ║
    ║     floor     = 0.01868133                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m21.820s
user	4m38.375s
sys	0m13.374s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.25, skate=0.25
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:51,  3.55s/it]  2%|▏         | 2/100 [00:07<05:43,  3.51s/it]  3%|▎         | 3/100 [00:10<05:44,  3.55s/it]  4%|▍         | 4/100 [00:13<05:16,  3.30s/it]  5%|▌         | 5/100 [00:16<04:54,  3.10s/it]  6%|▌         | 6/100 [00:19<04:56,  3.15s/it]  7%|▋         | 7/100 [00:22<04:52,  3.14s/it]  8%|▊         | 8/100 [00:25<04:52,  3.18s/it]  9%|▉         | 9/100 [00:28<04:44,  3.13s/it] 10%|█         | 10/100 [00:32<04:40,  3.12s/it] 11%|█         | 11/100 [00:35<04:38,  3.13s/it] 12%|█▏        | 12/100 [00:38<04:34,  3.11s/it] 13%|█▎        | 13/100 [00:41<04:41,  3.24s/it] 14%|█▍        | 14/100 [00:45<04:51,  3.38s/it] 15%|█▌        | 15/100 [00:49<04:51,  3.42s/it] 16%|█▌        | 16/100 [00:52<04:43,  3.37s/it] 17%|█▋        | 17/100 [00:55<04:33,  3.29s/it] 18%|█▊        | 18/100 [00:58<04:26,  3.25s/it] 19%|█▉        | 19/100 [01:01<04:22,  3.24s/it] 20%|██        | 20/100 [01:05<04:29,  3.36s/it] 21%|██        | 21/100 [01:08<04:19,  3.29s/it] 22%|██▏       | 22/100 [01:11<04:21,  3.35s/it] 23%|██▎       | 23/100 [01:15<04:16,  3.33s/it] 24%|██▍       | 24/100 [01:18<04:15,  3.36s/it] 25%|██▌       | 25/100 [01:21<04:08,  3.31s/it] 26%|██▌       | 26/100 [01:25<04:01,  3.27s/it] 27%|██▋       | 27/100 [01:28<03:55,  3.22s/it] 28%|██▊       | 28/100 [01:31<03:55,  3.28s/it] 29%|██▉       | 29/100 [01:34<03:52,  3.27s/it] 30%|███       | 30/100 [01:38<03:52,  3.33s/it] 31%|███       | 31/100 [01:41<03:45,  3.26s/it] 32%|███▏      | 32/100 [01:44<03:42,  3.28s/it] 33%|███▎      | 33/100 [01:48<03:44,  3.35s/it] 34%|███▍      | 34/100 [01:51<03:42,  3.37s/it] 35%|███▌      | 35/100 [01:55<03:44,  3.45s/it] 36%|███▌      | 36/100 [01:58<03:34,  3.36s/it] 37%|███▋      | 37/100 [02:01<03:31,  3.35s/it] 38%|███▊      | 38/100 [02:05<03:31,  3.42s/it] 39%|███▉      | 39/100 [02:08<03:24,  3.35s/it] 40%|████      | 40/100 [02:11<03:19,  3.33s/it] 41%|████      | 41/100 [02:15<03:15,  3.31s/it] 42%|████▏     | 42/100 [02:18<03:08,  3.25s/it] 43%|████▎     | 43/100 [02:21<03:06,  3.27s/it] 44%|████▍     | 44/100 [02:25<03:07,  3.35s/it] 45%|████▌     | 45/100 [02:28<03:08,  3.44s/it] 46%|████▌     | 46/100 [02:32<03:03,  3.41s/it] 47%|████▋     | 47/100 [02:35<03:02,  3.45s/it] 48%|████▊     | 48/100 [02:38<02:57,  3.41s/it] 49%|████▉     | 49/100 [02:42<02:54,  3.42s/it] 50%|█████     | 50/100 [02:45<02:50,  3.42s/it] 51%|█████     | 51/100 [02:49<02:58,  3.64s/it] 52%|█████▏    | 52/100 [02:53<02:51,  3.57s/it] 53%|█████▎    | 53/100 [02:56<02:43,  3.47s/it] 54%|█████▍    | 54/100 [02:59<02:35,  3.39s/it] 55%|█████▌    | 55/100 [03:03<02:32,  3.40s/it] 56%|█████▌    | 56/100 [03:06<02:28,  3.36s/it] 57%|█████▋    | 57/100 [03:09<02:25,  3.39s/it] 58%|█████▊    | 58/100 [03:13<02:19,  3.33s/it] 59%|█████▉    | 59/100 [03:16<02:16,  3.33s/it] 60%|██████    | 60/100 [03:19<02:15,  3.39s/it] 61%|██████    | 61/100 [03:23<02:13,  3.43s/it] 62%|██████▏   | 62/100 [03:27<02:17,  3.61s/it] 63%|██████▎   | 63/100 [03:30<02:12,  3.57s/it] 64%|██████▍   | 64/100 [03:34<02:09,  3.59s/it] 65%|██████▌   | 65/100 [03:38<02:07,  3.66s/it] 66%|██████▌   | 66/100 [03:41<02:00,  3.54s/it] 67%|██████▋   | 67/100 [03:45<01:55,  3.51s/it] 68%|██████▊   | 68/100 [03:48<01:50,  3.47s/it] 69%|██████▉   | 69/100 [03:52<01:50,  3.57s/it] 70%|███████   | 70/100 [03:55<01:45,  3.52s/it] 71%|███████   | 71/100 [03:59<01:40,  3.45s/it] 72%|███████▏  | 72/100 [04:02<01:37,  3.48s/it] 73%|███████▎  | 73/100 [04:06<01:33,  3.47s/it] 74%|███████▍  | 74/100 [04:10<01:34,  3.64s/it] 75%|███████▌  | 75/100 [04:13<01:28,  3.52s/it] 76%|███████▌  | 76/100 [04:16<01:24,  3.51s/it] 77%|███████▋  | 77/100 [04:20<01:19,  3.45s/it] 78%|███████▊  | 78/100 [04:23<01:15,  3.41s/it] 79%|███████▉  | 79/100 [04:26<01:09,  3.29s/it] 80%|████████  | 80/100 [04:29<01:04,  3.24s/it] 81%|████████  | 81/100 [04:32<01:01,  3.23s/it] 82%|████████▏ | 82/100 [04:35<00:57,  3.22s/it] 83%|████████▎ | 83/100 [04:39<00:54,  3.19s/it] 84%|████████▍ | 84/100 [04:42<00:53,  3.34s/it] 85%|████████▌ | 85/100 [04:46<00:50,  3.36s/it] 86%|████████▌ | 86/100 [04:49<00:46,  3.30s/it] 87%|████████▋ | 87/100 [04:52<00:42,  3.28s/it] 88%|████████▊ | 88/100 [04:55<00:38,  3.22s/it] 89%|████████▉ | 89/100 [04:58<00:35,  3.26s/it] 90%|█████████ | 90/100 [05:02<00:32,  3.29s/it] 91%|█████████ | 91/100 [05:05<00:29,  3.26s/it] 92%|█████████▏| 92/100 [05:08<00:25,  3.24s/it] 93%|█████████▎| 93/100 [05:12<00:22,  3.28s/it] 94%|█████████▍| 94/100 [05:15<00:19,  3.31s/it] 95%|█████████▌| 95/100 [05:18<00:16,  3.34s/it] 96%|█████████▌| 96/100 [05:22<00:13,  3.34s/it] 97%|█████████▋| 97/100 [05:25<00:10,  3.34s/it] 98%|█████████▊| 98/100 [05:29<00:06,  3.39s/it] 99%|█████████▉| 99/100 [05:32<00:03,  3.38s/it]100%|██████████| 100/100 [05:35<00:00,  3.31s/it]100%|██████████| 100/100 [05:35<00:00,  3.36s/it]
[0/100] loss: 2.698545217514038 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.484813690185547 loss_joints: 2.3971898555755615 loss_collision: 0.15283770859241486 loss_jerk: 0.06899002939462662 loss_floor_contact: 0.5509257316589355
[2/100] loss: 1.963256597518921 loss_joints: 1.857539176940918 loss_collision: 0.21750009059906006 loss_jerk: 0.09256947040557861 loss_floor_contact: 0.6082508563995361
[3/100] loss: 1.2482507228851318 loss_joints: 1.1800949573516846 loss_collision: 0.17786850035190582 loss_jerk: 0.09191033989191055 loss_floor_contact: 0.27391308546066284
[4/100] loss: 0.7054537534713745 loss_joints: 0.6648609638214111 loss_collision: 0.13774548470973969 loss_jerk: 0.09880481660366058 loss_floor_contact: 0.021170321851968765
[5/100] loss: 0.33488425612449646 loss_joints: 0.29919278621673584 loss_collision: 0.07829996943473816 loss_jerk: 0.10288188606500626 loss_floor_contact: 0.021410102024674416
[6/100] loss: 0.12905599176883698 loss_joints: 0.09154573082923889 loss_collision: 0.11776655167341232 loss_jerk: 0.09426596015691757 loss_floor_contact: 0.021671155467629433
[7/100] loss: 0.08964761346578598 loss_joints: 0.06439447402954102 loss_collision: 0.014459757134318352 loss_jerk: 0.08650252223014832 loss_floor_contact: 0.021815264597535133
[8/100] loss: 0.10072564333677292 loss_joints: 0.06697963178157806 loss_collision: 0.0441012978553772 loss_jerk: 0.10859626531600952 loss_floor_contact: 0.021868092939257622
[9/100] loss: 0.1079295426607132 loss_joints: 0.06762844324111938 loss_collision: 0.025842657312750816 loss_jerk: 0.142075315117836 loss_floor_contact: 0.021980127319693565
[10/100] loss: 0.10495112091302872 loss_joints: 0.05910671874880791 loss_collision: 0.02165944129228592 loss_jerk: 0.16264241933822632 loss_floor_contact: 0.030178487300872803
[11/100] loss: 0.082058846950531 loss_joints: 0.03233519196510315 loss_collision: 0.046567484736442566 loss_jerk: 0.17117652297019958 loss_floor_contact: 0.022727757692337036
[12/100] loss: 0.06129316985607147 loss_joints: 0.011340100318193436 loss_collision: 0.057048823684453964 loss_jerk: 0.16858315467834473 loss_floor_contact: 0.021023958921432495
[13/100] loss: 0.06086919829249382 loss_joints: 0.007789328694343567 loss_collision: 0.1154046356678009 loss_jerk: 0.15787731111049652 loss_floor_contact: 0.020700769498944283
[14/100] loss: 0.0600428506731987 loss_joints: 0.008271901868283749 loss_collision: 0.1280326396226883 loss_jerk: 0.1477597951889038 loss_floor_contact: 0.020277341827750206
[15/100] loss: 0.0498516745865345 loss_joints: 0.005239642225205898 loss_collision: 0.09518064558506012 loss_jerk: 0.13232596218585968 loss_floor_contact: 0.020124778151512146
[16/100] loss: 0.04068787023425102 loss_joints: 0.003212484996765852 loss_collision: 0.07098972797393799 loss_jerk: 0.1128067597746849 loss_floor_contact: 0.021747255697846413
[17/100] loss: 0.0336420051753521 loss_joints: 0.004347885958850384 loss_collision: 0.04650206118822098 loss_jerk: 0.09035710990428925 loss_floor_contact: 0.02054634317755699
[18/100] loss: 0.03143180534243584 loss_joints: 0.003791623283177614 loss_collision: 0.04011531546711922 loss_jerk: 0.08660634607076645 loss_floor_contact: 0.01977062225341797
[19/100] loss: 0.029409732669591904 loss_joints: 0.0017990369815379381 loss_collision: 0.04573845863342285 loss_jerk: 0.08448584377765656 loss_floor_contact: 0.01915387623012066
[20/100] loss: 0.02858896367251873 loss_joints: 0.0017199944704771042 loss_collision: 0.04373685643076897 loss_jerk: 0.08236197382211685 loss_floor_contact: 0.019047893583774567
[21/100] loss: 0.030649233609437943 loss_joints: 0.003064913209527731 loss_collision: 0.04600028321146965 loss_jerk: 0.08434303849935532 loss_floor_contact: 0.01898532174527645
[22/100] loss: 0.029594041407108307 loss_joints: 0.0022678556852042675 loss_collision: 0.043885111808776855 loss_jerk: 0.08409720659255981 loss_floor_contact: 0.019133714959025383
[23/100] loss: 0.02669665962457657 loss_joints: 0.0011117362882941961 loss_collision: 0.03922092169523239 loss_jerk: 0.07902469485998154 loss_floor_contact: 0.019066570326685905
[24/100] loss: 0.024422792717814445 loss_joints: 0.00025006718351505697 loss_collision: 0.030346717685461044 loss_jerk: 0.07677411288022995 loss_floor_contact: 0.01944524608552456
[25/100] loss: 0.02274320274591446 loss_joints: 0.0003591216809581965 loss_collision: 0.01658863015472889 loss_jerk: 0.07523834705352783 loss_floor_contact: 0.019156312569975853
[26/100] loss: 0.022713657468557358 loss_joints: 0.0002313188015250489 loss_collision: 0.020500602200627327 loss_jerk: 0.073969267308712 loss_floor_contact: 0.019399607554078102
[27/100] loss: 0.02167489193379879 loss_joints: 0.0001999122032430023 loss_collision: 0.015474824234843254 loss_jerk: 0.07155024260282516 loss_floor_contact: 0.020399365574121475
[28/100] loss: 0.02209181897342205 loss_joints: 4.950258880853653e-05 loss_collision: 0.02532043121755123 loss_jerk: 0.07012612372636795 loss_floor_contact: 0.01978742517530918
[29/100] loss: 0.02175978571176529 loss_joints: 0.00017061535618267953 loss_collision: 0.025211811065673828 loss_jerk: 0.06836361438035965 loss_floor_contact: 0.019770869985222816
[30/100] loss: 0.020086608827114105 loss_joints: 0.0003968278178945184 loss_collision: 0.013048265129327774 loss_jerk: 0.06567142903804779 loss_floor_contact: 0.019670957699418068
[31/100] loss: 0.018953699618577957 loss_joints: 7.509288843721151e-05 loss_collision: 0.011575667187571526 loss_jerk: 0.06309481710195541 loss_floor_contact: 0.01947336457669735
[32/100] loss: 0.018652452155947685 loss_joints: 0.0005461953114718199 loss_collision: 0.009351772256195545 loss_jerk: 0.061203476041555405 loss_floor_contact: 0.018702110275626183
[33/100] loss: 0.01799030601978302 loss_joints: 0.00025459681637585163 loss_collision: 0.009822328574955463 loss_jerk: 0.05954104661941528 loss_floor_contact: 0.018682152032852173
[34/100] loss: 0.018509674817323685 loss_joints: 0.00039263369399122894 loss_collision: 0.013688985258340836 loss_jerk: 0.05945153906941414 loss_floor_contact: 0.018852578476071358
[35/100] loss: 0.01825474388897419 loss_joints: 0.0006044974434189498 loss_collision: 0.00961308367550373 loss_jerk: 0.05912238731980324 loss_floor_contact: 0.0190834179520607
[36/100] loss: 0.017568327486515045 loss_joints: 0.0001638229878153652 loss_collision: 0.007887721061706543 loss_jerk: 0.058753643184900284 loss_floor_contact: 0.019273221492767334
[37/100] loss: 0.01767549104988575 loss_joints: 0.0005708400276489556 loss_collision: 0.006462660152465105 loss_jerk: 0.05816300958395004 loss_floor_contact: 0.01917632855474949
[38/100] loss: 0.01743936724960804 loss_joints: 0.0003782178682740778 loss_collision: 0.008005759678781033 loss_jerk: 0.05738857388496399 loss_floor_contact: 0.01913430355489254
[39/100] loss: 0.017515650019049644 loss_joints: 0.000311738986056298 loss_collision: 0.011700534261763096 loss_jerk: 0.056474559009075165 loss_floor_contact: 0.019152184948325157
[40/100] loss: 0.01709749735891819 loss_joints: 0.0003525319916661829 loss_collision: 0.008857942186295986 loss_jerk: 0.05577997863292694 loss_floor_contact: 0.019141757860779762
[41/100] loss: 0.01661951094865799 loss_joints: 0.00010085967369377613 loss_collision: 0.008246324025094509 loss_jerk: 0.055131036788225174 loss_floor_contact: 0.019112594425678253
[42/100] loss: 0.016602305695414543 loss_joints: 0.00012856755347456783 loss_collision: 0.009903824888169765 loss_jerk: 0.05428135395050049 loss_floor_contact: 0.019130166620016098
[43/100] loss: 0.01647351309657097 loss_joints: 0.00035038322675973177 loss_collision: 0.009111765772104263 loss_jerk: 0.05319715291261673 loss_floor_contact: 0.0191266480833292
[44/100] loss: 0.01618531532585621 loss_joints: 0.0002166538906749338 loss_collision: 0.008614442311227322 loss_jerk: 0.05280066654086113 loss_floor_contact: 0.019070513546466827
[45/100] loss: 0.01566743291914463 loss_joints: 7.426277443300933e-05 loss_collision: 0.007639467716217041 loss_jerk: 0.05172830447554588 loss_floor_contact: 0.018971463665366173
[46/100] loss: 0.015627440065145493 loss_joints: 0.0003766353474929929 loss_collision: 0.005128181539475918 loss_jerk: 0.05139182507991791 loss_floor_contact: 0.018900305032730103
[47/100] loss: 0.015377901494503021 loss_joints: 0.00011218406143598258 loss_collision: 0.006758494768291712 loss_jerk: 0.05081653594970703 loss_floor_contact: 0.018857337534427643
[48/100] loss: 0.015546583570539951 loss_joints: 0.0002559106796979904 loss_collision: 0.009692249819636345 loss_jerk: 0.04975176975131035 loss_floor_contact: 0.01883505843579769
[49/100] loss: 0.01557164266705513 loss_joints: 0.0004253003862686455 loss_collision: 0.009028717875480652 loss_jerk: 0.049452200531959534 loss_floor_contact: 0.01880420185625553
[50/100] loss: 0.015219740569591522 loss_joints: 0.00024374706845264882 loss_collision: 0.007965457625687122 loss_jerk: 0.049219485372304916 loss_floor_contact: 0.018745766952633858
[51/100] loss: 0.01517527922987938 loss_joints: 0.0003034660476259887 loss_collision: 0.006596459541469812 loss_jerk: 0.04938282072544098 loss_floor_contact: 0.018664618954062462
[52/100] loss: 0.015002429485321045 loss_joints: 0.0002185347257182002 loss_collision: 0.00644804397597909 loss_jerk: 0.0490962490439415 loss_floor_contact: 0.01865028403699398
[53/100] loss: 0.014648225158452988 loss_joints: 0.00014602411829400808 loss_collision: 0.005686655640602112 loss_jerk: 0.04825889319181442 loss_floor_contact: 0.018688125535845757
[54/100] loss: 0.014608589000999928 loss_joints: 0.0003185643581673503 loss_collision: 0.004449041560292244 loss_jerk: 0.04787954315543175 loss_floor_contact: 0.01875234954059124
[55/100] loss: 0.01451805792748928 loss_joints: 0.00025648606242612004 loss_collision: 0.005039440467953682 loss_jerk: 0.047522783279418945 loss_floor_contact: 0.018769318237900734
[56/100] loss: 0.01413046009838581 loss_joints: 6.288784061325714e-05 loss_collision: 0.005151838064193726 loss_jerk: 0.04671114683151245 loss_floor_contact: 0.018746018409729004
[57/100] loss: 0.014011583290994167 loss_joints: 0.00026438047643750906 loss_collision: 0.005279963370412588 loss_jerk: 0.04539160430431366 loss_floor_contact: 0.018713051453232765
[58/100] loss: 0.013809357769787312 loss_joints: 0.00013647685409523547 loss_collision: 0.005535738542675972 loss_jerk: 0.04500150680541992 loss_floor_contact: 0.018689308315515518
[59/100] loss: 0.013870364986360073 loss_joints: 8.154549868777394e-05 loss_collision: 0.0075180912390351295 loss_jerk: 0.044668231159448624 loss_floor_contact: 0.01869952119886875
[60/100] loss: 0.013968450017273426 loss_joints: 0.00015673227608203888 loss_collision: 0.008005840703845024 loss_jerk: 0.044560085982084274 loss_floor_contact: 0.018711119890213013
[61/100] loss: 0.013447376899421215 loss_joints: 8.605396942584775e-06 loss_collision: 0.0048287478275597095 loss_jerk: 0.04433537274599075 loss_floor_contact: 0.018720537424087524
[62/100] loss: 0.013952839188277721 loss_joints: 0.0001959888031706214 loss_collision: 0.004793989937752485 loss_jerk: 0.04561437666416168 loss_floor_contact: 0.018738577142357826
[63/100] loss: 0.013990771025419235 loss_joints: 0.00016672152560204268 loss_collision: 0.005661058705300093 loss_jerk: 0.04553130269050598 loss_floor_contact: 0.01875118352472782
[64/100] loss: 0.013606113381683826 loss_joints: 2.3852797312429175e-05 loss_collision: 0.005024100188165903 loss_jerk: 0.044816579669713974 loss_floor_contact: 0.018757058307528496
[65/100] loss: 0.013580621220171452 loss_joints: 0.00015116533904802054 loss_collision: 0.004684658721089363 loss_jerk: 0.04433842748403549 loss_floor_contact: 0.018763834610581398
[66/100] loss: 0.013437267392873764 loss_joints: 0.00012174079893156886 loss_collision: 0.003830037312582135 loss_jerk: 0.04423297941684723 loss_floor_contact: 0.01874278299510479
[67/100] loss: 0.013381344266235828 loss_joints: 8.471921319141984e-05 loss_collision: 0.004036817234009504 loss_jerk: 0.04408693313598633 loss_floor_contact: 0.018712107092142105
[68/100] loss: 0.013322862796485424 loss_joints: 4.5110420614946634e-05 loss_collision: 0.00438872491940856 loss_jerk: 0.043886054307222366 loss_floor_contact: 0.01867365837097168
[69/100] loss: 0.013371295295655727 loss_joints: 0.00030538131250068545 loss_collision: 0.0032106025610119104 loss_jerk: 0.04352215677499771 loss_floor_contact: 0.018643153831362724
[70/100] loss: 0.013430964201688766 loss_joints: 0.00033625279320403934 loss_collision: 0.0035805620718747377 loss_jerk: 0.043493762612342834 loss_floor_contact: 0.01863214001059532
[71/100] loss: 0.013504630886018276 loss_joints: 0.00020135007798671722 loss_collision: 0.006680204067379236 loss_jerk: 0.04308735206723213 loss_floor_contact: 0.01863422431051731
[72/100] loss: 0.013312657363712788 loss_joints: 0.00013999114162288606 loss_collision: 0.006439372897148132 loss_jerk: 0.042659319937229156 loss_floor_contact: 0.018638985231518745
[73/100] loss: 0.012924020178616047 loss_joints: 6.124831270426512e-05 loss_collision: 0.004204470198601484 loss_jerk: 0.042310893535614014 loss_floor_contact: 0.01864602230489254
[74/100] loss: 0.012844919227063656 loss_joints: 1.0932408258668147e-05 loss_collision: 0.004431873559951782 loss_jerk: 0.042097099125385284 loss_floor_contact: 0.018665248528122902
[75/100] loss: 0.012912444770336151 loss_joints: 9.238517668563873e-05 loss_collision: 0.004405031446367502 loss_jerk: 0.04204707592725754 loss_floor_contact: 0.018677880987524986
[76/100] loss: 0.012785056605935097 loss_joints: 9.350396430818364e-05 loss_collision: 0.0036312872543931007 loss_jerk: 0.04183780774474144 loss_floor_contact: 0.0186897162348032
[77/100] loss: 0.012638432905077934 loss_joints: 6.539714377140626e-05 loss_collision: 0.002846230985596776 loss_jerk: 0.041678208857774734 loss_floor_contact: 0.018688609823584557
[78/100] loss: 0.012589745223522186 loss_joints: 3.5562952689360827e-06 loss_collision: 0.002735113026574254 loss_jerk: 0.04177466779947281 loss_floor_contact: 0.01869010366499424
[79/100] loss: 0.01260244008153677 loss_joints: 5.005267303204164e-05 loss_collision: 0.003399764420464635 loss_jerk: 0.041374024003744125 loss_floor_contact: 0.018689049407839775
[80/100] loss: 0.012464071623980999 loss_joints: 8.674604760017246e-05 loss_collision: 0.0023576850071549416 loss_jerk: 0.04108792543411255 loss_floor_contact: 0.018695758655667305
[81/100] loss: 0.012558961287140846 loss_joints: 5.169943324290216e-05 loss_collision: 0.003955072723329067 loss_jerk: 0.04096380993723869 loss_floor_contact: 0.018708014860749245
[82/100] loss: 0.012583217583596706 loss_joints: 1.9267383322585374e-05 loss_collision: 0.004777386784553528 loss_jerk: 0.04086019843816757 loss_floor_contact: 0.018711617216467857
[83/100] loss: 0.012439963407814503 loss_joints: 1.8595168285173713e-06 loss_collision: 0.003657336113974452 loss_jerk: 0.040805500000715256 loss_floor_contact: 0.018709953874349594
[84/100] loss: 0.012369554489850998 loss_joints: 1.4227846804715227e-05 loss_collision: 0.0026200248394161463 loss_jerk: 0.04089370742440224 loss_floor_contact: 0.018698977306485176
[85/100] loss: 0.012506355531513691 loss_joints: 1.4972441931604408e-05 loss_collision: 0.004125616513192654 loss_jerk: 0.04083842411637306 loss_floor_contact: 0.018692152574658394
[86/100] loss: 0.012494790367782116 loss_joints: 1.971760138985701e-05 loss_collision: 0.003847741521894932 loss_jerk: 0.0408848375082016 loss_floor_contact: 0.018690887838602066
[87/100] loss: 0.012647603638470173 loss_joints: 3.537699376465753e-05 loss_collision: 0.005674539599567652 loss_jerk: 0.040700871497392654 loss_floor_contact: 0.018695546314120293
[88/100] loss: 0.012653063982725143 loss_joints: 1.745516601658892e-05 loss_collision: 0.0057952734641730785 loss_jerk: 0.04074549674987793 loss_floor_contact: 0.018697069957852364
[89/100] loss: 0.012524964287877083 loss_joints: 8.423176041105762e-07 loss_collision: 0.004614353179931641 loss_jerk: 0.04077380150556564 loss_floor_contact: 0.018692364916205406
[90/100] loss: 0.012354616075754166 loss_joints: 3.480803934508003e-05 loss_collision: 0.002768776612356305 loss_jerk: 0.04069843888282776 loss_floor_contact: 0.018683208152651787
[91/100] loss: 0.012380813248455524 loss_joints: 7.399726018775254e-05 loss_collision: 0.002797701396048069 loss_jerk: 0.04063607007265091 loss_floor_contact: 0.018680283799767494
[92/100] loss: 0.012344091199338436 loss_joints: 7.140071829780936e-05 loss_collision: 0.0027973982505500317 loss_jerk: 0.04049946740269661 loss_floor_contact: 0.018680844455957413
[93/100] loss: 0.012265936471521854 loss_joints: 3.9912811189424247e-05 loss_collision: 0.0026251741219311953 loss_jerk: 0.04038055241107941 loss_floor_contact: 0.01868368126451969
[94/100] loss: 0.012170223519206047 loss_joints: 1.4191207810654305e-05 loss_collision: 0.002128336112946272 loss_jerk: 0.04029763862490654 loss_floor_contact: 0.018687887117266655
[95/100] loss: 0.012267664074897766 loss_joints: 1.2298714864300564e-05 loss_collision: 0.0035096474457532167 loss_jerk: 0.04014186933636665 loss_floor_contact: 0.018689334392547607
[96/100] loss: 0.012255426496267319 loss_joints: 1.729102586978115e-05 loss_collision: 0.003476412734016776 loss_jerk: 0.040086667984724045 loss_floor_contact: 0.018688274547457695
[97/100] loss: 0.012259623035788536 loss_joints: 1.651210550335236e-05 loss_collision: 0.003599319141358137 loss_jerk: 0.04005834832787514 loss_floor_contact: 0.01868591643869877
[98/100] loss: 0.012243688106536865 loss_joints: 1.035326476994669e-05 loss_collision: 0.003379868110641837 loss_jerk: 0.040108051151037216 loss_floor_contact: 0.018683357164263725
[99/100] loss: 0.012172291986644268 loss_joints: 5.2419582061702386e-06 loss_collision: 0.0026969180908054113 loss_jerk: 0.04011689871549606 loss_floor_contact: 0.01868133433163166
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk0.25_skate0.25]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 335.58282                                                    ║
    ║     rollout = 146.92288                                                    ║
    ║     sdf     = 24.12516                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.01217229                                                 ║
    ║     joints    = 0.00000524                                                 ║
    ║     collision = 0.00269692                                                 ║
    ║     jerk      = 0.04011690                                                 ║
    ║     floor     = 0.01868133                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m56.266s
user	4m50.393s
sys	0m18.954s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.25, skate=0.5
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:44,  3.48s/it]  2%|▏         | 2/100 [00:07<05:53,  3.60s/it]  3%|▎         | 3/100 [00:11<06:00,  3.71s/it]  4%|▍         | 4/100 [00:14<05:36,  3.51s/it]  5%|▌         | 5/100 [00:17<05:24,  3.41s/it]  6%|▌         | 6/100 [00:20<05:21,  3.42s/it]  7%|▋         | 7/100 [00:24<05:10,  3.34s/it]  8%|▊         | 8/100 [00:27<04:59,  3.25s/it]  9%|▉         | 9/100 [00:30<04:53,  3.22s/it] 10%|█         | 10/100 [00:33<04:51,  3.23s/it] 11%|█         | 11/100 [00:36<04:52,  3.28s/it] 12%|█▏        | 12/100 [00:40<04:51,  3.32s/it] 13%|█▎        | 13/100 [00:43<04:46,  3.30s/it] 14%|█▍        | 14/100 [00:47<04:50,  3.38s/it] 15%|█▌        | 15/100 [00:50<04:45,  3.36s/it] 16%|█▌        | 16/100 [00:53<04:36,  3.29s/it] 17%|█▋        | 17/100 [00:56<04:30,  3.26s/it] 18%|█▊        | 18/100 [00:59<04:25,  3.24s/it] 19%|█▉        | 19/100 [01:03<04:25,  3.28s/it] 20%|██        | 20/100 [01:07<04:32,  3.40s/it] 21%|██        | 21/100 [01:10<04:28,  3.40s/it] 22%|██▏       | 22/100 [01:13<04:22,  3.37s/it] 23%|██▎       | 23/100 [01:16<04:13,  3.29s/it] 24%|██▍       | 24/100 [01:20<04:09,  3.28s/it] 25%|██▌       | 25/100 [01:23<04:08,  3.32s/it] 26%|██▌       | 26/100 [01:26<04:04,  3.31s/it] 27%|██▋       | 27/100 [01:29<03:57,  3.25s/it] 28%|██▊       | 28/100 [01:33<03:54,  3.26s/it] 29%|██▉       | 29/100 [01:36<03:50,  3.25s/it] 30%|███       | 30/100 [01:39<03:45,  3.22s/it] 31%|███       | 31/100 [01:42<03:42,  3.23s/it] 32%|███▏      | 32/100 [01:46<03:49,  3.38s/it] 33%|███▎      | 33/100 [01:50<03:55,  3.52s/it] 34%|███▍      | 34/100 [01:53<03:50,  3.49s/it] 35%|███▌      | 35/100 [01:57<03:52,  3.58s/it] 36%|███▌      | 36/100 [02:01<03:50,  3.60s/it] 37%|███▋      | 37/100 [02:04<03:41,  3.51s/it] 38%|███▊      | 38/100 [02:07<03:34,  3.46s/it] 39%|███▉      | 39/100 [02:11<03:27,  3.40s/it] 40%|████      | 40/100 [02:14<03:30,  3.50s/it] 41%|████      | 41/100 [02:18<03:24,  3.46s/it] 42%|████▏     | 42/100 [02:21<03:19,  3.44s/it] 43%|████▎     | 43/100 [02:25<03:14,  3.42s/it] 44%|████▍     | 44/100 [02:28<03:06,  3.34s/it] 45%|████▌     | 45/100 [02:31<02:56,  3.20s/it] 46%|████▌     | 46/100 [02:34<02:49,  3.14s/it] 47%|████▋     | 47/100 [02:36<02:43,  3.08s/it] 48%|████▊     | 48/100 [02:39<02:37,  3.03s/it] 49%|████▉     | 49/100 [02:42<02:30,  2.95s/it] 50%|█████     | 50/100 [02:45<02:32,  3.04s/it] 51%|█████     | 51/100 [02:48<02:27,  3.01s/it] 52%|█████▏    | 52/100 [02:52<02:29,  3.12s/it] 53%|█████▎    | 53/100 [02:55<02:29,  3.17s/it] 54%|█████▍    | 54/100 [02:58<02:28,  3.23s/it] 55%|█████▌    | 55/100 [03:02<02:26,  3.25s/it] 56%|█████▌    | 56/100 [03:05<02:18,  3.15s/it] 57%|█████▋    | 57/100 [03:08<02:14,  3.13s/it] 58%|█████▊    | 58/100 [03:11<02:13,  3.19s/it] 59%|█████▉    | 59/100 [03:14<02:12,  3.24s/it] 60%|██████    | 60/100 [03:18<02:08,  3.22s/it] 61%|██████    | 61/100 [03:21<02:09,  3.32s/it] 62%|██████▏   | 62/100 [03:24<02:05,  3.31s/it] 63%|██████▎   | 63/100 [03:28<02:03,  3.33s/it] 64%|██████▍   | 64/100 [03:31<01:58,  3.29s/it] 65%|██████▌   | 65/100 [03:34<01:53,  3.25s/it] 66%|██████▌   | 66/100 [03:37<01:50,  3.24s/it] 67%|██████▋   | 67/100 [03:41<01:46,  3.22s/it] 68%|██████▊   | 68/100 [03:44<01:42,  3.20s/it] 69%|██████▉   | 69/100 [03:47<01:38,  3.18s/it] 70%|███████   | 70/100 [03:50<01:36,  3.21s/it] 71%|███████   | 71/100 [03:53<01:33,  3.23s/it] 72%|███████▏  | 72/100 [03:57<01:30,  3.24s/it] 73%|███████▎  | 73/100 [04:00<01:25,  3.16s/it] 74%|███████▍  | 74/100 [04:03<01:21,  3.13s/it] 75%|███████▌  | 75/100 [04:06<01:18,  3.15s/it] 76%|███████▌  | 76/100 [04:09<01:15,  3.15s/it] 77%|███████▋  | 77/100 [04:12<01:11,  3.10s/it] 78%|███████▊  | 78/100 [04:15<01:07,  3.06s/it] 79%|███████▉  | 79/100 [04:18<01:05,  3.13s/it] 80%|████████  | 80/100 [04:22<01:04,  3.21s/it] 81%|████████  | 81/100 [04:25<01:00,  3.20s/it] 82%|████████▏ | 82/100 [04:28<00:57,  3.19s/it] 83%|████████▎ | 83/100 [04:31<00:55,  3.24s/it] 84%|████████▍ | 84/100 [04:35<00:53,  3.35s/it] 85%|████████▌ | 85/100 [04:38<00:50,  3.37s/it] 86%|████████▌ | 86/100 [04:42<00:46,  3.35s/it] 87%|████████▋ | 87/100 [04:45<00:42,  3.27s/it] 88%|████████▊ | 88/100 [04:48<00:38,  3.21s/it] 89%|████████▉ | 89/100 [04:51<00:36,  3.34s/it] 90%|█████████ | 90/100 [04:55<00:33,  3.34s/it] 91%|█████████ | 91/100 [04:58<00:28,  3.19s/it] 92%|█████████▏| 92/100 [05:01<00:26,  3.26s/it] 93%|█████████▎| 93/100 [05:04<00:23,  3.29s/it] 94%|█████████▍| 94/100 [05:08<00:19,  3.25s/it] 95%|█████████▌| 95/100 [05:11<00:16,  3.26s/it] 96%|█████████▌| 96/100 [05:14<00:12,  3.23s/it] 97%|█████████▋| 97/100 [05:17<00:09,  3.23s/it] 98%|█████████▊| 98/100 [05:21<00:06,  3.26s/it] 99%|█████████▉| 99/100 [05:24<00:03,  3.29s/it]100%|██████████| 100/100 [05:27<00:00,  3.34s/it]100%|██████████| 100/100 [05:27<00:00,  3.28s/it]
[0/100] loss: 2.698545217514038 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.484813690185547 loss_joints: 2.3971898555755615 loss_collision: 0.15283770859241486 loss_jerk: 0.06899002939462662 loss_floor_contact: 0.5509257316589355
[2/100] loss: 1.963256597518921 loss_joints: 1.857539176940918 loss_collision: 0.21750009059906006 loss_jerk: 0.09256947040557861 loss_floor_contact: 0.6082508563995361
[3/100] loss: 1.2482507228851318 loss_joints: 1.1800949573516846 loss_collision: 0.17786850035190582 loss_jerk: 0.09191033989191055 loss_floor_contact: 0.27391308546066284
[4/100] loss: 0.7054537534713745 loss_joints: 0.6648609638214111 loss_collision: 0.13774548470973969 loss_jerk: 0.09880481660366058 loss_floor_contact: 0.021170321851968765
[5/100] loss: 0.33488425612449646 loss_joints: 0.29919278621673584 loss_collision: 0.07829996943473816 loss_jerk: 0.10288188606500626 loss_floor_contact: 0.021410102024674416
[6/100] loss: 0.12905599176883698 loss_joints: 0.09154573082923889 loss_collision: 0.11776655167341232 loss_jerk: 0.09426596015691757 loss_floor_contact: 0.021671155467629433
[7/100] loss: 0.08964761346578598 loss_joints: 0.06439447402954102 loss_collision: 0.014459757134318352 loss_jerk: 0.08650252223014832 loss_floor_contact: 0.021815264597535133
[8/100] loss: 0.10072564333677292 loss_joints: 0.06697963178157806 loss_collision: 0.0441012978553772 loss_jerk: 0.10859626531600952 loss_floor_contact: 0.021868092939257622
[9/100] loss: 0.1079295426607132 loss_joints: 0.06762844324111938 loss_collision: 0.025842657312750816 loss_jerk: 0.142075315117836 loss_floor_contact: 0.021980127319693565
[10/100] loss: 0.10495112091302872 loss_joints: 0.05910671874880791 loss_collision: 0.02165944129228592 loss_jerk: 0.16264241933822632 loss_floor_contact: 0.030178487300872803
[11/100] loss: 0.082058846950531 loss_joints: 0.03233519196510315 loss_collision: 0.046567484736442566 loss_jerk: 0.17117652297019958 loss_floor_contact: 0.022727757692337036
[12/100] loss: 0.06129316985607147 loss_joints: 0.011340100318193436 loss_collision: 0.057048823684453964 loss_jerk: 0.16858315467834473 loss_floor_contact: 0.021023958921432495
[13/100] loss: 0.06086919829249382 loss_joints: 0.007789328694343567 loss_collision: 0.1154046356678009 loss_jerk: 0.15787731111049652 loss_floor_contact: 0.020700769498944283
[14/100] loss: 0.0600428506731987 loss_joints: 0.008271901868283749 loss_collision: 0.1280326396226883 loss_jerk: 0.1477597951889038 loss_floor_contact: 0.020277341827750206
[15/100] loss: 0.0498516745865345 loss_joints: 0.005239642225205898 loss_collision: 0.09518064558506012 loss_jerk: 0.13232596218585968 loss_floor_contact: 0.020124778151512146
[16/100] loss: 0.04068787023425102 loss_joints: 0.003212484996765852 loss_collision: 0.07098972797393799 loss_jerk: 0.1128067597746849 loss_floor_contact: 0.021747255697846413
[17/100] loss: 0.0336420051753521 loss_joints: 0.004347885958850384 loss_collision: 0.04650206118822098 loss_jerk: 0.09035710990428925 loss_floor_contact: 0.02054634317755699
[18/100] loss: 0.03143180534243584 loss_joints: 0.003791623283177614 loss_collision: 0.04011531546711922 loss_jerk: 0.08660634607076645 loss_floor_contact: 0.01977062225341797
[19/100] loss: 0.029409732669591904 loss_joints: 0.0017990369815379381 loss_collision: 0.04573845863342285 loss_jerk: 0.08448584377765656 loss_floor_contact: 0.01915387623012066
[20/100] loss: 0.02858896367251873 loss_joints: 0.0017199944704771042 loss_collision: 0.04373685643076897 loss_jerk: 0.08236197382211685 loss_floor_contact: 0.019047893583774567
[21/100] loss: 0.030649233609437943 loss_joints: 0.003064913209527731 loss_collision: 0.04600028321146965 loss_jerk: 0.08434303849935532 loss_floor_contact: 0.01898532174527645
[22/100] loss: 0.029594041407108307 loss_joints: 0.0022678556852042675 loss_collision: 0.043885111808776855 loss_jerk: 0.08409720659255981 loss_floor_contact: 0.019133714959025383
[23/100] loss: 0.02669665962457657 loss_joints: 0.0011117362882941961 loss_collision: 0.03922092169523239 loss_jerk: 0.07902469485998154 loss_floor_contact: 0.019066570326685905
[24/100] loss: 0.024422792717814445 loss_joints: 0.00025006718351505697 loss_collision: 0.030346717685461044 loss_jerk: 0.07677411288022995 loss_floor_contact: 0.01944524608552456
[25/100] loss: 0.02274320274591446 loss_joints: 0.0003591216809581965 loss_collision: 0.01658863015472889 loss_jerk: 0.07523834705352783 loss_floor_contact: 0.019156312569975853
[26/100] loss: 0.022713657468557358 loss_joints: 0.0002313188015250489 loss_collision: 0.020500602200627327 loss_jerk: 0.073969267308712 loss_floor_contact: 0.019399607554078102
[27/100] loss: 0.02167489193379879 loss_joints: 0.0001999122032430023 loss_collision: 0.015474824234843254 loss_jerk: 0.07155024260282516 loss_floor_contact: 0.020399365574121475
[28/100] loss: 0.02209181897342205 loss_joints: 4.950258880853653e-05 loss_collision: 0.02532043121755123 loss_jerk: 0.07012612372636795 loss_floor_contact: 0.01978742517530918
[29/100] loss: 0.02175978571176529 loss_joints: 0.00017061535618267953 loss_collision: 0.025211811065673828 loss_jerk: 0.06836361438035965 loss_floor_contact: 0.019770869985222816
[30/100] loss: 0.020086608827114105 loss_joints: 0.0003968278178945184 loss_collision: 0.013048265129327774 loss_jerk: 0.06567142903804779 loss_floor_contact: 0.019670957699418068
[31/100] loss: 0.018953699618577957 loss_joints: 7.509288843721151e-05 loss_collision: 0.011575667187571526 loss_jerk: 0.06309481710195541 loss_floor_contact: 0.01947336457669735
[32/100] loss: 0.018652452155947685 loss_joints: 0.0005461953114718199 loss_collision: 0.009351772256195545 loss_jerk: 0.061203476041555405 loss_floor_contact: 0.018702110275626183
[33/100] loss: 0.01799030601978302 loss_joints: 0.00025459681637585163 loss_collision: 0.009822328574955463 loss_jerk: 0.05954104661941528 loss_floor_contact: 0.018682152032852173
[34/100] loss: 0.018509674817323685 loss_joints: 0.00039263369399122894 loss_collision: 0.013688985258340836 loss_jerk: 0.05945153906941414 loss_floor_contact: 0.018852578476071358
[35/100] loss: 0.01825474388897419 loss_joints: 0.0006044974434189498 loss_collision: 0.00961308367550373 loss_jerk: 0.05912238731980324 loss_floor_contact: 0.0190834179520607
[36/100] loss: 0.017568327486515045 loss_joints: 0.0001638229878153652 loss_collision: 0.007887721061706543 loss_jerk: 0.058753643184900284 loss_floor_contact: 0.019273221492767334
[37/100] loss: 0.01767549104988575 loss_joints: 0.0005708400276489556 loss_collision: 0.006462660152465105 loss_jerk: 0.05816300958395004 loss_floor_contact: 0.01917632855474949
[38/100] loss: 0.01743936724960804 loss_joints: 0.0003782178682740778 loss_collision: 0.008005759678781033 loss_jerk: 0.05738857388496399 loss_floor_contact: 0.01913430355489254
[39/100] loss: 0.017515650019049644 loss_joints: 0.000311738986056298 loss_collision: 0.011700534261763096 loss_jerk: 0.056474559009075165 loss_floor_contact: 0.019152184948325157
[40/100] loss: 0.01709749735891819 loss_joints: 0.0003525319916661829 loss_collision: 0.008857942186295986 loss_jerk: 0.05577997863292694 loss_floor_contact: 0.019141757860779762
[41/100] loss: 0.01661951094865799 loss_joints: 0.00010085967369377613 loss_collision: 0.008246324025094509 loss_jerk: 0.055131036788225174 loss_floor_contact: 0.019112594425678253
[42/100] loss: 0.016602305695414543 loss_joints: 0.00012856755347456783 loss_collision: 0.009903824888169765 loss_jerk: 0.05428135395050049 loss_floor_contact: 0.019130166620016098
[43/100] loss: 0.01647351309657097 loss_joints: 0.00035038322675973177 loss_collision: 0.009111765772104263 loss_jerk: 0.05319715291261673 loss_floor_contact: 0.0191266480833292
[44/100] loss: 0.01618531532585621 loss_joints: 0.0002166538906749338 loss_collision: 0.008614442311227322 loss_jerk: 0.05280066654086113 loss_floor_contact: 0.019070513546466827
[45/100] loss: 0.01566743291914463 loss_joints: 7.426277443300933e-05 loss_collision: 0.007639467716217041 loss_jerk: 0.05172830447554588 loss_floor_contact: 0.018971463665366173
[46/100] loss: 0.015627440065145493 loss_joints: 0.0003766353474929929 loss_collision: 0.005128181539475918 loss_jerk: 0.05139182507991791 loss_floor_contact: 0.018900305032730103
[47/100] loss: 0.015377901494503021 loss_joints: 0.00011218406143598258 loss_collision: 0.006758494768291712 loss_jerk: 0.05081653594970703 loss_floor_contact: 0.018857337534427643
[48/100] loss: 0.015546583570539951 loss_joints: 0.0002559106796979904 loss_collision: 0.009692249819636345 loss_jerk: 0.04975176975131035 loss_floor_contact: 0.01883505843579769
[49/100] loss: 0.01557164266705513 loss_joints: 0.0004253003862686455 loss_collision: 0.009028717875480652 loss_jerk: 0.049452200531959534 loss_floor_contact: 0.01880420185625553
[50/100] loss: 0.015219740569591522 loss_joints: 0.00024374706845264882 loss_collision: 0.007965457625687122 loss_jerk: 0.049219485372304916 loss_floor_contact: 0.018745766952633858
[51/100] loss: 0.01517527922987938 loss_joints: 0.0003034660476259887 loss_collision: 0.006596459541469812 loss_jerk: 0.04938282072544098 loss_floor_contact: 0.018664618954062462
[52/100] loss: 0.015002429485321045 loss_joints: 0.0002185347257182002 loss_collision: 0.00644804397597909 loss_jerk: 0.0490962490439415 loss_floor_contact: 0.01865028403699398
[53/100] loss: 0.014648225158452988 loss_joints: 0.00014602411829400808 loss_collision: 0.005686655640602112 loss_jerk: 0.04825889319181442 loss_floor_contact: 0.018688125535845757
[54/100] loss: 0.014608589000999928 loss_joints: 0.0003185643581673503 loss_collision: 0.004449041560292244 loss_jerk: 0.04787954315543175 loss_floor_contact: 0.01875234954059124
[55/100] loss: 0.01451805792748928 loss_joints: 0.00025648606242612004 loss_collision: 0.005039440467953682 loss_jerk: 0.047522783279418945 loss_floor_contact: 0.018769318237900734
[56/100] loss: 0.01413046009838581 loss_joints: 6.288784061325714e-05 loss_collision: 0.005151838064193726 loss_jerk: 0.04671114683151245 loss_floor_contact: 0.018746018409729004
[57/100] loss: 0.014011583290994167 loss_joints: 0.00026438047643750906 loss_collision: 0.005279963370412588 loss_jerk: 0.04539160430431366 loss_floor_contact: 0.018713051453232765
[58/100] loss: 0.013809357769787312 loss_joints: 0.00013647685409523547 loss_collision: 0.005535738542675972 loss_jerk: 0.04500150680541992 loss_floor_contact: 0.018689308315515518
[59/100] loss: 0.013870364986360073 loss_joints: 8.154549868777394e-05 loss_collision: 0.0075180912390351295 loss_jerk: 0.044668231159448624 loss_floor_contact: 0.01869952119886875
[60/100] loss: 0.013968450017273426 loss_joints: 0.00015673227608203888 loss_collision: 0.008005840703845024 loss_jerk: 0.044560085982084274 loss_floor_contact: 0.018711119890213013
[61/100] loss: 0.013447376899421215 loss_joints: 8.605396942584775e-06 loss_collision: 0.0048287478275597095 loss_jerk: 0.04433537274599075 loss_floor_contact: 0.018720537424087524
[62/100] loss: 0.013952839188277721 loss_joints: 0.0001959888031706214 loss_collision: 0.004793989937752485 loss_jerk: 0.04561437666416168 loss_floor_contact: 0.018738577142357826
[63/100] loss: 0.013990771025419235 loss_joints: 0.00016672152560204268 loss_collision: 0.005661058705300093 loss_jerk: 0.04553130269050598 loss_floor_contact: 0.01875118352472782
[64/100] loss: 0.013606113381683826 loss_joints: 2.3852797312429175e-05 loss_collision: 0.005024100188165903 loss_jerk: 0.044816579669713974 loss_floor_contact: 0.018757058307528496
[65/100] loss: 0.013580621220171452 loss_joints: 0.00015116533904802054 loss_collision: 0.004684658721089363 loss_jerk: 0.04433842748403549 loss_floor_contact: 0.018763834610581398
[66/100] loss: 0.013437267392873764 loss_joints: 0.00012174079893156886 loss_collision: 0.003830037312582135 loss_jerk: 0.04423297941684723 loss_floor_contact: 0.01874278299510479
[67/100] loss: 0.013381344266235828 loss_joints: 8.471921319141984e-05 loss_collision: 0.004036817234009504 loss_jerk: 0.04408693313598633 loss_floor_contact: 0.018712107092142105
[68/100] loss: 0.013322862796485424 loss_joints: 4.5110420614946634e-05 loss_collision: 0.00438872491940856 loss_jerk: 0.043886054307222366 loss_floor_contact: 0.01867365837097168
[69/100] loss: 0.013371295295655727 loss_joints: 0.00030538131250068545 loss_collision: 0.0032106025610119104 loss_jerk: 0.04352215677499771 loss_floor_contact: 0.018643153831362724
[70/100] loss: 0.013430964201688766 loss_joints: 0.00033625279320403934 loss_collision: 0.0035805620718747377 loss_jerk: 0.043493762612342834 loss_floor_contact: 0.01863214001059532
[71/100] loss: 0.013504630886018276 loss_joints: 0.00020135007798671722 loss_collision: 0.006680204067379236 loss_jerk: 0.04308735206723213 loss_floor_contact: 0.01863422431051731
[72/100] loss: 0.013312657363712788 loss_joints: 0.00013999114162288606 loss_collision: 0.006439372897148132 loss_jerk: 0.042659319937229156 loss_floor_contact: 0.018638985231518745
[73/100] loss: 0.012924020178616047 loss_joints: 6.124831270426512e-05 loss_collision: 0.004204470198601484 loss_jerk: 0.042310893535614014 loss_floor_contact: 0.01864602230489254
[74/100] loss: 0.012844919227063656 loss_joints: 1.0932408258668147e-05 loss_collision: 0.004431873559951782 loss_jerk: 0.042097099125385284 loss_floor_contact: 0.018665248528122902
[75/100] loss: 0.012912444770336151 loss_joints: 9.238517668563873e-05 loss_collision: 0.004405031446367502 loss_jerk: 0.04204707592725754 loss_floor_contact: 0.018677880987524986
[76/100] loss: 0.012785056605935097 loss_joints: 9.350396430818364e-05 loss_collision: 0.0036312872543931007 loss_jerk: 0.04183780774474144 loss_floor_contact: 0.0186897162348032
[77/100] loss: 0.012638432905077934 loss_joints: 6.539714377140626e-05 loss_collision: 0.002846230985596776 loss_jerk: 0.041678208857774734 loss_floor_contact: 0.018688609823584557
[78/100] loss: 0.012589745223522186 loss_joints: 3.5562952689360827e-06 loss_collision: 0.002735113026574254 loss_jerk: 0.04177466779947281 loss_floor_contact: 0.01869010366499424
[79/100] loss: 0.01260244008153677 loss_joints: 5.005267303204164e-05 loss_collision: 0.003399764420464635 loss_jerk: 0.041374024003744125 loss_floor_contact: 0.018689049407839775
[80/100] loss: 0.012464071623980999 loss_joints: 8.674604760017246e-05 loss_collision: 0.0023576850071549416 loss_jerk: 0.04108792543411255 loss_floor_contact: 0.018695758655667305
[81/100] loss: 0.012558961287140846 loss_joints: 5.169943324290216e-05 loss_collision: 0.003955072723329067 loss_jerk: 0.04096380993723869 loss_floor_contact: 0.018708014860749245
[82/100] loss: 0.012583217583596706 loss_joints: 1.9267383322585374e-05 loss_collision: 0.004777386784553528 loss_jerk: 0.04086019843816757 loss_floor_contact: 0.018711617216467857
[83/100] loss: 0.012439963407814503 loss_joints: 1.8595168285173713e-06 loss_collision: 0.003657336113974452 loss_jerk: 0.040805500000715256 loss_floor_contact: 0.018709953874349594
[84/100] loss: 0.012369554489850998 loss_joints: 1.4227846804715227e-05 loss_collision: 0.0026200248394161463 loss_jerk: 0.04089370742440224 loss_floor_contact: 0.018698977306485176
[85/100] loss: 0.012506355531513691 loss_joints: 1.4972441931604408e-05 loss_collision: 0.004125616513192654 loss_jerk: 0.04083842411637306 loss_floor_contact: 0.018692152574658394
[86/100] loss: 0.012494790367782116 loss_joints: 1.971760138985701e-05 loss_collision: 0.003847741521894932 loss_jerk: 0.0408848375082016 loss_floor_contact: 0.018690887838602066
[87/100] loss: 0.012647603638470173 loss_joints: 3.537699376465753e-05 loss_collision: 0.005674539599567652 loss_jerk: 0.040700871497392654 loss_floor_contact: 0.018695546314120293
[88/100] loss: 0.012653063982725143 loss_joints: 1.745516601658892e-05 loss_collision: 0.0057952734641730785 loss_jerk: 0.04074549674987793 loss_floor_contact: 0.018697069957852364
[89/100] loss: 0.012524964287877083 loss_joints: 8.423176041105762e-07 loss_collision: 0.004614353179931641 loss_jerk: 0.04077380150556564 loss_floor_contact: 0.018692364916205406
[90/100] loss: 0.012354616075754166 loss_joints: 3.480803934508003e-05 loss_collision: 0.002768776612356305 loss_jerk: 0.04069843888282776 loss_floor_contact: 0.018683208152651787
[91/100] loss: 0.012380813248455524 loss_joints: 7.399726018775254e-05 loss_collision: 0.002797701396048069 loss_jerk: 0.04063607007265091 loss_floor_contact: 0.018680283799767494
[92/100] loss: 0.012344091199338436 loss_joints: 7.140071829780936e-05 loss_collision: 0.0027973982505500317 loss_jerk: 0.04049946740269661 loss_floor_contact: 0.018680844455957413
[93/100] loss: 0.012265936471521854 loss_joints: 3.9912811189424247e-05 loss_collision: 0.0026251741219311953 loss_jerk: 0.04038055241107941 loss_floor_contact: 0.01868368126451969
[94/100] loss: 0.012170223519206047 loss_joints: 1.4191207810654305e-05 loss_collision: 0.002128336112946272 loss_jerk: 0.04029763862490654 loss_floor_contact: 0.018687887117266655
[95/100] loss: 0.012267664074897766 loss_joints: 1.2298714864300564e-05 loss_collision: 0.0035096474457532167 loss_jerk: 0.04014186933636665 loss_floor_contact: 0.018689334392547607
[96/100] loss: 0.012255426496267319 loss_joints: 1.729102586978115e-05 loss_collision: 0.003476412734016776 loss_jerk: 0.040086667984724045 loss_floor_contact: 0.018688274547457695
[97/100] loss: 0.012259623035788536 loss_joints: 1.651210550335236e-05 loss_collision: 0.003599319141358137 loss_jerk: 0.04005834832787514 loss_floor_contact: 0.01868591643869877
[98/100] loss: 0.012243688106536865 loss_joints: 1.035326476994669e-05 loss_collision: 0.003379868110641837 loss_jerk: 0.040108051151037216 loss_floor_contact: 0.018683357164263725
[99/100] loss: 0.012172291986644268 loss_joints: 5.2419582061702386e-06 loss_collision: 0.0026969180908054113 loss_jerk: 0.04011689871549606 loss_floor_contact: 0.01868133433163166
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk0.25_skate0.5]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 327.90991                                                    ║
    ║     rollout = 144.00778                                                    ║
    ║     sdf     = 22.76065                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.01217229                                                 ║
    ║     joints    = 0.00000524                                                 ║
    ║     collision = 0.00269692                                                 ║
    ║     jerk      = 0.04011690                                                 ║
    ║     floor     = 0.01868133                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m49.548s
user	4m45.458s
sys	0m18.862s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.25, skate=1.0
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:20,  3.24s/it]  2%|▏         | 2/100 [00:06<05:06,  3.12s/it]  3%|▎         | 3/100 [00:10<05:34,  3.45s/it]  4%|▍         | 4/100 [00:13<05:29,  3.43s/it]  5%|▌         | 5/100 [00:16<05:16,  3.33s/it]  6%|▌         | 6/100 [00:20<05:17,  3.38s/it]  7%|▋         | 7/100 [00:23<05:01,  3.24s/it]  8%|▊         | 8/100 [00:25<04:42,  3.07s/it]  9%|▉         | 9/100 [00:28<04:31,  2.98s/it] 10%|█         | 10/100 [00:31<04:23,  2.93s/it] 11%|█         | 11/100 [00:34<04:27,  3.00s/it] 12%|█▏        | 12/100 [00:37<04:19,  2.95s/it] 13%|█▎        | 13/100 [00:40<04:13,  2.91s/it] 14%|█▍        | 14/100 [00:43<04:07,  2.88s/it] 15%|█▌        | 15/100 [00:46<04:15,  3.01s/it] 16%|█▌        | 16/100 [00:49<04:19,  3.09s/it] 17%|█▋        | 17/100 [00:52<04:19,  3.13s/it] 18%|█▊        | 18/100 [00:55<04:17,  3.14s/it] 19%|█▉        | 19/100 [00:59<04:13,  3.13s/it] 20%|██        | 20/100 [01:02<04:22,  3.28s/it] 21%|██        | 21/100 [01:05<04:18,  3.27s/it] 22%|██▏       | 22/100 [01:08<04:08,  3.18s/it] 23%|██▎       | 23/100 [01:11<04:00,  3.12s/it] 24%|██▍       | 24/100 [01:14<03:52,  3.06s/it] 25%|██▌       | 25/100 [01:18<03:53,  3.11s/it] 26%|██▌       | 26/100 [01:20<03:42,  3.00s/it] 27%|██▋       | 27/100 [01:23<03:32,  2.90s/it] 28%|██▊       | 28/100 [01:26<03:24,  2.85s/it] 29%|██▉       | 29/100 [01:29<03:25,  2.89s/it] 30%|███       | 30/100 [01:31<03:17,  2.83s/it] 31%|███       | 31/100 [01:34<03:13,  2.81s/it] 32%|███▏      | 32/100 [01:37<03:11,  2.82s/it] 33%|███▎      | 33/100 [01:40<03:06,  2.79s/it] 34%|███▍      | 34/100 [01:42<03:01,  2.75s/it] 35%|███▌      | 35/100 [01:45<03:00,  2.78s/it] 36%|███▌      | 36/100 [01:48<02:55,  2.74s/it] 37%|███▋      | 37/100 [01:51<02:55,  2.79s/it] 38%|███▊      | 38/100 [01:54<02:54,  2.81s/it] 39%|███▉      | 39/100 [01:56<02:50,  2.79s/it] 40%|████      | 40/100 [01:59<02:45,  2.75s/it] 41%|████      | 41/100 [02:03<02:57,  3.01s/it] 42%|████▏     | 42/100 [02:05<02:48,  2.90s/it] 43%|████▎     | 43/100 [02:08<02:43,  2.88s/it] 44%|████▍     | 44/100 [02:11<02:47,  3.00s/it] 45%|████▌     | 45/100 [02:14<02:46,  3.02s/it] 46%|████▌     | 46/100 [02:18<02:44,  3.05s/it] 47%|████▋     | 47/100 [02:20<02:38,  2.99s/it] 48%|████▊     | 48/100 [02:23<02:36,  3.01s/it] 49%|████▉     | 49/100 [02:27<02:36,  3.06s/it] 50%|█████     | 50/100 [02:30<02:38,  3.16s/it] 51%|█████     | 51/100 [02:33<02:37,  3.21s/it] 52%|█████▏    | 52/100 [02:37<02:35,  3.25s/it] 53%|█████▎    | 53/100 [02:40<02:33,  3.27s/it] 54%|█████▍    | 54/100 [02:43<02:27,  3.21s/it] 55%|█████▌    | 55/100 [02:46<02:21,  3.14s/it] 56%|█████▌    | 56/100 [02:49<02:18,  3.15s/it] 57%|█████▋    | 57/100 [02:52<02:16,  3.17s/it] 58%|█████▊    | 58/100 [02:55<02:10,  3.10s/it] 59%|█████▉    | 59/100 [02:59<02:09,  3.16s/it] 60%|██████    | 60/100 [03:02<02:08,  3.21s/it] 61%|██████    | 61/100 [03:05<02:03,  3.17s/it] 62%|██████▏   | 62/100 [03:08<01:58,  3.11s/it] 63%|██████▎   | 63/100 [03:11<01:53,  3.07s/it] 64%|██████▍   | 64/100 [03:14<01:51,  3.09s/it] 65%|██████▌   | 65/100 [03:17<01:48,  3.09s/it] 66%|██████▌   | 66/100 [03:20<01:44,  3.08s/it] 67%|██████▋   | 67/100 [03:24<01:42,  3.11s/it] 68%|██████▊   | 68/100 [03:26<01:37,  3.06s/it] 69%|██████▉   | 69/100 [03:30<01:36,  3.12s/it] 70%|███████   | 70/100 [03:33<01:33,  3.13s/it] 71%|███████   | 71/100 [03:36<01:31,  3.17s/it] 72%|███████▏  | 72/100 [03:39<01:29,  3.19s/it] 73%|███████▎  | 73/100 [03:42<01:24,  3.13s/it] 74%|███████▍  | 74/100 [03:45<01:19,  3.07s/it] 75%|███████▌  | 75/100 [03:48<01:15,  3.01s/it] 76%|███████▌  | 76/100 [03:51<01:11,  2.96s/it] 77%|███████▋  | 77/100 [03:54<01:07,  2.93s/it] 78%|███████▊  | 78/100 [03:57<01:03,  2.91s/it] 79%|███████▉  | 79/100 [04:00<01:02,  2.99s/it] 80%|████████  | 80/100 [04:03<01:01,  3.07s/it] 81%|████████  | 81/100 [04:06<00:59,  3.13s/it] 82%|████████▏ | 82/100 [04:10<00:57,  3.17s/it] 83%|████████▎ | 83/100 [04:13<00:53,  3.15s/it] 84%|████████▍ | 84/100 [04:16<00:49,  3.12s/it] 85%|████████▌ | 85/100 [04:19<00:47,  3.15s/it] 86%|████████▌ | 86/100 [04:22<00:44,  3.21s/it] 87%|████████▋ | 87/100 [04:26<00:41,  3.23s/it] 88%|████████▊ | 88/100 [04:29<00:38,  3.17s/it] 89%|████████▉ | 89/100 [04:32<00:35,  3.19s/it] 90%|█████████ | 90/100 [04:35<00:31,  3.14s/it] 91%|█████████ | 91/100 [04:38<00:29,  3.24s/it] 92%|█████████▏| 92/100 [04:42<00:25,  3.20s/it] 93%|█████████▎| 93/100 [04:45<00:22,  3.22s/it] 94%|█████████▍| 94/100 [04:48<00:19,  3.30s/it] 95%|█████████▌| 95/100 [04:52<00:16,  3.33s/it] 96%|█████████▌| 96/100 [04:55<00:12,  3.24s/it] 97%|█████████▋| 97/100 [04:58<00:09,  3.24s/it] 98%|█████████▊| 98/100 [05:01<00:06,  3.30s/it] 99%|█████████▉| 99/100 [05:05<00:03,  3.25s/it]100%|██████████| 100/100 [05:08<00:00,  3.16s/it]100%|██████████| 100/100 [05:08<00:00,  3.08s/it]
[0/100] loss: 2.698545217514038 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.484813690185547 loss_joints: 2.3971898555755615 loss_collision: 0.15283770859241486 loss_jerk: 0.06899002939462662 loss_floor_contact: 0.5509257316589355
[2/100] loss: 1.963256597518921 loss_joints: 1.857539176940918 loss_collision: 0.21750009059906006 loss_jerk: 0.09256947040557861 loss_floor_contact: 0.6082508563995361
[3/100] loss: 1.2482507228851318 loss_joints: 1.1800949573516846 loss_collision: 0.17786850035190582 loss_jerk: 0.09191033989191055 loss_floor_contact: 0.27391308546066284
[4/100] loss: 0.7054537534713745 loss_joints: 0.6648609638214111 loss_collision: 0.13774548470973969 loss_jerk: 0.09880481660366058 loss_floor_contact: 0.021170321851968765
[5/100] loss: 0.33488425612449646 loss_joints: 0.29919278621673584 loss_collision: 0.07829996943473816 loss_jerk: 0.10288188606500626 loss_floor_contact: 0.021410102024674416
[6/100] loss: 0.12905599176883698 loss_joints: 0.09154573082923889 loss_collision: 0.11776655167341232 loss_jerk: 0.09426596015691757 loss_floor_contact: 0.021671155467629433
[7/100] loss: 0.08964761346578598 loss_joints: 0.06439447402954102 loss_collision: 0.014459757134318352 loss_jerk: 0.08650252223014832 loss_floor_contact: 0.021815264597535133
[8/100] loss: 0.10072564333677292 loss_joints: 0.06697963178157806 loss_collision: 0.0441012978553772 loss_jerk: 0.10859626531600952 loss_floor_contact: 0.021868092939257622
[9/100] loss: 0.1079295426607132 loss_joints: 0.06762844324111938 loss_collision: 0.025842657312750816 loss_jerk: 0.142075315117836 loss_floor_contact: 0.021980127319693565
[10/100] loss: 0.10495112091302872 loss_joints: 0.05910671874880791 loss_collision: 0.02165944129228592 loss_jerk: 0.16264241933822632 loss_floor_contact: 0.030178487300872803
[11/100] loss: 0.082058846950531 loss_joints: 0.03233519196510315 loss_collision: 0.046567484736442566 loss_jerk: 0.17117652297019958 loss_floor_contact: 0.022727757692337036
[12/100] loss: 0.06129316985607147 loss_joints: 0.011340100318193436 loss_collision: 0.057048823684453964 loss_jerk: 0.16858315467834473 loss_floor_contact: 0.021023958921432495
[13/100] loss: 0.06086919829249382 loss_joints: 0.007789328694343567 loss_collision: 0.1154046356678009 loss_jerk: 0.15787731111049652 loss_floor_contact: 0.020700769498944283
[14/100] loss: 0.0600428506731987 loss_joints: 0.008271901868283749 loss_collision: 0.1280326396226883 loss_jerk: 0.1477597951889038 loss_floor_contact: 0.020277341827750206
[15/100] loss: 0.0498516745865345 loss_joints: 0.005239642225205898 loss_collision: 0.09518064558506012 loss_jerk: 0.13232596218585968 loss_floor_contact: 0.020124778151512146
[16/100] loss: 0.04068787023425102 loss_joints: 0.003212484996765852 loss_collision: 0.07098972797393799 loss_jerk: 0.1128067597746849 loss_floor_contact: 0.021747255697846413
[17/100] loss: 0.0336420051753521 loss_joints: 0.004347885958850384 loss_collision: 0.04650206118822098 loss_jerk: 0.09035710990428925 loss_floor_contact: 0.02054634317755699
[18/100] loss: 0.03143180534243584 loss_joints: 0.003791623283177614 loss_collision: 0.04011531546711922 loss_jerk: 0.08660634607076645 loss_floor_contact: 0.01977062225341797
[19/100] loss: 0.029409732669591904 loss_joints: 0.0017990369815379381 loss_collision: 0.04573845863342285 loss_jerk: 0.08448584377765656 loss_floor_contact: 0.01915387623012066
[20/100] loss: 0.02858896367251873 loss_joints: 0.0017199944704771042 loss_collision: 0.04373685643076897 loss_jerk: 0.08236197382211685 loss_floor_contact: 0.019047893583774567
[21/100] loss: 0.030649233609437943 loss_joints: 0.003064913209527731 loss_collision: 0.04600028321146965 loss_jerk: 0.08434303849935532 loss_floor_contact: 0.01898532174527645
[22/100] loss: 0.029594041407108307 loss_joints: 0.0022678556852042675 loss_collision: 0.043885111808776855 loss_jerk: 0.08409720659255981 loss_floor_contact: 0.019133714959025383
[23/100] loss: 0.02669665962457657 loss_joints: 0.0011117362882941961 loss_collision: 0.03922092169523239 loss_jerk: 0.07902469485998154 loss_floor_contact: 0.019066570326685905
[24/100] loss: 0.024422792717814445 loss_joints: 0.00025006718351505697 loss_collision: 0.030346717685461044 loss_jerk: 0.07677411288022995 loss_floor_contact: 0.01944524608552456
[25/100] loss: 0.02274320274591446 loss_joints: 0.0003591216809581965 loss_collision: 0.01658863015472889 loss_jerk: 0.07523834705352783 loss_floor_contact: 0.019156312569975853
[26/100] loss: 0.022713657468557358 loss_joints: 0.0002313188015250489 loss_collision: 0.020500602200627327 loss_jerk: 0.073969267308712 loss_floor_contact: 0.019399607554078102
[27/100] loss: 0.02167489193379879 loss_joints: 0.0001999122032430023 loss_collision: 0.015474824234843254 loss_jerk: 0.07155024260282516 loss_floor_contact: 0.020399365574121475
[28/100] loss: 0.02209181897342205 loss_joints: 4.950258880853653e-05 loss_collision: 0.02532043121755123 loss_jerk: 0.07012612372636795 loss_floor_contact: 0.01978742517530918
[29/100] loss: 0.02175978571176529 loss_joints: 0.00017061535618267953 loss_collision: 0.025211811065673828 loss_jerk: 0.06836361438035965 loss_floor_contact: 0.019770869985222816
[30/100] loss: 0.020086608827114105 loss_joints: 0.0003968278178945184 loss_collision: 0.013048265129327774 loss_jerk: 0.06567142903804779 loss_floor_contact: 0.019670957699418068
[31/100] loss: 0.018953699618577957 loss_joints: 7.509288843721151e-05 loss_collision: 0.011575667187571526 loss_jerk: 0.06309481710195541 loss_floor_contact: 0.01947336457669735
[32/100] loss: 0.018652452155947685 loss_joints: 0.0005461953114718199 loss_collision: 0.009351772256195545 loss_jerk: 0.061203476041555405 loss_floor_contact: 0.018702110275626183
[33/100] loss: 0.01799030601978302 loss_joints: 0.00025459681637585163 loss_collision: 0.009822328574955463 loss_jerk: 0.05954104661941528 loss_floor_contact: 0.018682152032852173
[34/100] loss: 0.018509674817323685 loss_joints: 0.00039263369399122894 loss_collision: 0.013688985258340836 loss_jerk: 0.05945153906941414 loss_floor_contact: 0.018852578476071358
[35/100] loss: 0.01825474388897419 loss_joints: 0.0006044974434189498 loss_collision: 0.00961308367550373 loss_jerk: 0.05912238731980324 loss_floor_contact: 0.0190834179520607
[36/100] loss: 0.017568327486515045 loss_joints: 0.0001638229878153652 loss_collision: 0.007887721061706543 loss_jerk: 0.058753643184900284 loss_floor_contact: 0.019273221492767334
[37/100] loss: 0.01767549104988575 loss_joints: 0.0005708400276489556 loss_collision: 0.006462660152465105 loss_jerk: 0.05816300958395004 loss_floor_contact: 0.01917632855474949
[38/100] loss: 0.01743936724960804 loss_joints: 0.0003782178682740778 loss_collision: 0.008005759678781033 loss_jerk: 0.05738857388496399 loss_floor_contact: 0.01913430355489254
[39/100] loss: 0.017515650019049644 loss_joints: 0.000311738986056298 loss_collision: 0.011700534261763096 loss_jerk: 0.056474559009075165 loss_floor_contact: 0.019152184948325157
[40/100] loss: 0.01709749735891819 loss_joints: 0.0003525319916661829 loss_collision: 0.008857942186295986 loss_jerk: 0.05577997863292694 loss_floor_contact: 0.019141757860779762
[41/100] loss: 0.01661951094865799 loss_joints: 0.00010085967369377613 loss_collision: 0.008246324025094509 loss_jerk: 0.055131036788225174 loss_floor_contact: 0.019112594425678253
[42/100] loss: 0.016602305695414543 loss_joints: 0.00012856755347456783 loss_collision: 0.009903824888169765 loss_jerk: 0.05428135395050049 loss_floor_contact: 0.019130166620016098
[43/100] loss: 0.01647351309657097 loss_joints: 0.00035038322675973177 loss_collision: 0.009111765772104263 loss_jerk: 0.05319715291261673 loss_floor_contact: 0.0191266480833292
[44/100] loss: 0.01618531532585621 loss_joints: 0.0002166538906749338 loss_collision: 0.008614442311227322 loss_jerk: 0.05280066654086113 loss_floor_contact: 0.019070513546466827
[45/100] loss: 0.01566743291914463 loss_joints: 7.426277443300933e-05 loss_collision: 0.007639467716217041 loss_jerk: 0.05172830447554588 loss_floor_contact: 0.018971463665366173
[46/100] loss: 0.015627440065145493 loss_joints: 0.0003766353474929929 loss_collision: 0.005128181539475918 loss_jerk: 0.05139182507991791 loss_floor_contact: 0.018900305032730103
[47/100] loss: 0.015377901494503021 loss_joints: 0.00011218406143598258 loss_collision: 0.006758494768291712 loss_jerk: 0.05081653594970703 loss_floor_contact: 0.018857337534427643
[48/100] loss: 0.015546583570539951 loss_joints: 0.0002559106796979904 loss_collision: 0.009692249819636345 loss_jerk: 0.04975176975131035 loss_floor_contact: 0.01883505843579769
[49/100] loss: 0.01557164266705513 loss_joints: 0.0004253003862686455 loss_collision: 0.009028717875480652 loss_jerk: 0.049452200531959534 loss_floor_contact: 0.01880420185625553
[50/100] loss: 0.015219740569591522 loss_joints: 0.00024374706845264882 loss_collision: 0.007965457625687122 loss_jerk: 0.049219485372304916 loss_floor_contact: 0.018745766952633858
[51/100] loss: 0.01517527922987938 loss_joints: 0.0003034660476259887 loss_collision: 0.006596459541469812 loss_jerk: 0.04938282072544098 loss_floor_contact: 0.018664618954062462
[52/100] loss: 0.015002429485321045 loss_joints: 0.0002185347257182002 loss_collision: 0.00644804397597909 loss_jerk: 0.0490962490439415 loss_floor_contact: 0.01865028403699398
[53/100] loss: 0.014648225158452988 loss_joints: 0.00014602411829400808 loss_collision: 0.005686655640602112 loss_jerk: 0.04825889319181442 loss_floor_contact: 0.018688125535845757
[54/100] loss: 0.014608589000999928 loss_joints: 0.0003185643581673503 loss_collision: 0.004449041560292244 loss_jerk: 0.04787954315543175 loss_floor_contact: 0.01875234954059124
[55/100] loss: 0.01451805792748928 loss_joints: 0.00025648606242612004 loss_collision: 0.005039440467953682 loss_jerk: 0.047522783279418945 loss_floor_contact: 0.018769318237900734
[56/100] loss: 0.01413046009838581 loss_joints: 6.288784061325714e-05 loss_collision: 0.005151838064193726 loss_jerk: 0.04671114683151245 loss_floor_contact: 0.018746018409729004
[57/100] loss: 0.014011583290994167 loss_joints: 0.00026438047643750906 loss_collision: 0.005279963370412588 loss_jerk: 0.04539160430431366 loss_floor_contact: 0.018713051453232765
[58/100] loss: 0.013809357769787312 loss_joints: 0.00013647685409523547 loss_collision: 0.005535738542675972 loss_jerk: 0.04500150680541992 loss_floor_contact: 0.018689308315515518
[59/100] loss: 0.013870364986360073 loss_joints: 8.154549868777394e-05 loss_collision: 0.0075180912390351295 loss_jerk: 0.044668231159448624 loss_floor_contact: 0.01869952119886875
[60/100] loss: 0.013968450017273426 loss_joints: 0.00015673227608203888 loss_collision: 0.008005840703845024 loss_jerk: 0.044560085982084274 loss_floor_contact: 0.018711119890213013
[61/100] loss: 0.013447376899421215 loss_joints: 8.605396942584775e-06 loss_collision: 0.0048287478275597095 loss_jerk: 0.04433537274599075 loss_floor_contact: 0.018720537424087524
[62/100] loss: 0.013952839188277721 loss_joints: 0.0001959888031706214 loss_collision: 0.004793989937752485 loss_jerk: 0.04561437666416168 loss_floor_contact: 0.018738577142357826
[63/100] loss: 0.013990771025419235 loss_joints: 0.00016672152560204268 loss_collision: 0.005661058705300093 loss_jerk: 0.04553130269050598 loss_floor_contact: 0.01875118352472782
[64/100] loss: 0.013606113381683826 loss_joints: 2.3852797312429175e-05 loss_collision: 0.005024100188165903 loss_jerk: 0.044816579669713974 loss_floor_contact: 0.018757058307528496
[65/100] loss: 0.013580621220171452 loss_joints: 0.00015116533904802054 loss_collision: 0.004684658721089363 loss_jerk: 0.04433842748403549 loss_floor_contact: 0.018763834610581398
[66/100] loss: 0.013437267392873764 loss_joints: 0.00012174079893156886 loss_collision: 0.003830037312582135 loss_jerk: 0.04423297941684723 loss_floor_contact: 0.01874278299510479
[67/100] loss: 0.013381344266235828 loss_joints: 8.471921319141984e-05 loss_collision: 0.004036817234009504 loss_jerk: 0.04408693313598633 loss_floor_contact: 0.018712107092142105
[68/100] loss: 0.013322862796485424 loss_joints: 4.5110420614946634e-05 loss_collision: 0.00438872491940856 loss_jerk: 0.043886054307222366 loss_floor_contact: 0.01867365837097168
[69/100] loss: 0.013371295295655727 loss_joints: 0.00030538131250068545 loss_collision: 0.0032106025610119104 loss_jerk: 0.04352215677499771 loss_floor_contact: 0.018643153831362724
[70/100] loss: 0.013430964201688766 loss_joints: 0.00033625279320403934 loss_collision: 0.0035805620718747377 loss_jerk: 0.043493762612342834 loss_floor_contact: 0.01863214001059532
[71/100] loss: 0.013504630886018276 loss_joints: 0.00020135007798671722 loss_collision: 0.006680204067379236 loss_jerk: 0.04308735206723213 loss_floor_contact: 0.01863422431051731
[72/100] loss: 0.013312657363712788 loss_joints: 0.00013999114162288606 loss_collision: 0.006439372897148132 loss_jerk: 0.042659319937229156 loss_floor_contact: 0.018638985231518745
[73/100] loss: 0.012924020178616047 loss_joints: 6.124831270426512e-05 loss_collision: 0.004204470198601484 loss_jerk: 0.042310893535614014 loss_floor_contact: 0.01864602230489254
[74/100] loss: 0.012844919227063656 loss_joints: 1.0932408258668147e-05 loss_collision: 0.004431873559951782 loss_jerk: 0.042097099125385284 loss_floor_contact: 0.018665248528122902
[75/100] loss: 0.012912444770336151 loss_joints: 9.238517668563873e-05 loss_collision: 0.004405031446367502 loss_jerk: 0.04204707592725754 loss_floor_contact: 0.018677880987524986
[76/100] loss: 0.012785056605935097 loss_joints: 9.350396430818364e-05 loss_collision: 0.0036312872543931007 loss_jerk: 0.04183780774474144 loss_floor_contact: 0.0186897162348032
[77/100] loss: 0.012638432905077934 loss_joints: 6.539714377140626e-05 loss_collision: 0.002846230985596776 loss_jerk: 0.041678208857774734 loss_floor_contact: 0.018688609823584557
[78/100] loss: 0.012589745223522186 loss_joints: 3.5562952689360827e-06 loss_collision: 0.002735113026574254 loss_jerk: 0.04177466779947281 loss_floor_contact: 0.01869010366499424
[79/100] loss: 0.01260244008153677 loss_joints: 5.005267303204164e-05 loss_collision: 0.003399764420464635 loss_jerk: 0.041374024003744125 loss_floor_contact: 0.018689049407839775
[80/100] loss: 0.012464071623980999 loss_joints: 8.674604760017246e-05 loss_collision: 0.0023576850071549416 loss_jerk: 0.04108792543411255 loss_floor_contact: 0.018695758655667305
[81/100] loss: 0.012558961287140846 loss_joints: 5.169943324290216e-05 loss_collision: 0.003955072723329067 loss_jerk: 0.04096380993723869 loss_floor_contact: 0.018708014860749245
[82/100] loss: 0.012583217583596706 loss_joints: 1.9267383322585374e-05 loss_collision: 0.004777386784553528 loss_jerk: 0.04086019843816757 loss_floor_contact: 0.018711617216467857
[83/100] loss: 0.012439963407814503 loss_joints: 1.8595168285173713e-06 loss_collision: 0.003657336113974452 loss_jerk: 0.040805500000715256 loss_floor_contact: 0.018709953874349594
[84/100] loss: 0.012369554489850998 loss_joints: 1.4227846804715227e-05 loss_collision: 0.0026200248394161463 loss_jerk: 0.04089370742440224 loss_floor_contact: 0.018698977306485176
[85/100] loss: 0.012506355531513691 loss_joints: 1.4972441931604408e-05 loss_collision: 0.004125616513192654 loss_jerk: 0.04083842411637306 loss_floor_contact: 0.018692152574658394
[86/100] loss: 0.012494790367782116 loss_joints: 1.971760138985701e-05 loss_collision: 0.003847741521894932 loss_jerk: 0.0408848375082016 loss_floor_contact: 0.018690887838602066
[87/100] loss: 0.012647603638470173 loss_joints: 3.537699376465753e-05 loss_collision: 0.005674539599567652 loss_jerk: 0.040700871497392654 loss_floor_contact: 0.018695546314120293
[88/100] loss: 0.012653063982725143 loss_joints: 1.745516601658892e-05 loss_collision: 0.0057952734641730785 loss_jerk: 0.04074549674987793 loss_floor_contact: 0.018697069957852364
[89/100] loss: 0.012524964287877083 loss_joints: 8.423176041105762e-07 loss_collision: 0.004614353179931641 loss_jerk: 0.04077380150556564 loss_floor_contact: 0.018692364916205406
[90/100] loss: 0.012354616075754166 loss_joints: 3.480803934508003e-05 loss_collision: 0.002768776612356305 loss_jerk: 0.04069843888282776 loss_floor_contact: 0.018683208152651787
[91/100] loss: 0.012380813248455524 loss_joints: 7.399726018775254e-05 loss_collision: 0.002797701396048069 loss_jerk: 0.04063607007265091 loss_floor_contact: 0.018680283799767494
[92/100] loss: 0.012344091199338436 loss_joints: 7.140071829780936e-05 loss_collision: 0.0027973982505500317 loss_jerk: 0.04049946740269661 loss_floor_contact: 0.018680844455957413
[93/100] loss: 0.012265936471521854 loss_joints: 3.9912811189424247e-05 loss_collision: 0.0026251741219311953 loss_jerk: 0.04038055241107941 loss_floor_contact: 0.01868368126451969
[94/100] loss: 0.012170223519206047 loss_joints: 1.4191207810654305e-05 loss_collision: 0.002128336112946272 loss_jerk: 0.04029763862490654 loss_floor_contact: 0.018687887117266655
[95/100] loss: 0.012267664074897766 loss_joints: 1.2298714864300564e-05 loss_collision: 0.0035096474457532167 loss_jerk: 0.04014186933636665 loss_floor_contact: 0.018689334392547607
[96/100] loss: 0.012255426496267319 loss_joints: 1.729102586978115e-05 loss_collision: 0.003476412734016776 loss_jerk: 0.040086667984724045 loss_floor_contact: 0.018688274547457695
[97/100] loss: 0.012259623035788536 loss_joints: 1.651210550335236e-05 loss_collision: 0.003599319141358137 loss_jerk: 0.04005834832787514 loss_floor_contact: 0.01868591643869877
[98/100] loss: 0.012243688106536865 loss_joints: 1.035326476994669e-05 loss_collision: 0.003379868110641837 loss_jerk: 0.040108051151037216 loss_floor_contact: 0.018683357164263725
[99/100] loss: 0.012172291986644268 loss_joints: 5.2419582061702386e-06 loss_collision: 0.0026969180908054113 loss_jerk: 0.04011689871549606 loss_floor_contact: 0.01868133433163166
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk0.25_skate1.0]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 308.03295                                                    ║
    ║     rollout = 134.81589                                                    ║
    ║     sdf     = 21.38947                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.01217229                                                 ║
    ║     joints    = 0.00000524                                                 ║
    ║     collision = 0.00269692                                                 ║
    ║     jerk      = 0.04011690                                                 ║
    ║     floor     = 0.01868133                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m28.309s
user	4m29.329s
sys	0m16.252s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.5, skate=0.1
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:34,  3.38s/it]  2%|▏         | 2/100 [00:06<05:23,  3.30s/it]  3%|▎         | 3/100 [00:10<05:40,  3.51s/it]  4%|▍         | 4/100 [00:13<05:22,  3.36s/it]  5%|▌         | 5/100 [00:16<05:07,  3.24s/it]  6%|▌         | 6/100 [00:19<05:04,  3.24s/it]  7%|▋         | 7/100 [00:22<04:58,  3.21s/it]  8%|▊         | 8/100 [00:26<04:56,  3.22s/it]  9%|▉         | 9/100 [00:29<04:47,  3.16s/it] 10%|█         | 10/100 [00:32<04:47,  3.19s/it] 11%|█         | 11/100 [00:35<04:38,  3.13s/it] 12%|█▏        | 12/100 [00:38<04:37,  3.16s/it] 13%|█▎        | 13/100 [00:41<04:33,  3.14s/it] 14%|█▍        | 14/100 [00:44<04:28,  3.13s/it] 15%|█▌        | 15/100 [00:48<04:28,  3.15s/it] 16%|█▌        | 16/100 [00:51<04:35,  3.28s/it] 17%|█▋        | 17/100 [00:54<04:25,  3.20s/it] 18%|█▊        | 18/100 [00:57<04:23,  3.21s/it] 19%|█▉        | 19/100 [01:00<04:16,  3.17s/it] 20%|██        | 20/100 [01:04<04:12,  3.16s/it] 21%|██        | 21/100 [01:07<04:10,  3.17s/it] 22%|██▏       | 22/100 [01:10<04:07,  3.17s/it] 23%|██▎       | 23/100 [01:13<04:00,  3.12s/it] 24%|██▍       | 24/100 [01:16<04:00,  3.17s/it] 25%|██▌       | 25/100 [01:19<03:54,  3.12s/it] 26%|██▌       | 26/100 [01:22<03:52,  3.14s/it] 27%|██▋       | 27/100 [01:26<03:52,  3.18s/it] 28%|██▊       | 28/100 [01:29<03:48,  3.17s/it] 29%|██▉       | 29/100 [01:32<03:44,  3.16s/it] 30%|███       | 30/100 [01:35<03:42,  3.18s/it] 31%|███       | 31/100 [01:38<03:37,  3.15s/it] 32%|███▏      | 32/100 [01:42<03:36,  3.18s/it] 33%|███▎      | 33/100 [01:45<03:40,  3.30s/it] 34%|███▍      | 34/100 [01:49<03:41,  3.36s/it] 35%|███▌      | 35/100 [01:52<03:38,  3.37s/it] 36%|███▌      | 36/100 [01:56<03:42,  3.48s/it] 37%|███▋      | 37/100 [01:59<03:42,  3.54s/it] 38%|███▊      | 38/100 [02:03<03:39,  3.54s/it] 39%|███▉      | 39/100 [02:06<03:31,  3.47s/it] 40%|████      | 40/100 [02:10<03:25,  3.42s/it] 41%|████      | 41/100 [02:13<03:17,  3.35s/it] 42%|████▏     | 42/100 [02:16<03:12,  3.32s/it] 43%|████▎     | 43/100 [02:20<03:12,  3.38s/it] 44%|████▍     | 44/100 [02:23<03:12,  3.43s/it] 45%|████▌     | 45/100 [02:27<03:15,  3.56s/it] 46%|████▌     | 46/100 [02:31<03:11,  3.55s/it] 47%|████▋     | 47/100 [02:34<03:10,  3.60s/it] 48%|████▊     | 48/100 [02:38<03:07,  3.62s/it] 49%|████▉     | 49/100 [02:41<03:01,  3.55s/it] 50%|█████     | 50/100 [02:45<02:56,  3.52s/it] 51%|█████     | 51/100 [02:48<02:45,  3.37s/it] 52%|█████▏    | 52/100 [02:51<02:41,  3.36s/it] 53%|█████▎    | 53/100 [02:54<02:33,  3.27s/it] 54%|█████▍    | 54/100 [02:57<02:27,  3.22s/it] 55%|█████▌    | 55/100 [03:01<02:27,  3.28s/it] 56%|█████▌    | 56/100 [03:04<02:21,  3.22s/it] 57%|█████▋    | 57/100 [03:07<02:14,  3.12s/it] 58%|█████▊    | 58/100 [03:10<02:10,  3.10s/it] 59%|█████▉    | 59/100 [03:13<02:09,  3.16s/it] 60%|██████    | 60/100 [03:17<02:11,  3.29s/it] 61%|██████    | 61/100 [03:20<02:12,  3.39s/it] 62%|██████▏   | 62/100 [03:24<02:09,  3.40s/it] 63%|██████▎   | 63/100 [03:27<02:06,  3.41s/it] 64%|██████▍   | 64/100 [03:30<02:00,  3.34s/it] 65%|██████▌   | 65/100 [03:33<01:54,  3.27s/it] 66%|██████▌   | 66/100 [03:36<01:49,  3.22s/it] 67%|██████▋   | 67/100 [03:39<01:44,  3.15s/it] 68%|██████▊   | 68/100 [03:42<01:38,  3.07s/it] 69%|██████▉   | 69/100 [03:45<01:33,  3.00s/it] 70%|███████   | 70/100 [03:48<01:28,  2.94s/it] 71%|███████   | 71/100 [03:51<01:25,  2.94s/it] 72%|███████▏  | 72/100 [03:54<01:22,  2.96s/it] 73%|███████▎  | 73/100 [03:57<01:20,  2.97s/it] 74%|███████▍  | 74/100 [04:00<01:18,  3.01s/it] 75%|███████▌  | 75/100 [04:03<01:15,  3.01s/it] 76%|███████▌  | 76/100 [04:06<01:11,  2.99s/it] 77%|███████▋  | 77/100 [04:09<01:08,  2.99s/it] 78%|███████▊  | 78/100 [04:12<01:05,  3.00s/it] 79%|███████▉  | 79/100 [04:15<01:04,  3.05s/it] 80%|████████  | 80/100 [04:18<01:00,  3.02s/it] 81%|████████  | 81/100 [04:21<00:57,  3.05s/it] 82%|████████▏ | 82/100 [04:24<00:54,  3.03s/it] 83%|████████▎ | 83/100 [04:27<00:51,  3.02s/it] 84%|████████▍ | 84/100 [04:30<00:49,  3.06s/it] 85%|████████▌ | 85/100 [04:33<00:46,  3.07s/it] 86%|████████▌ | 86/100 [04:36<00:42,  3.06s/it] 87%|████████▋ | 87/100 [04:39<00:39,  3.01s/it] 88%|████████▊ | 88/100 [04:42<00:36,  3.03s/it] 89%|████████▉ | 89/100 [04:45<00:33,  3.01s/it] 90%|█████████ | 90/100 [04:49<00:30,  3.06s/it] 91%|█████████ | 91/100 [04:52<00:27,  3.11s/it] 92%|█████████▏| 92/100 [04:55<00:24,  3.11s/it] 93%|█████████▎| 93/100 [04:58<00:21,  3.07s/it] 94%|█████████▍| 94/100 [05:01<00:18,  3.02s/it] 95%|█████████▌| 95/100 [05:04<00:15,  3.07s/it] 96%|█████████▌| 96/100 [05:07<00:12,  3.00s/it] 97%|█████████▋| 97/100 [05:10<00:08,  2.97s/it] 98%|█████████▊| 98/100 [05:13<00:06,  3.03s/it] 99%|█████████▉| 99/100 [05:16<00:03,  3.00s/it]100%|██████████| 100/100 [05:19<00:00,  3.03s/it]100%|██████████| 100/100 [05:19<00:00,  3.19s/it]
[0/100] loss: 2.712847948074341 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.501634359359741 loss_joints: 2.3966832160949707 loss_collision: 0.15332184731960297 loss_jerk: 0.069520004093647 loss_floor_contact: 0.5485888719558716
[2/100] loss: 1.9135717153549194 loss_joints: 1.796841025352478 loss_collision: 0.18657764792442322 loss_jerk: 0.08514098078012466 loss_floor_contact: 0.5550239682197571
[3/100] loss: 1.1843602657318115 loss_joints: 1.1071622371673584 loss_collision: 0.1306166648864746 loss_jerk: 0.08936107903718948 loss_floor_contact: 0.19455750286579132
[4/100] loss: 0.6931837797164917 loss_joints: 0.6299512386322021 loss_collision: 0.12019208073616028 loss_jerk: 0.09816835820674896 loss_floor_contact: 0.02129160426557064
[5/100] loss: 0.3237261176109314 loss_joints: 0.2644934356212616 loss_collision: 0.06515946239233017 loss_jerk: 0.10112185031175613 loss_floor_contact: 0.021558202803134918
[6/100] loss: 0.11234434694051743 loss_joints: 0.05551847070455551 loss_collision: 0.07718644291162491 loss_jerk: 0.09384264051914215 loss_floor_contact: 0.02185913547873497
[7/100] loss: 0.12539908289909363 loss_joints: 0.07611670345067978 loss_collision: 0.03853427246212959 loss_jerk: 0.08638507127761841 loss_floor_contact: 0.022364109754562378
[8/100] loss: 0.1766097992658615 loss_joints: 0.10344469547271729 loss_collision: 0.21311010420322418 loss_jerk: 0.09924741834402084 loss_floor_contact: 0.022303814068436623
[9/100] loss: 0.14443646371364594 loss_joints: 0.08160726726055145 loss_collision: 0.07305873185396194 loss_jerk: 0.10662488639354706 loss_floor_contact: 0.022108713164925575
[10/100] loss: 0.11846193671226501 loss_joints: 0.060360413044691086 loss_collision: 0.030047595500946045 loss_jerk: 0.10584868490695953 loss_floor_contact: 0.02172418124973774
[11/100] loss: 0.09259466081857681 loss_joints: 0.037169598042964935 loss_collision: 0.02609161101281643 loss_jerk: 0.10141414403915405 loss_floor_contact: 0.02108832821249962
[12/100] loss: 0.06316912919282913 loss_joints: 0.009690549224615097 loss_collision: 0.061177849769592285 loss_jerk: 0.09063971787691116 loss_floor_contact: 0.02040938474237919
[13/100] loss: 0.05533492565155029 loss_joints: 0.009379456751048565 loss_collision: 0.04920843243598938 loss_jerk: 0.0780952200293541 loss_floor_contact: 0.019870178773999214
[14/100] loss: 0.060546908527612686 loss_joints: 0.01824050210416317 loss_collision: 0.03979085013270378 loss_jerk: 0.07272233814001083 loss_floor_contact: 0.019661515951156616
[15/100] loss: 0.05723656713962555 loss_joints: 0.01569497212767601 loss_collision: 0.04391620680689812 loss_jerk: 0.07038898020982742 loss_floor_contact: 0.019554831087589264
[16/100] loss: 0.04821115732192993 loss_joints: 0.006937574129551649 loss_collision: 0.04642639309167862 loss_jerk: 0.06935436278581619 loss_floor_contact: 0.01953762397170067
[17/100] loss: 0.0478031225502491 loss_joints: 0.006168306805193424 loss_collision: 0.05259932950139046 loss_jerk: 0.06882995367050171 loss_floor_contact: 0.01959904469549656
[18/100] loss: 0.04882287606596947 loss_joints: 0.007941016927361488 loss_collision: 0.054079826921224594 loss_jerk: 0.06699655950069427 loss_floor_contact: 0.01975596882402897
[19/100] loss: 0.0449800007045269 loss_joints: 0.006056654267013073 loss_collision: 0.041064608842134476 loss_jerk: 0.06565720587968826 loss_floor_contact: 0.019882788881659508
[20/100] loss: 0.043457772582769394 loss_joints: 0.004756419453769922 loss_collision: 0.03882252424955368 loss_jerk: 0.06565302610397339 loss_floor_contact: 0.01992587000131607
[21/100] loss: 0.04019564390182495 loss_joints: 0.002352614887058735 loss_collision: 0.04000736400485039 loss_jerk: 0.06369781494140625 loss_floor_contact: 0.01993383653461933
[22/100] loss: 0.04020954295992851 loss_joints: 0.002466193400323391 loss_collision: 0.05675720050930977 loss_jerk: 0.0601467564702034 loss_floor_contact: 0.019942522048950195
[23/100] loss: 0.042338237166404724 loss_joints: 0.003324388060718775 loss_collision: 0.0716404989361763 loss_jerk: 0.05970928817987442 loss_floor_contact: 0.019951526075601578
[24/100] loss: 0.039308592677116394 loss_joints: 0.003007554914802313 loss_collision: 0.04771555960178375 loss_jerk: 0.058992478996515274 loss_floor_contact: 0.020332396030426025
[25/100] loss: 0.039148423820734024 loss_joints: 0.004035160411149263 loss_collision: 0.03818473592400551 loss_jerk: 0.058358415961265564 loss_floor_contact: 0.02115579880774021
[26/100] loss: 0.03719264268875122 loss_joints: 0.0023695139680057764 loss_collision: 0.037639059126377106 loss_jerk: 0.05779581889510155 loss_floor_contact: 0.021613135933876038
[27/100] loss: 0.03539542853832245 loss_joints: 0.0009626861428841949 loss_collision: 0.04386812448501587 loss_jerk: 0.055713340640068054 loss_floor_contact: 0.021892601624131203
[28/100] loss: 0.03677508607506752 loss_joints: 0.002177181886509061 loss_collision: 0.04765619337558746 loss_jerk: 0.05529441684484482 loss_floor_contact: 0.02185077592730522
[29/100] loss: 0.034991078078746796 loss_joints: 0.0015605331864207983 loss_collision: 0.0379057414829731 loss_jerk: 0.05490539222955704 loss_floor_contact: 0.0218727458268404
[30/100] loss: 0.032764971256256104 loss_joints: 0.002385374391451478 loss_collision: 0.015085269697010517 loss_jerk: 0.053714606910943985 loss_floor_contact: 0.02013765648007393
[31/100] loss: 0.0327744297683239 loss_joints: 0.002422609832137823 loss_collision: 0.015902012586593628 loss_jerk: 0.053394615650177 loss_floor_contact: 0.020643090829253197
[32/100] loss: 0.030806515365839005 loss_joints: 0.00033518997952342033 loss_collision: 0.017295340076088905 loss_jerk: 0.05316924303770065 loss_floor_contact: 0.021571697667241096
[33/100] loss: 0.03227446228265762 loss_joints: 0.001485471031628549 loss_collision: 0.02045229636132717 loss_jerk: 0.05326361954212189 loss_floor_contact: 0.021119512617588043
[34/100] loss: 0.03283102065324783 loss_joints: 0.0020034092012792826 loss_collision: 0.021041283383965492 loss_jerk: 0.05330508202314377 loss_floor_contact: 0.02070942521095276
[35/100] loss: 0.0309990793466568 loss_joints: 0.0003326424630358815 loss_collision: 0.02522888034582138 loss_jerk: 0.052281878888607025 loss_floor_contact: 0.020026106387376785
[36/100] loss: 0.03200796991586685 loss_joints: 0.0010798647999763489 loss_collision: 0.03356572240591049 loss_jerk: 0.05113775655627251 loss_floor_contact: 0.02002652920782566
[37/100] loss: 0.03285079449415207 loss_joints: 0.0018421508138999343 loss_collision: 0.03349866345524788 loss_jerk: 0.05131174623966217 loss_floor_contact: 0.02002902515232563
[38/100] loss: 0.030970031395554543 loss_joints: 0.0006776112131774426 loss_collision: 0.026025991886854172 loss_jerk: 0.05148680508136749 loss_floor_contact: 0.01946418173611164
[39/100] loss: 0.030981652438640594 loss_joints: 0.0015983842313289642 loss_collision: 0.015494533814489841 loss_jerk: 0.051777198910713196 loss_floor_contact: 0.019452158361673355
[40/100] loss: 0.03175932168960571 loss_joints: 0.002101853024214506 loss_collision: 0.01341448538005352 loss_jerk: 0.052675798535346985 loss_floor_contact: 0.019781209528446198
[41/100] loss: 0.030446812510490417 loss_joints: 0.0005920623661950231 loss_collision: 0.014766115695238113 loss_jerk: 0.05272824689745903 loss_floor_contact: 0.020140143111348152
[42/100] loss: 0.030050521716475487 loss_joints: 0.0005342338117770851 loss_collision: 0.01695474423468113 loss_jerk: 0.051559485495090485 loss_floor_contact: 0.020410696044564247
[43/100] loss: 0.030542150139808655 loss_joints: 0.0011214736150577664 loss_collision: 0.01603705808520317 loss_jerk: 0.05142569541931152 loss_floor_contact: 0.02104121260344982
[44/100] loss: 0.029466405510902405 loss_joints: 0.0003358703979756683 loss_collision: 0.014383071102201939 loss_jerk: 0.05134573578834534 loss_floor_contact: 0.02019360102713108
[45/100] loss: 0.029574079439044 loss_joints: 0.0005843756953254342 loss_collision: 0.014161563478410244 loss_jerk: 0.051237352192401886 loss_floor_contact: 0.019548704847693443
[46/100] loss: 0.02997390553355217 loss_joints: 0.001226657535880804 loss_collision: 0.015463166870176792 loss_jerk: 0.05049648508429527 loss_floor_contact: 0.01952688954770565
[47/100] loss: 0.02862679213285446 loss_joints: 0.0003294050111435354 loss_collision: 0.014168436639010906 loss_jerk: 0.04985116422176361 loss_floor_contact: 0.01954960823059082
[48/100] loss: 0.028333768248558044 loss_joints: 0.0005501058185473084 loss_collision: 0.013842170126736164 loss_jerk: 0.048876676708459854 loss_floor_contact: 0.019611071795225143
[49/100] loss: 0.028786443173885345 loss_joints: 0.0010945232352241874 loss_collision: 0.016209669411182404 loss_jerk: 0.04821975901722908 loss_floor_contact: 0.019610727205872536
[50/100] loss: 0.02793736383318901 loss_joints: 0.0003751405165530741 loss_collision: 0.01640007644891739 loss_jerk: 0.04792652279138565 loss_floor_contact: 0.019589560106396675
[51/100] loss: 0.027345312759280205 loss_joints: 0.0002594532270450145 loss_collision: 0.012482232414186 loss_jerk: 0.047767847776412964 loss_floor_contact: 0.019537121057510376
[52/100] loss: 0.027505984529852867 loss_joints: 0.0007240119157359004 loss_collision: 0.012373462319374084 loss_jerk: 0.04719363525509834 loss_floor_contact: 0.019478091970086098
[53/100] loss: 0.027013929560780525 loss_joints: 0.00033431604970246553 loss_collision: 0.01127621904015541 loss_jerk: 0.047211650758981705 loss_floor_contact: 0.019461657851934433
[54/100] loss: 0.02675599232316017 loss_joints: 8.163128222804517e-05 loss_collision: 0.014396784827113152 loss_jerk: 0.04657294973731041 loss_floor_contact: 0.019482066854834557
[55/100] loss: 0.027238931506872177 loss_joints: 0.00022399243607651442 loss_collision: 0.01718139462172985 loss_jerk: 0.04670175164937973 loss_floor_contact: 0.01945924200117588
[56/100] loss: 0.026924360543489456 loss_joints: 1.220158810610883e-05 loss_collision: 0.017457138746976852 loss_jerk: 0.046447571367025375 loss_floor_contact: 0.01942659355700016
[57/100] loss: 0.027008701115846634 loss_joints: 0.0005033863708376884 loss_collision: 0.014580491930246353 loss_jerk: 0.04621003940701485 loss_floor_contact: 0.019422445446252823
[58/100] loss: 0.027142489328980446 loss_joints: 0.0007148485165089369 loss_collision: 0.015247706323862076 loss_jerk: 0.04591582342982292 loss_floor_contact: 0.019449586048722267
[59/100] loss: 0.026557086035609245 loss_joints: 0.00036388516309671104 loss_collision: 0.012446178123354912 loss_jerk: 0.045988358557224274 loss_floor_contact: 0.019544050097465515
[60/100] loss: 0.02650492452085018 loss_joints: 0.00010447016393300146 loss_collision: 0.015154163353145123 loss_jerk: 0.045700158923864365 loss_floor_contact: 0.02034957893192768
[61/100] loss: 0.026494650170207024 loss_joints: 0.0001710228098090738 loss_collision: 0.016655156388878822 loss_jerk: 0.045297324657440186 loss_floor_contact: 0.020094500854611397
[62/100] loss: 0.026021946221590042 loss_joints: 0.00017215614207088947 loss_collision: 0.014532212167978287 loss_jerk: 0.04480641335248947 loss_floor_contact: 0.019933616742491722
[63/100] loss: 0.025393467396497726 loss_joints: 1.4964914953452535e-05 loss_collision: 0.012879475951194763 loss_jerk: 0.044212911278009415 loss_floor_contact: 0.019840983673930168
[64/100] loss: 0.025403523817658424 loss_joints: 0.00015557858569081873 loss_collision: 0.012906581163406372 loss_jerk: 0.044032271951436996 loss_floor_contact: 0.019411524757742882
[65/100] loss: 0.025340808555483818 loss_joints: 0.00017728724924381822 loss_collision: 0.015188018791377544 loss_jerk: 0.04340996965765953 loss_floor_contact: 0.019397342577576637
[66/100] loss: 0.02516353316605091 loss_joints: 1.9657307348097675e-05 loss_collision: 0.013505620881915092 loss_jerk: 0.0437152162194252 loss_floor_contact: 0.019357049837708473
[67/100] loss: 0.024860693141818047 loss_joints: 0.00015786010771989822 loss_collision: 0.011611118912696838 loss_jerk: 0.04321964457631111 loss_floor_contact: 0.01931898482143879
[68/100] loss: 0.024773404002189636 loss_joints: 0.0002899603277910501 loss_collision: 0.009732590988278389 loss_jerk: 0.04315773397684097 loss_floor_contact: 0.019313164055347443
[69/100] loss: 0.024575700983405113 loss_joints: 7.372428808594123e-05 loss_collision: 0.009897851385176182 loss_jerk: 0.043156810104846954 loss_floor_contact: 0.019337870180606842
[70/100] loss: 0.0250175092369318 loss_joints: 0.0001829260727390647 loss_collision: 0.011636348441243172 loss_jerk: 0.04336363449692726 loss_floor_contact: 0.019891314208507538
[71/100] loss: 0.025133760645985603 loss_joints: 0.0002758761984296143 loss_collision: 0.012956563383340836 loss_jerk: 0.043118543922901154 loss_floor_contact: 0.02002955600619316
[72/100] loss: 0.024868587031960487 loss_joints: 5.550164496526122e-05 loss_collision: 0.012670840136706829 loss_jerk: 0.043215423822402954 loss_floor_contact: 0.019382892176508904
[73/100] loss: 0.024438362568616867 loss_joints: 0.00011169243953190744 loss_collision: 0.009816218167543411 loss_jerk: 0.042826879769563675 loss_floor_contact: 0.01931608095765114
[74/100] loss: 0.024482984095811844 loss_joints: 0.00022422464098781347 loss_collision: 0.009339559823274612 loss_jerk: 0.042792290449142456 loss_floor_contact: 0.01928657293319702
[75/100] loss: 0.024274881929159164 loss_joints: 0.00010158571967622265 loss_collision: 0.008924784138798714 loss_jerk: 0.042704977095127106 loss_floor_contact: 0.019283294677734375
[76/100] loss: 0.024055534973740578 loss_joints: 6.132869748398662e-05 loss_collision: 0.009320790879428387 loss_jerk: 0.042265187948942184 loss_floor_contact: 0.019295331090688705
[77/100] loss: 0.02412680722773075 loss_joints: 0.00011616462143138051 loss_collision: 0.009826366789638996 loss_jerk: 0.04219549894332886 loss_floor_contact: 0.019302573055028915
[78/100] loss: 0.023833421990275383 loss_joints: 6.693641626043245e-05 loss_collision: 0.008068730123341084 loss_jerk: 0.042060691863298416 loss_floor_contact: 0.019292661920189857
[79/100] loss: 0.02384084276854992 loss_joints: 3.673741957754828e-05 loss_collision: 0.008750570937991142 loss_jerk: 0.04199982061982155 loss_floor_contact: 0.01929137483239174
[80/100] loss: 0.023781096562743187 loss_joints: 7.622614793945104e-05 loss_collision: 0.008860332891345024 loss_jerk: 0.04177911579608917 loss_floor_contact: 0.01929279789328575
[81/100] loss: 0.023723823949694633 loss_joints: 2.0660756490542553e-05 loss_collision: 0.009192400611937046 loss_jerk: 0.04170835763216019 loss_floor_contact: 0.019297445192933083
[82/100] loss: 0.023715028539299965 loss_joints: 1.4209787877916824e-05 loss_collision: 0.00980954896658659 loss_jerk: 0.04158075526356697 loss_floor_contact: 0.019294865429401398
[83/100] loss: 0.023638281971216202 loss_joints: 2.7756683266488835e-05 loss_collision: 0.008964753709733486 loss_jerk: 0.04157210886478424 loss_floor_contact: 0.01927996054291725
[84/100] loss: 0.023704849183559418 loss_joints: 3.355134685989469e-05 loss_collision: 0.009491865523159504 loss_jerk: 0.041590820997953415 loss_floor_contact: 0.01926700584590435
[85/100] loss: 0.02392498217523098 loss_joints: 5.814184987684712e-05 loss_collision: 0.011408163234591484 loss_jerk: 0.041603587567806244 loss_floor_contact: 0.019242294132709503
[86/100] loss: 0.023927653208374977 loss_joints: 7.261997961904854e-05 loss_collision: 0.01225606631487608 loss_jerk: 0.04141424223780632 loss_floor_contact: 0.019223058596253395
[87/100] loss: 0.02366117388010025 loss_joints: 9.079744631890208e-05 loss_collision: 0.010761318728327751 loss_jerk: 0.041144419461488724 loss_floor_contact: 0.01922035589814186
[88/100] loss: 0.02361755073070526 loss_joints: 6.213418237166479e-05 loss_collision: 0.010304881259799004 loss_jerk: 0.04120519384741783 loss_floor_contact: 0.01922331564128399
[89/100] loss: 0.023536279797554016 loss_joints: 2.2674114006804302e-05 loss_collision: 0.009736250154674053 loss_jerk: 0.04123622924089432 loss_floor_contact: 0.01921866275370121
[90/100] loss: 0.02349688671529293 loss_joints: 1.171425810753135e-05 loss_collision: 0.009986700490117073 loss_jerk: 0.041127923876047134 loss_floor_contact: 0.01922539621591568
[91/100] loss: 0.023390522226691246 loss_joints: 3.838445263681933e-05 loss_collision: 0.00922354031354189 loss_jerk: 0.04098773002624512 loss_floor_contact: 0.019359178841114044
[92/100] loss: 0.02338152751326561 loss_joints: 3.502442632452585e-05 loss_collision: 0.009209005162119865 loss_jerk: 0.04098821058869362 loss_floor_contact: 0.019314972683787346
[93/100] loss: 0.023264838382601738 loss_joints: 1.0978477803291753e-05 loss_collision: 0.008726242929697037 loss_jerk: 0.0409172922372818 loss_floor_contact: 0.019225891679525375
[94/100] loss: 0.023320265114307404 loss_joints: 1.68375163411838e-06 loss_collision: 0.00961664505302906 loss_jerk: 0.040869515389204025 loss_floor_contact: 0.0192215908318758
[95/100] loss: 0.023251498118042946 loss_joints: 5.629617589875124e-07 loss_collision: 0.009424049407243729 loss_jerk: 0.0407734178006649 loss_floor_contact: 0.019218219444155693
[96/100] loss: 0.023211492225527763 loss_joints: 3.3094447644543834e-06 loss_collision: 0.009603796526789665 loss_jerk: 0.040652550756931305 loss_floor_contact: 0.019215265288949013
[97/100] loss: 0.023124005645513535 loss_joints: 3.3910177990037482e-06 loss_collision: 0.009227234870195389 loss_jerk: 0.04055234044790268 loss_floor_contact: 0.019217200577259064
[98/100] loss: 0.023172352463006973 loss_joints: 6.333085821097484e-06 loss_collision: 0.009966173209249973 loss_jerk: 0.04049573838710785 loss_floor_contact: 0.019215324893593788
[99/100] loss: 0.023133302107453346 loss_joints: 5.787501322629396e-06 loss_collision: 0.009763267822563648 loss_jerk: 0.04045912250876427 loss_floor_contact: 0.01921626552939415
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk0.5_skate0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 319.42649                                                    ║
    ║     rollout = 141.70342                                                    ║
    ║     sdf     = 20.73732                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.02313330                                                 ║
    ║     joints    = 0.00000579                                                 ║
    ║     collision = 0.00976327                                                 ║
    ║     jerk      = 0.04045912                                                 ║
    ║     floor     = 0.01921627                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m40.703s
user	4m46.538s
sys	0m16.132s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.5, skate=0.25
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<04:58,  3.01s/it]  2%|▏         | 2/100 [00:05<04:46,  2.92s/it]  3%|▎         | 3/100 [00:09<05:12,  3.22s/it]  4%|▍         | 4/100 [00:12<04:56,  3.09s/it]  5%|▌         | 5/100 [00:15<04:46,  3.02s/it]  6%|▌         | 6/100 [00:18<04:41,  3.00s/it]  7%|▋         | 7/100 [00:21<04:33,  2.94s/it]  8%|▊         | 8/100 [00:23<04:26,  2.90s/it]  9%|▉         | 9/100 [00:26<04:22,  2.89s/it] 10%|█         | 10/100 [00:29<04:18,  2.87s/it] 11%|█         | 11/100 [00:32<04:13,  2.85s/it] 12%|█▏        | 12/100 [00:35<04:10,  2.85s/it] 13%|█▎        | 13/100 [00:38<04:08,  2.86s/it] 14%|█▍        | 14/100 [00:40<04:05,  2.85s/it] 15%|█▌        | 15/100 [00:43<04:04,  2.88s/it] 16%|█▌        | 16/100 [00:46<04:00,  2.87s/it] 17%|█▋        | 17/100 [00:49<03:56,  2.85s/it] 18%|█▊        | 18/100 [00:52<03:52,  2.84s/it] 19%|█▉        | 19/100 [00:55<03:50,  2.84s/it] 20%|██        | 20/100 [00:58<03:58,  2.98s/it] 21%|██        | 21/100 [01:01<03:57,  3.01s/it] 22%|██▏       | 22/100 [01:04<03:56,  3.03s/it] 23%|██▎       | 23/100 [01:07<03:52,  3.02s/it] 24%|██▍       | 24/100 [01:10<03:50,  3.04s/it] 25%|██▌       | 25/100 [01:13<03:47,  3.03s/it] 26%|██▌       | 26/100 [01:16<03:44,  3.03s/it] 27%|██▋       | 27/100 [01:19<03:41,  3.04s/it] 28%|██▊       | 28/100 [01:22<03:36,  3.00s/it] 29%|██▉       | 29/100 [01:25<03:35,  3.03s/it] 30%|███       | 30/100 [01:28<03:34,  3.07s/it] 31%|███       | 31/100 [01:31<03:28,  3.01s/it] 32%|███▏      | 32/100 [01:34<03:21,  2.97s/it] 33%|███▎      | 33/100 [01:37<03:21,  3.01s/it] 34%|███▍      | 34/100 [01:40<03:18,  3.00s/it] 35%|███▌      | 35/100 [01:43<03:13,  2.97s/it] 36%|███▌      | 36/100 [01:46<03:08,  2.95s/it] 37%|███▋      | 37/100 [01:49<03:12,  3.06s/it] 38%|███▊      | 38/100 [01:52<03:08,  3.04s/it] 39%|███▉      | 39/100 [01:56<03:08,  3.10s/it] 40%|████      | 40/100 [01:59<03:02,  3.05s/it] 41%|████      | 41/100 [02:02<03:01,  3.07s/it] 42%|████▏     | 42/100 [02:05<02:54,  3.01s/it] 43%|████▎     | 43/100 [02:08<02:51,  3.01s/it] 44%|████▍     | 44/100 [02:11<02:50,  3.04s/it] 45%|████▌     | 45/100 [02:14<02:48,  3.06s/it] 46%|████▌     | 46/100 [02:17<02:44,  3.04s/it] 47%|████▋     | 47/100 [02:20<02:42,  3.07s/it] 48%|████▊     | 48/100 [02:23<02:39,  3.07s/it] 49%|████▉     | 49/100 [02:26<02:31,  2.97s/it] 50%|█████     | 50/100 [02:28<02:25,  2.91s/it] 51%|█████     | 51/100 [02:31<02:21,  2.88s/it] 52%|█████▏    | 52/100 [02:34<02:16,  2.85s/it] 53%|█████▎    | 53/100 [02:37<02:12,  2.83s/it] 54%|█████▍    | 54/100 [02:40<02:10,  2.83s/it] 55%|█████▌    | 55/100 [02:42<02:06,  2.82s/it] 56%|█████▌    | 56/100 [02:45<02:02,  2.78s/it] 57%|█████▋    | 57/100 [02:48<01:59,  2.77s/it] 58%|█████▊    | 58/100 [02:51<01:55,  2.74s/it] 59%|█████▉    | 59/100 [02:54<01:56,  2.85s/it] 60%|██████    | 60/100 [02:57<01:53,  2.84s/it] 61%|██████    | 61/100 [02:59<01:50,  2.82s/it] 62%|██████▏   | 62/100 [03:02<01:46,  2.80s/it] 63%|██████▎   | 63/100 [03:05<01:43,  2.81s/it] 64%|██████▍   | 64/100 [03:08<01:40,  2.79s/it] 65%|██████▌   | 65/100 [03:10<01:37,  2.78s/it] 66%|██████▌   | 66/100 [03:13<01:34,  2.77s/it] 67%|██████▋   | 67/100 [03:16<01:30,  2.76s/it] 68%|██████▊   | 68/100 [03:19<01:28,  2.78s/it] 69%|██████▉   | 69/100 [03:21<01:25,  2.76s/it] 70%|███████   | 70/100 [03:24<01:23,  2.77s/it] 71%|███████   | 71/100 [03:27<01:21,  2.81s/it] 72%|███████▏  | 72/100 [03:30<01:21,  2.89s/it] 73%|███████▎  | 73/100 [03:33<01:16,  2.85s/it] 74%|███████▍  | 74/100 [03:36<01:12,  2.81s/it] 75%|███████▌  | 75/100 [03:38<01:10,  2.81s/it] 76%|███████▌  | 76/100 [03:41<01:07,  2.80s/it] 77%|███████▋  | 77/100 [03:44<01:04,  2.81s/it] 78%|███████▊  | 78/100 [03:47<01:01,  2.78s/it] 79%|███████▉  | 79/100 [03:50<00:58,  2.77s/it] 80%|████████  | 80/100 [03:52<00:56,  2.82s/it] 81%|████████  | 81/100 [03:55<00:53,  2.81s/it] 82%|████████▏ | 82/100 [03:58<00:50,  2.81s/it] 83%|████████▎ | 83/100 [04:01<00:47,  2.78s/it] 84%|████████▍ | 84/100 [04:04<00:45,  2.82s/it] 85%|████████▌ | 85/100 [04:06<00:42,  2.81s/it] 86%|████████▌ | 86/100 [04:09<00:39,  2.79s/it] 87%|████████▋ | 87/100 [04:12<00:36,  2.77s/it] 88%|████████▊ | 88/100 [04:15<00:34,  2.89s/it] 89%|████████▉ | 89/100 [04:18<00:31,  2.91s/it] 90%|█████████ | 90/100 [04:21<00:28,  2.88s/it] 91%|█████████ | 91/100 [04:24<00:25,  2.84s/it] 92%|█████████▏| 92/100 [04:26<00:22,  2.83s/it] 93%|█████████▎| 93/100 [04:29<00:19,  2.85s/it] 94%|█████████▍| 94/100 [04:32<00:17,  2.90s/it] 95%|█████████▌| 95/100 [04:35<00:14,  2.86s/it] 96%|█████████▌| 96/100 [04:38<00:11,  2.84s/it] 97%|█████████▋| 97/100 [04:41<00:08,  2.80s/it] 98%|█████████▊| 98/100 [04:44<00:05,  2.87s/it] 99%|█████████▉| 99/100 [04:47<00:02,  2.95s/it]100%|██████████| 100/100 [04:50<00:00,  2.92s/it]100%|██████████| 100/100 [04:50<00:00,  2.90s/it]
[0/100] loss: 2.712847948074341 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.501634359359741 loss_joints: 2.3966832160949707 loss_collision: 0.15332184731960297 loss_jerk: 0.069520004093647 loss_floor_contact: 0.5485888719558716
[2/100] loss: 1.9135717153549194 loss_joints: 1.796841025352478 loss_collision: 0.18657764792442322 loss_jerk: 0.08514098078012466 loss_floor_contact: 0.5550239682197571
[3/100] loss: 1.1843602657318115 loss_joints: 1.1071622371673584 loss_collision: 0.1306166648864746 loss_jerk: 0.08936107903718948 loss_floor_contact: 0.19455750286579132
[4/100] loss: 0.6931837797164917 loss_joints: 0.6299512386322021 loss_collision: 0.12019208073616028 loss_jerk: 0.09816835820674896 loss_floor_contact: 0.02129160426557064
[5/100] loss: 0.3237261176109314 loss_joints: 0.2644934356212616 loss_collision: 0.06515946239233017 loss_jerk: 0.10112185031175613 loss_floor_contact: 0.021558202803134918
[6/100] loss: 0.11234434694051743 loss_joints: 0.05551847070455551 loss_collision: 0.07718644291162491 loss_jerk: 0.09384264051914215 loss_floor_contact: 0.02185913547873497
[7/100] loss: 0.12539908289909363 loss_joints: 0.07611670345067978 loss_collision: 0.03853427246212959 loss_jerk: 0.08638507127761841 loss_floor_contact: 0.022364109754562378
[8/100] loss: 0.1766097992658615 loss_joints: 0.10344469547271729 loss_collision: 0.21311010420322418 loss_jerk: 0.09924741834402084 loss_floor_contact: 0.022303814068436623
[9/100] loss: 0.14443646371364594 loss_joints: 0.08160726726055145 loss_collision: 0.07305873185396194 loss_jerk: 0.10662488639354706 loss_floor_contact: 0.022108713164925575
[10/100] loss: 0.11846193671226501 loss_joints: 0.060360413044691086 loss_collision: 0.030047595500946045 loss_jerk: 0.10584868490695953 loss_floor_contact: 0.02172418124973774
[11/100] loss: 0.09259466081857681 loss_joints: 0.037169598042964935 loss_collision: 0.02609161101281643 loss_jerk: 0.10141414403915405 loss_floor_contact: 0.02108832821249962
[12/100] loss: 0.06316912919282913 loss_joints: 0.009690549224615097 loss_collision: 0.061177849769592285 loss_jerk: 0.09063971787691116 loss_floor_contact: 0.02040938474237919
[13/100] loss: 0.05533492565155029 loss_joints: 0.009379456751048565 loss_collision: 0.04920843243598938 loss_jerk: 0.0780952200293541 loss_floor_contact: 0.019870178773999214
[14/100] loss: 0.060546908527612686 loss_joints: 0.01824050210416317 loss_collision: 0.03979085013270378 loss_jerk: 0.07272233814001083 loss_floor_contact: 0.019661515951156616
[15/100] loss: 0.05723656713962555 loss_joints: 0.01569497212767601 loss_collision: 0.04391620680689812 loss_jerk: 0.07038898020982742 loss_floor_contact: 0.019554831087589264
[16/100] loss: 0.04821115732192993 loss_joints: 0.006937574129551649 loss_collision: 0.04642639309167862 loss_jerk: 0.06935436278581619 loss_floor_contact: 0.01953762397170067
[17/100] loss: 0.0478031225502491 loss_joints: 0.006168306805193424 loss_collision: 0.05259932950139046 loss_jerk: 0.06882995367050171 loss_floor_contact: 0.01959904469549656
[18/100] loss: 0.04882287606596947 loss_joints: 0.007941016927361488 loss_collision: 0.054079826921224594 loss_jerk: 0.06699655950069427 loss_floor_contact: 0.01975596882402897
[19/100] loss: 0.0449800007045269 loss_joints: 0.006056654267013073 loss_collision: 0.041064608842134476 loss_jerk: 0.06565720587968826 loss_floor_contact: 0.019882788881659508
[20/100] loss: 0.043457772582769394 loss_joints: 0.004756419453769922 loss_collision: 0.03882252424955368 loss_jerk: 0.06565302610397339 loss_floor_contact: 0.01992587000131607
[21/100] loss: 0.04019564390182495 loss_joints: 0.002352614887058735 loss_collision: 0.04000736400485039 loss_jerk: 0.06369781494140625 loss_floor_contact: 0.01993383653461933
[22/100] loss: 0.04020954295992851 loss_joints: 0.002466193400323391 loss_collision: 0.05675720050930977 loss_jerk: 0.0601467564702034 loss_floor_contact: 0.019942522048950195
[23/100] loss: 0.042338237166404724 loss_joints: 0.003324388060718775 loss_collision: 0.0716404989361763 loss_jerk: 0.05970928817987442 loss_floor_contact: 0.019951526075601578
[24/100] loss: 0.039308592677116394 loss_joints: 0.003007554914802313 loss_collision: 0.04771555960178375 loss_jerk: 0.058992478996515274 loss_floor_contact: 0.020332396030426025
[25/100] loss: 0.039148423820734024 loss_joints: 0.004035160411149263 loss_collision: 0.03818473592400551 loss_jerk: 0.058358415961265564 loss_floor_contact: 0.02115579880774021
[26/100] loss: 0.03719264268875122 loss_joints: 0.0023695139680057764 loss_collision: 0.037639059126377106 loss_jerk: 0.05779581889510155 loss_floor_contact: 0.021613135933876038
[27/100] loss: 0.03539542853832245 loss_joints: 0.0009626861428841949 loss_collision: 0.04386812448501587 loss_jerk: 0.055713340640068054 loss_floor_contact: 0.021892601624131203
[28/100] loss: 0.03677508607506752 loss_joints: 0.002177181886509061 loss_collision: 0.04765619337558746 loss_jerk: 0.05529441684484482 loss_floor_contact: 0.02185077592730522
[29/100] loss: 0.034991078078746796 loss_joints: 0.0015605331864207983 loss_collision: 0.0379057414829731 loss_jerk: 0.05490539222955704 loss_floor_contact: 0.0218727458268404
[30/100] loss: 0.032764971256256104 loss_joints: 0.002385374391451478 loss_collision: 0.015085269697010517 loss_jerk: 0.053714606910943985 loss_floor_contact: 0.02013765648007393
[31/100] loss: 0.0327744297683239 loss_joints: 0.002422609832137823 loss_collision: 0.015902012586593628 loss_jerk: 0.053394615650177 loss_floor_contact: 0.020643090829253197
[32/100] loss: 0.030806515365839005 loss_joints: 0.00033518997952342033 loss_collision: 0.017295340076088905 loss_jerk: 0.05316924303770065 loss_floor_contact: 0.021571697667241096
[33/100] loss: 0.03227446228265762 loss_joints: 0.001485471031628549 loss_collision: 0.02045229636132717 loss_jerk: 0.05326361954212189 loss_floor_contact: 0.021119512617588043
[34/100] loss: 0.03283102065324783 loss_joints: 0.0020034092012792826 loss_collision: 0.021041283383965492 loss_jerk: 0.05330508202314377 loss_floor_contact: 0.02070942521095276
[35/100] loss: 0.0309990793466568 loss_joints: 0.0003326424630358815 loss_collision: 0.02522888034582138 loss_jerk: 0.052281878888607025 loss_floor_contact: 0.020026106387376785
[36/100] loss: 0.03200796991586685 loss_joints: 0.0010798647999763489 loss_collision: 0.03356572240591049 loss_jerk: 0.05113775655627251 loss_floor_contact: 0.02002652920782566
[37/100] loss: 0.03285079449415207 loss_joints: 0.0018421508138999343 loss_collision: 0.03349866345524788 loss_jerk: 0.05131174623966217 loss_floor_contact: 0.02002902515232563
[38/100] loss: 0.030970031395554543 loss_joints: 0.0006776112131774426 loss_collision: 0.026025991886854172 loss_jerk: 0.05148680508136749 loss_floor_contact: 0.01946418173611164
[39/100] loss: 0.030981652438640594 loss_joints: 0.0015983842313289642 loss_collision: 0.015494533814489841 loss_jerk: 0.051777198910713196 loss_floor_contact: 0.019452158361673355
[40/100] loss: 0.03175932168960571 loss_joints: 0.002101853024214506 loss_collision: 0.01341448538005352 loss_jerk: 0.052675798535346985 loss_floor_contact: 0.019781209528446198
[41/100] loss: 0.030446812510490417 loss_joints: 0.0005920623661950231 loss_collision: 0.014766115695238113 loss_jerk: 0.05272824689745903 loss_floor_contact: 0.020140143111348152
[42/100] loss: 0.030050521716475487 loss_joints: 0.0005342338117770851 loss_collision: 0.01695474423468113 loss_jerk: 0.051559485495090485 loss_floor_contact: 0.020410696044564247
[43/100] loss: 0.030542150139808655 loss_joints: 0.0011214736150577664 loss_collision: 0.01603705808520317 loss_jerk: 0.05142569541931152 loss_floor_contact: 0.02104121260344982
[44/100] loss: 0.029466405510902405 loss_joints: 0.0003358703979756683 loss_collision: 0.014383071102201939 loss_jerk: 0.05134573578834534 loss_floor_contact: 0.02019360102713108
[45/100] loss: 0.029574079439044 loss_joints: 0.0005843756953254342 loss_collision: 0.014161563478410244 loss_jerk: 0.051237352192401886 loss_floor_contact: 0.019548704847693443
[46/100] loss: 0.02997390553355217 loss_joints: 0.001226657535880804 loss_collision: 0.015463166870176792 loss_jerk: 0.05049648508429527 loss_floor_contact: 0.01952688954770565
[47/100] loss: 0.02862679213285446 loss_joints: 0.0003294050111435354 loss_collision: 0.014168436639010906 loss_jerk: 0.04985116422176361 loss_floor_contact: 0.01954960823059082
[48/100] loss: 0.028333768248558044 loss_joints: 0.0005501058185473084 loss_collision: 0.013842170126736164 loss_jerk: 0.048876676708459854 loss_floor_contact: 0.019611071795225143
[49/100] loss: 0.028786443173885345 loss_joints: 0.0010945232352241874 loss_collision: 0.016209669411182404 loss_jerk: 0.04821975901722908 loss_floor_contact: 0.019610727205872536
[50/100] loss: 0.02793736383318901 loss_joints: 0.0003751405165530741 loss_collision: 0.01640007644891739 loss_jerk: 0.04792652279138565 loss_floor_contact: 0.019589560106396675
[51/100] loss: 0.027345312759280205 loss_joints: 0.0002594532270450145 loss_collision: 0.012482232414186 loss_jerk: 0.047767847776412964 loss_floor_contact: 0.019537121057510376
[52/100] loss: 0.027505984529852867 loss_joints: 0.0007240119157359004 loss_collision: 0.012373462319374084 loss_jerk: 0.04719363525509834 loss_floor_contact: 0.019478091970086098
[53/100] loss: 0.027013929560780525 loss_joints: 0.00033431604970246553 loss_collision: 0.01127621904015541 loss_jerk: 0.047211650758981705 loss_floor_contact: 0.019461657851934433
[54/100] loss: 0.02675599232316017 loss_joints: 8.163128222804517e-05 loss_collision: 0.014396784827113152 loss_jerk: 0.04657294973731041 loss_floor_contact: 0.019482066854834557
[55/100] loss: 0.027238931506872177 loss_joints: 0.00022399243607651442 loss_collision: 0.01718139462172985 loss_jerk: 0.04670175164937973 loss_floor_contact: 0.01945924200117588
[56/100] loss: 0.026924360543489456 loss_joints: 1.220158810610883e-05 loss_collision: 0.017457138746976852 loss_jerk: 0.046447571367025375 loss_floor_contact: 0.01942659355700016
[57/100] loss: 0.027008701115846634 loss_joints: 0.0005033863708376884 loss_collision: 0.014580491930246353 loss_jerk: 0.04621003940701485 loss_floor_contact: 0.019422445446252823
[58/100] loss: 0.027142489328980446 loss_joints: 0.0007148485165089369 loss_collision: 0.015247706323862076 loss_jerk: 0.04591582342982292 loss_floor_contact: 0.019449586048722267
[59/100] loss: 0.026557086035609245 loss_joints: 0.00036388516309671104 loss_collision: 0.012446178123354912 loss_jerk: 0.045988358557224274 loss_floor_contact: 0.019544050097465515
[60/100] loss: 0.02650492452085018 loss_joints: 0.00010447016393300146 loss_collision: 0.015154163353145123 loss_jerk: 0.045700158923864365 loss_floor_contact: 0.02034957893192768
[61/100] loss: 0.026494650170207024 loss_joints: 0.0001710228098090738 loss_collision: 0.016655156388878822 loss_jerk: 0.045297324657440186 loss_floor_contact: 0.020094500854611397
[62/100] loss: 0.026021946221590042 loss_joints: 0.00017215614207088947 loss_collision: 0.014532212167978287 loss_jerk: 0.04480641335248947 loss_floor_contact: 0.019933616742491722
[63/100] loss: 0.025393467396497726 loss_joints: 1.4964914953452535e-05 loss_collision: 0.012879475951194763 loss_jerk: 0.044212911278009415 loss_floor_contact: 0.019840983673930168
[64/100] loss: 0.025403523817658424 loss_joints: 0.00015557858569081873 loss_collision: 0.012906581163406372 loss_jerk: 0.044032271951436996 loss_floor_contact: 0.019411524757742882
[65/100] loss: 0.025340808555483818 loss_joints: 0.00017728724924381822 loss_collision: 0.015188018791377544 loss_jerk: 0.04340996965765953 loss_floor_contact: 0.019397342577576637
[66/100] loss: 0.02516353316605091 loss_joints: 1.9657307348097675e-05 loss_collision: 0.013505620881915092 loss_jerk: 0.0437152162194252 loss_floor_contact: 0.019357049837708473
[67/100] loss: 0.024860693141818047 loss_joints: 0.00015786010771989822 loss_collision: 0.011611118912696838 loss_jerk: 0.04321964457631111 loss_floor_contact: 0.01931898482143879
[68/100] loss: 0.024773404002189636 loss_joints: 0.0002899603277910501 loss_collision: 0.009732590988278389 loss_jerk: 0.04315773397684097 loss_floor_contact: 0.019313164055347443
[69/100] loss: 0.024575700983405113 loss_joints: 7.372428808594123e-05 loss_collision: 0.009897851385176182 loss_jerk: 0.043156810104846954 loss_floor_contact: 0.019337870180606842
[70/100] loss: 0.0250175092369318 loss_joints: 0.0001829260727390647 loss_collision: 0.011636348441243172 loss_jerk: 0.04336363449692726 loss_floor_contact: 0.019891314208507538
[71/100] loss: 0.025133760645985603 loss_joints: 0.0002758761984296143 loss_collision: 0.012956563383340836 loss_jerk: 0.043118543922901154 loss_floor_contact: 0.02002955600619316
[72/100] loss: 0.024868587031960487 loss_joints: 5.550164496526122e-05 loss_collision: 0.012670840136706829 loss_jerk: 0.043215423822402954 loss_floor_contact: 0.019382892176508904
[73/100] loss: 0.024438362568616867 loss_joints: 0.00011169243953190744 loss_collision: 0.009816218167543411 loss_jerk: 0.042826879769563675 loss_floor_contact: 0.01931608095765114
[74/100] loss: 0.024482984095811844 loss_joints: 0.00022422464098781347 loss_collision: 0.009339559823274612 loss_jerk: 0.042792290449142456 loss_floor_contact: 0.01928657293319702
[75/100] loss: 0.024274881929159164 loss_joints: 0.00010158571967622265 loss_collision: 0.008924784138798714 loss_jerk: 0.042704977095127106 loss_floor_contact: 0.019283294677734375
[76/100] loss: 0.024055534973740578 loss_joints: 6.132869748398662e-05 loss_collision: 0.009320790879428387 loss_jerk: 0.042265187948942184 loss_floor_contact: 0.019295331090688705
[77/100] loss: 0.02412680722773075 loss_joints: 0.00011616462143138051 loss_collision: 0.009826366789638996 loss_jerk: 0.04219549894332886 loss_floor_contact: 0.019302573055028915
[78/100] loss: 0.023833421990275383 loss_joints: 6.693641626043245e-05 loss_collision: 0.008068730123341084 loss_jerk: 0.042060691863298416 loss_floor_contact: 0.019292661920189857
[79/100] loss: 0.02384084276854992 loss_joints: 3.673741957754828e-05 loss_collision: 0.008750570937991142 loss_jerk: 0.04199982061982155 loss_floor_contact: 0.01929137483239174
[80/100] loss: 0.023781096562743187 loss_joints: 7.622614793945104e-05 loss_collision: 0.008860332891345024 loss_jerk: 0.04177911579608917 loss_floor_contact: 0.01929279789328575
[81/100] loss: 0.023723823949694633 loss_joints: 2.0660756490542553e-05 loss_collision: 0.009192400611937046 loss_jerk: 0.04170835763216019 loss_floor_contact: 0.019297445192933083
[82/100] loss: 0.023715028539299965 loss_joints: 1.4209787877916824e-05 loss_collision: 0.00980954896658659 loss_jerk: 0.04158075526356697 loss_floor_contact: 0.019294865429401398
[83/100] loss: 0.023638281971216202 loss_joints: 2.7756683266488835e-05 loss_collision: 0.008964753709733486 loss_jerk: 0.04157210886478424 loss_floor_contact: 0.01927996054291725
[84/100] loss: 0.023704849183559418 loss_joints: 3.355134685989469e-05 loss_collision: 0.009491865523159504 loss_jerk: 0.041590820997953415 loss_floor_contact: 0.01926700584590435
[85/100] loss: 0.02392498217523098 loss_joints: 5.814184987684712e-05 loss_collision: 0.011408163234591484 loss_jerk: 0.041603587567806244 loss_floor_contact: 0.019242294132709503
[86/100] loss: 0.023927653208374977 loss_joints: 7.261997961904854e-05 loss_collision: 0.01225606631487608 loss_jerk: 0.04141424223780632 loss_floor_contact: 0.019223058596253395
[87/100] loss: 0.02366117388010025 loss_joints: 9.079744631890208e-05 loss_collision: 0.010761318728327751 loss_jerk: 0.041144419461488724 loss_floor_contact: 0.01922035589814186
[88/100] loss: 0.02361755073070526 loss_joints: 6.213418237166479e-05 loss_collision: 0.010304881259799004 loss_jerk: 0.04120519384741783 loss_floor_contact: 0.01922331564128399
[89/100] loss: 0.023536279797554016 loss_joints: 2.2674114006804302e-05 loss_collision: 0.009736250154674053 loss_jerk: 0.04123622924089432 loss_floor_contact: 0.01921866275370121
[90/100] loss: 0.02349688671529293 loss_joints: 1.171425810753135e-05 loss_collision: 0.009986700490117073 loss_jerk: 0.041127923876047134 loss_floor_contact: 0.01922539621591568
[91/100] loss: 0.023390522226691246 loss_joints: 3.838445263681933e-05 loss_collision: 0.00922354031354189 loss_jerk: 0.04098773002624512 loss_floor_contact: 0.019359178841114044
[92/100] loss: 0.02338152751326561 loss_joints: 3.502442632452585e-05 loss_collision: 0.009209005162119865 loss_jerk: 0.04098821058869362 loss_floor_contact: 0.019314972683787346
[93/100] loss: 0.023264838382601738 loss_joints: 1.0978477803291753e-05 loss_collision: 0.008726242929697037 loss_jerk: 0.0409172922372818 loss_floor_contact: 0.019225891679525375
[94/100] loss: 0.023320265114307404 loss_joints: 1.68375163411838e-06 loss_collision: 0.00961664505302906 loss_jerk: 0.040869515389204025 loss_floor_contact: 0.0192215908318758
[95/100] loss: 0.023251498118042946 loss_joints: 5.629617589875124e-07 loss_collision: 0.009424049407243729 loss_jerk: 0.0407734178006649 loss_floor_contact: 0.019218219444155693
[96/100] loss: 0.023211492225527763 loss_joints: 3.3094447644543834e-06 loss_collision: 0.009603796526789665 loss_jerk: 0.040652550756931305 loss_floor_contact: 0.019215265288949013
[97/100] loss: 0.023124005645513535 loss_joints: 3.3910177990037482e-06 loss_collision: 0.009227234870195389 loss_jerk: 0.04055234044790268 loss_floor_contact: 0.019217200577259064
[98/100] loss: 0.023172352463006973 loss_joints: 6.333085821097484e-06 loss_collision: 0.009966173209249973 loss_jerk: 0.04049573838710785 loss_floor_contact: 0.019215324893593788
[99/100] loss: 0.023133302107453346 loss_joints: 5.787501322629396e-06 loss_collision: 0.009763267822563648 loss_jerk: 0.04045912250876427 loss_floor_contact: 0.01921626552939415
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk0.5_skate0.25]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 290.11548                                                    ║
    ║     rollout = 129.75066                                                    ║
    ║     sdf     = 15.18304                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.02313330                                                 ║
    ║     joints    = 0.00000579                                                 ║
    ║     collision = 0.00976327                                                 ║
    ║     jerk      = 0.04045912                                                 ║
    ║     floor     = 0.01921627                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m8.391s
user	4m37.578s
sys	0m14.225s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.5, skate=0.5
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:49,  2.93s/it]  2%|▏         | 2/100 [00:05<04:40,  2.86s/it]  3%|▎         | 3/100 [00:09<05:03,  3.13s/it]  4%|▍         | 4/100 [00:11<04:46,  2.99s/it]  5%|▌         | 5/100 [00:14<04:37,  2.92s/it]  6%|▌         | 6/100 [00:17<04:39,  2.97s/it]  7%|▋         | 7/100 [00:20<04:29,  2.90s/it]  8%|▊         | 8/100 [00:23<04:26,  2.90s/it]  9%|▉         | 9/100 [00:26<04:15,  2.81s/it] 10%|█         | 10/100 [00:28<04:13,  2.81s/it] 11%|█         | 11/100 [00:31<04:07,  2.78s/it] 12%|█▏        | 12/100 [00:34<04:05,  2.79s/it] 13%|█▎        | 13/100 [00:37<04:00,  2.77s/it] 14%|█▍        | 14/100 [00:39<03:58,  2.77s/it] 15%|█▌        | 15/100 [00:42<03:56,  2.79s/it] 16%|█▌        | 16/100 [00:45<03:52,  2.77s/it] 17%|█▋        | 17/100 [00:48<03:50,  2.78s/it] 18%|█▊        | 18/100 [00:50<03:45,  2.75s/it] 19%|█▉        | 19/100 [00:53<03:43,  2.76s/it] 20%|██        | 20/100 [00:56<03:45,  2.82s/it] 21%|██        | 21/100 [00:59<03:41,  2.80s/it] 22%|██▏       | 22/100 [01:02<03:38,  2.80s/it] 23%|██▎       | 23/100 [01:05<03:45,  2.93s/it] 24%|██▍       | 24/100 [01:08<03:44,  2.95s/it] 25%|██▌       | 25/100 [01:11<03:39,  2.93s/it] 26%|██▌       | 26/100 [01:14<03:39,  2.97s/it] 27%|██▋       | 27/100 [01:17<03:37,  2.98s/it] 28%|██▊       | 28/100 [01:20<03:28,  2.90s/it] 29%|██▉       | 29/100 [01:23<03:28,  2.94s/it] 30%|███       | 30/100 [01:25<03:22,  2.89s/it] 31%|███       | 31/100 [01:28<03:18,  2.88s/it] 32%|███▏      | 32/100 [01:31<03:16,  2.90s/it] 33%|███▎      | 33/100 [01:34<03:19,  2.98s/it] 34%|███▍      | 34/100 [01:37<03:17,  3.00s/it] 35%|███▌      | 35/100 [01:40<03:15,  3.00s/it] 36%|███▌      | 36/100 [01:43<03:09,  2.96s/it] 37%|███▋      | 37/100 [01:46<03:04,  2.93s/it] 38%|███▊      | 38/100 [01:49<02:59,  2.90s/it] 39%|███▉      | 39/100 [01:52<02:54,  2.85s/it] 40%|████      | 40/100 [01:54<02:48,  2.80s/it] 41%|████      | 41/100 [01:57<02:47,  2.84s/it] 42%|████▏     | 42/100 [02:00<02:40,  2.77s/it] 43%|████▎     | 43/100 [02:03<02:35,  2.72s/it] 44%|████▍     | 44/100 [02:05<02:33,  2.73s/it] 45%|████▌     | 45/100 [02:08<02:27,  2.69s/it] 46%|████▌     | 46/100 [02:11<02:23,  2.67s/it] 47%|████▋     | 47/100 [02:13<02:20,  2.65s/it] 48%|████▊     | 48/100 [02:16<02:16,  2.63s/it] 49%|████▉     | 49/100 [02:19<02:17,  2.69s/it] 50%|█████     | 50/100 [02:21<02:13,  2.66s/it] 51%|█████     | 51/100 [02:24<02:09,  2.64s/it] 52%|█████▏    | 52/100 [02:26<02:06,  2.63s/it] 53%|█████▎    | 53/100 [02:29<02:04,  2.64s/it] 54%|█████▍    | 54/100 [02:32<02:02,  2.66s/it] 55%|█████▌    | 55/100 [02:34<01:59,  2.65s/it] 56%|█████▌    | 56/100 [02:37<01:56,  2.65s/it] 57%|█████▋    | 57/100 [02:40<01:53,  2.65s/it] 58%|█████▊    | 58/100 [02:42<01:51,  2.64s/it] 59%|█████▉    | 59/100 [02:45<01:51,  2.72s/it] 60%|██████    | 60/100 [02:48<01:46,  2.67s/it] 61%|██████    | 61/100 [02:50<01:43,  2.64s/it] 62%|██████▏   | 62/100 [02:53<01:39,  2.62s/it] 63%|██████▎   | 63/100 [02:56<01:38,  2.65s/it] 64%|██████▍   | 64/100 [02:58<01:35,  2.64s/it] 65%|██████▌   | 65/100 [03:01<01:31,  2.63s/it] 66%|██████▌   | 66/100 [03:03<01:29,  2.62s/it] 67%|██████▋   | 67/100 [03:06<01:25,  2.60s/it] 68%|██████▊   | 68/100 [03:09<01:22,  2.58s/it] 69%|██████▉   | 69/100 [03:11<01:19,  2.57s/it] 70%|███████   | 70/100 [03:14<01:17,  2.58s/it] 71%|███████   | 71/100 [03:16<01:14,  2.58s/it] 72%|███████▏  | 72/100 [03:19<01:13,  2.63s/it] 73%|███████▎  | 73/100 [03:22<01:11,  2.63s/it] 74%|███████▍  | 74/100 [03:24<01:07,  2.60s/it] 75%|███████▌  | 75/100 [03:27<01:04,  2.58s/it] 76%|███████▌  | 76/100 [03:29<01:02,  2.60s/it] 77%|███████▋  | 77/100 [03:32<01:00,  2.61s/it] 78%|███████▊  | 78/100 [03:35<00:57,  2.61s/it] 79%|███████▉  | 79/100 [03:37<00:55,  2.65s/it] 80%|████████  | 80/100 [03:40<00:52,  2.63s/it] 81%|████████  | 81/100 [03:43<00:51,  2.69s/it] 82%|████████▏ | 82/100 [03:45<00:48,  2.70s/it] 83%|████████▎ | 83/100 [03:48<00:45,  2.70s/it] 84%|████████▍ | 84/100 [03:51<00:43,  2.74s/it] 85%|████████▌ | 85/100 [03:54<00:41,  2.76s/it] 86%|████████▌ | 86/100 [03:57<00:38,  2.74s/it] 87%|████████▋ | 87/100 [03:59<00:35,  2.77s/it] 88%|████████▊ | 88/100 [04:02<00:32,  2.75s/it] 89%|████████▉ | 89/100 [04:05<00:30,  2.75s/it] 90%|█████████ | 90/100 [04:08<00:27,  2.73s/it] 91%|█████████ | 91/100 [04:10<00:24,  2.70s/it] 92%|█████████▏| 92/100 [04:13<00:21,  2.71s/it] 93%|█████████▎| 93/100 [04:16<00:19,  2.76s/it] 94%|█████████▍| 94/100 [04:19<00:16,  2.76s/it] 95%|█████████▌| 95/100 [04:21<00:13,  2.74s/it] 96%|█████████▌| 96/100 [04:24<00:10,  2.73s/it] 97%|█████████▋| 97/100 [04:27<00:08,  2.70s/it] 98%|█████████▊| 98/100 [04:30<00:05,  2.81s/it] 99%|█████████▉| 99/100 [04:32<00:02,  2.78s/it]100%|██████████| 100/100 [04:35<00:00,  2.83s/it]100%|██████████| 100/100 [04:35<00:00,  2.76s/it]
[0/100] loss: 2.712847948074341 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.501634359359741 loss_joints: 2.3966832160949707 loss_collision: 0.15332184731960297 loss_jerk: 0.069520004093647 loss_floor_contact: 0.5485888719558716
[2/100] loss: 1.9135717153549194 loss_joints: 1.796841025352478 loss_collision: 0.18657764792442322 loss_jerk: 0.08514098078012466 loss_floor_contact: 0.5550239682197571
[3/100] loss: 1.1843602657318115 loss_joints: 1.1071622371673584 loss_collision: 0.1306166648864746 loss_jerk: 0.08936107903718948 loss_floor_contact: 0.19455750286579132
[4/100] loss: 0.6931837797164917 loss_joints: 0.6299512386322021 loss_collision: 0.12019208073616028 loss_jerk: 0.09816835820674896 loss_floor_contact: 0.02129160426557064
[5/100] loss: 0.3237261176109314 loss_joints: 0.2644934356212616 loss_collision: 0.06515946239233017 loss_jerk: 0.10112185031175613 loss_floor_contact: 0.021558202803134918
[6/100] loss: 0.11234434694051743 loss_joints: 0.05551847070455551 loss_collision: 0.07718644291162491 loss_jerk: 0.09384264051914215 loss_floor_contact: 0.02185913547873497
[7/100] loss: 0.12539908289909363 loss_joints: 0.07611670345067978 loss_collision: 0.03853427246212959 loss_jerk: 0.08638507127761841 loss_floor_contact: 0.022364109754562378
[8/100] loss: 0.1766097992658615 loss_joints: 0.10344469547271729 loss_collision: 0.21311010420322418 loss_jerk: 0.09924741834402084 loss_floor_contact: 0.022303814068436623
[9/100] loss: 0.14443646371364594 loss_joints: 0.08160726726055145 loss_collision: 0.07305873185396194 loss_jerk: 0.10662488639354706 loss_floor_contact: 0.022108713164925575
[10/100] loss: 0.11846193671226501 loss_joints: 0.060360413044691086 loss_collision: 0.030047595500946045 loss_jerk: 0.10584868490695953 loss_floor_contact: 0.02172418124973774
[11/100] loss: 0.09259466081857681 loss_joints: 0.037169598042964935 loss_collision: 0.02609161101281643 loss_jerk: 0.10141414403915405 loss_floor_contact: 0.02108832821249962
[12/100] loss: 0.06316912919282913 loss_joints: 0.009690549224615097 loss_collision: 0.061177849769592285 loss_jerk: 0.09063971787691116 loss_floor_contact: 0.02040938474237919
[13/100] loss: 0.05533492565155029 loss_joints: 0.009379456751048565 loss_collision: 0.04920843243598938 loss_jerk: 0.0780952200293541 loss_floor_contact: 0.019870178773999214
[14/100] loss: 0.060546908527612686 loss_joints: 0.01824050210416317 loss_collision: 0.03979085013270378 loss_jerk: 0.07272233814001083 loss_floor_contact: 0.019661515951156616
[15/100] loss: 0.05723656713962555 loss_joints: 0.01569497212767601 loss_collision: 0.04391620680689812 loss_jerk: 0.07038898020982742 loss_floor_contact: 0.019554831087589264
[16/100] loss: 0.04821115732192993 loss_joints: 0.006937574129551649 loss_collision: 0.04642639309167862 loss_jerk: 0.06935436278581619 loss_floor_contact: 0.01953762397170067
[17/100] loss: 0.0478031225502491 loss_joints: 0.006168306805193424 loss_collision: 0.05259932950139046 loss_jerk: 0.06882995367050171 loss_floor_contact: 0.01959904469549656
[18/100] loss: 0.04882287606596947 loss_joints: 0.007941016927361488 loss_collision: 0.054079826921224594 loss_jerk: 0.06699655950069427 loss_floor_contact: 0.01975596882402897
[19/100] loss: 0.0449800007045269 loss_joints: 0.006056654267013073 loss_collision: 0.041064608842134476 loss_jerk: 0.06565720587968826 loss_floor_contact: 0.019882788881659508
[20/100] loss: 0.043457772582769394 loss_joints: 0.004756419453769922 loss_collision: 0.03882252424955368 loss_jerk: 0.06565302610397339 loss_floor_contact: 0.01992587000131607
[21/100] loss: 0.04019564390182495 loss_joints: 0.002352614887058735 loss_collision: 0.04000736400485039 loss_jerk: 0.06369781494140625 loss_floor_contact: 0.01993383653461933
[22/100] loss: 0.04020954295992851 loss_joints: 0.002466193400323391 loss_collision: 0.05675720050930977 loss_jerk: 0.0601467564702034 loss_floor_contact: 0.019942522048950195
[23/100] loss: 0.042338237166404724 loss_joints: 0.003324388060718775 loss_collision: 0.0716404989361763 loss_jerk: 0.05970928817987442 loss_floor_contact: 0.019951526075601578
[24/100] loss: 0.039308592677116394 loss_joints: 0.003007554914802313 loss_collision: 0.04771555960178375 loss_jerk: 0.058992478996515274 loss_floor_contact: 0.020332396030426025
[25/100] loss: 0.039148423820734024 loss_joints: 0.004035160411149263 loss_collision: 0.03818473592400551 loss_jerk: 0.058358415961265564 loss_floor_contact: 0.02115579880774021
[26/100] loss: 0.03719264268875122 loss_joints: 0.0023695139680057764 loss_collision: 0.037639059126377106 loss_jerk: 0.05779581889510155 loss_floor_contact: 0.021613135933876038
[27/100] loss: 0.03539542853832245 loss_joints: 0.0009626861428841949 loss_collision: 0.04386812448501587 loss_jerk: 0.055713340640068054 loss_floor_contact: 0.021892601624131203
[28/100] loss: 0.03677508607506752 loss_joints: 0.002177181886509061 loss_collision: 0.04765619337558746 loss_jerk: 0.05529441684484482 loss_floor_contact: 0.02185077592730522
[29/100] loss: 0.034991078078746796 loss_joints: 0.0015605331864207983 loss_collision: 0.0379057414829731 loss_jerk: 0.05490539222955704 loss_floor_contact: 0.0218727458268404
[30/100] loss: 0.032764971256256104 loss_joints: 0.002385374391451478 loss_collision: 0.015085269697010517 loss_jerk: 0.053714606910943985 loss_floor_contact: 0.02013765648007393
[31/100] loss: 0.0327744297683239 loss_joints: 0.002422609832137823 loss_collision: 0.015902012586593628 loss_jerk: 0.053394615650177 loss_floor_contact: 0.020643090829253197
[32/100] loss: 0.030806515365839005 loss_joints: 0.00033518997952342033 loss_collision: 0.017295340076088905 loss_jerk: 0.05316924303770065 loss_floor_contact: 0.021571697667241096
[33/100] loss: 0.03227446228265762 loss_joints: 0.001485471031628549 loss_collision: 0.02045229636132717 loss_jerk: 0.05326361954212189 loss_floor_contact: 0.021119512617588043
[34/100] loss: 0.03283102065324783 loss_joints: 0.0020034092012792826 loss_collision: 0.021041283383965492 loss_jerk: 0.05330508202314377 loss_floor_contact: 0.02070942521095276
[35/100] loss: 0.0309990793466568 loss_joints: 0.0003326424630358815 loss_collision: 0.02522888034582138 loss_jerk: 0.052281878888607025 loss_floor_contact: 0.020026106387376785
[36/100] loss: 0.03200796991586685 loss_joints: 0.0010798647999763489 loss_collision: 0.03356572240591049 loss_jerk: 0.05113775655627251 loss_floor_contact: 0.02002652920782566
[37/100] loss: 0.03285079449415207 loss_joints: 0.0018421508138999343 loss_collision: 0.03349866345524788 loss_jerk: 0.05131174623966217 loss_floor_contact: 0.02002902515232563
[38/100] loss: 0.030970031395554543 loss_joints: 0.0006776112131774426 loss_collision: 0.026025991886854172 loss_jerk: 0.05148680508136749 loss_floor_contact: 0.01946418173611164
[39/100] loss: 0.030981652438640594 loss_joints: 0.0015983842313289642 loss_collision: 0.015494533814489841 loss_jerk: 0.051777198910713196 loss_floor_contact: 0.019452158361673355
[40/100] loss: 0.03175932168960571 loss_joints: 0.002101853024214506 loss_collision: 0.01341448538005352 loss_jerk: 0.052675798535346985 loss_floor_contact: 0.019781209528446198
[41/100] loss: 0.030446812510490417 loss_joints: 0.0005920623661950231 loss_collision: 0.014766115695238113 loss_jerk: 0.05272824689745903 loss_floor_contact: 0.020140143111348152
[42/100] loss: 0.030050521716475487 loss_joints: 0.0005342338117770851 loss_collision: 0.01695474423468113 loss_jerk: 0.051559485495090485 loss_floor_contact: 0.020410696044564247
[43/100] loss: 0.030542150139808655 loss_joints: 0.0011214736150577664 loss_collision: 0.01603705808520317 loss_jerk: 0.05142569541931152 loss_floor_contact: 0.02104121260344982
[44/100] loss: 0.029466405510902405 loss_joints: 0.0003358703979756683 loss_collision: 0.014383071102201939 loss_jerk: 0.05134573578834534 loss_floor_contact: 0.02019360102713108
[45/100] loss: 0.029574079439044 loss_joints: 0.0005843756953254342 loss_collision: 0.014161563478410244 loss_jerk: 0.051237352192401886 loss_floor_contact: 0.019548704847693443
[46/100] loss: 0.02997390553355217 loss_joints: 0.001226657535880804 loss_collision: 0.015463166870176792 loss_jerk: 0.05049648508429527 loss_floor_contact: 0.01952688954770565
[47/100] loss: 0.02862679213285446 loss_joints: 0.0003294050111435354 loss_collision: 0.014168436639010906 loss_jerk: 0.04985116422176361 loss_floor_contact: 0.01954960823059082
[48/100] loss: 0.028333768248558044 loss_joints: 0.0005501058185473084 loss_collision: 0.013842170126736164 loss_jerk: 0.048876676708459854 loss_floor_contact: 0.019611071795225143
[49/100] loss: 0.028786443173885345 loss_joints: 0.0010945232352241874 loss_collision: 0.016209669411182404 loss_jerk: 0.04821975901722908 loss_floor_contact: 0.019610727205872536
[50/100] loss: 0.02793736383318901 loss_joints: 0.0003751405165530741 loss_collision: 0.01640007644891739 loss_jerk: 0.04792652279138565 loss_floor_contact: 0.019589560106396675
[51/100] loss: 0.027345312759280205 loss_joints: 0.0002594532270450145 loss_collision: 0.012482232414186 loss_jerk: 0.047767847776412964 loss_floor_contact: 0.019537121057510376
[52/100] loss: 0.027505984529852867 loss_joints: 0.0007240119157359004 loss_collision: 0.012373462319374084 loss_jerk: 0.04719363525509834 loss_floor_contact: 0.019478091970086098
[53/100] loss: 0.027013929560780525 loss_joints: 0.00033431604970246553 loss_collision: 0.01127621904015541 loss_jerk: 0.047211650758981705 loss_floor_contact: 0.019461657851934433
[54/100] loss: 0.02675599232316017 loss_joints: 8.163128222804517e-05 loss_collision: 0.014396784827113152 loss_jerk: 0.04657294973731041 loss_floor_contact: 0.019482066854834557
[55/100] loss: 0.027238931506872177 loss_joints: 0.00022399243607651442 loss_collision: 0.01718139462172985 loss_jerk: 0.04670175164937973 loss_floor_contact: 0.01945924200117588
[56/100] loss: 0.026924360543489456 loss_joints: 1.220158810610883e-05 loss_collision: 0.017457138746976852 loss_jerk: 0.046447571367025375 loss_floor_contact: 0.01942659355700016
[57/100] loss: 0.027008701115846634 loss_joints: 0.0005033863708376884 loss_collision: 0.014580491930246353 loss_jerk: 0.04621003940701485 loss_floor_contact: 0.019422445446252823
[58/100] loss: 0.027142489328980446 loss_joints: 0.0007148485165089369 loss_collision: 0.015247706323862076 loss_jerk: 0.04591582342982292 loss_floor_contact: 0.019449586048722267
[59/100] loss: 0.026557086035609245 loss_joints: 0.00036388516309671104 loss_collision: 0.012446178123354912 loss_jerk: 0.045988358557224274 loss_floor_contact: 0.019544050097465515
[60/100] loss: 0.02650492452085018 loss_joints: 0.00010447016393300146 loss_collision: 0.015154163353145123 loss_jerk: 0.045700158923864365 loss_floor_contact: 0.02034957893192768
[61/100] loss: 0.026494650170207024 loss_joints: 0.0001710228098090738 loss_collision: 0.016655156388878822 loss_jerk: 0.045297324657440186 loss_floor_contact: 0.020094500854611397
[62/100] loss: 0.026021946221590042 loss_joints: 0.00017215614207088947 loss_collision: 0.014532212167978287 loss_jerk: 0.04480641335248947 loss_floor_contact: 0.019933616742491722
[63/100] loss: 0.025393467396497726 loss_joints: 1.4964914953452535e-05 loss_collision: 0.012879475951194763 loss_jerk: 0.044212911278009415 loss_floor_contact: 0.019840983673930168
[64/100] loss: 0.025403523817658424 loss_joints: 0.00015557858569081873 loss_collision: 0.012906581163406372 loss_jerk: 0.044032271951436996 loss_floor_contact: 0.019411524757742882
[65/100] loss: 0.025340808555483818 loss_joints: 0.00017728724924381822 loss_collision: 0.015188018791377544 loss_jerk: 0.04340996965765953 loss_floor_contact: 0.019397342577576637
[66/100] loss: 0.02516353316605091 loss_joints: 1.9657307348097675e-05 loss_collision: 0.013505620881915092 loss_jerk: 0.0437152162194252 loss_floor_contact: 0.019357049837708473
[67/100] loss: 0.024860693141818047 loss_joints: 0.00015786010771989822 loss_collision: 0.011611118912696838 loss_jerk: 0.04321964457631111 loss_floor_contact: 0.01931898482143879
[68/100] loss: 0.024773404002189636 loss_joints: 0.0002899603277910501 loss_collision: 0.009732590988278389 loss_jerk: 0.04315773397684097 loss_floor_contact: 0.019313164055347443
[69/100] loss: 0.024575700983405113 loss_joints: 7.372428808594123e-05 loss_collision: 0.009897851385176182 loss_jerk: 0.043156810104846954 loss_floor_contact: 0.019337870180606842
[70/100] loss: 0.0250175092369318 loss_joints: 0.0001829260727390647 loss_collision: 0.011636348441243172 loss_jerk: 0.04336363449692726 loss_floor_contact: 0.019891314208507538
[71/100] loss: 0.025133760645985603 loss_joints: 0.0002758761984296143 loss_collision: 0.012956563383340836 loss_jerk: 0.043118543922901154 loss_floor_contact: 0.02002955600619316
[72/100] loss: 0.024868587031960487 loss_joints: 5.550164496526122e-05 loss_collision: 0.012670840136706829 loss_jerk: 0.043215423822402954 loss_floor_contact: 0.019382892176508904
[73/100] loss: 0.024438362568616867 loss_joints: 0.00011169243953190744 loss_collision: 0.009816218167543411 loss_jerk: 0.042826879769563675 loss_floor_contact: 0.01931608095765114
[74/100] loss: 0.024482984095811844 loss_joints: 0.00022422464098781347 loss_collision: 0.009339559823274612 loss_jerk: 0.042792290449142456 loss_floor_contact: 0.01928657293319702
[75/100] loss: 0.024274881929159164 loss_joints: 0.00010158571967622265 loss_collision: 0.008924784138798714 loss_jerk: 0.042704977095127106 loss_floor_contact: 0.019283294677734375
[76/100] loss: 0.024055534973740578 loss_joints: 6.132869748398662e-05 loss_collision: 0.009320790879428387 loss_jerk: 0.042265187948942184 loss_floor_contact: 0.019295331090688705
[77/100] loss: 0.02412680722773075 loss_joints: 0.00011616462143138051 loss_collision: 0.009826366789638996 loss_jerk: 0.04219549894332886 loss_floor_contact: 0.019302573055028915
[78/100] loss: 0.023833421990275383 loss_joints: 6.693641626043245e-05 loss_collision: 0.008068730123341084 loss_jerk: 0.042060691863298416 loss_floor_contact: 0.019292661920189857
[79/100] loss: 0.02384084276854992 loss_joints: 3.673741957754828e-05 loss_collision: 0.008750570937991142 loss_jerk: 0.04199982061982155 loss_floor_contact: 0.01929137483239174
[80/100] loss: 0.023781096562743187 loss_joints: 7.622614793945104e-05 loss_collision: 0.008860332891345024 loss_jerk: 0.04177911579608917 loss_floor_contact: 0.01929279789328575
[81/100] loss: 0.023723823949694633 loss_joints: 2.0660756490542553e-05 loss_collision: 0.009192400611937046 loss_jerk: 0.04170835763216019 loss_floor_contact: 0.019297445192933083
[82/100] loss: 0.023715028539299965 loss_joints: 1.4209787877916824e-05 loss_collision: 0.00980954896658659 loss_jerk: 0.04158075526356697 loss_floor_contact: 0.019294865429401398
[83/100] loss: 0.023638281971216202 loss_joints: 2.7756683266488835e-05 loss_collision: 0.008964753709733486 loss_jerk: 0.04157210886478424 loss_floor_contact: 0.01927996054291725
[84/100] loss: 0.023704849183559418 loss_joints: 3.355134685989469e-05 loss_collision: 0.009491865523159504 loss_jerk: 0.041590820997953415 loss_floor_contact: 0.01926700584590435
[85/100] loss: 0.02392498217523098 loss_joints: 5.814184987684712e-05 loss_collision: 0.011408163234591484 loss_jerk: 0.041603587567806244 loss_floor_contact: 0.019242294132709503
[86/100] loss: 0.023927653208374977 loss_joints: 7.261997961904854e-05 loss_collision: 0.01225606631487608 loss_jerk: 0.04141424223780632 loss_floor_contact: 0.019223058596253395
[87/100] loss: 0.02366117388010025 loss_joints: 9.079744631890208e-05 loss_collision: 0.010761318728327751 loss_jerk: 0.041144419461488724 loss_floor_contact: 0.01922035589814186
[88/100] loss: 0.02361755073070526 loss_joints: 6.213418237166479e-05 loss_collision: 0.010304881259799004 loss_jerk: 0.04120519384741783 loss_floor_contact: 0.01922331564128399
[89/100] loss: 0.023536279797554016 loss_joints: 2.2674114006804302e-05 loss_collision: 0.009736250154674053 loss_jerk: 0.04123622924089432 loss_floor_contact: 0.01921866275370121
[90/100] loss: 0.02349688671529293 loss_joints: 1.171425810753135e-05 loss_collision: 0.009986700490117073 loss_jerk: 0.041127923876047134 loss_floor_contact: 0.01922539621591568
[91/100] loss: 0.023390522226691246 loss_joints: 3.838445263681933e-05 loss_collision: 0.00922354031354189 loss_jerk: 0.04098773002624512 loss_floor_contact: 0.019359178841114044
[92/100] loss: 0.02338152751326561 loss_joints: 3.502442632452585e-05 loss_collision: 0.009209005162119865 loss_jerk: 0.04098821058869362 loss_floor_contact: 0.019314972683787346
[93/100] loss: 0.023264838382601738 loss_joints: 1.0978477803291753e-05 loss_collision: 0.008726242929697037 loss_jerk: 0.0409172922372818 loss_floor_contact: 0.019225891679525375
[94/100] loss: 0.023320265114307404 loss_joints: 1.68375163411838e-06 loss_collision: 0.00961664505302906 loss_jerk: 0.040869515389204025 loss_floor_contact: 0.0192215908318758
[95/100] loss: 0.023251498118042946 loss_joints: 5.629617589875124e-07 loss_collision: 0.009424049407243729 loss_jerk: 0.0407734178006649 loss_floor_contact: 0.019218219444155693
[96/100] loss: 0.023211492225527763 loss_joints: 3.3094447644543834e-06 loss_collision: 0.009603796526789665 loss_jerk: 0.040652550756931305 loss_floor_contact: 0.019215265288949013
[97/100] loss: 0.023124005645513535 loss_joints: 3.3910177990037482e-06 loss_collision: 0.009227234870195389 loss_jerk: 0.04055234044790268 loss_floor_contact: 0.019217200577259064
[98/100] loss: 0.023172352463006973 loss_joints: 6.333085821097484e-06 loss_collision: 0.009966173209249973 loss_jerk: 0.04049573838710785 loss_floor_contact: 0.019215324893593788
[99/100] loss: 0.023133302107453346 loss_joints: 5.787501322629396e-06 loss_collision: 0.009763267822563648 loss_jerk: 0.04045912250876427 loss_floor_contact: 0.01921626552939415
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk0.5_skate0.5]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 275.77756                                                    ║
    ║     rollout = 124.20398                                                    ║
    ║     sdf     = 13.93189                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.02313330                                                 ║
    ║     joints    = 0.00000579                                                 ║
    ║     collision = 0.00976327                                                 ║
    ║     jerk      = 0.04045912                                                 ║
    ║     floor     = 0.01921627                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	4m55.923s
user	4m29.875s
sys	0m16.022s
[INFO] Running with collision=0.1, contact=0.1, jerk=0.5, skate=1.0
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:07,  3.11s/it]  2%|▏         | 2/100 [00:06<04:57,  3.04s/it]  3%|▎         | 3/100 [00:09<05:09,  3.20s/it]  4%|▍         | 4/100 [00:12<04:55,  3.08s/it]  5%|▌         | 5/100 [00:15<04:48,  3.04s/it]  6%|▌         | 6/100 [00:18<04:53,  3.12s/it]  7%|▋         | 7/100 [00:21<04:45,  3.07s/it]  8%|▊         | 8/100 [00:24<04:41,  3.06s/it]  9%|▉         | 9/100 [00:27<04:40,  3.09s/it] 10%|█         | 10/100 [00:30<04:40,  3.12s/it] 11%|█         | 11/100 [00:33<04:34,  3.09s/it] 12%|█▏        | 12/100 [00:37<04:36,  3.15s/it] 13%|█▎        | 13/100 [00:40<04:34,  3.15s/it] 14%|█▍        | 14/100 [00:43<04:21,  3.04s/it] 15%|█▌        | 15/100 [00:46<04:14,  3.00s/it] 16%|█▌        | 16/100 [00:49<04:15,  3.04s/it] 17%|█▋        | 17/100 [00:52<04:09,  3.01s/it] 18%|█▊        | 18/100 [00:55<04:07,  3.01s/it] 19%|█▉        | 19/100 [00:58<03:59,  2.95s/it] 20%|██        | 20/100 [01:01<03:58,  2.98s/it] 21%|██        | 21/100 [01:04<03:58,  3.02s/it] 22%|██▏       | 22/100 [01:07<03:54,  3.01s/it] 23%|██▎       | 23/100 [01:10<03:50,  2.99s/it] 24%|██▍       | 24/100 [01:13<03:46,  2.98s/it] 25%|██▌       | 25/100 [01:15<03:40,  2.94s/it] 26%|██▌       | 26/100 [01:18<03:32,  2.88s/it] 27%|██▋       | 27/100 [01:21<03:27,  2.84s/it] 28%|██▊       | 28/100 [01:24<03:25,  2.85s/it] 29%|██▉       | 29/100 [01:26<03:18,  2.80s/it] 30%|███       | 30/100 [01:29<03:13,  2.76s/it] 31%|███       | 31/100 [01:32<03:09,  2.74s/it] 32%|███▏      | 32/100 [01:34<03:05,  2.72s/it] 33%|███▎      | 33/100 [01:37<03:06,  2.78s/it] 34%|███▍      | 34/100 [01:40<03:05,  2.82s/it] 35%|███▌      | 35/100 [01:43<03:02,  2.80s/it] 36%|███▌      | 36/100 [01:46<02:57,  2.78s/it] 37%|███▋      | 37/100 [01:49<02:53,  2.76s/it] 38%|███▊      | 38/100 [01:51<02:52,  2.77s/it] 39%|███▉      | 39/100 [01:54<02:47,  2.75s/it] 40%|████      | 40/100 [01:57<02:44,  2.74s/it] 41%|████      | 41/100 [01:59<02:39,  2.70s/it] 42%|████▏     | 42/100 [02:02<02:36,  2.69s/it] 43%|████▎     | 43/100 [02:05<02:36,  2.75s/it] 44%|████▍     | 44/100 [02:08<02:36,  2.79s/it] 45%|████▌     | 45/100 [02:10<02:30,  2.74s/it] 46%|████▌     | 46/100 [02:13<02:24,  2.68s/it] 47%|████▋     | 47/100 [02:16<02:20,  2.66s/it] 48%|████▊     | 48/100 [02:18<02:17,  2.64s/it] 49%|████▉     | 49/100 [02:21<02:13,  2.63s/it] 50%|█████     | 50/100 [02:23<02:11,  2.63s/it] 51%|█████     | 51/100 [02:26<02:09,  2.63s/it] 52%|█████▏    | 52/100 [02:29<02:07,  2.65s/it] 53%|█████▎    | 53/100 [02:31<02:04,  2.65s/it] 54%|█████▍    | 54/100 [02:34<02:01,  2.64s/it] 55%|█████▌    | 55/100 [02:37<02:02,  2.71s/it] 56%|█████▌    | 56/100 [02:40<01:58,  2.70s/it] 57%|█████▋    | 57/100 [02:42<01:57,  2.72s/it] 58%|█████▊    | 58/100 [02:45<01:55,  2.74s/it] 59%|█████▉    | 59/100 [02:48<01:55,  2.82s/it] 60%|██████    | 60/100 [02:51<01:52,  2.80s/it] 61%|██████    | 61/100 [02:54<01:50,  2.82s/it] 62%|██████▏   | 62/100 [02:57<01:49,  2.88s/it] 63%|██████▎   | 63/100 [03:00<01:46,  2.89s/it] 64%|██████▍   | 64/100 [03:02<01:43,  2.86s/it] 65%|██████▌   | 65/100 [03:05<01:38,  2.82s/it] 66%|██████▌   | 66/100 [03:08<01:35,  2.80s/it] 67%|██████▋   | 67/100 [03:11<01:33,  2.82s/it] 68%|██████▊   | 68/100 [03:14<01:30,  2.82s/it] 69%|██████▉   | 69/100 [03:16<01:27,  2.83s/it] 70%|███████   | 70/100 [03:19<01:24,  2.81s/it] 71%|███████   | 71/100 [03:22<01:21,  2.81s/it] 72%|███████▏  | 72/100 [03:25<01:21,  2.91s/it] 73%|███████▎  | 73/100 [03:28<01:17,  2.88s/it] 74%|███████▍  | 74/100 [03:31<01:15,  2.89s/it] 75%|███████▌  | 75/100 [03:34<01:11,  2.84s/it] 76%|███████▌  | 76/100 [03:37<01:08,  2.86s/it] 77%|███████▋  | 77/100 [03:39<01:06,  2.88s/it] 78%|███████▊  | 78/100 [03:42<01:02,  2.85s/it] 79%|███████▉  | 79/100 [03:45<00:59,  2.82s/it] 80%|████████  | 80/100 [03:48<00:56,  2.83s/it] 81%|████████  | 81/100 [03:51<00:53,  2.84s/it] 82%|████████▏ | 82/100 [03:54<00:51,  2.84s/it] 83%|████████▎ | 83/100 [03:56<00:47,  2.82s/it] 84%|████████▍ | 84/100 [03:59<00:45,  2.83s/it] 85%|████████▌ | 85/100 [04:02<00:42,  2.84s/it] 86%|████████▌ | 86/100 [04:05<00:39,  2.80s/it] 87%|████████▋ | 87/100 [04:08<00:36,  2.79s/it] 88%|████████▊ | 88/100 [04:10<00:33,  2.83s/it] 89%|████████▉ | 89/100 [04:13<00:30,  2.79s/it] 90%|█████████ | 90/100 [04:16<00:27,  2.77s/it] 91%|█████████ | 91/100 [04:19<00:25,  2.79s/it] 92%|█████████▏| 92/100 [04:21<00:22,  2.78s/it] 93%|█████████▎| 93/100 [04:24<00:19,  2.77s/it] 94%|█████████▍| 94/100 [04:27<00:16,  2.76s/it] 95%|█████████▌| 95/100 [04:30<00:13,  2.75s/it] 96%|█████████▌| 96/100 [04:32<00:11,  2.78s/it] 97%|█████████▋| 97/100 [04:35<00:08,  2.77s/it] 98%|█████████▊| 98/100 [04:38<00:05,  2.79s/it] 99%|█████████▉| 99/100 [04:41<00:02,  2.79s/it]100%|██████████| 100/100 [04:44<00:00,  2.85s/it]100%|██████████| 100/100 [04:44<00:00,  2.84s/it]
[0/100] loss: 2.712847948074341 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.501634359359741 loss_joints: 2.3966832160949707 loss_collision: 0.15332184731960297 loss_jerk: 0.069520004093647 loss_floor_contact: 0.5485888719558716
[2/100] loss: 1.9135717153549194 loss_joints: 1.796841025352478 loss_collision: 0.18657764792442322 loss_jerk: 0.08514098078012466 loss_floor_contact: 0.5550239682197571
[3/100] loss: 1.1843602657318115 loss_joints: 1.1071622371673584 loss_collision: 0.1306166648864746 loss_jerk: 0.08936107903718948 loss_floor_contact: 0.19455750286579132
[4/100] loss: 0.6931837797164917 loss_joints: 0.6299512386322021 loss_collision: 0.12019208073616028 loss_jerk: 0.09816835820674896 loss_floor_contact: 0.02129160426557064
[5/100] loss: 0.3237261176109314 loss_joints: 0.2644934356212616 loss_collision: 0.06515946239233017 loss_jerk: 0.10112185031175613 loss_floor_contact: 0.021558202803134918
[6/100] loss: 0.11234434694051743 loss_joints: 0.05551847070455551 loss_collision: 0.07718644291162491 loss_jerk: 0.09384264051914215 loss_floor_contact: 0.02185913547873497
[7/100] loss: 0.12539908289909363 loss_joints: 0.07611670345067978 loss_collision: 0.03853427246212959 loss_jerk: 0.08638507127761841 loss_floor_contact: 0.022364109754562378
[8/100] loss: 0.1766097992658615 loss_joints: 0.10344469547271729 loss_collision: 0.21311010420322418 loss_jerk: 0.09924741834402084 loss_floor_contact: 0.022303814068436623
[9/100] loss: 0.14443646371364594 loss_joints: 0.08160726726055145 loss_collision: 0.07305873185396194 loss_jerk: 0.10662488639354706 loss_floor_contact: 0.022108713164925575
[10/100] loss: 0.11846193671226501 loss_joints: 0.060360413044691086 loss_collision: 0.030047595500946045 loss_jerk: 0.10584868490695953 loss_floor_contact: 0.02172418124973774
[11/100] loss: 0.09259466081857681 loss_joints: 0.037169598042964935 loss_collision: 0.02609161101281643 loss_jerk: 0.10141414403915405 loss_floor_contact: 0.02108832821249962
[12/100] loss: 0.06316912919282913 loss_joints: 0.009690549224615097 loss_collision: 0.061177849769592285 loss_jerk: 0.09063971787691116 loss_floor_contact: 0.02040938474237919
[13/100] loss: 0.05533492565155029 loss_joints: 0.009379456751048565 loss_collision: 0.04920843243598938 loss_jerk: 0.0780952200293541 loss_floor_contact: 0.019870178773999214
[14/100] loss: 0.060546908527612686 loss_joints: 0.01824050210416317 loss_collision: 0.03979085013270378 loss_jerk: 0.07272233814001083 loss_floor_contact: 0.019661515951156616
[15/100] loss: 0.05723656713962555 loss_joints: 0.01569497212767601 loss_collision: 0.04391620680689812 loss_jerk: 0.07038898020982742 loss_floor_contact: 0.019554831087589264
[16/100] loss: 0.04821115732192993 loss_joints: 0.006937574129551649 loss_collision: 0.04642639309167862 loss_jerk: 0.06935436278581619 loss_floor_contact: 0.01953762397170067
[17/100] loss: 0.0478031225502491 loss_joints: 0.006168306805193424 loss_collision: 0.05259932950139046 loss_jerk: 0.06882995367050171 loss_floor_contact: 0.01959904469549656
[18/100] loss: 0.04882287606596947 loss_joints: 0.007941016927361488 loss_collision: 0.054079826921224594 loss_jerk: 0.06699655950069427 loss_floor_contact: 0.01975596882402897
[19/100] loss: 0.0449800007045269 loss_joints: 0.006056654267013073 loss_collision: 0.041064608842134476 loss_jerk: 0.06565720587968826 loss_floor_contact: 0.019882788881659508
[20/100] loss: 0.043457772582769394 loss_joints: 0.004756419453769922 loss_collision: 0.03882252424955368 loss_jerk: 0.06565302610397339 loss_floor_contact: 0.01992587000131607
[21/100] loss: 0.04019564390182495 loss_joints: 0.002352614887058735 loss_collision: 0.04000736400485039 loss_jerk: 0.06369781494140625 loss_floor_contact: 0.01993383653461933
[22/100] loss: 0.04020954295992851 loss_joints: 0.002466193400323391 loss_collision: 0.05675720050930977 loss_jerk: 0.0601467564702034 loss_floor_contact: 0.019942522048950195
[23/100] loss: 0.042338237166404724 loss_joints: 0.003324388060718775 loss_collision: 0.0716404989361763 loss_jerk: 0.05970928817987442 loss_floor_contact: 0.019951526075601578
[24/100] loss: 0.039308592677116394 loss_joints: 0.003007554914802313 loss_collision: 0.04771555960178375 loss_jerk: 0.058992478996515274 loss_floor_contact: 0.020332396030426025
[25/100] loss: 0.039148423820734024 loss_joints: 0.004035160411149263 loss_collision: 0.03818473592400551 loss_jerk: 0.058358415961265564 loss_floor_contact: 0.02115579880774021
[26/100] loss: 0.03719264268875122 loss_joints: 0.0023695139680057764 loss_collision: 0.037639059126377106 loss_jerk: 0.05779581889510155 loss_floor_contact: 0.021613135933876038
[27/100] loss: 0.03539542853832245 loss_joints: 0.0009626861428841949 loss_collision: 0.04386812448501587 loss_jerk: 0.055713340640068054 loss_floor_contact: 0.021892601624131203
[28/100] loss: 0.03677508607506752 loss_joints: 0.002177181886509061 loss_collision: 0.04765619337558746 loss_jerk: 0.05529441684484482 loss_floor_contact: 0.02185077592730522
[29/100] loss: 0.034991078078746796 loss_joints: 0.0015605331864207983 loss_collision: 0.0379057414829731 loss_jerk: 0.05490539222955704 loss_floor_contact: 0.0218727458268404
[30/100] loss: 0.032764971256256104 loss_joints: 0.002385374391451478 loss_collision: 0.015085269697010517 loss_jerk: 0.053714606910943985 loss_floor_contact: 0.02013765648007393
[31/100] loss: 0.0327744297683239 loss_joints: 0.002422609832137823 loss_collision: 0.015902012586593628 loss_jerk: 0.053394615650177 loss_floor_contact: 0.020643090829253197
[32/100] loss: 0.030806515365839005 loss_joints: 0.00033518997952342033 loss_collision: 0.017295340076088905 loss_jerk: 0.05316924303770065 loss_floor_contact: 0.021571697667241096
[33/100] loss: 0.03227446228265762 loss_joints: 0.001485471031628549 loss_collision: 0.02045229636132717 loss_jerk: 0.05326361954212189 loss_floor_contact: 0.021119512617588043
[34/100] loss: 0.03283102065324783 loss_joints: 0.0020034092012792826 loss_collision: 0.021041283383965492 loss_jerk: 0.05330508202314377 loss_floor_contact: 0.02070942521095276
[35/100] loss: 0.0309990793466568 loss_joints: 0.0003326424630358815 loss_collision: 0.02522888034582138 loss_jerk: 0.052281878888607025 loss_floor_contact: 0.020026106387376785
[36/100] loss: 0.03200796991586685 loss_joints: 0.0010798647999763489 loss_collision: 0.03356572240591049 loss_jerk: 0.05113775655627251 loss_floor_contact: 0.02002652920782566
[37/100] loss: 0.03285079449415207 loss_joints: 0.0018421508138999343 loss_collision: 0.03349866345524788 loss_jerk: 0.05131174623966217 loss_floor_contact: 0.02002902515232563
[38/100] loss: 0.030970031395554543 loss_joints: 0.0006776112131774426 loss_collision: 0.026025991886854172 loss_jerk: 0.05148680508136749 loss_floor_contact: 0.01946418173611164
[39/100] loss: 0.030981652438640594 loss_joints: 0.0015983842313289642 loss_collision: 0.015494533814489841 loss_jerk: 0.051777198910713196 loss_floor_contact: 0.019452158361673355
[40/100] loss: 0.03175932168960571 loss_joints: 0.002101853024214506 loss_collision: 0.01341448538005352 loss_jerk: 0.052675798535346985 loss_floor_contact: 0.019781209528446198
[41/100] loss: 0.030446812510490417 loss_joints: 0.0005920623661950231 loss_collision: 0.014766115695238113 loss_jerk: 0.05272824689745903 loss_floor_contact: 0.020140143111348152
[42/100] loss: 0.030050521716475487 loss_joints: 0.0005342338117770851 loss_collision: 0.01695474423468113 loss_jerk: 0.051559485495090485 loss_floor_contact: 0.020410696044564247
[43/100] loss: 0.030542150139808655 loss_joints: 0.0011214736150577664 loss_collision: 0.01603705808520317 loss_jerk: 0.05142569541931152 loss_floor_contact: 0.02104121260344982
[44/100] loss: 0.029466405510902405 loss_joints: 0.0003358703979756683 loss_collision: 0.014383071102201939 loss_jerk: 0.05134573578834534 loss_floor_contact: 0.02019360102713108
[45/100] loss: 0.029574079439044 loss_joints: 0.0005843756953254342 loss_collision: 0.014161563478410244 loss_jerk: 0.051237352192401886 loss_floor_contact: 0.019548704847693443
[46/100] loss: 0.02997390553355217 loss_joints: 0.001226657535880804 loss_collision: 0.015463166870176792 loss_jerk: 0.05049648508429527 loss_floor_contact: 0.01952688954770565
[47/100] loss: 0.02862679213285446 loss_joints: 0.0003294050111435354 loss_collision: 0.014168436639010906 loss_jerk: 0.04985116422176361 loss_floor_contact: 0.01954960823059082
[48/100] loss: 0.028333768248558044 loss_joints: 0.0005501058185473084 loss_collision: 0.013842170126736164 loss_jerk: 0.048876676708459854 loss_floor_contact: 0.019611071795225143
[49/100] loss: 0.028786443173885345 loss_joints: 0.0010945232352241874 loss_collision: 0.016209669411182404 loss_jerk: 0.04821975901722908 loss_floor_contact: 0.019610727205872536
[50/100] loss: 0.02793736383318901 loss_joints: 0.0003751405165530741 loss_collision: 0.01640007644891739 loss_jerk: 0.04792652279138565 loss_floor_contact: 0.019589560106396675
[51/100] loss: 0.027345312759280205 loss_joints: 0.0002594532270450145 loss_collision: 0.012482232414186 loss_jerk: 0.047767847776412964 loss_floor_contact: 0.019537121057510376
[52/100] loss: 0.027505984529852867 loss_joints: 0.0007240119157359004 loss_collision: 0.012373462319374084 loss_jerk: 0.04719363525509834 loss_floor_contact: 0.019478091970086098
[53/100] loss: 0.027013929560780525 loss_joints: 0.00033431604970246553 loss_collision: 0.01127621904015541 loss_jerk: 0.047211650758981705 loss_floor_contact: 0.019461657851934433
[54/100] loss: 0.02675599232316017 loss_joints: 8.163128222804517e-05 loss_collision: 0.014396784827113152 loss_jerk: 0.04657294973731041 loss_floor_contact: 0.019482066854834557
[55/100] loss: 0.027238931506872177 loss_joints: 0.00022399243607651442 loss_collision: 0.01718139462172985 loss_jerk: 0.04670175164937973 loss_floor_contact: 0.01945924200117588
[56/100] loss: 0.026924360543489456 loss_joints: 1.220158810610883e-05 loss_collision: 0.017457138746976852 loss_jerk: 0.046447571367025375 loss_floor_contact: 0.01942659355700016
[57/100] loss: 0.027008701115846634 loss_joints: 0.0005033863708376884 loss_collision: 0.014580491930246353 loss_jerk: 0.04621003940701485 loss_floor_contact: 0.019422445446252823
[58/100] loss: 0.027142489328980446 loss_joints: 0.0007148485165089369 loss_collision: 0.015247706323862076 loss_jerk: 0.04591582342982292 loss_floor_contact: 0.019449586048722267
[59/100] loss: 0.026557086035609245 loss_joints: 0.00036388516309671104 loss_collision: 0.012446178123354912 loss_jerk: 0.045988358557224274 loss_floor_contact: 0.019544050097465515
[60/100] loss: 0.02650492452085018 loss_joints: 0.00010447016393300146 loss_collision: 0.015154163353145123 loss_jerk: 0.045700158923864365 loss_floor_contact: 0.02034957893192768
[61/100] loss: 0.026494650170207024 loss_joints: 0.0001710228098090738 loss_collision: 0.016655156388878822 loss_jerk: 0.045297324657440186 loss_floor_contact: 0.020094500854611397
[62/100] loss: 0.026021946221590042 loss_joints: 0.00017215614207088947 loss_collision: 0.014532212167978287 loss_jerk: 0.04480641335248947 loss_floor_contact: 0.019933616742491722
[63/100] loss: 0.025393467396497726 loss_joints: 1.4964914953452535e-05 loss_collision: 0.012879475951194763 loss_jerk: 0.044212911278009415 loss_floor_contact: 0.019840983673930168
[64/100] loss: 0.025403523817658424 loss_joints: 0.00015557858569081873 loss_collision: 0.012906581163406372 loss_jerk: 0.044032271951436996 loss_floor_contact: 0.019411524757742882
[65/100] loss: 0.025340808555483818 loss_joints: 0.00017728724924381822 loss_collision: 0.015188018791377544 loss_jerk: 0.04340996965765953 loss_floor_contact: 0.019397342577576637
[66/100] loss: 0.02516353316605091 loss_joints: 1.9657307348097675e-05 loss_collision: 0.013505620881915092 loss_jerk: 0.0437152162194252 loss_floor_contact: 0.019357049837708473
[67/100] loss: 0.024860693141818047 loss_joints: 0.00015786010771989822 loss_collision: 0.011611118912696838 loss_jerk: 0.04321964457631111 loss_floor_contact: 0.01931898482143879
[68/100] loss: 0.024773404002189636 loss_joints: 0.0002899603277910501 loss_collision: 0.009732590988278389 loss_jerk: 0.04315773397684097 loss_floor_contact: 0.019313164055347443
[69/100] loss: 0.024575700983405113 loss_joints: 7.372428808594123e-05 loss_collision: 0.009897851385176182 loss_jerk: 0.043156810104846954 loss_floor_contact: 0.019337870180606842
[70/100] loss: 0.0250175092369318 loss_joints: 0.0001829260727390647 loss_collision: 0.011636348441243172 loss_jerk: 0.04336363449692726 loss_floor_contact: 0.019891314208507538
[71/100] loss: 0.025133760645985603 loss_joints: 0.0002758761984296143 loss_collision: 0.012956563383340836 loss_jerk: 0.043118543922901154 loss_floor_contact: 0.02002955600619316
[72/100] loss: 0.024868587031960487 loss_joints: 5.550164496526122e-05 loss_collision: 0.012670840136706829 loss_jerk: 0.043215423822402954 loss_floor_contact: 0.019382892176508904
[73/100] loss: 0.024438362568616867 loss_joints: 0.00011169243953190744 loss_collision: 0.009816218167543411 loss_jerk: 0.042826879769563675 loss_floor_contact: 0.01931608095765114
[74/100] loss: 0.024482984095811844 loss_joints: 0.00022422464098781347 loss_collision: 0.009339559823274612 loss_jerk: 0.042792290449142456 loss_floor_contact: 0.01928657293319702
[75/100] loss: 0.024274881929159164 loss_joints: 0.00010158571967622265 loss_collision: 0.008924784138798714 loss_jerk: 0.042704977095127106 loss_floor_contact: 0.019283294677734375
[76/100] loss: 0.024055534973740578 loss_joints: 6.132869748398662e-05 loss_collision: 0.009320790879428387 loss_jerk: 0.042265187948942184 loss_floor_contact: 0.019295331090688705
[77/100] loss: 0.02412680722773075 loss_joints: 0.00011616462143138051 loss_collision: 0.009826366789638996 loss_jerk: 0.04219549894332886 loss_floor_contact: 0.019302573055028915
[78/100] loss: 0.023833421990275383 loss_joints: 6.693641626043245e-05 loss_collision: 0.008068730123341084 loss_jerk: 0.042060691863298416 loss_floor_contact: 0.019292661920189857
[79/100] loss: 0.02384084276854992 loss_joints: 3.673741957754828e-05 loss_collision: 0.008750570937991142 loss_jerk: 0.04199982061982155 loss_floor_contact: 0.01929137483239174
[80/100] loss: 0.023781096562743187 loss_joints: 7.622614793945104e-05 loss_collision: 0.008860332891345024 loss_jerk: 0.04177911579608917 loss_floor_contact: 0.01929279789328575
[81/100] loss: 0.023723823949694633 loss_joints: 2.0660756490542553e-05 loss_collision: 0.009192400611937046 loss_jerk: 0.04170835763216019 loss_floor_contact: 0.019297445192933083
[82/100] loss: 0.023715028539299965 loss_joints: 1.4209787877916824e-05 loss_collision: 0.00980954896658659 loss_jerk: 0.04158075526356697 loss_floor_contact: 0.019294865429401398
[83/100] loss: 0.023638281971216202 loss_joints: 2.7756683266488835e-05 loss_collision: 0.008964753709733486 loss_jerk: 0.04157210886478424 loss_floor_contact: 0.01927996054291725
[84/100] loss: 0.023704849183559418 loss_joints: 3.355134685989469e-05 loss_collision: 0.009491865523159504 loss_jerk: 0.041590820997953415 loss_floor_contact: 0.01926700584590435
[85/100] loss: 0.02392498217523098 loss_joints: 5.814184987684712e-05 loss_collision: 0.011408163234591484 loss_jerk: 0.041603587567806244 loss_floor_contact: 0.019242294132709503
[86/100] loss: 0.023927653208374977 loss_joints: 7.261997961904854e-05 loss_collision: 0.01225606631487608 loss_jerk: 0.04141424223780632 loss_floor_contact: 0.019223058596253395
[87/100] loss: 0.02366117388010025 loss_joints: 9.079744631890208e-05 loss_collision: 0.010761318728327751 loss_jerk: 0.041144419461488724 loss_floor_contact: 0.01922035589814186
[88/100] loss: 0.02361755073070526 loss_joints: 6.213418237166479e-05 loss_collision: 0.010304881259799004 loss_jerk: 0.04120519384741783 loss_floor_contact: 0.01922331564128399
[89/100] loss: 0.023536279797554016 loss_joints: 2.2674114006804302e-05 loss_collision: 0.009736250154674053 loss_jerk: 0.04123622924089432 loss_floor_contact: 0.01921866275370121
[90/100] loss: 0.02349688671529293 loss_joints: 1.171425810753135e-05 loss_collision: 0.009986700490117073 loss_jerk: 0.041127923876047134 loss_floor_contact: 0.01922539621591568
[91/100] loss: 0.023390522226691246 loss_joints: 3.838445263681933e-05 loss_collision: 0.00922354031354189 loss_jerk: 0.04098773002624512 loss_floor_contact: 0.019359178841114044
[92/100] loss: 0.02338152751326561 loss_joints: 3.502442632452585e-05 loss_collision: 0.009209005162119865 loss_jerk: 0.04098821058869362 loss_floor_contact: 0.019314972683787346
[93/100] loss: 0.023264838382601738 loss_joints: 1.0978477803291753e-05 loss_collision: 0.008726242929697037 loss_jerk: 0.0409172922372818 loss_floor_contact: 0.019225891679525375
[94/100] loss: 0.023320265114307404 loss_joints: 1.68375163411838e-06 loss_collision: 0.00961664505302906 loss_jerk: 0.040869515389204025 loss_floor_contact: 0.0192215908318758
[95/100] loss: 0.023251498118042946 loss_joints: 5.629617589875124e-07 loss_collision: 0.009424049407243729 loss_jerk: 0.0407734178006649 loss_floor_contact: 0.019218219444155693
[96/100] loss: 0.023211492225527763 loss_joints: 3.3094447644543834e-06 loss_collision: 0.009603796526789665 loss_jerk: 0.040652550756931305 loss_floor_contact: 0.019215265288949013
[97/100] loss: 0.023124005645513535 loss_joints: 3.3910177990037482e-06 loss_collision: 0.009227234870195389 loss_jerk: 0.04055234044790268 loss_floor_contact: 0.019217200577259064
[98/100] loss: 0.023172352463006973 loss_joints: 6.333085821097484e-06 loss_collision: 0.009966173209249973 loss_jerk: 0.04049573838710785 loss_floor_contact: 0.019215324893593788
[99/100] loss: 0.023133302107453346 loss_joints: 5.787501322629396e-06 loss_collision: 0.009763267822563648 loss_jerk: 0.04045912250876427 loss_floor_contact: 0.01921626552939415
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk0.5_skate1.0]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 284.34689                                                    ║
    ║     rollout = 129.67855                                                    ║
    ║     sdf     = 14.39294                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.02313330                                                 ║
    ║     joints    = 0.00000579                                                 ║
    ║     collision = 0.00976327                                                 ║
    ║     jerk      = 0.04045912                                                 ║
    ║     floor     = 0.01921627                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m3.509s
user	4m36.664s
sys	0m15.510s
[INFO] Running with collision=0.1, contact=0.1, jerk=1.0, skate=0.1
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:45,  2.89s/it]  2%|▏         | 2/100 [00:05<04:32,  2.78s/it]  3%|▎         | 3/100 [00:08<04:51,  3.01s/it]  4%|▍         | 4/100 [00:11<04:37,  2.89s/it]  5%|▌         | 5/100 [00:14<04:28,  2.82s/it]  6%|▌         | 6/100 [00:17<04:29,  2.87s/it]  7%|▋         | 7/100 [00:19<04:22,  2.83s/it]  8%|▊         | 8/100 [00:22<04:19,  2.82s/it]  9%|▉         | 9/100 [00:25<04:12,  2.78s/it] 10%|█         | 10/100 [00:28<04:07,  2.75s/it] 11%|█         | 11/100 [00:30<04:04,  2.75s/it] 12%|█▏        | 12/100 [00:33<04:00,  2.73s/it] 13%|█▎        | 13/100 [00:36<03:56,  2.72s/it] 14%|█▍        | 14/100 [00:39<03:55,  2.74s/it] 15%|█▌        | 15/100 [00:41<03:53,  2.75s/it] 16%|█▌        | 16/100 [00:44<03:49,  2.74s/it] 17%|█▋        | 17/100 [00:47<03:46,  2.73s/it] 18%|█▊        | 18/100 [00:49<03:43,  2.73s/it] 19%|█▉        | 19/100 [00:52<03:41,  2.73s/it] 20%|██        | 20/100 [00:55<03:40,  2.75s/it] 21%|██        | 21/100 [00:58<03:35,  2.73s/it] 22%|██▏       | 22/100 [01:00<03:33,  2.73s/it] 23%|██▎       | 23/100 [01:03<03:29,  2.73s/it] 24%|██▍       | 24/100 [01:06<03:27,  2.73s/it] 25%|██▌       | 25/100 [01:09<03:25,  2.74s/it] 26%|██▌       | 26/100 [01:11<03:23,  2.76s/it] 27%|██▋       | 27/100 [01:14<03:25,  2.81s/it] 28%|██▊       | 28/100 [01:17<03:26,  2.87s/it] 29%|██▉       | 29/100 [01:20<03:23,  2.86s/it] 30%|███       | 30/100 [01:23<03:20,  2.86s/it] 31%|███       | 31/100 [01:26<03:16,  2.85s/it] 32%|███▏      | 32/100 [01:29<03:12,  2.83s/it] 33%|███▎      | 33/100 [01:32<03:17,  2.94s/it] 34%|███▍      | 34/100 [01:35<03:13,  2.93s/it] 35%|███▌      | 35/100 [01:38<03:08,  2.90s/it] 36%|███▌      | 36/100 [01:41<03:05,  2.89s/it] 37%|███▋      | 37/100 [01:43<02:59,  2.85s/it] 38%|███▊      | 38/100 [01:46<02:54,  2.82s/it] 39%|███▉      | 39/100 [01:49<02:50,  2.80s/it] 40%|████      | 40/100 [01:52<02:50,  2.84s/it] 41%|████      | 41/100 [01:54<02:46,  2.82s/it] 42%|████▏     | 42/100 [01:57<02:44,  2.83s/it] 43%|████▎     | 43/100 [02:00<02:43,  2.86s/it] 44%|████▍     | 44/100 [02:03<02:42,  2.90s/it] 45%|████▌     | 45/100 [02:06<02:39,  2.90s/it] 46%|████▌     | 46/100 [02:09<02:35,  2.88s/it] 47%|████▋     | 47/100 [02:12<02:32,  2.88s/it] 48%|████▊     | 48/100 [02:15<02:30,  2.90s/it] 49%|████▉     | 49/100 [02:18<02:29,  2.94s/it] 50%|█████     | 50/100 [02:21<02:28,  2.96s/it] 51%|█████     | 51/100 [02:24<02:27,  3.00s/it] 52%|█████▏    | 52/100 [02:27<02:24,  3.00s/it] 53%|█████▎    | 53/100 [02:30<02:21,  3.01s/it] 54%|█████▍    | 54/100 [02:33<02:16,  2.97s/it] 55%|█████▌    | 55/100 [02:36<02:11,  2.92s/it] 56%|█████▌    | 56/100 [02:39<02:10,  2.97s/it] 57%|█████▋    | 57/100 [02:42<02:07,  2.97s/it] 58%|█████▊    | 58/100 [02:45<02:04,  2.97s/it] 59%|█████▉    | 59/100 [02:48<02:03,  3.01s/it] 60%|██████    | 60/100 [02:51<02:01,  3.03s/it] 61%|██████    | 61/100 [02:54<01:56,  3.00s/it] 62%|██████▏   | 62/100 [02:57<01:52,  2.97s/it] 63%|██████▎   | 63/100 [02:59<01:48,  2.92s/it] 64%|██████▍   | 64/100 [03:03<01:46,  2.96s/it] 65%|██████▌   | 65/100 [03:05<01:43,  2.95s/it] 66%|██████▌   | 66/100 [03:08<01:39,  2.91s/it] 67%|██████▋   | 67/100 [03:11<01:35,  2.89s/it] 68%|██████▊   | 68/100 [03:14<01:33,  2.92s/it] 69%|██████▉   | 69/100 [03:17<01:29,  2.89s/it] 70%|███████   | 70/100 [03:20<01:25,  2.86s/it] 71%|███████   | 71/100 [03:23<01:22,  2.85s/it] 72%|███████▏  | 72/100 [03:25<01:20,  2.88s/it] 73%|███████▎  | 73/100 [03:28<01:17,  2.86s/it] 74%|███████▍  | 74/100 [03:31<01:14,  2.86s/it] 75%|███████▌  | 75/100 [03:34<01:10,  2.81s/it] 76%|███████▌  | 76/100 [03:37<01:08,  2.86s/it] 77%|███████▋  | 77/100 [03:40<01:05,  2.83s/it] 78%|███████▊  | 78/100 [03:42<01:02,  2.82s/it] 79%|███████▉  | 79/100 [03:45<00:59,  2.86s/it] 80%|████████  | 80/100 [03:48<00:57,  2.87s/it] 81%|████████  | 81/100 [03:51<00:54,  2.85s/it] 82%|████████▏ | 82/100 [03:54<00:51,  2.85s/it] 83%|████████▎ | 83/100 [03:57<00:47,  2.82s/it] 84%|████████▍ | 84/100 [04:00<00:45,  2.84s/it] 85%|████████▌ | 85/100 [04:02<00:41,  2.80s/it] 86%|████████▌ | 86/100 [04:05<00:38,  2.78s/it] 87%|████████▋ | 87/100 [04:08<00:35,  2.76s/it] 88%|████████▊ | 88/100 [04:10<00:33,  2.77s/it] 89%|████████▉ | 89/100 [04:13<00:30,  2.77s/it] 90%|█████████ | 90/100 [04:16<00:27,  2.78s/it] 91%|█████████ | 91/100 [04:19<00:24,  2.75s/it] 92%|█████████▏| 92/100 [04:21<00:21,  2.74s/it] 93%|█████████▎| 93/100 [04:24<00:19,  2.72s/it] 94%|█████████▍| 94/100 [04:27<00:16,  2.69s/it] 95%|█████████▌| 95/100 [04:29<00:13,  2.67s/it] 96%|█████████▌| 96/100 [04:32<00:10,  2.66s/it] 97%|█████████▋| 97/100 [04:35<00:07,  2.66s/it] 98%|█████████▊| 98/100 [04:37<00:05,  2.67s/it] 99%|█████████▉| 99/100 [04:40<00:02,  2.67s/it]100%|██████████| 100/100 [04:43<00:00,  2.65s/it]100%|██████████| 100/100 [04:43<00:00,  2.83s/it]
[0/100] loss: 2.7414534091949463 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.5290708541870117 loss_joints: 2.3897745609283447 loss_collision: 0.1529988944530487 loss_jerk: 0.06971309334039688 loss_floor_contact: 0.5428349375724792
[2/100] loss: 1.8357179164886475 loss_joints: 1.720144510269165 loss_collision: 0.07583892345428467 loss_jerk: 0.06627251207828522 loss_floor_contact: 0.4171707332134247
[3/100] loss: 1.292296051979065 loss_joints: 1.1565842628479004 loss_collision: 0.17005537450313568 loss_jerk: 0.09471084177494049 loss_floor_contact: 0.23995347321033478
[4/100] loss: 0.7809802293777466 loss_joints: 0.6632305383682251 loss_collision: 0.16129431128501892 loss_jerk: 0.0994918942451477 loss_floor_contact: 0.021283792331814766
[5/100] loss: 0.47127556800842285 loss_joints: 0.34317395091056824 loss_collision: 0.32124724984169006 loss_jerk: 0.09383871406316757 loss_floor_contact: 0.0213816836476326
[6/100] loss: 0.230333611369133 loss_joints: 0.12674158811569214 loss_collision: 0.19282770156860352 loss_jerk: 0.0821499302983284 loss_floor_contact: 0.021593153476715088
[7/100] loss: 0.14500056207180023 loss_joints: 0.059507858008146286 loss_collision: 0.02022637613117695 loss_jerk: 0.08127863705158234 loss_floor_contact: 0.021914280951023102
[8/100] loss: 0.1694077104330063 loss_joints: 0.08082723617553711 loss_collision: 0.022704757750034332 loss_jerk: 0.08412382751703262 loss_floor_contact: 0.021861642599105835
[9/100] loss: 0.1636425256729126 loss_joints: 0.06614165008068085 loss_collision: 0.06327789276838303 loss_jerk: 0.08903094381093979 loss_floor_contact: 0.021421249955892563
[10/100] loss: 0.12239640951156616 loss_joints: 0.03691546618938446 loss_collision: 0.014273698441684246 loss_jerk: 0.08195624500513077 loss_floor_contact: 0.020973259583115578
[11/100] loss: 0.11318068206310272 loss_joints: 0.024910470470786095 loss_collision: 0.03951304033398628 loss_jerk: 0.08227670192718506 loss_floor_contact: 0.02042204514145851
[12/100] loss: 0.09985212236642838 loss_joints: 0.012305919080972672 loss_collision: 0.045906875282526016 loss_jerk: 0.08097200095653534 loss_floor_contact: 0.019835153594613075
[13/100] loss: 0.08986154943704605 loss_joints: 0.009086918085813522 loss_collision: 0.03498224541544914 loss_jerk: 0.07534251362085342 loss_floor_contact: 0.01933891884982586
[14/100] loss: 0.09747704118490219 loss_joints: 0.018963603302836418 loss_collision: 0.014822172001004219 loss_jerk: 0.07512761652469635 loss_floor_contact: 0.019036008045077324
[15/100] loss: 0.09758767485618591 loss_joints: 0.019138788804411888 loss_collision: 0.018662314862012863 loss_jerk: 0.07469262927770615 loss_floor_contact: 0.018900254741311073
[16/100] loss: 0.08628173917531967 loss_joints: 0.010626060888171196 loss_collision: 0.02319743111729622 loss_jerk: 0.07145468145608902 loss_floor_contact: 0.01881253719329834
[17/100] loss: 0.07293669879436493 loss_joints: 0.0035074418410658836 loss_collision: 0.030055701732635498 loss_jerk: 0.0645466297864914 loss_floor_contact: 0.018770523369312286
[18/100] loss: 0.07795318216085434 loss_joints: 0.008061712607741356 loss_collision: 0.024097304791212082 loss_jerk: 0.06560973823070526 loss_floor_contact: 0.01872001774609089
[19/100] loss: 0.07968215644359589 loss_joints: 0.010488341562449932 loss_collision: 0.029002700001001358 loss_jerk: 0.06442297995090485 loss_floor_contact: 0.018705662339925766
[20/100] loss: 0.07513377070426941 loss_joints: 0.0078058671206235886 loss_collision: 0.0325276181101799 loss_jerk: 0.062205348163843155 loss_floor_contact: 0.018697943538427353
[21/100] loss: 0.07125768065452576 loss_joints: 0.005559812765568495 loss_collision: 0.03570982441306114 loss_jerk: 0.06025485694408417 loss_floor_contact: 0.018720246851444244
[22/100] loss: 0.0661509782075882 loss_joints: 0.0032788170501589775 loss_collision: 0.03306373581290245 loss_jerk: 0.057695172727108 loss_floor_contact: 0.018706198781728745
[23/100] loss: 0.06607077270746231 loss_joints: 0.0030227885581552982 loss_collision: 0.026584895327687263 loss_jerk: 0.05852803960442543 loss_floor_contact: 0.01861455664038658
[24/100] loss: 0.06664015352725983 loss_joints: 0.005779934115707874 loss_collision: 0.02082718349993229 loss_jerk: 0.05691889300942421 loss_floor_contact: 0.0185860488563776
[25/100] loss: 0.06672560423612595 loss_joints: 0.005681312642991543 loss_collision: 0.01926923729479313 loss_jerk: 0.05724972486495972 loss_floor_contact: 0.01867642067372799
[26/100] loss: 0.06486482173204422 loss_joints: 0.0024380842223763466 loss_collision: 0.019911611452698708 loss_jerk: 0.05855107307434082 loss_floor_contact: 0.018845085054636
[27/100] loss: 0.06219293922185898 loss_joints: 0.0010244317818433046 loss_collision: 0.02081797644495964 loss_jerk: 0.05717848986387253 loss_floor_contact: 0.01908220164477825
[28/100] loss: 0.06177356466650963 loss_joints: 0.001260128105059266 loss_collision: 0.02294115349650383 loss_jerk: 0.05629642680287361 loss_floor_contact: 0.019228925928473473
[29/100] loss: 0.06053024157881737 loss_joints: 0.001575973117724061 loss_collision: 0.022261569276452065 loss_jerk: 0.05479590222239494 loss_floor_contact: 0.019322076812386513
[30/100] loss: 0.05916017293930054 loss_joints: 0.0007825735956430435 loss_collision: 0.022183874621987343 loss_jerk: 0.054226815700531006 loss_floor_contact: 0.019323961809277534
[31/100] loss: 0.05806330218911171 loss_joints: 0.00034843134926632047 loss_collision: 0.021821575239300728 loss_jerk: 0.053606171160936356 loss_floor_contact: 0.019265426322817802
[32/100] loss: 0.05788559466600418 loss_joints: 0.0008584472234360874 loss_collision: 0.019668633118271828 loss_jerk: 0.05312992259860039 loss_floor_contact: 0.019303610548377037
[33/100] loss: 0.05622172728180885 loss_joints: 0.0005687197553925216 loss_collision: 0.017884885892271996 loss_jerk: 0.05192265287041664 loss_floor_contact: 0.019418686628341675
[34/100] loss: 0.05618182569742203 loss_joints: 0.0003337426751386374 loss_collision: 0.020177766680717468 loss_jerk: 0.051878683269023895 loss_floor_contact: 0.019516250118613243
[35/100] loss: 0.05641569197177887 loss_joints: 0.0003119977191090584 loss_collision: 0.022544534876942635 loss_jerk: 0.051887258887290955 loss_floor_contact: 0.019619852304458618
[36/100] loss: 0.05625907704234123 loss_joints: 0.00020386691903695464 loss_collision: 0.02091270498931408 loss_jerk: 0.0519985593855381 loss_floor_contact: 0.01965380646288395
[37/100] loss: 0.05516926571726799 loss_joints: 0.0002593693498056382 loss_collision: 0.019248036667704582 loss_jerk: 0.05102454498410225 loss_floor_contact: 0.019605491310358047
[38/100] loss: 0.054791588336229324 loss_joints: 3.2012874726206064e-05 loss_collision: 0.017011325806379318 loss_jerk: 0.051102157682180405 loss_floor_contact: 0.019562853500247
[39/100] loss: 0.053804170340299606 loss_joints: 8.958960825111717e-05 loss_collision: 0.01642463542521 loss_jerk: 0.05012073367834091 loss_floor_contact: 0.019513849169015884
[40/100] loss: 0.053081728518009186 loss_joints: 0.00040961080230772495 loss_collision: 0.014279407449066639 loss_jerk: 0.04929548129439354 loss_floor_contact: 0.01948697306215763
[41/100] loss: 0.051549315452575684 loss_joints: 0.00014849691069684923 loss_collision: 0.012230313383042812 loss_jerk: 0.048226989805698395 loss_floor_contact: 0.01950795389711857
[42/100] loss: 0.05015387386083603 loss_joints: 0.000169308390468359 loss_collision: 0.011825480498373508 loss_jerk: 0.046852875500917435 loss_floor_contact: 0.019491421058773994
[43/100] loss: 0.050173889845609665 loss_joints: 0.00023781944764778018 loss_collision: 0.013289649970829487 loss_jerk: 0.046664297580718994 loss_floor_contact: 0.019428104162216187
[44/100] loss: 0.049639973789453506 loss_joints: 2.9434193038468948e-06 loss_collision: 0.009449629113078117 loss_jerk: 0.046754058450460434 loss_floor_contact: 0.019380075857043266
[45/100] loss: 0.04971664398908615 loss_joints: 0.0001833403221098706 loss_collision: 0.006241924129426479 loss_jerk: 0.04697619751095772 loss_floor_contact: 0.019329169765114784
[46/100] loss: 0.04892474785447121 loss_joints: 0.00013004014908801764 loss_collision: 0.00593137089163065 loss_jerk: 0.04626854509115219 loss_floor_contact: 0.019330263137817383
[47/100] loss: 0.04856875166296959 loss_joints: 3.539762110449374e-05 loss_collision: 0.005860378500074148 loss_jerk: 0.046015892177820206 loss_floor_contact: 0.01931425929069519
[48/100] loss: 0.04775944724678993 loss_joints: 0.0002437339717289433 loss_collision: 0.002585768699645996 loss_jerk: 0.045329056680202484 loss_floor_contact: 0.01928080804646015
[49/100] loss: 0.04691847413778305 loss_joints: 0.0001400394830852747 loss_collision: 0.002999621909111738 loss_jerk: 0.04455084726214409 loss_floor_contact: 0.01927625574171543
[50/100] loss: 0.04650602117180824 loss_joints: 3.392527287360281e-05 loss_collision: 0.003818023484200239 loss_jerk: 0.04416687414050102 loss_floor_contact: 0.019234206527471542
[51/100] loss: 0.04623610898852348 loss_joints: 0.000321024504955858 loss_collision: 0.0028142333030700684 loss_jerk: 0.04371297359466553 loss_floor_contact: 0.019206875935196877
[52/100] loss: 0.04535418003797531 loss_joints: 0.00027224072255194187 loss_collision: 0.001648272038437426 loss_jerk: 0.042999476194381714 loss_floor_contact: 0.019176358357071877
[53/100] loss: 0.0449533611536026 loss_joints: 9.268143185181543e-05 loss_collision: 0.004214639309793711 loss_jerk: 0.042521703988313675 loss_floor_contact: 0.019175106659531593
[54/100] loss: 0.04491940513253212 loss_joints: 0.00010892340651480481 loss_collision: 0.0062193539924919605 loss_jerk: 0.04227152094244957 loss_floor_contact: 0.019170258194208145
[55/100] loss: 0.04430169239640236 loss_joints: 2.4404011128353886e-05 loss_collision: 0.004650493618100882 loss_jerk: 0.04189614579081535 loss_floor_contact: 0.019160930067300797
[56/100] loss: 0.044535309076309204 loss_joints: 0.0002240045869257301 loss_collision: 0.0030898568220436573 loss_jerk: 0.04208710789680481 loss_floor_contact: 0.019152125343680382
[57/100] loss: 0.044171590358018875 loss_joints: 0.00012154258729424328 loss_collision: 0.0021549612283706665 loss_jerk: 0.04191725328564644 loss_floor_contact: 0.01917300559580326
[58/100] loss: 0.044208332896232605 loss_joints: 0.00012039464490953833 loss_collision: 0.003311655716970563 loss_jerk: 0.04183688759803772 loss_floor_contact: 0.019198831170797348
[59/100] loss: 0.04378565028309822 loss_joints: 0.00017230052617378533 loss_collision: 0.0017711868276819587 loss_jerk: 0.041499897837638855 loss_floor_contact: 0.019363338127732277
[60/100] loss: 0.04368703439831734 loss_joints: 0.00019877930753864348 loss_collision: 0.0021163406781852245 loss_jerk: 0.04133019596338272 loss_floor_contact: 0.01946423202753067
[61/100] loss: 0.04279227927327156 loss_joints: 2.214212690887507e-05 loss_collision: 0.0028525127563625574 loss_jerk: 0.04055418819189072 loss_floor_contact: 0.019306976348161697
[62/100] loss: 0.042311783879995346 loss_joints: 1.2286378478165716e-05 loss_collision: 0.001855956157669425 loss_jerk: 0.04017441347241402 loss_floor_contact: 0.019394855946302414
[63/100] loss: 0.04233688861131668 loss_joints: 0.00013735854008700699 loss_collision: 0.0026366279926151037 loss_jerk: 0.039977505803108215 loss_floor_contact: 0.019583620131015778
[64/100] loss: 0.04225453361868858 loss_joints: 6.175801536301151e-05 loss_collision: 0.002542053582146764 loss_jerk: 0.04001111909747124 loss_floor_contact: 0.01927451603114605
[65/100] loss: 0.042115941643714905 loss_joints: 6.708793807774782e-05 loss_collision: 0.00252207787707448 loss_jerk: 0.039880454540252686 loss_floor_contact: 0.019161943346261978
[66/100] loss: 0.04166814684867859 loss_joints: 7.583681144751608e-05 loss_collision: 0.0026337041053920984 loss_jerk: 0.039412423968315125 loss_floor_contact: 0.019165175035595894
[67/100] loss: 0.04173300787806511 loss_joints: 3.911020030500367e-05 loss_collision: 0.0032550443429499865 loss_jerk: 0.03944849595427513 loss_floor_contact: 0.019199004396796227
[68/100] loss: 0.04179878905415535 loss_joints: 6.0460861277533695e-05 loss_collision: 0.002820899011567235 loss_jerk: 0.039535850286483765 loss_floor_contact: 0.019203878939151764
[69/100] loss: 0.041875842958688736 loss_joints: 4.460827767616138e-05 loss_collision: 0.0036172866821289062 loss_jerk: 0.039551571011543274 loss_floor_contact: 0.019179364666342735
[70/100] loss: 0.04127330332994461 loss_joints: 4.965967309544794e-05 loss_collision: 0.004641286097466946 loss_jerk: 0.038845453411340714 loss_floor_contact: 0.019140634685754776
[71/100] loss: 0.04132474213838577 loss_joints: 0.00029159244149923325 loss_collision: 0.0048461854457855225 loss_jerk: 0.03863830491900444 loss_floor_contact: 0.01910223253071308
[72/100] loss: 0.041404955089092255 loss_joints: 0.0005008308799006045 loss_collision: 0.003546458203345537 loss_jerk: 0.03864104300737381 loss_floor_contact: 0.01908436417579651
[73/100] loss: 0.041013047099113464 loss_joints: 0.0003527387452777475 loss_collision: 0.003021160839125514 loss_jerk: 0.038449034094810486 loss_floor_contact: 0.01909160055220127
[74/100] loss: 0.04073125123977661 loss_joints: 8.636864367872477e-05 loss_collision: 0.0032736111897975206 loss_jerk: 0.038405828177928925 loss_floor_contact: 0.019116932526230812
[75/100] loss: 0.04085583984851837 loss_joints: 6.117158045526594e-05 loss_collision: 0.002303098561242223 loss_jerk: 0.03864974156022072 loss_floor_contact: 0.01914617046713829
[76/100] loss: 0.041137900203466415 loss_joints: 0.00013875258446205407 loss_collision: 0.0024125941563397646 loss_jerk: 0.03884309157729149 loss_floor_contact: 0.019147971644997597
[77/100] loss: 0.041041456162929535 loss_joints: 0.00010277866385877132 loss_collision: 0.0026644121389836073 loss_jerk: 0.038759928196668625 loss_floor_contact: 0.019123073667287827
[78/100] loss: 0.04093603044748306 loss_joints: 4.647248351830058e-05 loss_collision: 0.002778685884550214 loss_jerk: 0.03870384022593498 loss_floor_contact: 0.019078487530350685
[79/100] loss: 0.040731705725193024 loss_joints: 2.603605025797151e-05 loss_collision: 0.002645386615768075 loss_jerk: 0.038536638021469116 loss_floor_contact: 0.0190449096262455
[80/100] loss: 0.04032953083515167 loss_joints: 1.2736461485474138e-06 loss_collision: 0.0032218429259955883 loss_jerk: 0.03810333088040352 loss_floor_contact: 0.019027402624487877
[81/100] loss: 0.04043477773666382 loss_joints: 5.7351986470166594e-05 loss_collision: 0.00236536399461329 loss_jerk: 0.03823928162455559 loss_floor_contact: 0.019016083329916
[82/100] loss: 0.04009910300374031 loss_joints: 6.08032860327512e-05 loss_collision: 0.0037378636188805103 loss_jerk: 0.03776397556066513 loss_floor_contact: 0.01900537870824337
[83/100] loss: 0.03935088962316513 loss_joints: 6.8829772317258175e-06 loss_collision: 0.0035130514297634363 loss_jerk: 0.03709343448281288 loss_floor_contact: 0.018992701545357704
[84/100] loss: 0.03909769281744957 loss_joints: 2.7788082661572844e-05 loss_collision: 0.0023164120502769947 loss_jerk: 0.03694010525941849 loss_floor_contact: 0.0189815703779459
[85/100] loss: 0.03909292444586754 loss_joints: 4.498884663917124e-05 loss_collision: 0.0021365631837397814 loss_jerk: 0.03693656623363495 loss_floor_contact: 0.018977100029587746
[86/100] loss: 0.039123207330703735 loss_joints: 3.368004036019556e-05 loss_collision: 0.0025331212673336267 loss_jerk: 0.036939218640327454 loss_floor_contact: 0.018969977274537086
[87/100] loss: 0.03884589299559593 loss_joints: 1.6315992979798466e-05 loss_collision: 0.0023006366100162268 loss_jerk: 0.03670249134302139 loss_floor_contact: 0.018970221281051636
[88/100] loss: 0.038635458797216415 loss_joints: 1.8952396203530952e-05 loss_collision: 0.002442460972815752 loss_jerk: 0.036474939435720444 loss_floor_contact: 0.01897318847477436
[89/100] loss: 0.038460515439510345 loss_joints: 1.3892826245864853e-05 loss_collision: 0.002482965588569641 loss_jerk: 0.036301400512456894 loss_floor_contact: 0.018969237804412842
[90/100] loss: 0.03828052431344986 loss_joints: 5.188579962123185e-06 loss_collision: 0.0023802518844604492 loss_jerk: 0.0361405611038208 loss_floor_contact: 0.018967488780617714
[91/100] loss: 0.03832055628299713 loss_joints: 2.4605410544609185e-06 loss_collision: 0.0022716273088008165 loss_jerk: 0.03619416803121567 loss_floor_contact: 0.01896764524281025
[92/100] loss: 0.0381956622004509 loss_joints: 1.1180961791978916e-06 loss_collision: 0.002043921034783125 loss_jerk: 0.03609311208128929 loss_floor_contact: 0.01897042617201805
[93/100] loss: 0.038048215210437775 loss_joints: 1.8334566220801207e-06 loss_collision: 0.0019917439203709364 loss_jerk: 0.03594997897744179 loss_floor_contact: 0.018972255289554596
[94/100] loss: 0.03792104497551918 loss_joints: 6.225880497368053e-06 loss_collision: 0.0019578668288886547 loss_jerk: 0.03582179173827171 loss_floor_contact: 0.018972406163811684
[95/100] loss: 0.03777676075696945 loss_joints: 1.681618596194312e-05 loss_collision: 0.001763721345923841 loss_jerk: 0.0356864370405674 loss_floor_contact: 0.018971353769302368
[96/100] loss: 0.03773964196443558 loss_joints: 1.8385875591775402e-05 loss_collision: 0.001798588433302939 loss_jerk: 0.03564469516277313 loss_floor_contact: 0.018967028707265854
[97/100] loss: 0.03772043064236641 loss_joints: 1.217651333718095e-05 loss_collision: 0.0020959244575351477 loss_jerk: 0.03560251370072365 loss_floor_contact: 0.018961479887366295
[98/100] loss: 0.037635914981365204 loss_joints: 5.136249001225224e-06 loss_collision: 0.0019104497041553259 loss_jerk: 0.035544153302907944 loss_floor_contact: 0.01895582303404808
[99/100] loss: 0.0375664196908474 loss_joints: 3.0868518479110207e-06 loss_collision: 0.0019075556192547083 loss_jerk: 0.03547750413417816 loss_floor_contact: 0.01895073428750038
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk1.0_skate0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 283.11927                                                    ║
    ║     rollout = 128.23587                                                    ║
    ║     sdf     = 13.72203                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.03756642                                                 ║
    ║     joints    = 0.00000309                                                 ║
    ║     collision = 0.00190756                                                 ║
    ║     jerk      = 0.03547750                                                 ║
    ║     floor     = 0.01895073                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m2.411s
user	4m37.650s
sys	0m13.974s
[INFO] Running with collision=0.1, contact=0.1, jerk=1.0, skate=0.25
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:28,  2.71s/it]  2%|▏         | 2/100 [00:05<04:17,  2.62s/it]  3%|▎         | 3/100 [00:08<04:35,  2.84s/it]  4%|▍         | 4/100 [00:10<04:23,  2.75s/it]  5%|▌         | 5/100 [00:13<04:15,  2.69s/it]  6%|▌         | 6/100 [00:16<04:16,  2.73s/it]  7%|▋         | 7/100 [00:19<04:12,  2.72s/it]  8%|▊         | 8/100 [00:21<04:07,  2.69s/it]  9%|▉         | 9/100 [00:24<04:03,  2.68s/it] 10%|█         | 10/100 [00:26<03:59,  2.66s/it] 11%|█         | 11/100 [00:29<03:56,  2.66s/it] 12%|█▏        | 12/100 [00:32<03:53,  2.66s/it] 13%|█▎        | 13/100 [00:35<03:53,  2.68s/it] 14%|█▍        | 14/100 [00:37<03:50,  2.69s/it] 15%|█▌        | 15/100 [00:40<03:48,  2.68s/it] 16%|█▌        | 16/100 [00:43<03:47,  2.71s/it] 17%|█▋        | 17/100 [00:45<03:45,  2.72s/it] 18%|█▊        | 18/100 [00:48<03:44,  2.74s/it] 19%|█▉        | 19/100 [00:51<03:40,  2.72s/it] 20%|██        | 20/100 [00:54<03:38,  2.74s/it] 21%|██        | 21/100 [00:56<03:35,  2.73s/it] 22%|██▏       | 22/100 [00:59<03:31,  2.71s/it] 23%|██▎       | 23/100 [01:02<03:27,  2.69s/it] 24%|██▍       | 24/100 [01:04<03:23,  2.68s/it] 25%|██▌       | 25/100 [01:07<03:21,  2.69s/it] 26%|██▌       | 26/100 [01:10<03:19,  2.69s/it] 27%|██▋       | 27/100 [01:13<03:18,  2.72s/it] 28%|██▊       | 28/100 [01:15<03:16,  2.73s/it] 29%|██▉       | 29/100 [01:18<03:13,  2.73s/it] 30%|███       | 30/100 [01:21<03:10,  2.72s/it] 31%|███       | 31/100 [01:23<03:07,  2.71s/it] 32%|███▏      | 32/100 [01:26<03:03,  2.70s/it] 33%|███▎      | 33/100 [01:29<03:02,  2.72s/it] 34%|███▍      | 34/100 [01:31<02:58,  2.70s/it] 35%|███▌      | 35/100 [01:34<02:55,  2.71s/it] 36%|███▌      | 36/100 [01:37<02:52,  2.69s/it] 37%|███▋      | 37/100 [01:40<02:49,  2.69s/it] 38%|███▊      | 38/100 [01:42<02:46,  2.68s/it] 39%|███▉      | 39/100 [01:45<02:43,  2.67s/it] 40%|████      | 40/100 [01:47<02:39,  2.66s/it] 41%|████      | 41/100 [01:50<02:37,  2.66s/it] 42%|████▏     | 42/100 [01:53<02:34,  2.67s/it] 43%|████▎     | 43/100 [01:55<02:31,  2.66s/it] 44%|████▍     | 44/100 [01:58<02:32,  2.72s/it] 45%|████▌     | 45/100 [02:01<02:29,  2.73s/it] 46%|████▌     | 46/100 [02:04<02:27,  2.72s/it] 47%|████▋     | 47/100 [02:06<02:23,  2.70s/it] 48%|████▊     | 48/100 [02:09<02:19,  2.68s/it] 49%|████▉     | 49/100 [02:12<02:16,  2.68s/it] 50%|█████     | 50/100 [02:14<02:13,  2.68s/it] 51%|█████     | 51/100 [02:17<02:10,  2.67s/it] 52%|█████▏    | 52/100 [02:20<02:08,  2.67s/it] 53%|█████▎    | 53/100 [02:22<02:05,  2.67s/it] 54%|█████▍    | 54/100 [02:25<02:04,  2.70s/it] 55%|█████▌    | 55/100 [02:28<02:00,  2.68s/it] 56%|█████▌    | 56/100 [02:31<01:59,  2.72s/it] 57%|█████▋    | 57/100 [02:33<01:57,  2.73s/it] 58%|█████▊    | 58/100 [02:36<01:55,  2.74s/it] 59%|█████▉    | 59/100 [02:39<01:52,  2.74s/it] 60%|██████    | 60/100 [02:42<01:50,  2.75s/it] 61%|██████    | 61/100 [02:44<01:46,  2.72s/it] 62%|██████▏   | 62/100 [02:47<01:42,  2.69s/it] 63%|██████▎   | 63/100 [02:50<01:40,  2.71s/it] 64%|██████▍   | 64/100 [02:52<01:37,  2.71s/it] 65%|██████▌   | 65/100 [02:55<01:34,  2.69s/it] 66%|██████▌   | 66/100 [02:58<01:31,  2.69s/it] 67%|██████▋   | 67/100 [03:00<01:29,  2.70s/it] 68%|██████▊   | 68/100 [03:03<01:26,  2.69s/it] 69%|██████▉   | 69/100 [03:06<01:23,  2.68s/it] 70%|███████   | 70/100 [03:09<01:21,  2.73s/it] 71%|███████   | 71/100 [03:11<01:20,  2.76s/it] 72%|███████▏  | 72/100 [03:14<01:19,  2.84s/it] 73%|███████▎  | 73/100 [03:17<01:17,  2.87s/it] 74%|███████▍  | 74/100 [03:20<01:14,  2.85s/it] 75%|███████▌  | 75/100 [03:23<01:10,  2.82s/it] 76%|███████▌  | 76/100 [03:26<01:07,  2.80s/it] 77%|███████▋  | 77/100 [03:29<01:05,  2.83s/it] 78%|███████▊  | 78/100 [03:31<01:01,  2.80s/it] 79%|███████▉  | 79/100 [03:34<00:58,  2.79s/it] 80%|████████  | 80/100 [03:37<00:55,  2.79s/it] 81%|████████  | 81/100 [03:40<00:52,  2.79s/it] 82%|████████▏ | 82/100 [03:43<00:50,  2.81s/it] 83%|████████▎ | 83/100 [03:45<00:47,  2.82s/it] 84%|████████▍ | 84/100 [03:48<00:45,  2.84s/it] 85%|████████▌ | 85/100 [03:51<00:42,  2.80s/it] 86%|████████▌ | 86/100 [03:54<00:39,  2.82s/it] 87%|████████▋ | 87/100 [03:57<00:36,  2.84s/it] 88%|████████▊ | 88/100 [04:00<00:34,  2.84s/it] 89%|████████▉ | 89/100 [04:02<00:31,  2.85s/it] 90%|█████████ | 90/100 [04:05<00:28,  2.87s/it] 91%|█████████ | 91/100 [04:08<00:25,  2.84s/it] 92%|█████████▏| 92/100 [04:11<00:22,  2.81s/it] 93%|█████████▎| 93/100 [04:14<00:19,  2.83s/it] 94%|█████████▍| 94/100 [04:17<00:16,  2.83s/it] 95%|█████████▌| 95/100 [04:19<00:14,  2.81s/it] 96%|█████████▌| 96/100 [04:22<00:11,  2.79s/it] 97%|█████████▋| 97/100 [04:25<00:08,  2.82s/it] 98%|█████████▊| 98/100 [04:28<00:05,  2.83s/it] 99%|█████████▉| 99/100 [04:31<00:02,  2.86s/it]100%|██████████| 100/100 [04:34<00:00,  2.89s/it]100%|██████████| 100/100 [04:34<00:00,  2.74s/it]
[0/100] loss: 2.7414534091949463 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.5290708541870117 loss_joints: 2.3897745609283447 loss_collision: 0.1529988944530487 loss_jerk: 0.06971309334039688 loss_floor_contact: 0.5428349375724792
[2/100] loss: 1.8357179164886475 loss_joints: 1.720144510269165 loss_collision: 0.07583892345428467 loss_jerk: 0.06627251207828522 loss_floor_contact: 0.4171707332134247
[3/100] loss: 1.292296051979065 loss_joints: 1.1565842628479004 loss_collision: 0.17005537450313568 loss_jerk: 0.09471084177494049 loss_floor_contact: 0.23995347321033478
[4/100] loss: 0.7809802293777466 loss_joints: 0.6632305383682251 loss_collision: 0.16129431128501892 loss_jerk: 0.0994918942451477 loss_floor_contact: 0.021283792331814766
[5/100] loss: 0.47127556800842285 loss_joints: 0.34317395091056824 loss_collision: 0.32124724984169006 loss_jerk: 0.09383871406316757 loss_floor_contact: 0.0213816836476326
[6/100] loss: 0.230333611369133 loss_joints: 0.12674158811569214 loss_collision: 0.19282770156860352 loss_jerk: 0.0821499302983284 loss_floor_contact: 0.021593153476715088
[7/100] loss: 0.14500056207180023 loss_joints: 0.059507858008146286 loss_collision: 0.02022637613117695 loss_jerk: 0.08127863705158234 loss_floor_contact: 0.021914280951023102
[8/100] loss: 0.1694077104330063 loss_joints: 0.08082723617553711 loss_collision: 0.022704757750034332 loss_jerk: 0.08412382751703262 loss_floor_contact: 0.021861642599105835
[9/100] loss: 0.1636425256729126 loss_joints: 0.06614165008068085 loss_collision: 0.06327789276838303 loss_jerk: 0.08903094381093979 loss_floor_contact: 0.021421249955892563
[10/100] loss: 0.12239640951156616 loss_joints: 0.03691546618938446 loss_collision: 0.014273698441684246 loss_jerk: 0.08195624500513077 loss_floor_contact: 0.020973259583115578
[11/100] loss: 0.11318068206310272 loss_joints: 0.024910470470786095 loss_collision: 0.03951304033398628 loss_jerk: 0.08227670192718506 loss_floor_contact: 0.02042204514145851
[12/100] loss: 0.09985212236642838 loss_joints: 0.012305919080972672 loss_collision: 0.045906875282526016 loss_jerk: 0.08097200095653534 loss_floor_contact: 0.019835153594613075
[13/100] loss: 0.08986154943704605 loss_joints: 0.009086918085813522 loss_collision: 0.03498224541544914 loss_jerk: 0.07534251362085342 loss_floor_contact: 0.01933891884982586
[14/100] loss: 0.09747704118490219 loss_joints: 0.018963603302836418 loss_collision: 0.014822172001004219 loss_jerk: 0.07512761652469635 loss_floor_contact: 0.019036008045077324
[15/100] loss: 0.09758767485618591 loss_joints: 0.019138788804411888 loss_collision: 0.018662314862012863 loss_jerk: 0.07469262927770615 loss_floor_contact: 0.018900254741311073
[16/100] loss: 0.08628173917531967 loss_joints: 0.010626060888171196 loss_collision: 0.02319743111729622 loss_jerk: 0.07145468145608902 loss_floor_contact: 0.01881253719329834
[17/100] loss: 0.07293669879436493 loss_joints: 0.0035074418410658836 loss_collision: 0.030055701732635498 loss_jerk: 0.0645466297864914 loss_floor_contact: 0.018770523369312286
[18/100] loss: 0.07795318216085434 loss_joints: 0.008061712607741356 loss_collision: 0.024097304791212082 loss_jerk: 0.06560973823070526 loss_floor_contact: 0.01872001774609089
[19/100] loss: 0.07968215644359589 loss_joints: 0.010488341562449932 loss_collision: 0.029002700001001358 loss_jerk: 0.06442297995090485 loss_floor_contact: 0.018705662339925766
[20/100] loss: 0.07513377070426941 loss_joints: 0.0078058671206235886 loss_collision: 0.0325276181101799 loss_jerk: 0.062205348163843155 loss_floor_contact: 0.018697943538427353
[21/100] loss: 0.07125768065452576 loss_joints: 0.005559812765568495 loss_collision: 0.03570982441306114 loss_jerk: 0.06025485694408417 loss_floor_contact: 0.018720246851444244
[22/100] loss: 0.0661509782075882 loss_joints: 0.0032788170501589775 loss_collision: 0.03306373581290245 loss_jerk: 0.057695172727108 loss_floor_contact: 0.018706198781728745
[23/100] loss: 0.06607077270746231 loss_joints: 0.0030227885581552982 loss_collision: 0.026584895327687263 loss_jerk: 0.05852803960442543 loss_floor_contact: 0.01861455664038658
[24/100] loss: 0.06664015352725983 loss_joints: 0.005779934115707874 loss_collision: 0.02082718349993229 loss_jerk: 0.05691889300942421 loss_floor_contact: 0.0185860488563776
[25/100] loss: 0.06672560423612595 loss_joints: 0.005681312642991543 loss_collision: 0.01926923729479313 loss_jerk: 0.05724972486495972 loss_floor_contact: 0.01867642067372799
[26/100] loss: 0.06486482173204422 loss_joints: 0.0024380842223763466 loss_collision: 0.019911611452698708 loss_jerk: 0.05855107307434082 loss_floor_contact: 0.018845085054636
[27/100] loss: 0.06219293922185898 loss_joints: 0.0010244317818433046 loss_collision: 0.02081797644495964 loss_jerk: 0.05717848986387253 loss_floor_contact: 0.01908220164477825
[28/100] loss: 0.06177356466650963 loss_joints: 0.001260128105059266 loss_collision: 0.02294115349650383 loss_jerk: 0.05629642680287361 loss_floor_contact: 0.019228925928473473
[29/100] loss: 0.06053024157881737 loss_joints: 0.001575973117724061 loss_collision: 0.022261569276452065 loss_jerk: 0.05479590222239494 loss_floor_contact: 0.019322076812386513
[30/100] loss: 0.05916017293930054 loss_joints: 0.0007825735956430435 loss_collision: 0.022183874621987343 loss_jerk: 0.054226815700531006 loss_floor_contact: 0.019323961809277534
[31/100] loss: 0.05806330218911171 loss_joints: 0.00034843134926632047 loss_collision: 0.021821575239300728 loss_jerk: 0.053606171160936356 loss_floor_contact: 0.019265426322817802
[32/100] loss: 0.05788559466600418 loss_joints: 0.0008584472234360874 loss_collision: 0.019668633118271828 loss_jerk: 0.05312992259860039 loss_floor_contact: 0.019303610548377037
[33/100] loss: 0.05622172728180885 loss_joints: 0.0005687197553925216 loss_collision: 0.017884885892271996 loss_jerk: 0.05192265287041664 loss_floor_contact: 0.019418686628341675
[34/100] loss: 0.05618182569742203 loss_joints: 0.0003337426751386374 loss_collision: 0.020177766680717468 loss_jerk: 0.051878683269023895 loss_floor_contact: 0.019516250118613243
[35/100] loss: 0.05641569197177887 loss_joints: 0.0003119977191090584 loss_collision: 0.022544534876942635 loss_jerk: 0.051887258887290955 loss_floor_contact: 0.019619852304458618
[36/100] loss: 0.05625907704234123 loss_joints: 0.00020386691903695464 loss_collision: 0.02091270498931408 loss_jerk: 0.0519985593855381 loss_floor_contact: 0.01965380646288395
[37/100] loss: 0.05516926571726799 loss_joints: 0.0002593693498056382 loss_collision: 0.019248036667704582 loss_jerk: 0.05102454498410225 loss_floor_contact: 0.019605491310358047
[38/100] loss: 0.054791588336229324 loss_joints: 3.2012874726206064e-05 loss_collision: 0.017011325806379318 loss_jerk: 0.051102157682180405 loss_floor_contact: 0.019562853500247
[39/100] loss: 0.053804170340299606 loss_joints: 8.958960825111717e-05 loss_collision: 0.01642463542521 loss_jerk: 0.05012073367834091 loss_floor_contact: 0.019513849169015884
[40/100] loss: 0.053081728518009186 loss_joints: 0.00040961080230772495 loss_collision: 0.014279407449066639 loss_jerk: 0.04929548129439354 loss_floor_contact: 0.01948697306215763
[41/100] loss: 0.051549315452575684 loss_joints: 0.00014849691069684923 loss_collision: 0.012230313383042812 loss_jerk: 0.048226989805698395 loss_floor_contact: 0.01950795389711857
[42/100] loss: 0.05015387386083603 loss_joints: 0.000169308390468359 loss_collision: 0.011825480498373508 loss_jerk: 0.046852875500917435 loss_floor_contact: 0.019491421058773994
[43/100] loss: 0.050173889845609665 loss_joints: 0.00023781944764778018 loss_collision: 0.013289649970829487 loss_jerk: 0.046664297580718994 loss_floor_contact: 0.019428104162216187
[44/100] loss: 0.049639973789453506 loss_joints: 2.9434193038468948e-06 loss_collision: 0.009449629113078117 loss_jerk: 0.046754058450460434 loss_floor_contact: 0.019380075857043266
[45/100] loss: 0.04971664398908615 loss_joints: 0.0001833403221098706 loss_collision: 0.006241924129426479 loss_jerk: 0.04697619751095772 loss_floor_contact: 0.019329169765114784
[46/100] loss: 0.04892474785447121 loss_joints: 0.00013004014908801764 loss_collision: 0.00593137089163065 loss_jerk: 0.04626854509115219 loss_floor_contact: 0.019330263137817383
[47/100] loss: 0.04856875166296959 loss_joints: 3.539762110449374e-05 loss_collision: 0.005860378500074148 loss_jerk: 0.046015892177820206 loss_floor_contact: 0.01931425929069519
[48/100] loss: 0.04775944724678993 loss_joints: 0.0002437339717289433 loss_collision: 0.002585768699645996 loss_jerk: 0.045329056680202484 loss_floor_contact: 0.01928080804646015
[49/100] loss: 0.04691847413778305 loss_joints: 0.0001400394830852747 loss_collision: 0.002999621909111738 loss_jerk: 0.04455084726214409 loss_floor_contact: 0.01927625574171543
[50/100] loss: 0.04650602117180824 loss_joints: 3.392527287360281e-05 loss_collision: 0.003818023484200239 loss_jerk: 0.04416687414050102 loss_floor_contact: 0.019234206527471542
[51/100] loss: 0.04623610898852348 loss_joints: 0.000321024504955858 loss_collision: 0.0028142333030700684 loss_jerk: 0.04371297359466553 loss_floor_contact: 0.019206875935196877
[52/100] loss: 0.04535418003797531 loss_joints: 0.00027224072255194187 loss_collision: 0.001648272038437426 loss_jerk: 0.042999476194381714 loss_floor_contact: 0.019176358357071877
[53/100] loss: 0.0449533611536026 loss_joints: 9.268143185181543e-05 loss_collision: 0.004214639309793711 loss_jerk: 0.042521703988313675 loss_floor_contact: 0.019175106659531593
[54/100] loss: 0.04491940513253212 loss_joints: 0.00010892340651480481 loss_collision: 0.0062193539924919605 loss_jerk: 0.04227152094244957 loss_floor_contact: 0.019170258194208145
[55/100] loss: 0.04430169239640236 loss_joints: 2.4404011128353886e-05 loss_collision: 0.004650493618100882 loss_jerk: 0.04189614579081535 loss_floor_contact: 0.019160930067300797
[56/100] loss: 0.044535309076309204 loss_joints: 0.0002240045869257301 loss_collision: 0.0030898568220436573 loss_jerk: 0.04208710789680481 loss_floor_contact: 0.019152125343680382
[57/100] loss: 0.044171590358018875 loss_joints: 0.00012154258729424328 loss_collision: 0.0021549612283706665 loss_jerk: 0.04191725328564644 loss_floor_contact: 0.01917300559580326
[58/100] loss: 0.044208332896232605 loss_joints: 0.00012039464490953833 loss_collision: 0.003311655716970563 loss_jerk: 0.04183688759803772 loss_floor_contact: 0.019198831170797348
[59/100] loss: 0.04378565028309822 loss_joints: 0.00017230052617378533 loss_collision: 0.0017711868276819587 loss_jerk: 0.041499897837638855 loss_floor_contact: 0.019363338127732277
[60/100] loss: 0.04368703439831734 loss_joints: 0.00019877930753864348 loss_collision: 0.0021163406781852245 loss_jerk: 0.04133019596338272 loss_floor_contact: 0.01946423202753067
[61/100] loss: 0.04279227927327156 loss_joints: 2.214212690887507e-05 loss_collision: 0.0028525127563625574 loss_jerk: 0.04055418819189072 loss_floor_contact: 0.019306976348161697
[62/100] loss: 0.042311783879995346 loss_joints: 1.2286378478165716e-05 loss_collision: 0.001855956157669425 loss_jerk: 0.04017441347241402 loss_floor_contact: 0.019394855946302414
[63/100] loss: 0.04233688861131668 loss_joints: 0.00013735854008700699 loss_collision: 0.0026366279926151037 loss_jerk: 0.039977505803108215 loss_floor_contact: 0.019583620131015778
[64/100] loss: 0.04225453361868858 loss_joints: 6.175801536301151e-05 loss_collision: 0.002542053582146764 loss_jerk: 0.04001111909747124 loss_floor_contact: 0.01927451603114605
[65/100] loss: 0.042115941643714905 loss_joints: 6.708793807774782e-05 loss_collision: 0.00252207787707448 loss_jerk: 0.039880454540252686 loss_floor_contact: 0.019161943346261978
[66/100] loss: 0.04166814684867859 loss_joints: 7.583681144751608e-05 loss_collision: 0.0026337041053920984 loss_jerk: 0.039412423968315125 loss_floor_contact: 0.019165175035595894
[67/100] loss: 0.04173300787806511 loss_joints: 3.911020030500367e-05 loss_collision: 0.0032550443429499865 loss_jerk: 0.03944849595427513 loss_floor_contact: 0.019199004396796227
[68/100] loss: 0.04179878905415535 loss_joints: 6.0460861277533695e-05 loss_collision: 0.002820899011567235 loss_jerk: 0.039535850286483765 loss_floor_contact: 0.019203878939151764
[69/100] loss: 0.041875842958688736 loss_joints: 4.460827767616138e-05 loss_collision: 0.0036172866821289062 loss_jerk: 0.039551571011543274 loss_floor_contact: 0.019179364666342735
[70/100] loss: 0.04127330332994461 loss_joints: 4.965967309544794e-05 loss_collision: 0.004641286097466946 loss_jerk: 0.038845453411340714 loss_floor_contact: 0.019140634685754776
[71/100] loss: 0.04132474213838577 loss_joints: 0.00029159244149923325 loss_collision: 0.0048461854457855225 loss_jerk: 0.03863830491900444 loss_floor_contact: 0.01910223253071308
[72/100] loss: 0.041404955089092255 loss_joints: 0.0005008308799006045 loss_collision: 0.003546458203345537 loss_jerk: 0.03864104300737381 loss_floor_contact: 0.01908436417579651
[73/100] loss: 0.041013047099113464 loss_joints: 0.0003527387452777475 loss_collision: 0.003021160839125514 loss_jerk: 0.038449034094810486 loss_floor_contact: 0.01909160055220127
[74/100] loss: 0.04073125123977661 loss_joints: 8.636864367872477e-05 loss_collision: 0.0032736111897975206 loss_jerk: 0.038405828177928925 loss_floor_contact: 0.019116932526230812
[75/100] loss: 0.04085583984851837 loss_joints: 6.117158045526594e-05 loss_collision: 0.002303098561242223 loss_jerk: 0.03864974156022072 loss_floor_contact: 0.01914617046713829
[76/100] loss: 0.041137900203466415 loss_joints: 0.00013875258446205407 loss_collision: 0.0024125941563397646 loss_jerk: 0.03884309157729149 loss_floor_contact: 0.019147971644997597
[77/100] loss: 0.041041456162929535 loss_joints: 0.00010277866385877132 loss_collision: 0.0026644121389836073 loss_jerk: 0.038759928196668625 loss_floor_contact: 0.019123073667287827
[78/100] loss: 0.04093603044748306 loss_joints: 4.647248351830058e-05 loss_collision: 0.002778685884550214 loss_jerk: 0.03870384022593498 loss_floor_contact: 0.019078487530350685
[79/100] loss: 0.040731705725193024 loss_joints: 2.603605025797151e-05 loss_collision: 0.002645386615768075 loss_jerk: 0.038536638021469116 loss_floor_contact: 0.0190449096262455
[80/100] loss: 0.04032953083515167 loss_joints: 1.2736461485474138e-06 loss_collision: 0.0032218429259955883 loss_jerk: 0.03810333088040352 loss_floor_contact: 0.019027402624487877
[81/100] loss: 0.04043477773666382 loss_joints: 5.7351986470166594e-05 loss_collision: 0.00236536399461329 loss_jerk: 0.03823928162455559 loss_floor_contact: 0.019016083329916
[82/100] loss: 0.04009910300374031 loss_joints: 6.08032860327512e-05 loss_collision: 0.0037378636188805103 loss_jerk: 0.03776397556066513 loss_floor_contact: 0.01900537870824337
[83/100] loss: 0.03935088962316513 loss_joints: 6.8829772317258175e-06 loss_collision: 0.0035130514297634363 loss_jerk: 0.03709343448281288 loss_floor_contact: 0.018992701545357704
[84/100] loss: 0.03909769281744957 loss_joints: 2.7788082661572844e-05 loss_collision: 0.0023164120502769947 loss_jerk: 0.03694010525941849 loss_floor_contact: 0.0189815703779459
[85/100] loss: 0.03909292444586754 loss_joints: 4.498884663917124e-05 loss_collision: 0.0021365631837397814 loss_jerk: 0.03693656623363495 loss_floor_contact: 0.018977100029587746
[86/100] loss: 0.039123207330703735 loss_joints: 3.368004036019556e-05 loss_collision: 0.0025331212673336267 loss_jerk: 0.036939218640327454 loss_floor_contact: 0.018969977274537086
[87/100] loss: 0.03884589299559593 loss_joints: 1.6315992979798466e-05 loss_collision: 0.0023006366100162268 loss_jerk: 0.03670249134302139 loss_floor_contact: 0.018970221281051636
[88/100] loss: 0.038635458797216415 loss_joints: 1.8952396203530952e-05 loss_collision: 0.002442460972815752 loss_jerk: 0.036474939435720444 loss_floor_contact: 0.01897318847477436
[89/100] loss: 0.038460515439510345 loss_joints: 1.3892826245864853e-05 loss_collision: 0.002482965588569641 loss_jerk: 0.036301400512456894 loss_floor_contact: 0.018969237804412842
[90/100] loss: 0.03828052431344986 loss_joints: 5.188579962123185e-06 loss_collision: 0.0023802518844604492 loss_jerk: 0.0361405611038208 loss_floor_contact: 0.018967488780617714
[91/100] loss: 0.03832055628299713 loss_joints: 2.4605410544609185e-06 loss_collision: 0.0022716273088008165 loss_jerk: 0.03619416803121567 loss_floor_contact: 0.01896764524281025
[92/100] loss: 0.0381956622004509 loss_joints: 1.1180961791978916e-06 loss_collision: 0.002043921034783125 loss_jerk: 0.03609311208128929 loss_floor_contact: 0.01897042617201805
[93/100] loss: 0.038048215210437775 loss_joints: 1.8334566220801207e-06 loss_collision: 0.0019917439203709364 loss_jerk: 0.03594997897744179 loss_floor_contact: 0.018972255289554596
[94/100] loss: 0.03792104497551918 loss_joints: 6.225880497368053e-06 loss_collision: 0.0019578668288886547 loss_jerk: 0.03582179173827171 loss_floor_contact: 0.018972406163811684
[95/100] loss: 0.03777676075696945 loss_joints: 1.681618596194312e-05 loss_collision: 0.001763721345923841 loss_jerk: 0.0356864370405674 loss_floor_contact: 0.018971353769302368
[96/100] loss: 0.03773964196443558 loss_joints: 1.8385875591775402e-05 loss_collision: 0.001798588433302939 loss_jerk: 0.03564469516277313 loss_floor_contact: 0.018967028707265854
[97/100] loss: 0.03772043064236641 loss_joints: 1.217651333718095e-05 loss_collision: 0.0020959244575351477 loss_jerk: 0.03560251370072365 loss_floor_contact: 0.018961479887366295
[98/100] loss: 0.037635914981365204 loss_joints: 5.136249001225224e-06 loss_collision: 0.0019104497041553259 loss_jerk: 0.035544153302907944 loss_floor_contact: 0.01895582303404808
[99/100] loss: 0.0375664196908474 loss_joints: 3.0868518479110207e-06 loss_collision: 0.0019075556192547083 loss_jerk: 0.03547750413417816 loss_floor_contact: 0.01895073428750038
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk1.0_skate0.25]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 274.23029                                                    ║
    ║     rollout = 122.30994                                                    ║
    ║     sdf     = 12.62313                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.03756642                                                 ║
    ║     joints    = 0.00000309                                                 ║
    ║     collision = 0.00190756                                                 ║
    ║     jerk      = 0.03547750                                                 ║
    ║     floor     = 0.01895073                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	4m51.978s
user	4m32.891s
sys	0m12.731s
[INFO] Running with collision=0.1, contact=0.1, jerk=1.0, skate=0.5
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:47,  2.90s/it]  2%|▏         | 2/100 [00:05<04:34,  2.80s/it]  3%|▎         | 3/100 [00:08<04:49,  2.99s/it]  4%|▍         | 4/100 [00:11<04:32,  2.83s/it]  5%|▌         | 5/100 [00:14<04:26,  2.80s/it]  6%|▌         | 6/100 [00:17<04:28,  2.86s/it]  7%|▋         | 7/100 [00:19<04:20,  2.80s/it]  8%|▊         | 8/100 [00:22<04:18,  2.81s/it]  9%|▉         | 9/100 [00:25<04:16,  2.82s/it] 10%|█         | 10/100 [00:28<04:17,  2.86s/it] 11%|█         | 11/100 [00:31<04:12,  2.84s/it] 12%|█▏        | 12/100 [00:34<04:08,  2.82s/it] 13%|█▎        | 13/100 [00:36<04:07,  2.84s/it] 14%|█▍        | 14/100 [00:39<04:08,  2.89s/it] 15%|█▌        | 15/100 [00:42<04:06,  2.90s/it] 16%|█▌        | 16/100 [00:45<04:03,  2.90s/it] 17%|█▋        | 17/100 [00:48<04:02,  2.92s/it] 18%|█▊        | 18/100 [00:51<03:58,  2.90s/it] 19%|█▉        | 19/100 [00:54<03:53,  2.88s/it] 20%|██        | 20/100 [00:57<03:52,  2.91s/it] 21%|██        | 21/100 [01:00<03:51,  2.93s/it] 22%|██▏       | 22/100 [01:03<03:47,  2.92s/it] 23%|██▎       | 23/100 [01:06<03:42,  2.89s/it] 24%|██▍       | 24/100 [01:08<03:36,  2.85s/it] 25%|██▌       | 25/100 [01:11<03:32,  2.84s/it] 26%|██▌       | 26/100 [01:14<03:28,  2.81s/it] 27%|██▋       | 27/100 [01:17<03:24,  2.80s/it] 28%|██▊       | 28/100 [01:19<03:21,  2.81s/it] 29%|██▉       | 29/100 [01:22<03:20,  2.83s/it] 30%|███       | 30/100 [01:25<03:16,  2.80s/it] 31%|███       | 31/100 [01:28<03:13,  2.80s/it] 32%|███▏      | 32/100 [01:31<03:10,  2.81s/it] 33%|███▎      | 33/100 [01:34<03:13,  2.88s/it] 34%|███▍      | 34/100 [01:37<03:10,  2.88s/it] 35%|███▌      | 35/100 [01:40<03:07,  2.89s/it] 36%|███▌      | 36/100 [01:42<03:02,  2.85s/it] 37%|███▋      | 37/100 [01:45<02:58,  2.84s/it] 38%|███▊      | 38/100 [01:48<02:55,  2.83s/it] 39%|███▉      | 39/100 [01:51<02:53,  2.85s/it] 40%|████      | 40/100 [01:54<02:50,  2.85s/it] 41%|████      | 41/100 [01:57<02:47,  2.84s/it] 42%|████▏     | 42/100 [01:59<02:44,  2.83s/it] 43%|████▎     | 43/100 [02:02<02:42,  2.85s/it] 44%|████▍     | 44/100 [02:05<02:40,  2.86s/it] 45%|████▌     | 45/100 [02:08<02:34,  2.81s/it] 46%|████▌     | 46/100 [02:10<02:29,  2.76s/it] 47%|████▋     | 47/100 [02:13<02:23,  2.71s/it] 48%|████▊     | 48/100 [02:16<02:19,  2.68s/it] 49%|████▉     | 49/100 [02:18<02:15,  2.66s/it] 50%|█████     | 50/100 [02:21<02:11,  2.62s/it] 51%|█████     | 51/100 [02:23<02:09,  2.64s/it] 52%|█████▏    | 52/100 [02:26<02:06,  2.63s/it] 53%|█████▎    | 53/100 [02:29<02:03,  2.62s/it] 54%|█████▍    | 54/100 [02:31<02:00,  2.62s/it] 55%|█████▌    | 55/100 [02:34<01:58,  2.64s/it] 56%|█████▌    | 56/100 [02:37<01:54,  2.61s/it] 57%|█████▋    | 57/100 [02:39<01:53,  2.64s/it] 58%|█████▊    | 58/100 [02:42<01:50,  2.63s/it] 59%|█████▉    | 59/100 [02:45<01:52,  2.75s/it] 60%|██████    | 60/100 [02:48<01:51,  2.80s/it] 61%|██████    | 61/100 [02:51<01:48,  2.79s/it] 62%|██████▏   | 62/100 [02:53<01:45,  2.78s/it] 63%|██████▎   | 63/100 [02:56<01:42,  2.76s/it] 64%|██████▍   | 64/100 [02:59<01:37,  2.71s/it] 65%|██████▌   | 65/100 [03:01<01:34,  2.70s/it] 66%|██████▌   | 66/100 [03:04<01:30,  2.67s/it] 67%|██████▋   | 67/100 [03:07<01:27,  2.66s/it] 68%|██████▊   | 68/100 [03:09<01:24,  2.65s/it] 69%|██████▉   | 69/100 [03:12<01:21,  2.63s/it] 70%|███████   | 70/100 [03:14<01:18,  2.62s/it] 71%|███████   | 71/100 [03:17<01:16,  2.64s/it] 72%|███████▏  | 72/100 [03:20<01:14,  2.68s/it] 73%|███████▎  | 73/100 [03:22<01:10,  2.61s/it] 74%|███████▍  | 74/100 [03:25<01:06,  2.56s/it] 75%|███████▌  | 75/100 [03:27<01:03,  2.55s/it] 76%|███████▌  | 76/100 [03:30<01:00,  2.53s/it] 77%|███████▋  | 77/100 [03:32<00:58,  2.55s/it] 78%|███████▊  | 78/100 [03:35<00:55,  2.53s/it] 79%|███████▉  | 79/100 [03:37<00:53,  2.53s/it] 80%|████████  | 80/100 [03:40<00:50,  2.51s/it] 81%|████████  | 81/100 [03:42<00:47,  2.51s/it] 82%|████████▏ | 82/100 [03:45<00:45,  2.51s/it] 83%|████████▎ | 83/100 [03:47<00:42,  2.50s/it] 84%|████████▍ | 84/100 [03:50<00:40,  2.54s/it] 85%|████████▌ | 85/100 [03:52<00:37,  2.53s/it] 86%|████████▌ | 86/100 [03:55<00:35,  2.52s/it] 87%|████████▋ | 87/100 [03:57<00:32,  2.51s/it] 88%|████████▊ | 88/100 [04:00<00:29,  2.49s/it] 89%|████████▉ | 89/100 [04:02<00:27,  2.49s/it] 90%|█████████ | 90/100 [04:05<00:25,  2.51s/it] 91%|█████████ | 91/100 [04:08<00:22,  2.54s/it] 92%|█████████▏| 92/100 [04:10<00:20,  2.57s/it] 93%|█████████▎| 93/100 [04:13<00:18,  2.61s/it] 94%|█████████▍| 94/100 [04:15<00:15,  2.60s/it] 95%|█████████▌| 95/100 [04:18<00:12,  2.59s/it] 96%|█████████▌| 96/100 [04:20<00:10,  2.57s/it] 97%|█████████▋| 97/100 [04:23<00:07,  2.54s/it] 98%|█████████▊| 98/100 [04:26<00:05,  2.57s/it] 99%|█████████▉| 99/100 [04:28<00:02,  2.54s/it]100%|██████████| 100/100 [04:31<00:00,  2.53s/it]100%|██████████| 100/100 [04:31<00:00,  2.71s/it]
[0/100] loss: 2.7414534091949463 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.5290708541870117 loss_joints: 2.3897745609283447 loss_collision: 0.1529988944530487 loss_jerk: 0.06971309334039688 loss_floor_contact: 0.5428349375724792
[2/100] loss: 1.8357179164886475 loss_joints: 1.720144510269165 loss_collision: 0.07583892345428467 loss_jerk: 0.06627251207828522 loss_floor_contact: 0.4171707332134247
[3/100] loss: 1.292296051979065 loss_joints: 1.1565842628479004 loss_collision: 0.17005537450313568 loss_jerk: 0.09471084177494049 loss_floor_contact: 0.23995347321033478
[4/100] loss: 0.7809802293777466 loss_joints: 0.6632305383682251 loss_collision: 0.16129431128501892 loss_jerk: 0.0994918942451477 loss_floor_contact: 0.021283792331814766
[5/100] loss: 0.47127556800842285 loss_joints: 0.34317395091056824 loss_collision: 0.32124724984169006 loss_jerk: 0.09383871406316757 loss_floor_contact: 0.0213816836476326
[6/100] loss: 0.230333611369133 loss_joints: 0.12674158811569214 loss_collision: 0.19282770156860352 loss_jerk: 0.0821499302983284 loss_floor_contact: 0.021593153476715088
[7/100] loss: 0.14500056207180023 loss_joints: 0.059507858008146286 loss_collision: 0.02022637613117695 loss_jerk: 0.08127863705158234 loss_floor_contact: 0.021914280951023102
[8/100] loss: 0.1694077104330063 loss_joints: 0.08082723617553711 loss_collision: 0.022704757750034332 loss_jerk: 0.08412382751703262 loss_floor_contact: 0.021861642599105835
[9/100] loss: 0.1636425256729126 loss_joints: 0.06614165008068085 loss_collision: 0.06327789276838303 loss_jerk: 0.08903094381093979 loss_floor_contact: 0.021421249955892563
[10/100] loss: 0.12239640951156616 loss_joints: 0.03691546618938446 loss_collision: 0.014273698441684246 loss_jerk: 0.08195624500513077 loss_floor_contact: 0.020973259583115578
[11/100] loss: 0.11318068206310272 loss_joints: 0.024910470470786095 loss_collision: 0.03951304033398628 loss_jerk: 0.08227670192718506 loss_floor_contact: 0.02042204514145851
[12/100] loss: 0.09985212236642838 loss_joints: 0.012305919080972672 loss_collision: 0.045906875282526016 loss_jerk: 0.08097200095653534 loss_floor_contact: 0.019835153594613075
[13/100] loss: 0.08986154943704605 loss_joints: 0.009086918085813522 loss_collision: 0.03498224541544914 loss_jerk: 0.07534251362085342 loss_floor_contact: 0.01933891884982586
[14/100] loss: 0.09747704118490219 loss_joints: 0.018963603302836418 loss_collision: 0.014822172001004219 loss_jerk: 0.07512761652469635 loss_floor_contact: 0.019036008045077324
[15/100] loss: 0.09758767485618591 loss_joints: 0.019138788804411888 loss_collision: 0.018662314862012863 loss_jerk: 0.07469262927770615 loss_floor_contact: 0.018900254741311073
[16/100] loss: 0.08628173917531967 loss_joints: 0.010626060888171196 loss_collision: 0.02319743111729622 loss_jerk: 0.07145468145608902 loss_floor_contact: 0.01881253719329834
[17/100] loss: 0.07293669879436493 loss_joints: 0.0035074418410658836 loss_collision: 0.030055701732635498 loss_jerk: 0.0645466297864914 loss_floor_contact: 0.018770523369312286
[18/100] loss: 0.07795318216085434 loss_joints: 0.008061712607741356 loss_collision: 0.024097304791212082 loss_jerk: 0.06560973823070526 loss_floor_contact: 0.01872001774609089
[19/100] loss: 0.07968215644359589 loss_joints: 0.010488341562449932 loss_collision: 0.029002700001001358 loss_jerk: 0.06442297995090485 loss_floor_contact: 0.018705662339925766
[20/100] loss: 0.07513377070426941 loss_joints: 0.0078058671206235886 loss_collision: 0.0325276181101799 loss_jerk: 0.062205348163843155 loss_floor_contact: 0.018697943538427353
[21/100] loss: 0.07125768065452576 loss_joints: 0.005559812765568495 loss_collision: 0.03570982441306114 loss_jerk: 0.06025485694408417 loss_floor_contact: 0.018720246851444244
[22/100] loss: 0.0661509782075882 loss_joints: 0.0032788170501589775 loss_collision: 0.03306373581290245 loss_jerk: 0.057695172727108 loss_floor_contact: 0.018706198781728745
[23/100] loss: 0.06607077270746231 loss_joints: 0.0030227885581552982 loss_collision: 0.026584895327687263 loss_jerk: 0.05852803960442543 loss_floor_contact: 0.01861455664038658
[24/100] loss: 0.06664015352725983 loss_joints: 0.005779934115707874 loss_collision: 0.02082718349993229 loss_jerk: 0.05691889300942421 loss_floor_contact: 0.0185860488563776
[25/100] loss: 0.06672560423612595 loss_joints: 0.005681312642991543 loss_collision: 0.01926923729479313 loss_jerk: 0.05724972486495972 loss_floor_contact: 0.01867642067372799
[26/100] loss: 0.06486482173204422 loss_joints: 0.0024380842223763466 loss_collision: 0.019911611452698708 loss_jerk: 0.05855107307434082 loss_floor_contact: 0.018845085054636
[27/100] loss: 0.06219293922185898 loss_joints: 0.0010244317818433046 loss_collision: 0.02081797644495964 loss_jerk: 0.05717848986387253 loss_floor_contact: 0.01908220164477825
[28/100] loss: 0.06177356466650963 loss_joints: 0.001260128105059266 loss_collision: 0.02294115349650383 loss_jerk: 0.05629642680287361 loss_floor_contact: 0.019228925928473473
[29/100] loss: 0.06053024157881737 loss_joints: 0.001575973117724061 loss_collision: 0.022261569276452065 loss_jerk: 0.05479590222239494 loss_floor_contact: 0.019322076812386513
[30/100] loss: 0.05916017293930054 loss_joints: 0.0007825735956430435 loss_collision: 0.022183874621987343 loss_jerk: 0.054226815700531006 loss_floor_contact: 0.019323961809277534
[31/100] loss: 0.05806330218911171 loss_joints: 0.00034843134926632047 loss_collision: 0.021821575239300728 loss_jerk: 0.053606171160936356 loss_floor_contact: 0.019265426322817802
[32/100] loss: 0.05788559466600418 loss_joints: 0.0008584472234360874 loss_collision: 0.019668633118271828 loss_jerk: 0.05312992259860039 loss_floor_contact: 0.019303610548377037
[33/100] loss: 0.05622172728180885 loss_joints: 0.0005687197553925216 loss_collision: 0.017884885892271996 loss_jerk: 0.05192265287041664 loss_floor_contact: 0.019418686628341675
[34/100] loss: 0.05618182569742203 loss_joints: 0.0003337426751386374 loss_collision: 0.020177766680717468 loss_jerk: 0.051878683269023895 loss_floor_contact: 0.019516250118613243
[35/100] loss: 0.05641569197177887 loss_joints: 0.0003119977191090584 loss_collision: 0.022544534876942635 loss_jerk: 0.051887258887290955 loss_floor_contact: 0.019619852304458618
[36/100] loss: 0.05625907704234123 loss_joints: 0.00020386691903695464 loss_collision: 0.02091270498931408 loss_jerk: 0.0519985593855381 loss_floor_contact: 0.01965380646288395
[37/100] loss: 0.05516926571726799 loss_joints: 0.0002593693498056382 loss_collision: 0.019248036667704582 loss_jerk: 0.05102454498410225 loss_floor_contact: 0.019605491310358047
[38/100] loss: 0.054791588336229324 loss_joints: 3.2012874726206064e-05 loss_collision: 0.017011325806379318 loss_jerk: 0.051102157682180405 loss_floor_contact: 0.019562853500247
[39/100] loss: 0.053804170340299606 loss_joints: 8.958960825111717e-05 loss_collision: 0.01642463542521 loss_jerk: 0.05012073367834091 loss_floor_contact: 0.019513849169015884
[40/100] loss: 0.053081728518009186 loss_joints: 0.00040961080230772495 loss_collision: 0.014279407449066639 loss_jerk: 0.04929548129439354 loss_floor_contact: 0.01948697306215763
[41/100] loss: 0.051549315452575684 loss_joints: 0.00014849691069684923 loss_collision: 0.012230313383042812 loss_jerk: 0.048226989805698395 loss_floor_contact: 0.01950795389711857
[42/100] loss: 0.05015387386083603 loss_joints: 0.000169308390468359 loss_collision: 0.011825480498373508 loss_jerk: 0.046852875500917435 loss_floor_contact: 0.019491421058773994
[43/100] loss: 0.050173889845609665 loss_joints: 0.00023781944764778018 loss_collision: 0.013289649970829487 loss_jerk: 0.046664297580718994 loss_floor_contact: 0.019428104162216187
[44/100] loss: 0.049639973789453506 loss_joints: 2.9434193038468948e-06 loss_collision: 0.009449629113078117 loss_jerk: 0.046754058450460434 loss_floor_contact: 0.019380075857043266
[45/100] loss: 0.04971664398908615 loss_joints: 0.0001833403221098706 loss_collision: 0.006241924129426479 loss_jerk: 0.04697619751095772 loss_floor_contact: 0.019329169765114784
[46/100] loss: 0.04892474785447121 loss_joints: 0.00013004014908801764 loss_collision: 0.00593137089163065 loss_jerk: 0.04626854509115219 loss_floor_contact: 0.019330263137817383
[47/100] loss: 0.04856875166296959 loss_joints: 3.539762110449374e-05 loss_collision: 0.005860378500074148 loss_jerk: 0.046015892177820206 loss_floor_contact: 0.01931425929069519
[48/100] loss: 0.04775944724678993 loss_joints: 0.0002437339717289433 loss_collision: 0.002585768699645996 loss_jerk: 0.045329056680202484 loss_floor_contact: 0.01928080804646015
[49/100] loss: 0.04691847413778305 loss_joints: 0.0001400394830852747 loss_collision: 0.002999621909111738 loss_jerk: 0.04455084726214409 loss_floor_contact: 0.01927625574171543
[50/100] loss: 0.04650602117180824 loss_joints: 3.392527287360281e-05 loss_collision: 0.003818023484200239 loss_jerk: 0.04416687414050102 loss_floor_contact: 0.019234206527471542
[51/100] loss: 0.04623610898852348 loss_joints: 0.000321024504955858 loss_collision: 0.0028142333030700684 loss_jerk: 0.04371297359466553 loss_floor_contact: 0.019206875935196877
[52/100] loss: 0.04535418003797531 loss_joints: 0.00027224072255194187 loss_collision: 0.001648272038437426 loss_jerk: 0.042999476194381714 loss_floor_contact: 0.019176358357071877
[53/100] loss: 0.0449533611536026 loss_joints: 9.268143185181543e-05 loss_collision: 0.004214639309793711 loss_jerk: 0.042521703988313675 loss_floor_contact: 0.019175106659531593
[54/100] loss: 0.04491940513253212 loss_joints: 0.00010892340651480481 loss_collision: 0.0062193539924919605 loss_jerk: 0.04227152094244957 loss_floor_contact: 0.019170258194208145
[55/100] loss: 0.04430169239640236 loss_joints: 2.4404011128353886e-05 loss_collision: 0.004650493618100882 loss_jerk: 0.04189614579081535 loss_floor_contact: 0.019160930067300797
[56/100] loss: 0.044535309076309204 loss_joints: 0.0002240045869257301 loss_collision: 0.0030898568220436573 loss_jerk: 0.04208710789680481 loss_floor_contact: 0.019152125343680382
[57/100] loss: 0.044171590358018875 loss_joints: 0.00012154258729424328 loss_collision: 0.0021549612283706665 loss_jerk: 0.04191725328564644 loss_floor_contact: 0.01917300559580326
[58/100] loss: 0.044208332896232605 loss_joints: 0.00012039464490953833 loss_collision: 0.003311655716970563 loss_jerk: 0.04183688759803772 loss_floor_contact: 0.019198831170797348
[59/100] loss: 0.04378565028309822 loss_joints: 0.00017230052617378533 loss_collision: 0.0017711868276819587 loss_jerk: 0.041499897837638855 loss_floor_contact: 0.019363338127732277
[60/100] loss: 0.04368703439831734 loss_joints: 0.00019877930753864348 loss_collision: 0.0021163406781852245 loss_jerk: 0.04133019596338272 loss_floor_contact: 0.01946423202753067
[61/100] loss: 0.04279227927327156 loss_joints: 2.214212690887507e-05 loss_collision: 0.0028525127563625574 loss_jerk: 0.04055418819189072 loss_floor_contact: 0.019306976348161697
[62/100] loss: 0.042311783879995346 loss_joints: 1.2286378478165716e-05 loss_collision: 0.001855956157669425 loss_jerk: 0.04017441347241402 loss_floor_contact: 0.019394855946302414
[63/100] loss: 0.04233688861131668 loss_joints: 0.00013735854008700699 loss_collision: 0.0026366279926151037 loss_jerk: 0.039977505803108215 loss_floor_contact: 0.019583620131015778
[64/100] loss: 0.04225453361868858 loss_joints: 6.175801536301151e-05 loss_collision: 0.002542053582146764 loss_jerk: 0.04001111909747124 loss_floor_contact: 0.01927451603114605
[65/100] loss: 0.042115941643714905 loss_joints: 6.708793807774782e-05 loss_collision: 0.00252207787707448 loss_jerk: 0.039880454540252686 loss_floor_contact: 0.019161943346261978
[66/100] loss: 0.04166814684867859 loss_joints: 7.583681144751608e-05 loss_collision: 0.0026337041053920984 loss_jerk: 0.039412423968315125 loss_floor_contact: 0.019165175035595894
[67/100] loss: 0.04173300787806511 loss_joints: 3.911020030500367e-05 loss_collision: 0.0032550443429499865 loss_jerk: 0.03944849595427513 loss_floor_contact: 0.019199004396796227
[68/100] loss: 0.04179878905415535 loss_joints: 6.0460861277533695e-05 loss_collision: 0.002820899011567235 loss_jerk: 0.039535850286483765 loss_floor_contact: 0.019203878939151764
[69/100] loss: 0.041875842958688736 loss_joints: 4.460827767616138e-05 loss_collision: 0.0036172866821289062 loss_jerk: 0.039551571011543274 loss_floor_contact: 0.019179364666342735
[70/100] loss: 0.04127330332994461 loss_joints: 4.965967309544794e-05 loss_collision: 0.004641286097466946 loss_jerk: 0.038845453411340714 loss_floor_contact: 0.019140634685754776
[71/100] loss: 0.04132474213838577 loss_joints: 0.00029159244149923325 loss_collision: 0.0048461854457855225 loss_jerk: 0.03863830491900444 loss_floor_contact: 0.01910223253071308
[72/100] loss: 0.041404955089092255 loss_joints: 0.0005008308799006045 loss_collision: 0.003546458203345537 loss_jerk: 0.03864104300737381 loss_floor_contact: 0.01908436417579651
[73/100] loss: 0.041013047099113464 loss_joints: 0.0003527387452777475 loss_collision: 0.003021160839125514 loss_jerk: 0.038449034094810486 loss_floor_contact: 0.01909160055220127
[74/100] loss: 0.04073125123977661 loss_joints: 8.636864367872477e-05 loss_collision: 0.0032736111897975206 loss_jerk: 0.038405828177928925 loss_floor_contact: 0.019116932526230812
[75/100] loss: 0.04085583984851837 loss_joints: 6.117158045526594e-05 loss_collision: 0.002303098561242223 loss_jerk: 0.03864974156022072 loss_floor_contact: 0.01914617046713829
[76/100] loss: 0.041137900203466415 loss_joints: 0.00013875258446205407 loss_collision: 0.0024125941563397646 loss_jerk: 0.03884309157729149 loss_floor_contact: 0.019147971644997597
[77/100] loss: 0.041041456162929535 loss_joints: 0.00010277866385877132 loss_collision: 0.0026644121389836073 loss_jerk: 0.038759928196668625 loss_floor_contact: 0.019123073667287827
[78/100] loss: 0.04093603044748306 loss_joints: 4.647248351830058e-05 loss_collision: 0.002778685884550214 loss_jerk: 0.03870384022593498 loss_floor_contact: 0.019078487530350685
[79/100] loss: 0.040731705725193024 loss_joints: 2.603605025797151e-05 loss_collision: 0.002645386615768075 loss_jerk: 0.038536638021469116 loss_floor_contact: 0.0190449096262455
[80/100] loss: 0.04032953083515167 loss_joints: 1.2736461485474138e-06 loss_collision: 0.0032218429259955883 loss_jerk: 0.03810333088040352 loss_floor_contact: 0.019027402624487877
[81/100] loss: 0.04043477773666382 loss_joints: 5.7351986470166594e-05 loss_collision: 0.00236536399461329 loss_jerk: 0.03823928162455559 loss_floor_contact: 0.019016083329916
[82/100] loss: 0.04009910300374031 loss_joints: 6.08032860327512e-05 loss_collision: 0.0037378636188805103 loss_jerk: 0.03776397556066513 loss_floor_contact: 0.01900537870824337
[83/100] loss: 0.03935088962316513 loss_joints: 6.8829772317258175e-06 loss_collision: 0.0035130514297634363 loss_jerk: 0.03709343448281288 loss_floor_contact: 0.018992701545357704
[84/100] loss: 0.03909769281744957 loss_joints: 2.7788082661572844e-05 loss_collision: 0.0023164120502769947 loss_jerk: 0.03694010525941849 loss_floor_contact: 0.0189815703779459
[85/100] loss: 0.03909292444586754 loss_joints: 4.498884663917124e-05 loss_collision: 0.0021365631837397814 loss_jerk: 0.03693656623363495 loss_floor_contact: 0.018977100029587746
[86/100] loss: 0.039123207330703735 loss_joints: 3.368004036019556e-05 loss_collision: 0.0025331212673336267 loss_jerk: 0.036939218640327454 loss_floor_contact: 0.018969977274537086
[87/100] loss: 0.03884589299559593 loss_joints: 1.6315992979798466e-05 loss_collision: 0.0023006366100162268 loss_jerk: 0.03670249134302139 loss_floor_contact: 0.018970221281051636
[88/100] loss: 0.038635458797216415 loss_joints: 1.8952396203530952e-05 loss_collision: 0.002442460972815752 loss_jerk: 0.036474939435720444 loss_floor_contact: 0.01897318847477436
[89/100] loss: 0.038460515439510345 loss_joints: 1.3892826245864853e-05 loss_collision: 0.002482965588569641 loss_jerk: 0.036301400512456894 loss_floor_contact: 0.018969237804412842
[90/100] loss: 0.03828052431344986 loss_joints: 5.188579962123185e-06 loss_collision: 0.0023802518844604492 loss_jerk: 0.0361405611038208 loss_floor_contact: 0.018967488780617714
[91/100] loss: 0.03832055628299713 loss_joints: 2.4605410544609185e-06 loss_collision: 0.0022716273088008165 loss_jerk: 0.03619416803121567 loss_floor_contact: 0.01896764524281025
[92/100] loss: 0.0381956622004509 loss_joints: 1.1180961791978916e-06 loss_collision: 0.002043921034783125 loss_jerk: 0.03609311208128929 loss_floor_contact: 0.01897042617201805
[93/100] loss: 0.038048215210437775 loss_joints: 1.8334566220801207e-06 loss_collision: 0.0019917439203709364 loss_jerk: 0.03594997897744179 loss_floor_contact: 0.018972255289554596
[94/100] loss: 0.03792104497551918 loss_joints: 6.225880497368053e-06 loss_collision: 0.0019578668288886547 loss_jerk: 0.03582179173827171 loss_floor_contact: 0.018972406163811684
[95/100] loss: 0.03777676075696945 loss_joints: 1.681618596194312e-05 loss_collision: 0.001763721345923841 loss_jerk: 0.0356864370405674 loss_floor_contact: 0.018971353769302368
[96/100] loss: 0.03773964196443558 loss_joints: 1.8385875591775402e-05 loss_collision: 0.001798588433302939 loss_jerk: 0.03564469516277313 loss_floor_contact: 0.018967028707265854
[97/100] loss: 0.03772043064236641 loss_joints: 1.217651333718095e-05 loss_collision: 0.0020959244575351477 loss_jerk: 0.03560251370072365 loss_floor_contact: 0.018961479887366295
[98/100] loss: 0.037635914981365204 loss_joints: 5.136249001225224e-06 loss_collision: 0.0019104497041553259 loss_jerk: 0.035544153302907944 loss_floor_contact: 0.01895582303404808
[99/100] loss: 0.0375664196908474 loss_joints: 3.0868518479110207e-06 loss_collision: 0.0019075556192547083 loss_jerk: 0.03547750413417816 loss_floor_contact: 0.01895073428750038
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk1.0_skate0.5]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 271.08356                                                    ║
    ║     rollout = 121.06973                                                    ║
    ║     sdf     = 12.58629                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.03756642                                                 ║
    ║     joints    = 0.00000309                                                 ║
    ║     collision = 0.00190756                                                 ║
    ║     jerk      = 0.03547750                                                 ║
    ║     floor     = 0.01895073                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	4m49.296s
user	4m28.720s
sys	0m14.857s
[INFO] Running with collision=0.1, contact=0.1, jerk=1.0, skate=1.0
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:29,  2.72s/it]  2%|▏         | 2/100 [00:05<04:17,  2.63s/it]  3%|▎         | 3/100 [00:08<04:35,  2.84s/it]  4%|▍         | 4/100 [00:10<04:21,  2.73s/it]  5%|▌         | 5/100 [00:13<04:13,  2.67s/it]  6%|▌         | 6/100 [00:16<04:14,  2.70s/it]  7%|▋         | 7/100 [00:18<04:05,  2.64s/it]  8%|▊         | 8/100 [00:21<04:00,  2.62s/it]  9%|▉         | 9/100 [00:24<04:00,  2.64s/it] 10%|█         | 10/100 [00:26<03:57,  2.63s/it] 11%|█         | 11/100 [00:29<03:54,  2.63s/it] 12%|█▏        | 12/100 [00:31<03:52,  2.65s/it] 13%|█▎        | 13/100 [00:34<03:52,  2.68s/it] 14%|█▍        | 14/100 [00:37<03:49,  2.66s/it] 15%|█▌        | 15/100 [00:40<03:49,  2.69s/it] 16%|█▌        | 16/100 [00:42<03:47,  2.71s/it] 17%|█▋        | 17/100 [00:45<03:44,  2.70s/it] 18%|█▊        | 18/100 [00:48<03:40,  2.69s/it] 19%|█▉        | 19/100 [00:50<03:37,  2.68s/it] 20%|██        | 20/100 [00:53<03:40,  2.75s/it] 21%|██        | 21/100 [00:56<03:37,  2.75s/it] 22%|██▏       | 22/100 [00:59<03:36,  2.78s/it] 23%|██▎       | 23/100 [01:02<03:34,  2.78s/it] 24%|██▍       | 24/100 [01:04<03:29,  2.76s/it] 25%|██▌       | 25/100 [01:07<03:25,  2.74s/it] 26%|██▌       | 26/100 [01:10<03:21,  2.73s/it] 27%|██▋       | 27/100 [01:12<03:19,  2.73s/it] 28%|██▊       | 28/100 [01:15<03:16,  2.74s/it] 29%|██▉       | 29/100 [01:18<03:15,  2.76s/it] 30%|███       | 30/100 [01:21<03:12,  2.75s/it] 31%|███       | 31/100 [01:24<03:08,  2.74s/it] 32%|███▏      | 32/100 [01:26<03:06,  2.75s/it] 33%|███▎      | 33/100 [01:29<03:05,  2.77s/it] 34%|███▍      | 34/100 [01:32<03:00,  2.73s/it] 35%|███▌      | 35/100 [01:34<02:57,  2.72s/it] 36%|███▌      | 36/100 [01:37<02:53,  2.72s/it] 37%|███▋      | 37/100 [01:40<02:49,  2.69s/it] 38%|███▊      | 38/100 [01:42<02:46,  2.69s/it] 39%|███▉      | 39/100 [01:45<02:42,  2.67s/it] 40%|████      | 40/100 [01:48<02:40,  2.67s/it] 41%|████      | 41/100 [01:50<02:37,  2.68s/it] 42%|████▏     | 42/100 [01:53<02:35,  2.68s/it] 43%|████▎     | 43/100 [01:56<02:33,  2.69s/it] 44%|████▍     | 44/100 [01:59<02:33,  2.73s/it] 45%|████▌     | 45/100 [02:01<02:30,  2.74s/it] 46%|████▌     | 46/100 [02:04<02:28,  2.74s/it] 47%|████▋     | 47/100 [02:07<02:24,  2.73s/it] 48%|████▊     | 48/100 [02:10<02:21,  2.73s/it] 49%|████▉     | 49/100 [02:12<02:19,  2.74s/it] 50%|█████     | 50/100 [02:15<02:16,  2.73s/it] 51%|█████     | 51/100 [02:18<02:13,  2.73s/it] 52%|█████▏    | 52/100 [02:21<02:11,  2.74s/it] 53%|█████▎    | 53/100 [02:23<02:10,  2.78s/it] 54%|█████▍    | 54/100 [02:26<02:08,  2.79s/it] 55%|█████▌    | 55/100 [02:29<02:07,  2.84s/it] 56%|█████▌    | 56/100 [02:32<02:03,  2.81s/it] 57%|█████▋    | 57/100 [02:35<02:00,  2.80s/it] 58%|█████▊    | 58/100 [02:37<01:55,  2.76s/it] 59%|█████▉    | 59/100 [02:40<01:53,  2.77s/it] 60%|██████    | 60/100 [02:43<01:49,  2.74s/it] 61%|██████    | 61/100 [02:46<01:47,  2.75s/it] 62%|██████▏   | 62/100 [02:48<01:44,  2.75s/it] 63%|██████▎   | 63/100 [02:51<01:44,  2.83s/it] 64%|██████▍   | 64/100 [02:54<01:39,  2.78s/it] 65%|██████▌   | 65/100 [02:57<01:36,  2.75s/it] 66%|██████▌   | 66/100 [02:59<01:32,  2.71s/it] 67%|██████▋   | 67/100 [03:02<01:29,  2.70s/it] 68%|██████▊   | 68/100 [03:05<01:28,  2.75s/it] 69%|██████▉   | 69/100 [03:08<01:24,  2.74s/it] 70%|███████   | 70/100 [03:10<01:21,  2.73s/it] 71%|███████   | 71/100 [03:13<01:19,  2.74s/it] 72%|███████▏  | 72/100 [03:16<01:16,  2.74s/it] 73%|███████▎  | 73/100 [03:19<01:13,  2.74s/it] 74%|███████▍  | 74/100 [03:21<01:10,  2.73s/it] 75%|███████▌  | 75/100 [03:24<01:07,  2.70s/it] 76%|███████▌  | 76/100 [03:27<01:04,  2.69s/it] 77%|███████▋  | 77/100 [03:29<01:02,  2.71s/it] 78%|███████▊  | 78/100 [03:32<00:59,  2.71s/it] 79%|███████▉  | 79/100 [03:35<00:57,  2.72s/it] 80%|████████  | 80/100 [03:37<00:54,  2.71s/it] 81%|████████  | 81/100 [03:40<00:51,  2.69s/it] 82%|████████▏ | 82/100 [03:43<00:48,  2.70s/it] 83%|████████▎ | 83/100 [03:46<00:46,  2.72s/it] 84%|████████▍ | 84/100 [03:48<00:44,  2.76s/it] 85%|████████▌ | 85/100 [03:51<00:41,  2.75s/it] 86%|████████▌ | 86/100 [03:54<00:38,  2.78s/it] 87%|████████▋ | 87/100 [03:57<00:35,  2.76s/it] 88%|████████▊ | 88/100 [03:59<00:33,  2.76s/it] 89%|████████▉ | 89/100 [04:02<00:30,  2.77s/it] 90%|█████████ | 90/100 [04:05<00:27,  2.74s/it] 91%|█████████ | 91/100 [04:08<00:24,  2.74s/it] 92%|█████████▏| 92/100 [04:10<00:21,  2.75s/it] 93%|█████████▎| 93/100 [04:13<00:19,  2.75s/it] 94%|█████████▍| 94/100 [04:16<00:16,  2.75s/it] 95%|█████████▌| 95/100 [04:19<00:13,  2.75s/it] 96%|█████████▌| 96/100 [04:21<00:11,  2.76s/it] 97%|█████████▋| 97/100 [04:24<00:08,  2.76s/it] 98%|█████████▊| 98/100 [04:27<00:05,  2.78s/it] 99%|█████████▉| 99/100 [04:30<00:02,  2.75s/it]100%|██████████| 100/100 [04:32<00:00,  2.73s/it]100%|██████████| 100/100 [04:32<00:00,  2.73s/it]
[0/100] loss: 2.7414534091949463 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.5290708541870117 loss_joints: 2.3897745609283447 loss_collision: 0.1529988944530487 loss_jerk: 0.06971309334039688 loss_floor_contact: 0.5428349375724792
[2/100] loss: 1.8357179164886475 loss_joints: 1.720144510269165 loss_collision: 0.07583892345428467 loss_jerk: 0.06627251207828522 loss_floor_contact: 0.4171707332134247
[3/100] loss: 1.292296051979065 loss_joints: 1.1565842628479004 loss_collision: 0.17005537450313568 loss_jerk: 0.09471084177494049 loss_floor_contact: 0.23995347321033478
[4/100] loss: 0.7809802293777466 loss_joints: 0.6632305383682251 loss_collision: 0.16129431128501892 loss_jerk: 0.0994918942451477 loss_floor_contact: 0.021283792331814766
[5/100] loss: 0.47127556800842285 loss_joints: 0.34317395091056824 loss_collision: 0.32124724984169006 loss_jerk: 0.09383871406316757 loss_floor_contact: 0.0213816836476326
[6/100] loss: 0.230333611369133 loss_joints: 0.12674158811569214 loss_collision: 0.19282770156860352 loss_jerk: 0.0821499302983284 loss_floor_contact: 0.021593153476715088
[7/100] loss: 0.14500056207180023 loss_joints: 0.059507858008146286 loss_collision: 0.02022637613117695 loss_jerk: 0.08127863705158234 loss_floor_contact: 0.021914280951023102
[8/100] loss: 0.1694077104330063 loss_joints: 0.08082723617553711 loss_collision: 0.022704757750034332 loss_jerk: 0.08412382751703262 loss_floor_contact: 0.021861642599105835
[9/100] loss: 0.1636425256729126 loss_joints: 0.06614165008068085 loss_collision: 0.06327789276838303 loss_jerk: 0.08903094381093979 loss_floor_contact: 0.021421249955892563
[10/100] loss: 0.12239640951156616 loss_joints: 0.03691546618938446 loss_collision: 0.014273698441684246 loss_jerk: 0.08195624500513077 loss_floor_contact: 0.020973259583115578
[11/100] loss: 0.11318068206310272 loss_joints: 0.024910470470786095 loss_collision: 0.03951304033398628 loss_jerk: 0.08227670192718506 loss_floor_contact: 0.02042204514145851
[12/100] loss: 0.09985212236642838 loss_joints: 0.012305919080972672 loss_collision: 0.045906875282526016 loss_jerk: 0.08097200095653534 loss_floor_contact: 0.019835153594613075
[13/100] loss: 0.08986154943704605 loss_joints: 0.009086918085813522 loss_collision: 0.03498224541544914 loss_jerk: 0.07534251362085342 loss_floor_contact: 0.01933891884982586
[14/100] loss: 0.09747704118490219 loss_joints: 0.018963603302836418 loss_collision: 0.014822172001004219 loss_jerk: 0.07512761652469635 loss_floor_contact: 0.019036008045077324
[15/100] loss: 0.09758767485618591 loss_joints: 0.019138788804411888 loss_collision: 0.018662314862012863 loss_jerk: 0.07469262927770615 loss_floor_contact: 0.018900254741311073
[16/100] loss: 0.08628173917531967 loss_joints: 0.010626060888171196 loss_collision: 0.02319743111729622 loss_jerk: 0.07145468145608902 loss_floor_contact: 0.01881253719329834
[17/100] loss: 0.07293669879436493 loss_joints: 0.0035074418410658836 loss_collision: 0.030055701732635498 loss_jerk: 0.0645466297864914 loss_floor_contact: 0.018770523369312286
[18/100] loss: 0.07795318216085434 loss_joints: 0.008061712607741356 loss_collision: 0.024097304791212082 loss_jerk: 0.06560973823070526 loss_floor_contact: 0.01872001774609089
[19/100] loss: 0.07968215644359589 loss_joints: 0.010488341562449932 loss_collision: 0.029002700001001358 loss_jerk: 0.06442297995090485 loss_floor_contact: 0.018705662339925766
[20/100] loss: 0.07513377070426941 loss_joints: 0.0078058671206235886 loss_collision: 0.0325276181101799 loss_jerk: 0.062205348163843155 loss_floor_contact: 0.018697943538427353
[21/100] loss: 0.07125768065452576 loss_joints: 0.005559812765568495 loss_collision: 0.03570982441306114 loss_jerk: 0.06025485694408417 loss_floor_contact: 0.018720246851444244
[22/100] loss: 0.0661509782075882 loss_joints: 0.0032788170501589775 loss_collision: 0.03306373581290245 loss_jerk: 0.057695172727108 loss_floor_contact: 0.018706198781728745
[23/100] loss: 0.06607077270746231 loss_joints: 0.0030227885581552982 loss_collision: 0.026584895327687263 loss_jerk: 0.05852803960442543 loss_floor_contact: 0.01861455664038658
[24/100] loss: 0.06664015352725983 loss_joints: 0.005779934115707874 loss_collision: 0.02082718349993229 loss_jerk: 0.05691889300942421 loss_floor_contact: 0.0185860488563776
[25/100] loss: 0.06672560423612595 loss_joints: 0.005681312642991543 loss_collision: 0.01926923729479313 loss_jerk: 0.05724972486495972 loss_floor_contact: 0.01867642067372799
[26/100] loss: 0.06486482173204422 loss_joints: 0.0024380842223763466 loss_collision: 0.019911611452698708 loss_jerk: 0.05855107307434082 loss_floor_contact: 0.018845085054636
[27/100] loss: 0.06219293922185898 loss_joints: 0.0010244317818433046 loss_collision: 0.02081797644495964 loss_jerk: 0.05717848986387253 loss_floor_contact: 0.01908220164477825
[28/100] loss: 0.06177356466650963 loss_joints: 0.001260128105059266 loss_collision: 0.02294115349650383 loss_jerk: 0.05629642680287361 loss_floor_contact: 0.019228925928473473
[29/100] loss: 0.06053024157881737 loss_joints: 0.001575973117724061 loss_collision: 0.022261569276452065 loss_jerk: 0.05479590222239494 loss_floor_contact: 0.019322076812386513
[30/100] loss: 0.05916017293930054 loss_joints: 0.0007825735956430435 loss_collision: 0.022183874621987343 loss_jerk: 0.054226815700531006 loss_floor_contact: 0.019323961809277534
[31/100] loss: 0.05806330218911171 loss_joints: 0.00034843134926632047 loss_collision: 0.021821575239300728 loss_jerk: 0.053606171160936356 loss_floor_contact: 0.019265426322817802
[32/100] loss: 0.05788559466600418 loss_joints: 0.0008584472234360874 loss_collision: 0.019668633118271828 loss_jerk: 0.05312992259860039 loss_floor_contact: 0.019303610548377037
[33/100] loss: 0.05622172728180885 loss_joints: 0.0005687197553925216 loss_collision: 0.017884885892271996 loss_jerk: 0.05192265287041664 loss_floor_contact: 0.019418686628341675
[34/100] loss: 0.05618182569742203 loss_joints: 0.0003337426751386374 loss_collision: 0.020177766680717468 loss_jerk: 0.051878683269023895 loss_floor_contact: 0.019516250118613243
[35/100] loss: 0.05641569197177887 loss_joints: 0.0003119977191090584 loss_collision: 0.022544534876942635 loss_jerk: 0.051887258887290955 loss_floor_contact: 0.019619852304458618
[36/100] loss: 0.05625907704234123 loss_joints: 0.00020386691903695464 loss_collision: 0.02091270498931408 loss_jerk: 0.0519985593855381 loss_floor_contact: 0.01965380646288395
[37/100] loss: 0.05516926571726799 loss_joints: 0.0002593693498056382 loss_collision: 0.019248036667704582 loss_jerk: 0.05102454498410225 loss_floor_contact: 0.019605491310358047
[38/100] loss: 0.054791588336229324 loss_joints: 3.2012874726206064e-05 loss_collision: 0.017011325806379318 loss_jerk: 0.051102157682180405 loss_floor_contact: 0.019562853500247
[39/100] loss: 0.053804170340299606 loss_joints: 8.958960825111717e-05 loss_collision: 0.01642463542521 loss_jerk: 0.05012073367834091 loss_floor_contact: 0.019513849169015884
[40/100] loss: 0.053081728518009186 loss_joints: 0.00040961080230772495 loss_collision: 0.014279407449066639 loss_jerk: 0.04929548129439354 loss_floor_contact: 0.01948697306215763
[41/100] loss: 0.051549315452575684 loss_joints: 0.00014849691069684923 loss_collision: 0.012230313383042812 loss_jerk: 0.048226989805698395 loss_floor_contact: 0.01950795389711857
[42/100] loss: 0.05015387386083603 loss_joints: 0.000169308390468359 loss_collision: 0.011825480498373508 loss_jerk: 0.046852875500917435 loss_floor_contact: 0.019491421058773994
[43/100] loss: 0.050173889845609665 loss_joints: 0.00023781944764778018 loss_collision: 0.013289649970829487 loss_jerk: 0.046664297580718994 loss_floor_contact: 0.019428104162216187
[44/100] loss: 0.049639973789453506 loss_joints: 2.9434193038468948e-06 loss_collision: 0.009449629113078117 loss_jerk: 0.046754058450460434 loss_floor_contact: 0.019380075857043266
[45/100] loss: 0.04971664398908615 loss_joints: 0.0001833403221098706 loss_collision: 0.006241924129426479 loss_jerk: 0.04697619751095772 loss_floor_contact: 0.019329169765114784
[46/100] loss: 0.04892474785447121 loss_joints: 0.00013004014908801764 loss_collision: 0.00593137089163065 loss_jerk: 0.04626854509115219 loss_floor_contact: 0.019330263137817383
[47/100] loss: 0.04856875166296959 loss_joints: 3.539762110449374e-05 loss_collision: 0.005860378500074148 loss_jerk: 0.046015892177820206 loss_floor_contact: 0.01931425929069519
[48/100] loss: 0.04775944724678993 loss_joints: 0.0002437339717289433 loss_collision: 0.002585768699645996 loss_jerk: 0.045329056680202484 loss_floor_contact: 0.01928080804646015
[49/100] loss: 0.04691847413778305 loss_joints: 0.0001400394830852747 loss_collision: 0.002999621909111738 loss_jerk: 0.04455084726214409 loss_floor_contact: 0.01927625574171543
[50/100] loss: 0.04650602117180824 loss_joints: 3.392527287360281e-05 loss_collision: 0.003818023484200239 loss_jerk: 0.04416687414050102 loss_floor_contact: 0.019234206527471542
[51/100] loss: 0.04623610898852348 loss_joints: 0.000321024504955858 loss_collision: 0.0028142333030700684 loss_jerk: 0.04371297359466553 loss_floor_contact: 0.019206875935196877
[52/100] loss: 0.04535418003797531 loss_joints: 0.00027224072255194187 loss_collision: 0.001648272038437426 loss_jerk: 0.042999476194381714 loss_floor_contact: 0.019176358357071877
[53/100] loss: 0.0449533611536026 loss_joints: 9.268143185181543e-05 loss_collision: 0.004214639309793711 loss_jerk: 0.042521703988313675 loss_floor_contact: 0.019175106659531593
[54/100] loss: 0.04491940513253212 loss_joints: 0.00010892340651480481 loss_collision: 0.0062193539924919605 loss_jerk: 0.04227152094244957 loss_floor_contact: 0.019170258194208145
[55/100] loss: 0.04430169239640236 loss_joints: 2.4404011128353886e-05 loss_collision: 0.004650493618100882 loss_jerk: 0.04189614579081535 loss_floor_contact: 0.019160930067300797
[56/100] loss: 0.044535309076309204 loss_joints: 0.0002240045869257301 loss_collision: 0.0030898568220436573 loss_jerk: 0.04208710789680481 loss_floor_contact: 0.019152125343680382
[57/100] loss: 0.044171590358018875 loss_joints: 0.00012154258729424328 loss_collision: 0.0021549612283706665 loss_jerk: 0.04191725328564644 loss_floor_contact: 0.01917300559580326
[58/100] loss: 0.044208332896232605 loss_joints: 0.00012039464490953833 loss_collision: 0.003311655716970563 loss_jerk: 0.04183688759803772 loss_floor_contact: 0.019198831170797348
[59/100] loss: 0.04378565028309822 loss_joints: 0.00017230052617378533 loss_collision: 0.0017711868276819587 loss_jerk: 0.041499897837638855 loss_floor_contact: 0.019363338127732277
[60/100] loss: 0.04368703439831734 loss_joints: 0.00019877930753864348 loss_collision: 0.0021163406781852245 loss_jerk: 0.04133019596338272 loss_floor_contact: 0.01946423202753067
[61/100] loss: 0.04279227927327156 loss_joints: 2.214212690887507e-05 loss_collision: 0.0028525127563625574 loss_jerk: 0.04055418819189072 loss_floor_contact: 0.019306976348161697
[62/100] loss: 0.042311783879995346 loss_joints: 1.2286378478165716e-05 loss_collision: 0.001855956157669425 loss_jerk: 0.04017441347241402 loss_floor_contact: 0.019394855946302414
[63/100] loss: 0.04233688861131668 loss_joints: 0.00013735854008700699 loss_collision: 0.0026366279926151037 loss_jerk: 0.039977505803108215 loss_floor_contact: 0.019583620131015778
[64/100] loss: 0.04225453361868858 loss_joints: 6.175801536301151e-05 loss_collision: 0.002542053582146764 loss_jerk: 0.04001111909747124 loss_floor_contact: 0.01927451603114605
[65/100] loss: 0.042115941643714905 loss_joints: 6.708793807774782e-05 loss_collision: 0.00252207787707448 loss_jerk: 0.039880454540252686 loss_floor_contact: 0.019161943346261978
[66/100] loss: 0.04166814684867859 loss_joints: 7.583681144751608e-05 loss_collision: 0.0026337041053920984 loss_jerk: 0.039412423968315125 loss_floor_contact: 0.019165175035595894
[67/100] loss: 0.04173300787806511 loss_joints: 3.911020030500367e-05 loss_collision: 0.0032550443429499865 loss_jerk: 0.03944849595427513 loss_floor_contact: 0.019199004396796227
[68/100] loss: 0.04179878905415535 loss_joints: 6.0460861277533695e-05 loss_collision: 0.002820899011567235 loss_jerk: 0.039535850286483765 loss_floor_contact: 0.019203878939151764
[69/100] loss: 0.041875842958688736 loss_joints: 4.460827767616138e-05 loss_collision: 0.0036172866821289062 loss_jerk: 0.039551571011543274 loss_floor_contact: 0.019179364666342735
[70/100] loss: 0.04127330332994461 loss_joints: 4.965967309544794e-05 loss_collision: 0.004641286097466946 loss_jerk: 0.038845453411340714 loss_floor_contact: 0.019140634685754776
[71/100] loss: 0.04132474213838577 loss_joints: 0.00029159244149923325 loss_collision: 0.0048461854457855225 loss_jerk: 0.03863830491900444 loss_floor_contact: 0.01910223253071308
[72/100] loss: 0.041404955089092255 loss_joints: 0.0005008308799006045 loss_collision: 0.003546458203345537 loss_jerk: 0.03864104300737381 loss_floor_contact: 0.01908436417579651
[73/100] loss: 0.041013047099113464 loss_joints: 0.0003527387452777475 loss_collision: 0.003021160839125514 loss_jerk: 0.038449034094810486 loss_floor_contact: 0.01909160055220127
[74/100] loss: 0.04073125123977661 loss_joints: 8.636864367872477e-05 loss_collision: 0.0032736111897975206 loss_jerk: 0.038405828177928925 loss_floor_contact: 0.019116932526230812
[75/100] loss: 0.04085583984851837 loss_joints: 6.117158045526594e-05 loss_collision: 0.002303098561242223 loss_jerk: 0.03864974156022072 loss_floor_contact: 0.01914617046713829
[76/100] loss: 0.041137900203466415 loss_joints: 0.00013875258446205407 loss_collision: 0.0024125941563397646 loss_jerk: 0.03884309157729149 loss_floor_contact: 0.019147971644997597
[77/100] loss: 0.041041456162929535 loss_joints: 0.00010277866385877132 loss_collision: 0.0026644121389836073 loss_jerk: 0.038759928196668625 loss_floor_contact: 0.019123073667287827
[78/100] loss: 0.04093603044748306 loss_joints: 4.647248351830058e-05 loss_collision: 0.002778685884550214 loss_jerk: 0.03870384022593498 loss_floor_contact: 0.019078487530350685
[79/100] loss: 0.040731705725193024 loss_joints: 2.603605025797151e-05 loss_collision: 0.002645386615768075 loss_jerk: 0.038536638021469116 loss_floor_contact: 0.0190449096262455
[80/100] loss: 0.04032953083515167 loss_joints: 1.2736461485474138e-06 loss_collision: 0.0032218429259955883 loss_jerk: 0.03810333088040352 loss_floor_contact: 0.019027402624487877
[81/100] loss: 0.04043477773666382 loss_joints: 5.7351986470166594e-05 loss_collision: 0.00236536399461329 loss_jerk: 0.03823928162455559 loss_floor_contact: 0.019016083329916
[82/100] loss: 0.04009910300374031 loss_joints: 6.08032860327512e-05 loss_collision: 0.0037378636188805103 loss_jerk: 0.03776397556066513 loss_floor_contact: 0.01900537870824337
[83/100] loss: 0.03935088962316513 loss_joints: 6.8829772317258175e-06 loss_collision: 0.0035130514297634363 loss_jerk: 0.03709343448281288 loss_floor_contact: 0.018992701545357704
[84/100] loss: 0.03909769281744957 loss_joints: 2.7788082661572844e-05 loss_collision: 0.0023164120502769947 loss_jerk: 0.03694010525941849 loss_floor_contact: 0.0189815703779459
[85/100] loss: 0.03909292444586754 loss_joints: 4.498884663917124e-05 loss_collision: 0.0021365631837397814 loss_jerk: 0.03693656623363495 loss_floor_contact: 0.018977100029587746
[86/100] loss: 0.039123207330703735 loss_joints: 3.368004036019556e-05 loss_collision: 0.0025331212673336267 loss_jerk: 0.036939218640327454 loss_floor_contact: 0.018969977274537086
[87/100] loss: 0.03884589299559593 loss_joints: 1.6315992979798466e-05 loss_collision: 0.0023006366100162268 loss_jerk: 0.03670249134302139 loss_floor_contact: 0.018970221281051636
[88/100] loss: 0.038635458797216415 loss_joints: 1.8952396203530952e-05 loss_collision: 0.002442460972815752 loss_jerk: 0.036474939435720444 loss_floor_contact: 0.01897318847477436
[89/100] loss: 0.038460515439510345 loss_joints: 1.3892826245864853e-05 loss_collision: 0.002482965588569641 loss_jerk: 0.036301400512456894 loss_floor_contact: 0.018969237804412842
[90/100] loss: 0.03828052431344986 loss_joints: 5.188579962123185e-06 loss_collision: 0.0023802518844604492 loss_jerk: 0.0361405611038208 loss_floor_contact: 0.018967488780617714
[91/100] loss: 0.03832055628299713 loss_joints: 2.4605410544609185e-06 loss_collision: 0.0022716273088008165 loss_jerk: 0.03619416803121567 loss_floor_contact: 0.01896764524281025
[92/100] loss: 0.0381956622004509 loss_joints: 1.1180961791978916e-06 loss_collision: 0.002043921034783125 loss_jerk: 0.03609311208128929 loss_floor_contact: 0.01897042617201805
[93/100] loss: 0.038048215210437775 loss_joints: 1.8334566220801207e-06 loss_collision: 0.0019917439203709364 loss_jerk: 0.03594997897744179 loss_floor_contact: 0.018972255289554596
[94/100] loss: 0.03792104497551918 loss_joints: 6.225880497368053e-06 loss_collision: 0.0019578668288886547 loss_jerk: 0.03582179173827171 loss_floor_contact: 0.018972406163811684
[95/100] loss: 0.03777676075696945 loss_joints: 1.681618596194312e-05 loss_collision: 0.001763721345923841 loss_jerk: 0.0356864370405674 loss_floor_contact: 0.018971353769302368
[96/100] loss: 0.03773964196443558 loss_joints: 1.8385875591775402e-05 loss_collision: 0.001798588433302939 loss_jerk: 0.03564469516277313 loss_floor_contact: 0.018967028707265854
[97/100] loss: 0.03772043064236641 loss_joints: 1.217651333718095e-05 loss_collision: 0.0020959244575351477 loss_jerk: 0.03560251370072365 loss_floor_contact: 0.018961479887366295
[98/100] loss: 0.037635914981365204 loss_joints: 5.136249001225224e-06 loss_collision: 0.0019104497041553259 loss_jerk: 0.035544153302907944 loss_floor_contact: 0.01895582303404808
[99/100] loss: 0.0375664196908474 loss_joints: 3.0868518479110207e-06 loss_collision: 0.0019075556192547083 loss_jerk: 0.03547750413417816 loss_floor_contact: 0.01895073428750038
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.1_jerk1.0_skate1.0]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 272.92405                                                    ║
    ║     rollout = 123.15138                                                    ║
    ║     sdf     = 12.95442                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.03756642                                                 ║
    ║     joints    = 0.00000309                                                 ║
    ║     collision = 0.00190756                                                 ║
    ║     jerk      = 0.03547750                                                 ║
    ║     floor     = 0.01895073                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	4m50.682s
user	4m30.539s
sys	0m13.012s
[INFO] Running with collision=0.1, contact=0.25, jerk=0.1, skate=0.1
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:36,  2.79s/it]  2%|▏         | 2/100 [00:05<04:21,  2.67s/it]  3%|▎         | 3/100 [00:08<04:45,  2.95s/it]  4%|▍         | 4/100 [00:11<04:38,  2.91s/it]  5%|▌         | 5/100 [00:14<04:36,  2.91s/it]  6%|▌         | 6/100 [00:17<04:33,  2.91s/it]  7%|▋         | 7/100 [00:20<04:26,  2.87s/it]  8%|▊         | 8/100 [00:22<04:20,  2.83s/it]  9%|▉         | 9/100 [00:25<04:14,  2.79s/it] 10%|█         | 10/100 [00:28<04:09,  2.77s/it] 11%|█         | 11/100 [00:31<04:05,  2.76s/it] 12%|█▏        | 12/100 [00:33<04:01,  2.75s/it] 13%|█▎        | 13/100 [00:36<03:58,  2.74s/it] 14%|█▍        | 14/100 [00:39<03:55,  2.74s/it] 15%|█▌        | 15/100 [00:41<03:50,  2.71s/it] 16%|█▌        | 16/100 [00:44<03:46,  2.70s/it] 17%|█▋        | 17/100 [00:47<03:43,  2.69s/it] 18%|█▊        | 18/100 [00:49<03:39,  2.68s/it] 19%|█▉        | 19/100 [00:52<03:40,  2.72s/it] 20%|██        | 20/100 [00:55<03:41,  2.77s/it] 21%|██        | 21/100 [00:58<03:39,  2.77s/it] 22%|██▏       | 22/100 [01:01<03:39,  2.82s/it] 23%|██▎       | 23/100 [01:04<03:37,  2.82s/it] 24%|██▍       | 24/100 [01:06<03:33,  2.81s/it] 25%|██▌       | 25/100 [01:09<03:31,  2.82s/it] 26%|██▌       | 26/100 [01:12<03:29,  2.83s/it] 27%|██▋       | 27/100 [01:15<03:25,  2.81s/it] 28%|██▊       | 28/100 [01:18<03:26,  2.86s/it] 29%|██▉       | 29/100 [01:21<03:25,  2.90s/it] 30%|███       | 30/100 [01:24<03:23,  2.90s/it] 31%|███       | 31/100 [01:27<03:19,  2.89s/it] 32%|███▏      | 32/100 [01:30<03:20,  2.95s/it] 33%|███▎      | 33/100 [01:33<03:26,  3.08s/it] 34%|███▍      | 34/100 [01:36<03:23,  3.09s/it] 35%|███▌      | 35/100 [01:39<03:22,  3.11s/it] 36%|███▌      | 36/100 [01:43<03:26,  3.23s/it] 37%|███▋      | 37/100 [01:46<03:24,  3.24s/it] 38%|███▊      | 38/100 [01:49<03:17,  3.19s/it] 39%|███▉      | 39/100 [01:52<03:11,  3.13s/it] 40%|████      | 40/100 [01:55<03:03,  3.06s/it] 41%|████      | 41/100 [01:58<03:00,  3.07s/it] 42%|████▏     | 42/100 [02:01<02:58,  3.08s/it] 43%|████▎     | 43/100 [02:05<03:10,  3.34s/it] 44%|████▍     | 44/100 [02:08<03:04,  3.29s/it] 45%|████▌     | 45/100 [02:11<02:55,  3.19s/it] 46%|████▌     | 46/100 [02:14<02:50,  3.15s/it] 47%|████▋     | 47/100 [02:17<02:44,  3.09s/it] 48%|████▊     | 48/100 [02:21<02:42,  3.13s/it] 49%|████▉     | 49/100 [02:24<02:38,  3.11s/it] 50%|█████     | 50/100 [02:27<02:36,  3.12s/it] 51%|█████     | 51/100 [02:30<02:33,  3.14s/it] 52%|█████▏    | 52/100 [02:33<02:31,  3.15s/it] 53%|█████▎    | 53/100 [02:36<02:31,  3.21s/it] 54%|█████▍    | 54/100 [02:40<02:28,  3.22s/it] 55%|█████▌    | 55/100 [02:43<02:25,  3.23s/it] 56%|█████▌    | 56/100 [02:46<02:20,  3.19s/it] 57%|█████▋    | 57/100 [02:49<02:16,  3.17s/it] 58%|█████▊    | 58/100 [02:52<02:11,  3.13s/it] 59%|█████▉    | 59/100 [02:55<02:09,  3.16s/it] 60%|██████    | 60/100 [02:59<02:05,  3.15s/it] 61%|██████    | 61/100 [03:02<02:01,  3.11s/it] 62%|██████▏   | 62/100 [03:05<01:58,  3.13s/it] 63%|██████▎   | 63/100 [03:08<01:55,  3.12s/it] 64%|██████▍   | 64/100 [03:11<01:51,  3.10s/it] 65%|██████▌   | 65/100 [03:14<01:49,  3.13s/it] 66%|██████▌   | 66/100 [03:17<01:46,  3.12s/it] 67%|██████▋   | 67/100 [03:20<01:43,  3.14s/it] 68%|██████▊   | 68/100 [03:24<01:43,  3.22s/it] 69%|██████▉   | 69/100 [03:27<01:40,  3.24s/it] 70%|███████   | 70/100 [03:30<01:36,  3.22s/it] 71%|███████   | 71/100 [03:33<01:33,  3.21s/it] 72%|███████▏  | 72/100 [03:37<01:29,  3.19s/it] 73%|███████▎  | 73/100 [03:40<01:26,  3.21s/it] 74%|███████▍  | 74/100 [03:43<01:21,  3.14s/it] 75%|███████▌  | 75/100 [03:46<01:17,  3.11s/it] 76%|███████▌  | 76/100 [03:49<01:13,  3.06s/it] 77%|███████▋  | 77/100 [03:52<01:09,  3.02s/it] 78%|███████▊  | 78/100 [03:55<01:06,  3.02s/it] 79%|███████▉  | 79/100 [03:58<01:02,  3.00s/it] 80%|████████  | 80/100 [04:01<01:00,  3.00s/it] 81%|████████  | 81/100 [04:04<00:57,  3.03s/it] 82%|████████▏ | 82/100 [04:07<00:54,  3.02s/it] 83%|████████▎ | 83/100 [04:10<00:52,  3.09s/it] 84%|████████▍ | 84/100 [04:13<00:50,  3.17s/it] 85%|████████▌ | 85/100 [04:17<00:47,  3.15s/it] 86%|████████▌ | 86/100 [04:20<00:43,  3.11s/it] 87%|████████▋ | 87/100 [04:23<00:40,  3.14s/it] 88%|████████▊ | 88/100 [04:26<00:37,  3.13s/it] 89%|████████▉ | 89/100 [04:29<00:34,  3.12s/it] 90%|█████████ | 90/100 [04:32<00:31,  3.11s/it] 91%|█████████ | 91/100 [04:35<00:28,  3.13s/it] 92%|█████████▏| 92/100 [04:38<00:24,  3.10s/it] 93%|█████████▎| 93/100 [04:41<00:21,  3.06s/it] 94%|█████████▍| 94/100 [04:44<00:18,  3.07s/it] 95%|█████████▌| 95/100 [04:47<00:15,  3.09s/it] 96%|█████████▌| 96/100 [04:51<00:12,  3.09s/it] 97%|█████████▋| 97/100 [04:54<00:09,  3.09s/it] 98%|█████████▊| 98/100 [04:57<00:06,  3.19s/it] 99%|█████████▉| 99/100 [05:00<00:03,  3.15s/it]100%|██████████| 100/100 [05:03<00:00,  3.15s/it]100%|██████████| 100/100 [05:03<00:00,  3.04s/it]
[0/100] loss: 2.7662124633789062 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.5651912689208984 loss_joints: 2.405181646347046 loss_collision: 0.15441791713237762 loss_jerk: 0.06901062279939651 loss_floor_contact: 0.5506663918495178
[2/100] loss: 2.163612127304077 loss_joints: 1.9670703411102295 loss_collision: 0.2327931970357895 loss_jerk: 0.09627145528793335 loss_floor_contact: 0.6545411944389343
[3/100] loss: 1.3984886407852173 loss_joints: 1.2810232639312744 loss_collision: 0.22043617069721222 loss_jerk: 0.10176659375429153 loss_floor_contact: 0.3409806489944458
[4/100] loss: 0.8132372498512268 loss_joints: 0.7751802802085876 loss_collision: 0.15788395702838898 loss_jerk: 0.10814717411994934 loss_floor_contact: 0.045815568417310715
[5/100] loss: 0.39934012293815613 loss_joints: 0.36983832716941833 loss_collision: 0.13680177927017212 loss_jerk: 0.10472717881202698 loss_floor_contact: 0.02139553427696228
[6/100] loss: 0.16251185536384583 loss_joints: 0.1294492781162262 loss_collision: 0.17595171928405762 loss_jerk: 0.10036624222993851 loss_floor_contact: 0.02172316424548626
[7/100] loss: 0.057483285665512085 loss_joints: 0.04125550016760826 loss_collision: 0.016108805313706398 loss_jerk: 0.09178649634122849 loss_floor_contact: 0.02175302617251873
[8/100] loss: 0.056202519685029984 loss_joints: 0.037980541586875916 loss_collision: 0.024143442511558533 loss_jerk: 0.10376914590597153 loss_floor_contact: 0.02172287367284298
[9/100] loss: 0.07755458354949951 loss_joints: 0.05798473209142685 loss_collision: 0.019943827763199806 loss_jerk: 0.12184841930866241 loss_floor_contact: 0.02156251110136509
[10/100] loss: 0.07465054094791412 loss_joints: 0.05214875563979149 loss_collision: 0.020675070583820343 loss_jerk: 0.13938669860363007 loss_floor_contact: 0.025982443243265152
[11/100] loss: 0.046266913414001465 loss_joints: 0.02187521383166313 loss_collision: 0.037080030888319016 loss_jerk: 0.15553799271583557 loss_floor_contact: 0.02051958441734314
[12/100] loss: 0.034399569034576416 loss_joints: 0.005956624634563923 loss_collision: 0.08056694269180298 loss_jerk: 0.15421162545681 loss_floor_contact: 0.019860347732901573
[13/100] loss: 0.04548709839582443 loss_joints: 0.008996935561299324 loss_collision: 0.1748747080564499 loss_jerk: 0.14179667830467224 loss_floor_contact: 0.019292093813419342
[14/100] loss: 0.04629761353135109 loss_joints: 0.011423507705330849 loss_collision: 0.1760849952697754 loss_jerk: 0.12506762146949768 loss_floor_contact: 0.019035382196307182
[15/100] loss: 0.03648809716105461 loss_joints: 0.007230858318507671 loss_collision: 0.13871164619922638 loss_jerk: 0.10641878843307495 loss_floor_contact: 0.01897677220404148
[16/100] loss: 0.025090571492910385 loss_joints: 0.004640762694180012 loss_collision: 0.06422624737024307 loss_jerk: 0.09179006516933441 loss_floor_contact: 0.019392717629671097
[17/100] loss: 0.02637808583676815 loss_joints: 0.007370570208877325 loss_collision: 0.05938490107655525 loss_jerk: 0.08286898583173752 loss_floor_contact: 0.01912851072847843
[18/100] loss: 0.02738383784890175 loss_joints: 0.008701631799340248 loss_collision: 0.05668936297297478 loss_jerk: 0.08230088651180267 loss_floor_contact: 0.019132716581225395
[19/100] loss: 0.026927703991532326 loss_joints: 0.007461138069629669 loss_collision: 0.06584198772907257 loss_jerk: 0.08114553242921829 loss_floor_contact: 0.01907125860452652
[20/100] loss: 0.023113707080483437 loss_joints: 0.0031251225154846907 loss_collision: 0.07324915379285812 loss_jerk: 0.07924158871173859 loss_floor_contact: 0.018958041444420815
[21/100] loss: 0.02164442464709282 loss_joints: 0.0025113490410149097 loss_collision: 0.06320959329605103 loss_jerk: 0.080989308655262 loss_floor_contact: 0.01885274052619934
[22/100] loss: 0.023442000150680542 loss_joints: 0.004154446069151163 loss_collision: 0.06587213277816772 loss_jerk: 0.07998301088809967 loss_floor_contact: 0.01880815625190735
[23/100] loss: 0.02135142683982849 loss_joints: 0.002370347734540701 loss_collision: 0.06639520078897476 loss_jerk: 0.07651316374540329 loss_floor_contact: 0.01876097545027733
[24/100] loss: 0.01984276808798313 loss_joints: 0.001207824214361608 loss_collision: 0.06707929074764252 loss_jerk: 0.0724116861820221 loss_floor_contact: 0.01874338649213314
[25/100] loss: 0.01998308300971985 loss_joints: 0.0021601845510303974 loss_collision: 0.05952858924865723 loss_jerk: 0.07179275900125504 loss_floor_contact: 0.01876305229961872
[26/100] loss: 0.01948493905365467 loss_joints: 0.0025694817304611206 loss_collision: 0.05026312544941902 loss_jerk: 0.07134445756673813 loss_floor_contact: 0.01901879347860813
[27/100] loss: 0.01887616701424122 loss_joints: 0.0025103241205215454 loss_collision: 0.04581515118479729 loss_jerk: 0.07100048661231995 loss_floor_contact: 0.01873711682856083
[28/100] loss: 0.016696378588676453 loss_joints: 0.0008940921979956329 loss_collision: 0.03618940711021423 loss_jerk: 0.07020905613899231 loss_floor_contact: 0.020649759098887444
[29/100] loss: 0.016601957380771637 loss_joints: 0.00044285188778303564 loss_collision: 0.040975116193294525 loss_jerk: 0.06912480294704437 loss_floor_contact: 0.020596452057361603
[30/100] loss: 0.017643051221966743 loss_joints: 0.0015412381617352366 loss_collision: 0.041264958679676056 loss_jerk: 0.06800681352615356 loss_floor_contact: 0.020698538050055504
[31/100] loss: 0.01656484417617321 loss_joints: 0.0011958208633586764 loss_collision: 0.03449742868542671 loss_jerk: 0.06786374002695084 loss_floor_contact: 0.02053162269294262
[32/100] loss: 0.014380484819412231 loss_joints: 0.00048798543866723776 loss_collision: 0.021333036944270134 loss_jerk: 0.06738309562206268 loss_floor_contact: 0.020083541050553322
[33/100] loss: 0.013767017051577568 loss_joints: 0.00013628830492962152 loss_collision: 0.018296590074896812 loss_jerk: 0.06816434115171432 loss_floor_contact: 0.019938545301556587
[34/100] loss: 0.014932586811482906 loss_joints: 0.0013207754818722606 loss_collision: 0.02051554061472416 loss_jerk: 0.06706634163856506 loss_floor_contact: 0.019414491951465607
[35/100] loss: 0.014160018414258957 loss_joints: 0.0010245110606774688 loss_collision: 0.018881240859627724 loss_jerk: 0.06664831191301346 loss_floor_contact: 0.01833021081984043
[36/100] loss: 0.012632444500923157 loss_joints: 1.2834478866352583e-06 loss_collision: 0.015052855014801025 loss_jerk: 0.0655176192522049 loss_floor_contact: 0.01829645410180092
[37/100] loss: 0.014553938992321491 loss_joints: 0.0021464324090629816 loss_collision: 0.015533708967268467 loss_jerk: 0.06278331577777863 loss_floor_contact: 0.018303215503692627
[38/100] loss: 0.015371453016996384 loss_joints: 0.0030095295514911413 loss_collision: 0.01651800610125065 loss_jerk: 0.06138931214809418 loss_floor_contact: 0.018284767866134644
[39/100] loss: 0.013392118737101555 loss_joints: 0.0010672934586182237 loss_collision: 0.016726845875382423 loss_jerk: 0.06090870872139931 loss_floor_contact: 0.01824508048593998
[40/100] loss: 0.012119365856051445 loss_joints: 0.00026446260744705796 loss_collision: 0.013487017713487148 loss_jerk: 0.05956922844052315 loss_floor_contact: 0.018197115510702133
[41/100] loss: 0.012558462098240852 loss_joints: 0.0012462008744478226 loss_collision: 0.007115321233868599 loss_jerk: 0.06052227318286896 loss_floor_contact: 0.018194006755948067
[42/100] loss: 0.01195722259581089 loss_joints: 0.0006600545020774007 loss_collision: 0.004999675787985325 loss_jerk: 0.06239943951368332 loss_floor_contact: 0.01822902448475361
[43/100] loss: 0.011560145765542984 loss_joints: 0.0003399316919967532 loss_collision: 0.003910387400537729 loss_jerk: 0.06264187395572662 loss_floor_contact: 0.01825995184481144
[44/100] loss: 0.011670609936118126 loss_joints: 0.0005462041590362787 loss_collision: 0.003924774006009102 loss_jerk: 0.061742737889289856 loss_floor_contact: 0.0182306170463562
[45/100] loss: 0.011178143322467804 loss_joints: 0.00016918662004172802 loss_collision: 0.00399807607755065 loss_jerk: 0.06069156154990196 loss_floor_contact: 0.01815997250378132
[46/100] loss: 0.01126006804406643 loss_joints: 0.00047762220492586493 loss_collision: 0.003448945004492998 loss_jerk: 0.05910179764032364 loss_floor_contact: 0.018109483644366264
[47/100] loss: 0.011147504672408104 loss_joints: 0.0002694471040740609 loss_collision: 0.005302587989717722 loss_jerk: 0.058246154338121414 loss_floor_contact: 0.01809273473918438
[48/100] loss: 0.011059112846851349 loss_joints: 0.00018908285710494965 loss_collision: 0.006006608251482248 loss_jerk: 0.0574398934841156 loss_floor_contact: 0.018101517111063004
[49/100] loss: 0.01138952374458313 loss_joints: 0.0003245144325774163 loss_collision: 0.009496305137872696 loss_jerk: 0.055997274816036224 loss_floor_contact: 0.018062608316540718
[50/100] loss: 0.010977454483509064 loss_joints: 3.57669559889473e-05 loss_collision: 0.009418252855539322 loss_jerk: 0.05496375262737274 loss_floor_contact: 0.018013950437307358
[51/100] loss: 0.010758046060800552 loss_joints: 0.0002868451992981136 loss_collision: 0.0053665656596422195 loss_jerk: 0.054407749325037 loss_floor_contact: 0.01797507517039776
[52/100] loss: 0.01030740700662136 loss_joints: 6.766607839381322e-05 loss_collision: 0.003955918829888105 loss_jerk: 0.05352320149540901 loss_floor_contact: 0.017967313528060913
[53/100] loss: 0.01021815836429596 loss_joints: 0.0002655774587765336 loss_collision: 0.0016970320139080286 loss_jerk: 0.05291871726512909 loss_floor_contact: 0.017964022234082222
[54/100] loss: 0.010153794661164284 loss_joints: 0.00033891492057591677 loss_collision: 0.0005841023521497846 loss_jerk: 0.05271885171532631 loss_floor_contact: 0.017938340082764626
[55/100] loss: 0.009930824860930443 loss_joints: 4.8086363676702604e-05 loss_collision: 0.0015533665427938104 loss_jerk: 0.052579186856746674 loss_floor_contact: 0.017877932637929916
[56/100] loss: 0.010081123560667038 loss_joints: 0.0001550372107885778 loss_collision: 0.002657906850799918 loss_jerk: 0.05202069133520126 loss_floor_contact: 0.017832905054092407
[57/100] loss: 0.010078372433781624 loss_joints: 9.127795783570036e-05 loss_collision: 0.0038483324460685253 loss_jerk: 0.05158141627907753 loss_floor_contact: 0.017776476219296455
[58/100] loss: 0.00970545969903469 loss_joints: 4.402814374770969e-05 loss_collision: 0.0012646284885704517 loss_jerk: 0.051073573529720306 loss_floor_contact: 0.01771044172346592
[59/100] loss: 0.009617473930120468 loss_joints: 6.704728730255738e-05 loss_collision: 0.0013633751077577472 loss_jerk: 0.05000601336359978 loss_floor_contact: 0.017653951421380043
[60/100] loss: 0.00951516255736351 loss_joints: 2.529296352804522e-06 loss_collision: 0.0010824799537658691 loss_jerk: 0.05001557990908623 loss_floor_contact: 0.01761130802333355
[61/100] loss: 0.009518854320049286 loss_joints: 3.170972195221111e-05 loss_collision: 0.0009723951225169003 loss_jerk: 0.05001178756356239 loss_floor_contact: 0.017554903402924538
[62/100] loss: 0.009748300537467003 loss_joints: 6.205849786056206e-05 loss_collision: 0.0029744275379925966 loss_jerk: 0.050073493272066116 loss_floor_contact: 0.017525801435112953
[63/100] loss: 0.009592246264219284 loss_joints: 1.8574930436443537e-05 loss_collision: 0.0025607116986066103 loss_jerk: 0.04946982115507126 loss_floor_contact: 0.017482472583651543
[64/100] loss: 0.009587055072188377 loss_joints: 7.534923497587442e-05 loss_collision: 0.0017411195440217853 loss_jerk: 0.04977835714817047 loss_floor_contact: 0.01743903197348118
[65/100] loss: 0.00949026271700859 loss_joints: 6.521451723529026e-05 loss_collision: 0.0009484009933657944 loss_jerk: 0.0497421994805336 loss_floor_contact: 0.017423953860998154
[66/100] loss: 0.009323637932538986 loss_joints: 6.025155744282529e-05 loss_collision: 0.0 loss_jerk: 0.049134932458400726 loss_floor_contact: 0.01739957369863987
[67/100] loss: 0.009322975762188435 loss_joints: 1.4392454431799706e-05 loss_collision: 0.0005227592191658914 loss_jerk: 0.04914803057909012 loss_floor_contact: 0.017366018146276474
[68/100] loss: 0.009244045242667198 loss_joints: 1.100059125747066e-05 loss_collision: 0.0002990216016769409 loss_jerk: 0.048735830932855606 loss_floor_contact: 0.017318235710263252
[69/100] loss: 0.009191742166876793 loss_joints: 2.7014544684789144e-05 loss_collision: 0.0 loss_jerk: 0.04848670959472656 loss_floor_contact: 0.01726422645151615
[70/100] loss: 0.00914999283850193 loss_joints: 2.809987563523464e-05 loss_collision: 0.00026521916151978076 loss_jerk: 0.047945376485586166 loss_floor_contact: 0.017203334718942642
[71/100] loss: 0.009083614684641361 loss_joints: 1.771638562786393e-05 loss_collision: 0.00035739276790991426 loss_jerk: 0.04741918668150902 loss_floor_contact: 0.01715296134352684
[72/100] loss: 0.009187983348965645 loss_joints: 6.283885159064084e-05 loss_collision: 0.0011009855661541224 loss_jerk: 0.04739487171173096 loss_floor_contact: 0.017102235928177834
[73/100] loss: 0.009101169183850288 loss_joints: 6.446026964113116e-05 loss_collision: 0.0007513579330407083 loss_jerk: 0.046977363526821136 loss_floor_contact: 0.017055349424481392
[74/100] loss: 0.009019844233989716 loss_joints: 1.2877341760031413e-05 loss_collision: 0.0009255458717234433 loss_jerk: 0.0466647744178772 loss_floor_contact: 0.016991738229990005
[75/100] loss: 0.009226412512362003 loss_joints: 1.4628958524554037e-05 loss_collision: 0.003898070892319083 loss_jerk: 0.04586842656135559 loss_floor_contact: 0.016940534114837646
[76/100] loss: 0.009199710562825203 loss_joints: 8.421150596404914e-06 loss_collision: 0.0037773235235363245 loss_jerk: 0.045867811888456345 loss_floor_contact: 0.0169071052223444
[77/100] loss: 0.008927533403038979 loss_joints: 1.808588785934262e-05 loss_collision: 0.0014692578697577119 loss_jerk: 0.0454099141061306 loss_floor_contact: 0.016886118799448013
[78/100] loss: 0.008813794702291489 loss_joints: 3.136177110718563e-05 loss_collision: 0.00023789207625668496 loss_jerk: 0.04544832929968834 loss_floor_contact: 0.016855239868164062
[79/100] loss: 0.008851908147335052 loss_joints: 1.5666073522879742e-05 loss_collision: 0.0008281717891804874 loss_jerk: 0.04544316977262497 loss_floor_contact: 0.01683642901480198
[80/100] loss: 0.008964605629444122 loss_joints: 1.28949814097723e-05 loss_collision: 0.0016474889125674963 loss_jerk: 0.045857030898332596 loss_floor_contact: 0.016805032268166542
[81/100] loss: 0.008972720243036747 loss_joints: 6.433456292143092e-05 loss_collision: 0.0011679596500471234 loss_jerk: 0.045998599380254745 loss_floor_contact: 0.016766918823122978
[82/100] loss: 0.008940041065216064 loss_joints: 6.121404294390231e-05 loss_collision: 0.001193121075630188 loss_jerk: 0.04574795439839363 loss_floor_contact: 0.016738878563046455
[83/100] loss: 0.00881972536444664 loss_joints: 4.269880446372554e-05 loss_collision: 0.0006429817876778543 loss_jerk: 0.045367155224084854 loss_floor_contact: 0.016704048961400986
[84/100] loss: 0.008717324584722519 loss_joints: 1.4690205716760829e-05 loss_collision: 0.00028025772189721465 loss_jerk: 0.045079588890075684 loss_floor_contact: 0.016666598618030548
[85/100] loss: 0.00871499814093113 loss_joints: 9.584460713085718e-06 loss_collision: 0.0005077819223515689 loss_jerk: 0.04493064805865288 loss_floor_contact: 0.016646282747387886
[86/100] loss: 0.008746679872274399 loss_joints: 2.860134918591939e-05 loss_collision: 0.0007062024669721723 loss_jerk: 0.04492507129907608 loss_floor_contact: 0.01661980152130127
[87/100] loss: 0.008749337866902351 loss_joints: 3.788657340919599e-05 loss_collision: 0.0009492255048826337 loss_jerk: 0.044685833156108856 loss_floor_contact: 0.016591783612966537
[88/100] loss: 0.008782973513007164 loss_joints: 2.3230217266245745e-05 loss_collision: 0.0015843113651499152 loss_jerk: 0.04458184167742729 loss_floor_contact: 0.016572512686252594
[89/100] loss: 0.008721072226762772 loss_joints: 1.0859559552045539e-05 loss_collision: 0.0012076281709596515 loss_jerk: 0.044508062303066254 loss_floor_contact: 0.0165545716881752
[90/100] loss: 0.00867178663611412 loss_joints: 7.345131962210871e-06 loss_collision: 0.0008689678506925702 loss_jerk: 0.044411398470401764 loss_floor_contact: 0.016545617952942848
[91/100] loss: 0.008639944717288017 loss_joints: 7.30458339148754e-07 loss_collision: 0.0007114112377166748 loss_jerk: 0.04433935880661011 loss_floor_contact: 0.016536550596356392
[92/100] loss: 0.008635761216282845 loss_joints: 1.4637607819167897e-05 loss_collision: 0.00059200992109254 loss_jerk: 0.044309619814157486 loss_floor_contact: 0.01652384176850319
[93/100] loss: 0.008598017506301403 loss_joints: 1.681757566984743e-05 loss_collision: 0.00026710497331805527 loss_jerk: 0.044247858226299286 loss_floor_contact: 0.016518814489245415
[94/100] loss: 0.008578197099268436 loss_joints: 1.0291083526681177e-05 loss_collision: 0.00019018352031707764 loss_jerk: 0.04421035572886467 loss_floor_contact: 0.016511406749486923
[95/100] loss: 0.00859569851309061 loss_joints: 1.0510744687053375e-05 loss_collision: 0.00046777891111560166 loss_jerk: 0.044131938368082047 loss_floor_contact: 0.016500864177942276
[96/100] loss: 0.008588982746005058 loss_joints: 8.565753887523897e-06 loss_collision: 0.0004680421552620828 loss_jerk: 0.04409749433398247 loss_floor_contact: 0.01649545319378376
[97/100] loss: 0.008585815317928791 loss_joints: 6.000009307172149e-06 loss_collision: 0.0005181531305424869 loss_jerk: 0.04404613748192787 loss_floor_contact: 0.016493545845150948
[98/100] loss: 0.008581174537539482 loss_joints: 3.030070729437284e-06 loss_collision: 0.0005133052472956479 loss_jerk: 0.04403828829526901 loss_floor_contact: 0.01649194024503231
[99/100] loss: 0.0085801612585783 loss_joints: 1.492187720941729e-06 loss_collision: 0.0005554258823394775 loss_jerk: 0.04400673881173134 loss_floor_contact: 0.01648981124162674
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.25_jerk0.1_skate0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 303.75942                                                    ║
    ║     rollout = 132.12869                                                    ║
    ║     sdf     = 15.94890                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00858016                                                 ║
    ║     joints    = 0.00000149                                                 ║
    ║     collision = 0.00055543                                                 ║
    ║     jerk      = 0.04400674                                                 ║
    ║     floor     = 0.01648981                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m22.163s
user	4m48.363s
sys	0m16.374s
[INFO] Running with collision=0.1, contact=0.25, jerk=0.1, skate=0.25
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:18,  3.82s/it]  2%|▏         | 2/100 [00:07<05:57,  3.64s/it]  3%|▎         | 3/100 [00:11<06:03,  3.75s/it]  4%|▍         | 4/100 [00:14<05:37,  3.51s/it]  5%|▌         | 5/100 [00:17<05:25,  3.43s/it]  6%|▌         | 6/100 [00:21<05:29,  3.51s/it]  7%|▋         | 7/100 [00:24<05:15,  3.39s/it]  8%|▊         | 8/100 [00:27<05:10,  3.37s/it]  9%|▉         | 9/100 [00:30<04:59,  3.29s/it] 10%|█         | 10/100 [00:34<04:54,  3.28s/it] 11%|█         | 11/100 [00:37<04:57,  3.34s/it] 12%|█▏        | 12/100 [00:41<04:55,  3.36s/it] 13%|█▎        | 13/100 [00:44<04:56,  3.41s/it] 14%|█▍        | 14/100 [00:48<05:01,  3.50s/it] 15%|█▌        | 15/100 [00:51<05:03,  3.57s/it] 16%|█▌        | 16/100 [00:55<04:59,  3.57s/it] 17%|█▋        | 17/100 [00:59<04:53,  3.54s/it] 18%|█▊        | 18/100 [01:02<04:55,  3.61s/it] 19%|█▉        | 19/100 [01:06<04:52,  3.61s/it] 20%|██        | 20/100 [01:10<04:54,  3.68s/it] 21%|██        | 21/100 [01:13<04:47,  3.63s/it] 22%|██▏       | 22/100 [01:17<04:39,  3.59s/it] 23%|██▎       | 23/100 [01:20<04:36,  3.60s/it] 24%|██▍       | 24/100 [01:24<04:27,  3.52s/it] 25%|██▌       | 25/100 [01:27<04:19,  3.46s/it] 26%|██▌       | 26/100 [01:31<04:16,  3.46s/it] 27%|██▋       | 27/100 [01:34<04:10,  3.43s/it] 28%|██▊       | 28/100 [01:37<04:06,  3.42s/it] 29%|██▉       | 29/100 [01:41<03:58,  3.36s/it] 30%|███       | 30/100 [01:44<03:50,  3.30s/it] 31%|███       | 31/100 [01:47<03:44,  3.25s/it] 32%|███▏      | 32/100 [01:50<03:39,  3.23s/it] 33%|███▎      | 33/100 [01:53<03:39,  3.27s/it] 34%|███▍      | 34/100 [01:57<03:40,  3.34s/it] 35%|███▌      | 35/100 [02:00<03:33,  3.29s/it] 36%|███▌      | 36/100 [02:03<03:30,  3.29s/it] 37%|███▋      | 37/100 [02:06<03:23,  3.23s/it] 38%|███▊      | 38/100 [02:10<03:18,  3.20s/it] 39%|███▉      | 39/100 [02:13<03:15,  3.20s/it] 40%|████      | 40/100 [02:16<03:12,  3.21s/it] 41%|████      | 41/100 [02:19<03:13,  3.28s/it] 42%|████▏     | 42/100 [02:22<03:05,  3.19s/it] 43%|████▎     | 43/100 [02:26<03:00,  3.17s/it] 44%|████▍     | 44/100 [02:29<03:01,  3.23s/it] 45%|████▌     | 45/100 [02:32<02:57,  3.23s/it] 46%|████▌     | 46/100 [02:35<02:52,  3.19s/it] 47%|████▋     | 47/100 [02:38<02:49,  3.20s/it] 48%|████▊     | 48/100 [02:42<02:44,  3.17s/it] 49%|████▉     | 49/100 [02:45<02:38,  3.11s/it] 50%|█████     | 50/100 [02:48<02:35,  3.10s/it] 51%|█████     | 51/100 [02:51<02:30,  3.08s/it] 52%|█████▏    | 52/100 [02:54<02:28,  3.09s/it] 53%|█████▎    | 53/100 [02:57<02:25,  3.10s/it] 54%|█████▍    | 54/100 [03:00<02:22,  3.09s/it] 55%|█████▌    | 55/100 [03:03<02:18,  3.07s/it] 56%|█████▌    | 56/100 [03:06<02:15,  3.08s/it] 57%|█████▋    | 57/100 [03:09<02:12,  3.07s/it] 58%|█████▊    | 58/100 [03:12<02:08,  3.05s/it] 59%|█████▉    | 59/100 [03:15<02:07,  3.10s/it] 60%|██████    | 60/100 [03:19<02:06,  3.15s/it] 61%|██████    | 61/100 [03:22<02:05,  3.23s/it] 62%|██████▏   | 62/100 [03:25<02:05,  3.29s/it] 63%|██████▎   | 63/100 [03:29<01:59,  3.23s/it] 64%|██████▍   | 64/100 [03:32<01:54,  3.17s/it] 65%|██████▌   | 65/100 [03:35<01:50,  3.17s/it] 66%|██████▌   | 66/100 [03:38<01:46,  3.14s/it] 67%|██████▋   | 67/100 [03:41<01:42,  3.11s/it] 68%|██████▊   | 68/100 [03:44<01:39,  3.10s/it] 69%|██████▉   | 69/100 [03:47<01:36,  3.11s/it] 70%|███████   | 70/100 [03:50<01:35,  3.20s/it] 71%|███████   | 71/100 [03:54<01:32,  3.18s/it] 72%|███████▏  | 72/100 [03:57<01:30,  3.25s/it] 73%|███████▎  | 73/100 [04:00<01:26,  3.19s/it] 74%|███████▍  | 74/100 [04:03<01:22,  3.18s/it] 75%|███████▌  | 75/100 [04:06<01:19,  3.18s/it] 76%|███████▌  | 76/100 [04:10<01:16,  3.20s/it] 77%|███████▋  | 77/100 [04:13<01:12,  3.15s/it] 78%|███████▊  | 78/100 [04:16<01:09,  3.15s/it] 79%|███████▉  | 79/100 [04:19<01:06,  3.14s/it] 80%|████████  | 80/100 [04:22<01:02,  3.13s/it] 81%|████████  | 81/100 [04:25<00:59,  3.11s/it] 82%|████████▏ | 82/100 [04:28<00:55,  3.10s/it] 83%|████████▎ | 83/100 [04:31<00:52,  3.08s/it] 84%|████████▍ | 84/100 [04:35<00:51,  3.22s/it] 85%|████████▌ | 85/100 [04:38<00:48,  3.25s/it] 86%|████████▌ | 86/100 [04:41<00:45,  3.23s/it] 87%|████████▋ | 87/100 [04:45<00:42,  3.25s/it] 88%|████████▊ | 88/100 [04:48<00:38,  3.17s/it] 89%|████████▉ | 89/100 [04:51<00:34,  3.12s/it] 90%|█████████ | 90/100 [04:54<00:31,  3.11s/it] 91%|█████████ | 91/100 [04:57<00:27,  3.10s/it] 92%|█████████▏| 92/100 [05:00<00:24,  3.12s/it] 93%|█████████▎| 93/100 [05:03<00:22,  3.24s/it] 94%|█████████▍| 94/100 [05:07<00:19,  3.26s/it] 95%|█████████▌| 95/100 [05:10<00:15,  3.18s/it] 96%|█████████▌| 96/100 [05:13<00:12,  3.12s/it] 97%|█████████▋| 97/100 [05:16<00:09,  3.13s/it] 98%|█████████▊| 98/100 [05:19<00:06,  3.17s/it] 99%|█████████▉| 99/100 [05:22<00:03,  3.15s/it]100%|██████████| 100/100 [05:25<00:00,  3.16s/it]100%|██████████| 100/100 [05:25<00:00,  3.26s/it]
[0/100] loss: 2.7662124633789062 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.5651912689208984 loss_joints: 2.405181646347046 loss_collision: 0.15441791713237762 loss_jerk: 0.06901062279939651 loss_floor_contact: 0.5506663918495178
[2/100] loss: 2.163612127304077 loss_joints: 1.9670703411102295 loss_collision: 0.2327931970357895 loss_jerk: 0.09627145528793335 loss_floor_contact: 0.6545411944389343
[3/100] loss: 1.3984886407852173 loss_joints: 1.2810232639312744 loss_collision: 0.22043617069721222 loss_jerk: 0.10176659375429153 loss_floor_contact: 0.3409806489944458
[4/100] loss: 0.8132372498512268 loss_joints: 0.7751802802085876 loss_collision: 0.15788395702838898 loss_jerk: 0.10814717411994934 loss_floor_contact: 0.045815568417310715
[5/100] loss: 0.39934012293815613 loss_joints: 0.36983832716941833 loss_collision: 0.13680177927017212 loss_jerk: 0.10472717881202698 loss_floor_contact: 0.02139553427696228
[6/100] loss: 0.16251185536384583 loss_joints: 0.1294492781162262 loss_collision: 0.17595171928405762 loss_jerk: 0.10036624222993851 loss_floor_contact: 0.02172316424548626
[7/100] loss: 0.057483285665512085 loss_joints: 0.04125550016760826 loss_collision: 0.016108805313706398 loss_jerk: 0.09178649634122849 loss_floor_contact: 0.02175302617251873
[8/100] loss: 0.056202519685029984 loss_joints: 0.037980541586875916 loss_collision: 0.024143442511558533 loss_jerk: 0.10376914590597153 loss_floor_contact: 0.02172287367284298
[9/100] loss: 0.07755458354949951 loss_joints: 0.05798473209142685 loss_collision: 0.019943827763199806 loss_jerk: 0.12184841930866241 loss_floor_contact: 0.02156251110136509
[10/100] loss: 0.07465054094791412 loss_joints: 0.05214875563979149 loss_collision: 0.020675070583820343 loss_jerk: 0.13938669860363007 loss_floor_contact: 0.025982443243265152
[11/100] loss: 0.046266913414001465 loss_joints: 0.02187521383166313 loss_collision: 0.037080030888319016 loss_jerk: 0.15553799271583557 loss_floor_contact: 0.02051958441734314
[12/100] loss: 0.034399569034576416 loss_joints: 0.005956624634563923 loss_collision: 0.08056694269180298 loss_jerk: 0.15421162545681 loss_floor_contact: 0.019860347732901573
[13/100] loss: 0.04548709839582443 loss_joints: 0.008996935561299324 loss_collision: 0.1748747080564499 loss_jerk: 0.14179667830467224 loss_floor_contact: 0.019292093813419342
[14/100] loss: 0.04629761353135109 loss_joints: 0.011423507705330849 loss_collision: 0.1760849952697754 loss_jerk: 0.12506762146949768 loss_floor_contact: 0.019035382196307182
[15/100] loss: 0.03648809716105461 loss_joints: 0.007230858318507671 loss_collision: 0.13871164619922638 loss_jerk: 0.10641878843307495 loss_floor_contact: 0.01897677220404148
[16/100] loss: 0.025090571492910385 loss_joints: 0.004640762694180012 loss_collision: 0.06422624737024307 loss_jerk: 0.09179006516933441 loss_floor_contact: 0.019392717629671097
[17/100] loss: 0.02637808583676815 loss_joints: 0.007370570208877325 loss_collision: 0.05938490107655525 loss_jerk: 0.08286898583173752 loss_floor_contact: 0.01912851072847843
[18/100] loss: 0.02738383784890175 loss_joints: 0.008701631799340248 loss_collision: 0.05668936297297478 loss_jerk: 0.08230088651180267 loss_floor_contact: 0.019132716581225395
[19/100] loss: 0.026927703991532326 loss_joints: 0.007461138069629669 loss_collision: 0.06584198772907257 loss_jerk: 0.08114553242921829 loss_floor_contact: 0.01907125860452652
[20/100] loss: 0.023113707080483437 loss_joints: 0.0031251225154846907 loss_collision: 0.07324915379285812 loss_jerk: 0.07924158871173859 loss_floor_contact: 0.018958041444420815
[21/100] loss: 0.02164442464709282 loss_joints: 0.0025113490410149097 loss_collision: 0.06320959329605103 loss_jerk: 0.080989308655262 loss_floor_contact: 0.01885274052619934
[22/100] loss: 0.023442000150680542 loss_joints: 0.004154446069151163 loss_collision: 0.06587213277816772 loss_jerk: 0.07998301088809967 loss_floor_contact: 0.01880815625190735
[23/100] loss: 0.02135142683982849 loss_joints: 0.002370347734540701 loss_collision: 0.06639520078897476 loss_jerk: 0.07651316374540329 loss_floor_contact: 0.01876097545027733
[24/100] loss: 0.01984276808798313 loss_joints: 0.001207824214361608 loss_collision: 0.06707929074764252 loss_jerk: 0.0724116861820221 loss_floor_contact: 0.01874338649213314
[25/100] loss: 0.01998308300971985 loss_joints: 0.0021601845510303974 loss_collision: 0.05952858924865723 loss_jerk: 0.07179275900125504 loss_floor_contact: 0.01876305229961872
[26/100] loss: 0.01948493905365467 loss_joints: 0.0025694817304611206 loss_collision: 0.05026312544941902 loss_jerk: 0.07134445756673813 loss_floor_contact: 0.01901879347860813
[27/100] loss: 0.01887616701424122 loss_joints: 0.0025103241205215454 loss_collision: 0.04581515118479729 loss_jerk: 0.07100048661231995 loss_floor_contact: 0.01873711682856083
[28/100] loss: 0.016696378588676453 loss_joints: 0.0008940921979956329 loss_collision: 0.03618940711021423 loss_jerk: 0.07020905613899231 loss_floor_contact: 0.020649759098887444
[29/100] loss: 0.016601957380771637 loss_joints: 0.00044285188778303564 loss_collision: 0.040975116193294525 loss_jerk: 0.06912480294704437 loss_floor_contact: 0.020596452057361603
[30/100] loss: 0.017643051221966743 loss_joints: 0.0015412381617352366 loss_collision: 0.041264958679676056 loss_jerk: 0.06800681352615356 loss_floor_contact: 0.020698538050055504
[31/100] loss: 0.01656484417617321 loss_joints: 0.0011958208633586764 loss_collision: 0.03449742868542671 loss_jerk: 0.06786374002695084 loss_floor_contact: 0.02053162269294262
[32/100] loss: 0.014380484819412231 loss_joints: 0.00048798543866723776 loss_collision: 0.021333036944270134 loss_jerk: 0.06738309562206268 loss_floor_contact: 0.020083541050553322
[33/100] loss: 0.013767017051577568 loss_joints: 0.00013628830492962152 loss_collision: 0.018296590074896812 loss_jerk: 0.06816434115171432 loss_floor_contact: 0.019938545301556587
[34/100] loss: 0.014932586811482906 loss_joints: 0.0013207754818722606 loss_collision: 0.02051554061472416 loss_jerk: 0.06706634163856506 loss_floor_contact: 0.019414491951465607
[35/100] loss: 0.014160018414258957 loss_joints: 0.0010245110606774688 loss_collision: 0.018881240859627724 loss_jerk: 0.06664831191301346 loss_floor_contact: 0.01833021081984043
[36/100] loss: 0.012632444500923157 loss_joints: 1.2834478866352583e-06 loss_collision: 0.015052855014801025 loss_jerk: 0.0655176192522049 loss_floor_contact: 0.01829645410180092
[37/100] loss: 0.014553938992321491 loss_joints: 0.0021464324090629816 loss_collision: 0.015533708967268467 loss_jerk: 0.06278331577777863 loss_floor_contact: 0.018303215503692627
[38/100] loss: 0.015371453016996384 loss_joints: 0.0030095295514911413 loss_collision: 0.01651800610125065 loss_jerk: 0.06138931214809418 loss_floor_contact: 0.018284767866134644
[39/100] loss: 0.013392118737101555 loss_joints: 0.0010672934586182237 loss_collision: 0.016726845875382423 loss_jerk: 0.06090870872139931 loss_floor_contact: 0.01824508048593998
[40/100] loss: 0.012119365856051445 loss_joints: 0.00026446260744705796 loss_collision: 0.013487017713487148 loss_jerk: 0.05956922844052315 loss_floor_contact: 0.018197115510702133
[41/100] loss: 0.012558462098240852 loss_joints: 0.0012462008744478226 loss_collision: 0.007115321233868599 loss_jerk: 0.06052227318286896 loss_floor_contact: 0.018194006755948067
[42/100] loss: 0.01195722259581089 loss_joints: 0.0006600545020774007 loss_collision: 0.004999675787985325 loss_jerk: 0.06239943951368332 loss_floor_contact: 0.01822902448475361
[43/100] loss: 0.011560145765542984 loss_joints: 0.0003399316919967532 loss_collision: 0.003910387400537729 loss_jerk: 0.06264187395572662 loss_floor_contact: 0.01825995184481144
[44/100] loss: 0.011670609936118126 loss_joints: 0.0005462041590362787 loss_collision: 0.003924774006009102 loss_jerk: 0.061742737889289856 loss_floor_contact: 0.0182306170463562
[45/100] loss: 0.011178143322467804 loss_joints: 0.00016918662004172802 loss_collision: 0.00399807607755065 loss_jerk: 0.06069156154990196 loss_floor_contact: 0.01815997250378132
[46/100] loss: 0.01126006804406643 loss_joints: 0.00047762220492586493 loss_collision: 0.003448945004492998 loss_jerk: 0.05910179764032364 loss_floor_contact: 0.018109483644366264
[47/100] loss: 0.011147504672408104 loss_joints: 0.0002694471040740609 loss_collision: 0.005302587989717722 loss_jerk: 0.058246154338121414 loss_floor_contact: 0.01809273473918438
[48/100] loss: 0.011059112846851349 loss_joints: 0.00018908285710494965 loss_collision: 0.006006608251482248 loss_jerk: 0.0574398934841156 loss_floor_contact: 0.018101517111063004
[49/100] loss: 0.01138952374458313 loss_joints: 0.0003245144325774163 loss_collision: 0.009496305137872696 loss_jerk: 0.055997274816036224 loss_floor_contact: 0.018062608316540718
[50/100] loss: 0.010977454483509064 loss_joints: 3.57669559889473e-05 loss_collision: 0.009418252855539322 loss_jerk: 0.05496375262737274 loss_floor_contact: 0.018013950437307358
[51/100] loss: 0.010758046060800552 loss_joints: 0.0002868451992981136 loss_collision: 0.0053665656596422195 loss_jerk: 0.054407749325037 loss_floor_contact: 0.01797507517039776
[52/100] loss: 0.01030740700662136 loss_joints: 6.766607839381322e-05 loss_collision: 0.003955918829888105 loss_jerk: 0.05352320149540901 loss_floor_contact: 0.017967313528060913
[53/100] loss: 0.01021815836429596 loss_joints: 0.0002655774587765336 loss_collision: 0.0016970320139080286 loss_jerk: 0.05291871726512909 loss_floor_contact: 0.017964022234082222
[54/100] loss: 0.010153794661164284 loss_joints: 0.00033891492057591677 loss_collision: 0.0005841023521497846 loss_jerk: 0.05271885171532631 loss_floor_contact: 0.017938340082764626
[55/100] loss: 0.009930824860930443 loss_joints: 4.8086363676702604e-05 loss_collision: 0.0015533665427938104 loss_jerk: 0.052579186856746674 loss_floor_contact: 0.017877932637929916
[56/100] loss: 0.010081123560667038 loss_joints: 0.0001550372107885778 loss_collision: 0.002657906850799918 loss_jerk: 0.05202069133520126 loss_floor_contact: 0.017832905054092407
[57/100] loss: 0.010078372433781624 loss_joints: 9.127795783570036e-05 loss_collision: 0.0038483324460685253 loss_jerk: 0.05158141627907753 loss_floor_contact: 0.017776476219296455
[58/100] loss: 0.00970545969903469 loss_joints: 4.402814374770969e-05 loss_collision: 0.0012646284885704517 loss_jerk: 0.051073573529720306 loss_floor_contact: 0.01771044172346592
[59/100] loss: 0.009617473930120468 loss_joints: 6.704728730255738e-05 loss_collision: 0.0013633751077577472 loss_jerk: 0.05000601336359978 loss_floor_contact: 0.017653951421380043
[60/100] loss: 0.00951516255736351 loss_joints: 2.529296352804522e-06 loss_collision: 0.0010824799537658691 loss_jerk: 0.05001557990908623 loss_floor_contact: 0.01761130802333355
[61/100] loss: 0.009518854320049286 loss_joints: 3.170972195221111e-05 loss_collision: 0.0009723951225169003 loss_jerk: 0.05001178756356239 loss_floor_contact: 0.017554903402924538
[62/100] loss: 0.009748300537467003 loss_joints: 6.205849786056206e-05 loss_collision: 0.0029744275379925966 loss_jerk: 0.050073493272066116 loss_floor_contact: 0.017525801435112953
[63/100] loss: 0.009592246264219284 loss_joints: 1.8574930436443537e-05 loss_collision: 0.0025607116986066103 loss_jerk: 0.04946982115507126 loss_floor_contact: 0.017482472583651543
[64/100] loss: 0.009587055072188377 loss_joints: 7.534923497587442e-05 loss_collision: 0.0017411195440217853 loss_jerk: 0.04977835714817047 loss_floor_contact: 0.01743903197348118
[65/100] loss: 0.00949026271700859 loss_joints: 6.521451723529026e-05 loss_collision: 0.0009484009933657944 loss_jerk: 0.0497421994805336 loss_floor_contact: 0.017423953860998154
[66/100] loss: 0.009323637932538986 loss_joints: 6.025155744282529e-05 loss_collision: 0.0 loss_jerk: 0.049134932458400726 loss_floor_contact: 0.01739957369863987
[67/100] loss: 0.009322975762188435 loss_joints: 1.4392454431799706e-05 loss_collision: 0.0005227592191658914 loss_jerk: 0.04914803057909012 loss_floor_contact: 0.017366018146276474
[68/100] loss: 0.009244045242667198 loss_joints: 1.100059125747066e-05 loss_collision: 0.0002990216016769409 loss_jerk: 0.048735830932855606 loss_floor_contact: 0.017318235710263252
[69/100] loss: 0.009191742166876793 loss_joints: 2.7014544684789144e-05 loss_collision: 0.0 loss_jerk: 0.04848670959472656 loss_floor_contact: 0.01726422645151615
[70/100] loss: 0.00914999283850193 loss_joints: 2.809987563523464e-05 loss_collision: 0.00026521916151978076 loss_jerk: 0.047945376485586166 loss_floor_contact: 0.017203334718942642
[71/100] loss: 0.009083614684641361 loss_joints: 1.771638562786393e-05 loss_collision: 0.00035739276790991426 loss_jerk: 0.04741918668150902 loss_floor_contact: 0.01715296134352684
[72/100] loss: 0.009187983348965645 loss_joints: 6.283885159064084e-05 loss_collision: 0.0011009855661541224 loss_jerk: 0.04739487171173096 loss_floor_contact: 0.017102235928177834
[73/100] loss: 0.009101169183850288 loss_joints: 6.446026964113116e-05 loss_collision: 0.0007513579330407083 loss_jerk: 0.046977363526821136 loss_floor_contact: 0.017055349424481392
[74/100] loss: 0.009019844233989716 loss_joints: 1.2877341760031413e-05 loss_collision: 0.0009255458717234433 loss_jerk: 0.0466647744178772 loss_floor_contact: 0.016991738229990005
[75/100] loss: 0.009226412512362003 loss_joints: 1.4628958524554037e-05 loss_collision: 0.003898070892319083 loss_jerk: 0.04586842656135559 loss_floor_contact: 0.016940534114837646
[76/100] loss: 0.009199710562825203 loss_joints: 8.421150596404914e-06 loss_collision: 0.0037773235235363245 loss_jerk: 0.045867811888456345 loss_floor_contact: 0.0169071052223444
[77/100] loss: 0.008927533403038979 loss_joints: 1.808588785934262e-05 loss_collision: 0.0014692578697577119 loss_jerk: 0.0454099141061306 loss_floor_contact: 0.016886118799448013
[78/100] loss: 0.008813794702291489 loss_joints: 3.136177110718563e-05 loss_collision: 0.00023789207625668496 loss_jerk: 0.04544832929968834 loss_floor_contact: 0.016855239868164062
[79/100] loss: 0.008851908147335052 loss_joints: 1.5666073522879742e-05 loss_collision: 0.0008281717891804874 loss_jerk: 0.04544316977262497 loss_floor_contact: 0.01683642901480198
[80/100] loss: 0.008964605629444122 loss_joints: 1.28949814097723e-05 loss_collision: 0.0016474889125674963 loss_jerk: 0.045857030898332596 loss_floor_contact: 0.016805032268166542
[81/100] loss: 0.008972720243036747 loss_joints: 6.433456292143092e-05 loss_collision: 0.0011679596500471234 loss_jerk: 0.045998599380254745 loss_floor_contact: 0.016766918823122978
[82/100] loss: 0.008940041065216064 loss_joints: 6.121404294390231e-05 loss_collision: 0.001193121075630188 loss_jerk: 0.04574795439839363 loss_floor_contact: 0.016738878563046455
[83/100] loss: 0.00881972536444664 loss_joints: 4.269880446372554e-05 loss_collision: 0.0006429817876778543 loss_jerk: 0.045367155224084854 loss_floor_contact: 0.016704048961400986
[84/100] loss: 0.008717324584722519 loss_joints: 1.4690205716760829e-05 loss_collision: 0.00028025772189721465 loss_jerk: 0.045079588890075684 loss_floor_contact: 0.016666598618030548
[85/100] loss: 0.00871499814093113 loss_joints: 9.584460713085718e-06 loss_collision: 0.0005077819223515689 loss_jerk: 0.04493064805865288 loss_floor_contact: 0.016646282747387886
[86/100] loss: 0.008746679872274399 loss_joints: 2.860134918591939e-05 loss_collision: 0.0007062024669721723 loss_jerk: 0.04492507129907608 loss_floor_contact: 0.01661980152130127
[87/100] loss: 0.008749337866902351 loss_joints: 3.788657340919599e-05 loss_collision: 0.0009492255048826337 loss_jerk: 0.044685833156108856 loss_floor_contact: 0.016591783612966537
[88/100] loss: 0.008782973513007164 loss_joints: 2.3230217266245745e-05 loss_collision: 0.0015843113651499152 loss_jerk: 0.04458184167742729 loss_floor_contact: 0.016572512686252594
[89/100] loss: 0.008721072226762772 loss_joints: 1.0859559552045539e-05 loss_collision: 0.0012076281709596515 loss_jerk: 0.044508062303066254 loss_floor_contact: 0.0165545716881752
[90/100] loss: 0.00867178663611412 loss_joints: 7.345131962210871e-06 loss_collision: 0.0008689678506925702 loss_jerk: 0.044411398470401764 loss_floor_contact: 0.016545617952942848
[91/100] loss: 0.008639944717288017 loss_joints: 7.30458339148754e-07 loss_collision: 0.0007114112377166748 loss_jerk: 0.04433935880661011 loss_floor_contact: 0.016536550596356392
[92/100] loss: 0.008635761216282845 loss_joints: 1.4637607819167897e-05 loss_collision: 0.00059200992109254 loss_jerk: 0.044309619814157486 loss_floor_contact: 0.01652384176850319
[93/100] loss: 0.008598017506301403 loss_joints: 1.681757566984743e-05 loss_collision: 0.00026710497331805527 loss_jerk: 0.044247858226299286 loss_floor_contact: 0.016518814489245415
[94/100] loss: 0.008578197099268436 loss_joints: 1.0291083526681177e-05 loss_collision: 0.00019018352031707764 loss_jerk: 0.04421035572886467 loss_floor_contact: 0.016511406749486923
[95/100] loss: 0.00859569851309061 loss_joints: 1.0510744687053375e-05 loss_collision: 0.00046777891111560166 loss_jerk: 0.044131938368082047 loss_floor_contact: 0.016500864177942276
[96/100] loss: 0.008588982746005058 loss_joints: 8.565753887523897e-06 loss_collision: 0.0004680421552620828 loss_jerk: 0.04409749433398247 loss_floor_contact: 0.01649545319378376
[97/100] loss: 0.008585815317928791 loss_joints: 6.000009307172149e-06 loss_collision: 0.0005181531305424869 loss_jerk: 0.04404613748192787 loss_floor_contact: 0.016493545845150948
[98/100] loss: 0.008581174537539482 loss_joints: 3.030070729437284e-06 loss_collision: 0.0005133052472956479 loss_jerk: 0.04403828829526901 loss_floor_contact: 0.01649194024503231
[99/100] loss: 0.0085801612585783 loss_joints: 1.492187720941729e-06 loss_collision: 0.0005554258823394775 loss_jerk: 0.04400673881173134 loss_floor_contact: 0.01648981124162674
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.25_jerk0.1_skate0.25]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 325.93830                                                    ║
    ║     rollout = 147.81080                                                    ║
    ║     sdf     = 16.56740                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00858016                                                 ║
    ║     joints    = 0.00000149                                                 ║
    ║     collision = 0.00055543                                                 ║
    ║     jerk      = 0.04400674                                                 ║
    ║     floor     = 0.01648981                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m46.725s
user	5m7.181s
sys	0m23.884s
[INFO] Running with collision=0.1, contact=0.25, jerk=0.1, skate=0.5
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:33,  3.36s/it]  2%|▏         | 2/100 [00:06<04:58,  3.04s/it]  3%|▎         | 3/100 [00:09<05:25,  3.36s/it]  4%|▍         | 4/100 [00:12<05:10,  3.24s/it]  5%|▌         | 5/100 [00:16<05:00,  3.17s/it]  6%|▌         | 6/100 [00:19<05:07,  3.27s/it]  7%|▋         | 7/100 [00:22<05:00,  3.23s/it]  8%|▊         | 8/100 [00:25<04:56,  3.22s/it]  9%|▉         | 9/100 [00:28<04:49,  3.19s/it] 10%|█         | 10/100 [00:31<04:40,  3.11s/it] 11%|█         | 11/100 [00:34<04:35,  3.09s/it] 12%|█▏        | 12/100 [00:37<04:29,  3.06s/it] 13%|█▎        | 13/100 [00:41<04:32,  3.14s/it] 14%|█▍        | 14/100 [00:44<04:27,  3.11s/it] 15%|█▌        | 15/100 [00:47<04:23,  3.10s/it] 16%|█▌        | 16/100 [00:50<04:24,  3.15s/it] 17%|█▋        | 17/100 [00:53<04:18,  3.12s/it] 18%|█▊        | 18/100 [00:57<04:22,  3.21s/it] 19%|█▉        | 19/100 [01:00<04:25,  3.28s/it] 20%|██        | 20/100 [01:04<04:29,  3.37s/it] 21%|██        | 21/100 [01:07<04:20,  3.29s/it] 22%|██▏       | 22/100 [01:10<04:18,  3.31s/it] 23%|██▎       | 23/100 [01:13<04:08,  3.23s/it] 24%|██▍       | 24/100 [01:17<04:09,  3.29s/it] 25%|██▌       | 25/100 [01:20<04:12,  3.37s/it] 26%|██▌       | 26/100 [01:24<04:17,  3.47s/it] 27%|██▋       | 27/100 [01:27<04:15,  3.49s/it] 28%|██▊       | 28/100 [01:31<04:06,  3.43s/it] 29%|██▉       | 29/100 [01:34<03:56,  3.33s/it] 30%|███       | 30/100 [01:37<03:48,  3.26s/it] 31%|███       | 31/100 [01:40<03:42,  3.22s/it] 32%|███▏      | 32/100 [01:43<03:39,  3.23s/it] 33%|███▎      | 33/100 [01:47<03:41,  3.30s/it] 34%|███▍      | 34/100 [01:50<03:38,  3.30s/it] 35%|███▌      | 35/100 [01:53<03:29,  3.23s/it] 36%|███▌      | 36/100 [01:56<03:28,  3.26s/it] 37%|███▋      | 37/100 [02:00<03:23,  3.22s/it] 38%|███▊      | 38/100 [02:03<03:15,  3.15s/it] 39%|███▉      | 39/100 [02:06<03:09,  3.11s/it] 40%|████      | 40/100 [02:08<03:02,  3.03s/it] 41%|████      | 41/100 [02:11<02:57,  3.00s/it] 42%|████▏     | 42/100 [02:14<02:54,  3.00s/it] 43%|████▎     | 43/100 [02:17<02:51,  3.01s/it] 44%|████▍     | 44/100 [02:21<02:54,  3.11s/it] 45%|████▌     | 45/100 [02:24<02:53,  3.16s/it] 46%|████▌     | 46/100 [02:27<02:51,  3.17s/it] 47%|████▋     | 47/100 [02:30<02:44,  3.11s/it] 48%|████▊     | 48/100 [02:33<02:40,  3.08s/it] 49%|████▉     | 49/100 [02:36<02:34,  3.04s/it] 50%|█████     | 50/100 [02:39<02:34,  3.09s/it] 51%|█████     | 51/100 [02:42<02:28,  3.03s/it] 52%|█████▏    | 52/100 [02:46<02:31,  3.15s/it] 53%|█████▎    | 53/100 [02:49<02:28,  3.16s/it] 54%|█████▍    | 54/100 [02:52<02:23,  3.12s/it] 55%|█████▌    | 55/100 [02:55<02:17,  3.05s/it] 56%|█████▌    | 56/100 [02:58<02:11,  2.99s/it] 57%|█████▋    | 57/100 [03:01<02:09,  3.01s/it] 58%|█████▊    | 58/100 [03:04<02:06,  3.01s/it] 59%|█████▉    | 59/100 [03:07<02:03,  3.02s/it] 60%|██████    | 60/100 [03:10<01:59,  3.00s/it] 61%|██████    | 61/100 [03:13<01:58,  3.03s/it] 62%|██████▏   | 62/100 [03:16<01:53,  2.99s/it] 63%|██████▎   | 63/100 [03:19<01:50,  2.97s/it] 64%|██████▍   | 64/100 [03:22<01:47,  2.98s/it] 65%|██████▌   | 65/100 [03:24<01:43,  2.97s/it] 66%|██████▌   | 66/100 [03:27<01:41,  2.97s/it] 67%|██████▋   | 67/100 [03:30<01:37,  2.95s/it] 68%|██████▊   | 68/100 [03:33<01:34,  2.96s/it] 69%|██████▉   | 69/100 [03:36<01:31,  2.97s/it] 70%|███████   | 70/100 [03:39<01:29,  2.98s/it] 71%|███████   | 71/100 [03:42<01:27,  3.02s/it] 72%|███████▏  | 72/100 [03:46<01:28,  3.15s/it] 73%|███████▎  | 73/100 [03:49<01:25,  3.17s/it] 74%|███████▍  | 74/100 [03:52<01:22,  3.19s/it] 75%|███████▌  | 75/100 [03:55<01:18,  3.13s/it] 76%|███████▌  | 76/100 [03:58<01:13,  3.07s/it] 77%|███████▋  | 77/100 [04:01<01:09,  3.03s/it] 78%|███████▊  | 78/100 [04:04<01:08,  3.10s/it] 79%|███████▉  | 79/100 [04:07<01:04,  3.08s/it] 80%|████████  | 80/100 [04:10<01:00,  3.02s/it] 81%|████████  | 81/100 [04:13<00:56,  2.99s/it] 82%|████████▏ | 82/100 [04:16<00:53,  2.99s/it] 83%|████████▎ | 83/100 [04:19<00:50,  2.97s/it] 84%|████████▍ | 84/100 [04:22<00:47,  3.00s/it] 85%|████████▌ | 85/100 [04:25<00:45,  3.02s/it] 86%|████████▌ | 86/100 [04:28<00:42,  3.05s/it] 87%|████████▋ | 87/100 [04:32<00:39,  3.07s/it] 88%|████████▊ | 88/100 [04:35<00:36,  3.07s/it] 89%|████████▉ | 89/100 [04:38<00:33,  3.07s/it] 90%|█████████ | 90/100 [04:41<00:30,  3.07s/it] 91%|█████████ | 91/100 [04:44<00:27,  3.06s/it] 92%|█████████▏| 92/100 [04:47<00:24,  3.04s/it] 93%|█████████▎| 93/100 [04:50<00:21,  3.06s/it] 94%|█████████▍| 94/100 [04:53<00:18,  3.03s/it] 95%|█████████▌| 95/100 [04:56<00:14,  2.99s/it] 96%|█████████▌| 96/100 [04:59<00:11,  2.96s/it] 97%|█████████▋| 97/100 [05:02<00:09,  3.00s/it] 98%|█████████▊| 98/100 [05:05<00:06,  3.02s/it] 99%|█████████▉| 99/100 [05:08<00:03,  3.06s/it]100%|██████████| 100/100 [05:11<00:00,  2.99s/it]100%|██████████| 100/100 [05:11<00:00,  3.11s/it]
[0/100] loss: 2.7662124633789062 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.5651912689208984 loss_joints: 2.405181646347046 loss_collision: 0.15441791713237762 loss_jerk: 0.06901062279939651 loss_floor_contact: 0.5506663918495178
[2/100] loss: 2.163612127304077 loss_joints: 1.9670703411102295 loss_collision: 0.2327931970357895 loss_jerk: 0.09627145528793335 loss_floor_contact: 0.6545411944389343
[3/100] loss: 1.3984886407852173 loss_joints: 1.2810232639312744 loss_collision: 0.22043617069721222 loss_jerk: 0.10176659375429153 loss_floor_contact: 0.3409806489944458
[4/100] loss: 0.8132372498512268 loss_joints: 0.7751802802085876 loss_collision: 0.15788395702838898 loss_jerk: 0.10814717411994934 loss_floor_contact: 0.045815568417310715
[5/100] loss: 0.39934012293815613 loss_joints: 0.36983832716941833 loss_collision: 0.13680177927017212 loss_jerk: 0.10472717881202698 loss_floor_contact: 0.02139553427696228
[6/100] loss: 0.16251185536384583 loss_joints: 0.1294492781162262 loss_collision: 0.17595171928405762 loss_jerk: 0.10036624222993851 loss_floor_contact: 0.02172316424548626
[7/100] loss: 0.057483285665512085 loss_joints: 0.04125550016760826 loss_collision: 0.016108805313706398 loss_jerk: 0.09178649634122849 loss_floor_contact: 0.02175302617251873
[8/100] loss: 0.056202519685029984 loss_joints: 0.037980541586875916 loss_collision: 0.024143442511558533 loss_jerk: 0.10376914590597153 loss_floor_contact: 0.02172287367284298
[9/100] loss: 0.07755458354949951 loss_joints: 0.05798473209142685 loss_collision: 0.019943827763199806 loss_jerk: 0.12184841930866241 loss_floor_contact: 0.02156251110136509
[10/100] loss: 0.07465054094791412 loss_joints: 0.05214875563979149 loss_collision: 0.020675070583820343 loss_jerk: 0.13938669860363007 loss_floor_contact: 0.025982443243265152
[11/100] loss: 0.046266913414001465 loss_joints: 0.02187521383166313 loss_collision: 0.037080030888319016 loss_jerk: 0.15553799271583557 loss_floor_contact: 0.02051958441734314
[12/100] loss: 0.034399569034576416 loss_joints: 0.005956624634563923 loss_collision: 0.08056694269180298 loss_jerk: 0.15421162545681 loss_floor_contact: 0.019860347732901573
[13/100] loss: 0.04548709839582443 loss_joints: 0.008996935561299324 loss_collision: 0.1748747080564499 loss_jerk: 0.14179667830467224 loss_floor_contact: 0.019292093813419342
[14/100] loss: 0.04629761353135109 loss_joints: 0.011423507705330849 loss_collision: 0.1760849952697754 loss_jerk: 0.12506762146949768 loss_floor_contact: 0.019035382196307182
[15/100] loss: 0.03648809716105461 loss_joints: 0.007230858318507671 loss_collision: 0.13871164619922638 loss_jerk: 0.10641878843307495 loss_floor_contact: 0.01897677220404148
[16/100] loss: 0.025090571492910385 loss_joints: 0.004640762694180012 loss_collision: 0.06422624737024307 loss_jerk: 0.09179006516933441 loss_floor_contact: 0.019392717629671097
[17/100] loss: 0.02637808583676815 loss_joints: 0.007370570208877325 loss_collision: 0.05938490107655525 loss_jerk: 0.08286898583173752 loss_floor_contact: 0.01912851072847843
[18/100] loss: 0.02738383784890175 loss_joints: 0.008701631799340248 loss_collision: 0.05668936297297478 loss_jerk: 0.08230088651180267 loss_floor_contact: 0.019132716581225395
[19/100] loss: 0.026927703991532326 loss_joints: 0.007461138069629669 loss_collision: 0.06584198772907257 loss_jerk: 0.08114553242921829 loss_floor_contact: 0.01907125860452652
[20/100] loss: 0.023113707080483437 loss_joints: 0.0031251225154846907 loss_collision: 0.07324915379285812 loss_jerk: 0.07924158871173859 loss_floor_contact: 0.018958041444420815
[21/100] loss: 0.02164442464709282 loss_joints: 0.0025113490410149097 loss_collision: 0.06320959329605103 loss_jerk: 0.080989308655262 loss_floor_contact: 0.01885274052619934
[22/100] loss: 0.023442000150680542 loss_joints: 0.004154446069151163 loss_collision: 0.06587213277816772 loss_jerk: 0.07998301088809967 loss_floor_contact: 0.01880815625190735
[23/100] loss: 0.02135142683982849 loss_joints: 0.002370347734540701 loss_collision: 0.06639520078897476 loss_jerk: 0.07651316374540329 loss_floor_contact: 0.01876097545027733
[24/100] loss: 0.01984276808798313 loss_joints: 0.001207824214361608 loss_collision: 0.06707929074764252 loss_jerk: 0.0724116861820221 loss_floor_contact: 0.01874338649213314
[25/100] loss: 0.01998308300971985 loss_joints: 0.0021601845510303974 loss_collision: 0.05952858924865723 loss_jerk: 0.07179275900125504 loss_floor_contact: 0.01876305229961872
[26/100] loss: 0.01948493905365467 loss_joints: 0.0025694817304611206 loss_collision: 0.05026312544941902 loss_jerk: 0.07134445756673813 loss_floor_contact: 0.01901879347860813
[27/100] loss: 0.01887616701424122 loss_joints: 0.0025103241205215454 loss_collision: 0.04581515118479729 loss_jerk: 0.07100048661231995 loss_floor_contact: 0.01873711682856083
[28/100] loss: 0.016696378588676453 loss_joints: 0.0008940921979956329 loss_collision: 0.03618940711021423 loss_jerk: 0.07020905613899231 loss_floor_contact: 0.020649759098887444
[29/100] loss: 0.016601957380771637 loss_joints: 0.00044285188778303564 loss_collision: 0.040975116193294525 loss_jerk: 0.06912480294704437 loss_floor_contact: 0.020596452057361603
[30/100] loss: 0.017643051221966743 loss_joints: 0.0015412381617352366 loss_collision: 0.041264958679676056 loss_jerk: 0.06800681352615356 loss_floor_contact: 0.020698538050055504
[31/100] loss: 0.01656484417617321 loss_joints: 0.0011958208633586764 loss_collision: 0.03449742868542671 loss_jerk: 0.06786374002695084 loss_floor_contact: 0.02053162269294262
[32/100] loss: 0.014380484819412231 loss_joints: 0.00048798543866723776 loss_collision: 0.021333036944270134 loss_jerk: 0.06738309562206268 loss_floor_contact: 0.020083541050553322
[33/100] loss: 0.013767017051577568 loss_joints: 0.00013628830492962152 loss_collision: 0.018296590074896812 loss_jerk: 0.06816434115171432 loss_floor_contact: 0.019938545301556587
[34/100] loss: 0.014932586811482906 loss_joints: 0.0013207754818722606 loss_collision: 0.02051554061472416 loss_jerk: 0.06706634163856506 loss_floor_contact: 0.019414491951465607
[35/100] loss: 0.014160018414258957 loss_joints: 0.0010245110606774688 loss_collision: 0.018881240859627724 loss_jerk: 0.06664831191301346 loss_floor_contact: 0.01833021081984043
[36/100] loss: 0.012632444500923157 loss_joints: 1.2834478866352583e-06 loss_collision: 0.015052855014801025 loss_jerk: 0.0655176192522049 loss_floor_contact: 0.01829645410180092
[37/100] loss: 0.014553938992321491 loss_joints: 0.0021464324090629816 loss_collision: 0.015533708967268467 loss_jerk: 0.06278331577777863 loss_floor_contact: 0.018303215503692627
[38/100] loss: 0.015371453016996384 loss_joints: 0.0030095295514911413 loss_collision: 0.01651800610125065 loss_jerk: 0.06138931214809418 loss_floor_contact: 0.018284767866134644
[39/100] loss: 0.013392118737101555 loss_joints: 0.0010672934586182237 loss_collision: 0.016726845875382423 loss_jerk: 0.06090870872139931 loss_floor_contact: 0.01824508048593998
[40/100] loss: 0.012119365856051445 loss_joints: 0.00026446260744705796 loss_collision: 0.013487017713487148 loss_jerk: 0.05956922844052315 loss_floor_contact: 0.018197115510702133
[41/100] loss: 0.012558462098240852 loss_joints: 0.0012462008744478226 loss_collision: 0.007115321233868599 loss_jerk: 0.06052227318286896 loss_floor_contact: 0.018194006755948067
[42/100] loss: 0.01195722259581089 loss_joints: 0.0006600545020774007 loss_collision: 0.004999675787985325 loss_jerk: 0.06239943951368332 loss_floor_contact: 0.01822902448475361
[43/100] loss: 0.011560145765542984 loss_joints: 0.0003399316919967532 loss_collision: 0.003910387400537729 loss_jerk: 0.06264187395572662 loss_floor_contact: 0.01825995184481144
[44/100] loss: 0.011670609936118126 loss_joints: 0.0005462041590362787 loss_collision: 0.003924774006009102 loss_jerk: 0.061742737889289856 loss_floor_contact: 0.0182306170463562
[45/100] loss: 0.011178143322467804 loss_joints: 0.00016918662004172802 loss_collision: 0.00399807607755065 loss_jerk: 0.06069156154990196 loss_floor_contact: 0.01815997250378132
[46/100] loss: 0.01126006804406643 loss_joints: 0.00047762220492586493 loss_collision: 0.003448945004492998 loss_jerk: 0.05910179764032364 loss_floor_contact: 0.018109483644366264
[47/100] loss: 0.011147504672408104 loss_joints: 0.0002694471040740609 loss_collision: 0.005302587989717722 loss_jerk: 0.058246154338121414 loss_floor_contact: 0.01809273473918438
[48/100] loss: 0.011059112846851349 loss_joints: 0.00018908285710494965 loss_collision: 0.006006608251482248 loss_jerk: 0.0574398934841156 loss_floor_contact: 0.018101517111063004
[49/100] loss: 0.01138952374458313 loss_joints: 0.0003245144325774163 loss_collision: 0.009496305137872696 loss_jerk: 0.055997274816036224 loss_floor_contact: 0.018062608316540718
[50/100] loss: 0.010977454483509064 loss_joints: 3.57669559889473e-05 loss_collision: 0.009418252855539322 loss_jerk: 0.05496375262737274 loss_floor_contact: 0.018013950437307358
[51/100] loss: 0.010758046060800552 loss_joints: 0.0002868451992981136 loss_collision: 0.0053665656596422195 loss_jerk: 0.054407749325037 loss_floor_contact: 0.01797507517039776
[52/100] loss: 0.01030740700662136 loss_joints: 6.766607839381322e-05 loss_collision: 0.003955918829888105 loss_jerk: 0.05352320149540901 loss_floor_contact: 0.017967313528060913
[53/100] loss: 0.01021815836429596 loss_joints: 0.0002655774587765336 loss_collision: 0.0016970320139080286 loss_jerk: 0.05291871726512909 loss_floor_contact: 0.017964022234082222
[54/100] loss: 0.010153794661164284 loss_joints: 0.00033891492057591677 loss_collision: 0.0005841023521497846 loss_jerk: 0.05271885171532631 loss_floor_contact: 0.017938340082764626
[55/100] loss: 0.009930824860930443 loss_joints: 4.8086363676702604e-05 loss_collision: 0.0015533665427938104 loss_jerk: 0.052579186856746674 loss_floor_contact: 0.017877932637929916
[56/100] loss: 0.010081123560667038 loss_joints: 0.0001550372107885778 loss_collision: 0.002657906850799918 loss_jerk: 0.05202069133520126 loss_floor_contact: 0.017832905054092407
[57/100] loss: 0.010078372433781624 loss_joints: 9.127795783570036e-05 loss_collision: 0.0038483324460685253 loss_jerk: 0.05158141627907753 loss_floor_contact: 0.017776476219296455
[58/100] loss: 0.00970545969903469 loss_joints: 4.402814374770969e-05 loss_collision: 0.0012646284885704517 loss_jerk: 0.051073573529720306 loss_floor_contact: 0.01771044172346592
[59/100] loss: 0.009617473930120468 loss_joints: 6.704728730255738e-05 loss_collision: 0.0013633751077577472 loss_jerk: 0.05000601336359978 loss_floor_contact: 0.017653951421380043
[60/100] loss: 0.00951516255736351 loss_joints: 2.529296352804522e-06 loss_collision: 0.0010824799537658691 loss_jerk: 0.05001557990908623 loss_floor_contact: 0.01761130802333355
[61/100] loss: 0.009518854320049286 loss_joints: 3.170972195221111e-05 loss_collision: 0.0009723951225169003 loss_jerk: 0.05001178756356239 loss_floor_contact: 0.017554903402924538
[62/100] loss: 0.009748300537467003 loss_joints: 6.205849786056206e-05 loss_collision: 0.0029744275379925966 loss_jerk: 0.050073493272066116 loss_floor_contact: 0.017525801435112953
[63/100] loss: 0.009592246264219284 loss_joints: 1.8574930436443537e-05 loss_collision: 0.0025607116986066103 loss_jerk: 0.04946982115507126 loss_floor_contact: 0.017482472583651543
[64/100] loss: 0.009587055072188377 loss_joints: 7.534923497587442e-05 loss_collision: 0.0017411195440217853 loss_jerk: 0.04977835714817047 loss_floor_contact: 0.01743903197348118
[65/100] loss: 0.00949026271700859 loss_joints: 6.521451723529026e-05 loss_collision: 0.0009484009933657944 loss_jerk: 0.0497421994805336 loss_floor_contact: 0.017423953860998154
[66/100] loss: 0.009323637932538986 loss_joints: 6.025155744282529e-05 loss_collision: 0.0 loss_jerk: 0.049134932458400726 loss_floor_contact: 0.01739957369863987
[67/100] loss: 0.009322975762188435 loss_joints: 1.4392454431799706e-05 loss_collision: 0.0005227592191658914 loss_jerk: 0.04914803057909012 loss_floor_contact: 0.017366018146276474
[68/100] loss: 0.009244045242667198 loss_joints: 1.100059125747066e-05 loss_collision: 0.0002990216016769409 loss_jerk: 0.048735830932855606 loss_floor_contact: 0.017318235710263252
[69/100] loss: 0.009191742166876793 loss_joints: 2.7014544684789144e-05 loss_collision: 0.0 loss_jerk: 0.04848670959472656 loss_floor_contact: 0.01726422645151615
[70/100] loss: 0.00914999283850193 loss_joints: 2.809987563523464e-05 loss_collision: 0.00026521916151978076 loss_jerk: 0.047945376485586166 loss_floor_contact: 0.017203334718942642
[71/100] loss: 0.009083614684641361 loss_joints: 1.771638562786393e-05 loss_collision: 0.00035739276790991426 loss_jerk: 0.04741918668150902 loss_floor_contact: 0.01715296134352684
[72/100] loss: 0.009187983348965645 loss_joints: 6.283885159064084e-05 loss_collision: 0.0011009855661541224 loss_jerk: 0.04739487171173096 loss_floor_contact: 0.017102235928177834
[73/100] loss: 0.009101169183850288 loss_joints: 6.446026964113116e-05 loss_collision: 0.0007513579330407083 loss_jerk: 0.046977363526821136 loss_floor_contact: 0.017055349424481392
[74/100] loss: 0.009019844233989716 loss_joints: 1.2877341760031413e-05 loss_collision: 0.0009255458717234433 loss_jerk: 0.0466647744178772 loss_floor_contact: 0.016991738229990005
[75/100] loss: 0.009226412512362003 loss_joints: 1.4628958524554037e-05 loss_collision: 0.003898070892319083 loss_jerk: 0.04586842656135559 loss_floor_contact: 0.016940534114837646
[76/100] loss: 0.009199710562825203 loss_joints: 8.421150596404914e-06 loss_collision: 0.0037773235235363245 loss_jerk: 0.045867811888456345 loss_floor_contact: 0.0169071052223444
[77/100] loss: 0.008927533403038979 loss_joints: 1.808588785934262e-05 loss_collision: 0.0014692578697577119 loss_jerk: 0.0454099141061306 loss_floor_contact: 0.016886118799448013
[78/100] loss: 0.008813794702291489 loss_joints: 3.136177110718563e-05 loss_collision: 0.00023789207625668496 loss_jerk: 0.04544832929968834 loss_floor_contact: 0.016855239868164062
[79/100] loss: 0.008851908147335052 loss_joints: 1.5666073522879742e-05 loss_collision: 0.0008281717891804874 loss_jerk: 0.04544316977262497 loss_floor_contact: 0.01683642901480198
[80/100] loss: 0.008964605629444122 loss_joints: 1.28949814097723e-05 loss_collision: 0.0016474889125674963 loss_jerk: 0.045857030898332596 loss_floor_contact: 0.016805032268166542
[81/100] loss: 0.008972720243036747 loss_joints: 6.433456292143092e-05 loss_collision: 0.0011679596500471234 loss_jerk: 0.045998599380254745 loss_floor_contact: 0.016766918823122978
[82/100] loss: 0.008940041065216064 loss_joints: 6.121404294390231e-05 loss_collision: 0.001193121075630188 loss_jerk: 0.04574795439839363 loss_floor_contact: 0.016738878563046455
[83/100] loss: 0.00881972536444664 loss_joints: 4.269880446372554e-05 loss_collision: 0.0006429817876778543 loss_jerk: 0.045367155224084854 loss_floor_contact: 0.016704048961400986
[84/100] loss: 0.008717324584722519 loss_joints: 1.4690205716760829e-05 loss_collision: 0.00028025772189721465 loss_jerk: 0.045079588890075684 loss_floor_contact: 0.016666598618030548
[85/100] loss: 0.00871499814093113 loss_joints: 9.584460713085718e-06 loss_collision: 0.0005077819223515689 loss_jerk: 0.04493064805865288 loss_floor_contact: 0.016646282747387886
[86/100] loss: 0.008746679872274399 loss_joints: 2.860134918591939e-05 loss_collision: 0.0007062024669721723 loss_jerk: 0.04492507129907608 loss_floor_contact: 0.01661980152130127
[87/100] loss: 0.008749337866902351 loss_joints: 3.788657340919599e-05 loss_collision: 0.0009492255048826337 loss_jerk: 0.044685833156108856 loss_floor_contact: 0.016591783612966537
[88/100] loss: 0.008782973513007164 loss_joints: 2.3230217266245745e-05 loss_collision: 0.0015843113651499152 loss_jerk: 0.04458184167742729 loss_floor_contact: 0.016572512686252594
[89/100] loss: 0.008721072226762772 loss_joints: 1.0859559552045539e-05 loss_collision: 0.0012076281709596515 loss_jerk: 0.044508062303066254 loss_floor_contact: 0.0165545716881752
[90/100] loss: 0.00867178663611412 loss_joints: 7.345131962210871e-06 loss_collision: 0.0008689678506925702 loss_jerk: 0.044411398470401764 loss_floor_contact: 0.016545617952942848
[91/100] loss: 0.008639944717288017 loss_joints: 7.30458339148754e-07 loss_collision: 0.0007114112377166748 loss_jerk: 0.04433935880661011 loss_floor_contact: 0.016536550596356392
[92/100] loss: 0.008635761216282845 loss_joints: 1.4637607819167897e-05 loss_collision: 0.00059200992109254 loss_jerk: 0.044309619814157486 loss_floor_contact: 0.01652384176850319
[93/100] loss: 0.008598017506301403 loss_joints: 1.681757566984743e-05 loss_collision: 0.00026710497331805527 loss_jerk: 0.044247858226299286 loss_floor_contact: 0.016518814489245415
[94/100] loss: 0.008578197099268436 loss_joints: 1.0291083526681177e-05 loss_collision: 0.00019018352031707764 loss_jerk: 0.04421035572886467 loss_floor_contact: 0.016511406749486923
[95/100] loss: 0.00859569851309061 loss_joints: 1.0510744687053375e-05 loss_collision: 0.00046777891111560166 loss_jerk: 0.044131938368082047 loss_floor_contact: 0.016500864177942276
[96/100] loss: 0.008588982746005058 loss_joints: 8.565753887523897e-06 loss_collision: 0.0004680421552620828 loss_jerk: 0.04409749433398247 loss_floor_contact: 0.01649545319378376
[97/100] loss: 0.008585815317928791 loss_joints: 6.000009307172149e-06 loss_collision: 0.0005181531305424869 loss_jerk: 0.04404613748192787 loss_floor_contact: 0.016493545845150948
[98/100] loss: 0.008581174537539482 loss_joints: 3.030070729437284e-06 loss_collision: 0.0005133052472956479 loss_jerk: 0.04403828829526901 loss_floor_contact: 0.01649194024503231
[99/100] loss: 0.0085801612585783 loss_joints: 1.492187720941729e-06 loss_collision: 0.0005554258823394775 loss_jerk: 0.04400673881173134 loss_floor_contact: 0.01648981124162674
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.25_jerk0.1_skate0.5]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 311.32534                                                    ║
    ║     rollout = 139.97934                                                    ║
    ║     sdf     = 15.56807                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00858016                                                 ║
    ║     joints    = 0.00000149                                                 ║
    ║     collision = 0.00055543                                                 ║
    ║     jerk      = 0.04400674                                                 ║
    ║     floor     = 0.01648981                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m31.763s
user	4m58.484s
sys	0m17.903s
[INFO] Running with collision=0.1, contact=0.25, jerk=0.1, skate=1.0
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<04:59,  3.02s/it]  2%|▏         | 2/100 [00:05<04:41,  2.88s/it]  3%|▎         | 3/100 [00:09<05:01,  3.11s/it]  4%|▍         | 4/100 [00:12<04:50,  3.03s/it]  5%|▌         | 5/100 [00:14<04:40,  2.96s/it]  6%|▌         | 6/100 [00:18<04:42,  3.01s/it]  7%|▋         | 7/100 [00:21<04:43,  3.04s/it]  8%|▊         | 8/100 [00:24<04:42,  3.07s/it]  9%|▉         | 9/100 [00:27<04:40,  3.08s/it] 10%|█         | 10/100 [00:30<04:32,  3.03s/it] 11%|█         | 11/100 [00:33<04:24,  2.98s/it] 12%|█▏        | 12/100 [00:36<04:27,  3.04s/it] 13%|█▎        | 13/100 [00:39<04:20,  2.99s/it] 14%|█▍        | 14/100 [00:42<04:21,  3.04s/it] 15%|█▌        | 15/100 [00:45<04:14,  3.00s/it] 16%|█▌        | 16/100 [00:48<04:06,  2.94s/it] 17%|█▋        | 17/100 [00:50<04:02,  2.92s/it] 18%|█▊        | 18/100 [00:53<03:59,  2.92s/it] 19%|█▉        | 19/100 [00:56<03:56,  2.92s/it] 20%|██        | 20/100 [00:59<03:57,  2.96s/it] 21%|██        | 21/100 [01:02<03:54,  2.97s/it] 22%|██▏       | 22/100 [01:05<03:55,  3.02s/it] 23%|██▎       | 23/100 [01:09<03:54,  3.04s/it] 24%|██▍       | 24/100 [01:12<04:01,  3.18s/it] 25%|██▌       | 25/100 [01:15<03:55,  3.14s/it] 26%|██▌       | 26/100 [01:18<03:54,  3.16s/it] 27%|██▋       | 27/100 [01:21<03:49,  3.15s/it] 28%|██▊       | 28/100 [01:25<03:46,  3.15s/it] 29%|██▉       | 29/100 [01:28<03:45,  3.18s/it] 30%|███       | 30/100 [01:31<03:44,  3.21s/it] 31%|███       | 31/100 [01:34<03:43,  3.24s/it] 32%|███▏      | 32/100 [01:38<03:42,  3.27s/it] 33%|███▎      | 33/100 [01:41<03:47,  3.39s/it] 34%|███▍      | 34/100 [01:45<03:40,  3.33s/it] 35%|███▌      | 35/100 [01:48<03:31,  3.26s/it] 36%|███▌      | 36/100 [01:51<03:35,  3.37s/it] 37%|███▋      | 37/100 [01:55<03:32,  3.38s/it] 38%|███▊      | 38/100 [01:58<03:30,  3.39s/it] 39%|███▉      | 39/100 [02:01<03:22,  3.32s/it] 40%|████      | 40/100 [02:05<03:22,  3.38s/it] 41%|████      | 41/100 [02:08<03:15,  3.32s/it] 42%|████▏     | 42/100 [02:11<03:12,  3.31s/it] 43%|████▎     | 43/100 [02:15<03:10,  3.35s/it] 44%|████▍     | 44/100 [02:18<03:13,  3.45s/it] 45%|████▌     | 45/100 [02:22<03:06,  3.39s/it] 46%|████▌     | 46/100 [02:25<03:01,  3.35s/it] 47%|████▋     | 47/100 [02:28<02:55,  3.31s/it] 48%|████▊     | 48/100 [02:32<02:53,  3.33s/it] 49%|████▉     | 49/100 [02:35<02:50,  3.34s/it] 50%|█████     | 50/100 [02:38<02:42,  3.24s/it] 51%|█████     | 51/100 [02:41<02:36,  3.19s/it] 52%|█████▏    | 52/100 [02:44<02:33,  3.19s/it] 53%|█████▎    | 53/100 [02:47<02:31,  3.21s/it] 54%|█████▍    | 54/100 [02:51<02:25,  3.17s/it] 55%|█████▌    | 55/100 [02:54<02:21,  3.14s/it] 56%|█████▌    | 56/100 [02:57<02:18,  3.15s/it] 57%|█████▋    | 57/100 [03:00<02:16,  3.18s/it] 58%|█████▊    | 58/100 [03:03<02:16,  3.24s/it] 59%|█████▉    | 59/100 [03:07<02:15,  3.32s/it] 60%|██████    | 60/100 [03:11<02:17,  3.45s/it] 61%|██████    | 61/100 [03:14<02:16,  3.50s/it] 62%|██████▏   | 62/100 [03:18<02:12,  3.49s/it] 63%|██████▎   | 63/100 [03:21<02:11,  3.55s/it] 64%|██████▍   | 64/100 [03:25<02:06,  3.52s/it] 65%|██████▌   | 65/100 [03:28<02:02,  3.51s/it] 66%|██████▌   | 66/100 [03:32<01:56,  3.41s/it] 67%|██████▋   | 67/100 [03:35<01:50,  3.34s/it] 68%|██████▊   | 68/100 [03:38<01:47,  3.37s/it] 69%|██████▉   | 69/100 [03:41<01:43,  3.33s/it] 70%|███████   | 70/100 [03:45<01:40,  3.37s/it] 71%|███████   | 71/100 [03:48<01:35,  3.31s/it] 72%|███████▏  | 72/100 [03:52<01:34,  3.38s/it] 73%|███████▎  | 73/100 [03:55<01:29,  3.31s/it] 74%|███████▍  | 74/100 [03:58<01:27,  3.37s/it] 75%|███████▌  | 75/100 [04:02<01:24,  3.40s/it] 76%|███████▌  | 76/100 [04:05<01:21,  3.38s/it] 77%|███████▋  | 77/100 [04:08<01:16,  3.33s/it] 78%|███████▊  | 78/100 [04:11<01:12,  3.31s/it] 79%|███████▉  | 79/100 [04:15<01:12,  3.44s/it] 80%|████████  | 80/100 [04:18<01:07,  3.38s/it] 81%|████████  | 81/100 [04:22<01:03,  3.33s/it] 82%|████████▏ | 82/100 [04:25<00:59,  3.32s/it] 83%|████████▎ | 83/100 [04:28<00:56,  3.35s/it] 84%|████████▍ | 84/100 [04:32<00:53,  3.34s/it] 85%|████████▌ | 85/100 [04:35<00:49,  3.30s/it] 86%|████████▌ | 86/100 [04:38<00:45,  3.28s/it] 87%|████████▋ | 87/100 [04:41<00:42,  3.27s/it] 88%|████████▊ | 88/100 [04:45<00:39,  3.33s/it] 89%|████████▉ | 89/100 [04:48<00:37,  3.40s/it] 90%|█████████ | 90/100 [04:52<00:33,  3.34s/it] 91%|█████████ | 91/100 [04:55<00:29,  3.26s/it] 92%|█████████▏| 92/100 [04:58<00:26,  3.25s/it] 93%|█████████▎| 93/100 [05:01<00:23,  3.31s/it] 94%|█████████▍| 94/100 [05:05<00:19,  3.29s/it] 95%|█████████▌| 95/100 [05:08<00:16,  3.26s/it] 96%|█████████▌| 96/100 [05:11<00:12,  3.22s/it] 97%|█████████▋| 97/100 [05:14<00:09,  3.19s/it] 98%|█████████▊| 98/100 [05:17<00:06,  3.24s/it] 99%|█████████▉| 99/100 [05:21<00:03,  3.25s/it]100%|██████████| 100/100 [05:24<00:00,  3.23s/it]100%|██████████| 100/100 [05:24<00:00,  3.24s/it]
[0/100] loss: 2.7662124633789062 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.5651912689208984 loss_joints: 2.405181646347046 loss_collision: 0.15441791713237762 loss_jerk: 0.06901062279939651 loss_floor_contact: 0.5506663918495178
[2/100] loss: 2.163612127304077 loss_joints: 1.9670703411102295 loss_collision: 0.2327931970357895 loss_jerk: 0.09627145528793335 loss_floor_contact: 0.6545411944389343
[3/100] loss: 1.3984886407852173 loss_joints: 1.2810232639312744 loss_collision: 0.22043617069721222 loss_jerk: 0.10176659375429153 loss_floor_contact: 0.3409806489944458
[4/100] loss: 0.8132372498512268 loss_joints: 0.7751802802085876 loss_collision: 0.15788395702838898 loss_jerk: 0.10814717411994934 loss_floor_contact: 0.045815568417310715
[5/100] loss: 0.39934012293815613 loss_joints: 0.36983832716941833 loss_collision: 0.13680177927017212 loss_jerk: 0.10472717881202698 loss_floor_contact: 0.02139553427696228
[6/100] loss: 0.16251185536384583 loss_joints: 0.1294492781162262 loss_collision: 0.17595171928405762 loss_jerk: 0.10036624222993851 loss_floor_contact: 0.02172316424548626
[7/100] loss: 0.057483285665512085 loss_joints: 0.04125550016760826 loss_collision: 0.016108805313706398 loss_jerk: 0.09178649634122849 loss_floor_contact: 0.02175302617251873
[8/100] loss: 0.056202519685029984 loss_joints: 0.037980541586875916 loss_collision: 0.024143442511558533 loss_jerk: 0.10376914590597153 loss_floor_contact: 0.02172287367284298
[9/100] loss: 0.07755458354949951 loss_joints: 0.05798473209142685 loss_collision: 0.019943827763199806 loss_jerk: 0.12184841930866241 loss_floor_contact: 0.02156251110136509
[10/100] loss: 0.07465054094791412 loss_joints: 0.05214875563979149 loss_collision: 0.020675070583820343 loss_jerk: 0.13938669860363007 loss_floor_contact: 0.025982443243265152
[11/100] loss: 0.046266913414001465 loss_joints: 0.02187521383166313 loss_collision: 0.037080030888319016 loss_jerk: 0.15553799271583557 loss_floor_contact: 0.02051958441734314
[12/100] loss: 0.034399569034576416 loss_joints: 0.005956624634563923 loss_collision: 0.08056694269180298 loss_jerk: 0.15421162545681 loss_floor_contact: 0.019860347732901573
[13/100] loss: 0.04548709839582443 loss_joints: 0.008996935561299324 loss_collision: 0.1748747080564499 loss_jerk: 0.14179667830467224 loss_floor_contact: 0.019292093813419342
[14/100] loss: 0.04629761353135109 loss_joints: 0.011423507705330849 loss_collision: 0.1760849952697754 loss_jerk: 0.12506762146949768 loss_floor_contact: 0.019035382196307182
[15/100] loss: 0.03648809716105461 loss_joints: 0.007230858318507671 loss_collision: 0.13871164619922638 loss_jerk: 0.10641878843307495 loss_floor_contact: 0.01897677220404148
[16/100] loss: 0.025090571492910385 loss_joints: 0.004640762694180012 loss_collision: 0.06422624737024307 loss_jerk: 0.09179006516933441 loss_floor_contact: 0.019392717629671097
[17/100] loss: 0.02637808583676815 loss_joints: 0.007370570208877325 loss_collision: 0.05938490107655525 loss_jerk: 0.08286898583173752 loss_floor_contact: 0.01912851072847843
[18/100] loss: 0.02738383784890175 loss_joints: 0.008701631799340248 loss_collision: 0.05668936297297478 loss_jerk: 0.08230088651180267 loss_floor_contact: 0.019132716581225395
[19/100] loss: 0.026927703991532326 loss_joints: 0.007461138069629669 loss_collision: 0.06584198772907257 loss_jerk: 0.08114553242921829 loss_floor_contact: 0.01907125860452652
[20/100] loss: 0.023113707080483437 loss_joints: 0.0031251225154846907 loss_collision: 0.07324915379285812 loss_jerk: 0.07924158871173859 loss_floor_contact: 0.018958041444420815
[21/100] loss: 0.02164442464709282 loss_joints: 0.0025113490410149097 loss_collision: 0.06320959329605103 loss_jerk: 0.080989308655262 loss_floor_contact: 0.01885274052619934
[22/100] loss: 0.023442000150680542 loss_joints: 0.004154446069151163 loss_collision: 0.06587213277816772 loss_jerk: 0.07998301088809967 loss_floor_contact: 0.01880815625190735
[23/100] loss: 0.02135142683982849 loss_joints: 0.002370347734540701 loss_collision: 0.06639520078897476 loss_jerk: 0.07651316374540329 loss_floor_contact: 0.01876097545027733
[24/100] loss: 0.01984276808798313 loss_joints: 0.001207824214361608 loss_collision: 0.06707929074764252 loss_jerk: 0.0724116861820221 loss_floor_contact: 0.01874338649213314
[25/100] loss: 0.01998308300971985 loss_joints: 0.0021601845510303974 loss_collision: 0.05952858924865723 loss_jerk: 0.07179275900125504 loss_floor_contact: 0.01876305229961872
[26/100] loss: 0.01948493905365467 loss_joints: 0.0025694817304611206 loss_collision: 0.05026312544941902 loss_jerk: 0.07134445756673813 loss_floor_contact: 0.01901879347860813
[27/100] loss: 0.01887616701424122 loss_joints: 0.0025103241205215454 loss_collision: 0.04581515118479729 loss_jerk: 0.07100048661231995 loss_floor_contact: 0.01873711682856083
[28/100] loss: 0.016696378588676453 loss_joints: 0.0008940921979956329 loss_collision: 0.03618940711021423 loss_jerk: 0.07020905613899231 loss_floor_contact: 0.020649759098887444
[29/100] loss: 0.016601957380771637 loss_joints: 0.00044285188778303564 loss_collision: 0.040975116193294525 loss_jerk: 0.06912480294704437 loss_floor_contact: 0.020596452057361603
[30/100] loss: 0.017643051221966743 loss_joints: 0.0015412381617352366 loss_collision: 0.041264958679676056 loss_jerk: 0.06800681352615356 loss_floor_contact: 0.020698538050055504
[31/100] loss: 0.01656484417617321 loss_joints: 0.0011958208633586764 loss_collision: 0.03449742868542671 loss_jerk: 0.06786374002695084 loss_floor_contact: 0.02053162269294262
[32/100] loss: 0.014380484819412231 loss_joints: 0.00048798543866723776 loss_collision: 0.021333036944270134 loss_jerk: 0.06738309562206268 loss_floor_contact: 0.020083541050553322
[33/100] loss: 0.013767017051577568 loss_joints: 0.00013628830492962152 loss_collision: 0.018296590074896812 loss_jerk: 0.06816434115171432 loss_floor_contact: 0.019938545301556587
[34/100] loss: 0.014932586811482906 loss_joints: 0.0013207754818722606 loss_collision: 0.02051554061472416 loss_jerk: 0.06706634163856506 loss_floor_contact: 0.019414491951465607
[35/100] loss: 0.014160018414258957 loss_joints: 0.0010245110606774688 loss_collision: 0.018881240859627724 loss_jerk: 0.06664831191301346 loss_floor_contact: 0.01833021081984043
[36/100] loss: 0.012632444500923157 loss_joints: 1.2834478866352583e-06 loss_collision: 0.015052855014801025 loss_jerk: 0.0655176192522049 loss_floor_contact: 0.01829645410180092
[37/100] loss: 0.014553938992321491 loss_joints: 0.0021464324090629816 loss_collision: 0.015533708967268467 loss_jerk: 0.06278331577777863 loss_floor_contact: 0.018303215503692627
[38/100] loss: 0.015371453016996384 loss_joints: 0.0030095295514911413 loss_collision: 0.01651800610125065 loss_jerk: 0.06138931214809418 loss_floor_contact: 0.018284767866134644
[39/100] loss: 0.013392118737101555 loss_joints: 0.0010672934586182237 loss_collision: 0.016726845875382423 loss_jerk: 0.06090870872139931 loss_floor_contact: 0.01824508048593998
[40/100] loss: 0.012119365856051445 loss_joints: 0.00026446260744705796 loss_collision: 0.013487017713487148 loss_jerk: 0.05956922844052315 loss_floor_contact: 0.018197115510702133
[41/100] loss: 0.012558462098240852 loss_joints: 0.0012462008744478226 loss_collision: 0.007115321233868599 loss_jerk: 0.06052227318286896 loss_floor_contact: 0.018194006755948067
[42/100] loss: 0.01195722259581089 loss_joints: 0.0006600545020774007 loss_collision: 0.004999675787985325 loss_jerk: 0.06239943951368332 loss_floor_contact: 0.01822902448475361
[43/100] loss: 0.011560145765542984 loss_joints: 0.0003399316919967532 loss_collision: 0.003910387400537729 loss_jerk: 0.06264187395572662 loss_floor_contact: 0.01825995184481144
[44/100] loss: 0.011670609936118126 loss_joints: 0.0005462041590362787 loss_collision: 0.003924774006009102 loss_jerk: 0.061742737889289856 loss_floor_contact: 0.0182306170463562
[45/100] loss: 0.011178143322467804 loss_joints: 0.00016918662004172802 loss_collision: 0.00399807607755065 loss_jerk: 0.06069156154990196 loss_floor_contact: 0.01815997250378132
[46/100] loss: 0.01126006804406643 loss_joints: 0.00047762220492586493 loss_collision: 0.003448945004492998 loss_jerk: 0.05910179764032364 loss_floor_contact: 0.018109483644366264
[47/100] loss: 0.011147504672408104 loss_joints: 0.0002694471040740609 loss_collision: 0.005302587989717722 loss_jerk: 0.058246154338121414 loss_floor_contact: 0.01809273473918438
[48/100] loss: 0.011059112846851349 loss_joints: 0.00018908285710494965 loss_collision: 0.006006608251482248 loss_jerk: 0.0574398934841156 loss_floor_contact: 0.018101517111063004
[49/100] loss: 0.01138952374458313 loss_joints: 0.0003245144325774163 loss_collision: 0.009496305137872696 loss_jerk: 0.055997274816036224 loss_floor_contact: 0.018062608316540718
[50/100] loss: 0.010977454483509064 loss_joints: 3.57669559889473e-05 loss_collision: 0.009418252855539322 loss_jerk: 0.05496375262737274 loss_floor_contact: 0.018013950437307358
[51/100] loss: 0.010758046060800552 loss_joints: 0.0002868451992981136 loss_collision: 0.0053665656596422195 loss_jerk: 0.054407749325037 loss_floor_contact: 0.01797507517039776
[52/100] loss: 0.01030740700662136 loss_joints: 6.766607839381322e-05 loss_collision: 0.003955918829888105 loss_jerk: 0.05352320149540901 loss_floor_contact: 0.017967313528060913
[53/100] loss: 0.01021815836429596 loss_joints: 0.0002655774587765336 loss_collision: 0.0016970320139080286 loss_jerk: 0.05291871726512909 loss_floor_contact: 0.017964022234082222
[54/100] loss: 0.010153794661164284 loss_joints: 0.00033891492057591677 loss_collision: 0.0005841023521497846 loss_jerk: 0.05271885171532631 loss_floor_contact: 0.017938340082764626
[55/100] loss: 0.009930824860930443 loss_joints: 4.8086363676702604e-05 loss_collision: 0.0015533665427938104 loss_jerk: 0.052579186856746674 loss_floor_contact: 0.017877932637929916
[56/100] loss: 0.010081123560667038 loss_joints: 0.0001550372107885778 loss_collision: 0.002657906850799918 loss_jerk: 0.05202069133520126 loss_floor_contact: 0.017832905054092407
[57/100] loss: 0.010078372433781624 loss_joints: 9.127795783570036e-05 loss_collision: 0.0038483324460685253 loss_jerk: 0.05158141627907753 loss_floor_contact: 0.017776476219296455
[58/100] loss: 0.00970545969903469 loss_joints: 4.402814374770969e-05 loss_collision: 0.0012646284885704517 loss_jerk: 0.051073573529720306 loss_floor_contact: 0.01771044172346592
[59/100] loss: 0.009617473930120468 loss_joints: 6.704728730255738e-05 loss_collision: 0.0013633751077577472 loss_jerk: 0.05000601336359978 loss_floor_contact: 0.017653951421380043
[60/100] loss: 0.00951516255736351 loss_joints: 2.529296352804522e-06 loss_collision: 0.0010824799537658691 loss_jerk: 0.05001557990908623 loss_floor_contact: 0.01761130802333355
[61/100] loss: 0.009518854320049286 loss_joints: 3.170972195221111e-05 loss_collision: 0.0009723951225169003 loss_jerk: 0.05001178756356239 loss_floor_contact: 0.017554903402924538
[62/100] loss: 0.009748300537467003 loss_joints: 6.205849786056206e-05 loss_collision: 0.0029744275379925966 loss_jerk: 0.050073493272066116 loss_floor_contact: 0.017525801435112953
[63/100] loss: 0.009592246264219284 loss_joints: 1.8574930436443537e-05 loss_collision: 0.0025607116986066103 loss_jerk: 0.04946982115507126 loss_floor_contact: 0.017482472583651543
[64/100] loss: 0.009587055072188377 loss_joints: 7.534923497587442e-05 loss_collision: 0.0017411195440217853 loss_jerk: 0.04977835714817047 loss_floor_contact: 0.01743903197348118
[65/100] loss: 0.00949026271700859 loss_joints: 6.521451723529026e-05 loss_collision: 0.0009484009933657944 loss_jerk: 0.0497421994805336 loss_floor_contact: 0.017423953860998154
[66/100] loss: 0.009323637932538986 loss_joints: 6.025155744282529e-05 loss_collision: 0.0 loss_jerk: 0.049134932458400726 loss_floor_contact: 0.01739957369863987
[67/100] loss: 0.009322975762188435 loss_joints: 1.4392454431799706e-05 loss_collision: 0.0005227592191658914 loss_jerk: 0.04914803057909012 loss_floor_contact: 0.017366018146276474
[68/100] loss: 0.009244045242667198 loss_joints: 1.100059125747066e-05 loss_collision: 0.0002990216016769409 loss_jerk: 0.048735830932855606 loss_floor_contact: 0.017318235710263252
[69/100] loss: 0.009191742166876793 loss_joints: 2.7014544684789144e-05 loss_collision: 0.0 loss_jerk: 0.04848670959472656 loss_floor_contact: 0.01726422645151615
[70/100] loss: 0.00914999283850193 loss_joints: 2.809987563523464e-05 loss_collision: 0.00026521916151978076 loss_jerk: 0.047945376485586166 loss_floor_contact: 0.017203334718942642
[71/100] loss: 0.009083614684641361 loss_joints: 1.771638562786393e-05 loss_collision: 0.00035739276790991426 loss_jerk: 0.04741918668150902 loss_floor_contact: 0.01715296134352684
[72/100] loss: 0.009187983348965645 loss_joints: 6.283885159064084e-05 loss_collision: 0.0011009855661541224 loss_jerk: 0.04739487171173096 loss_floor_contact: 0.017102235928177834
[73/100] loss: 0.009101169183850288 loss_joints: 6.446026964113116e-05 loss_collision: 0.0007513579330407083 loss_jerk: 0.046977363526821136 loss_floor_contact: 0.017055349424481392
[74/100] loss: 0.009019844233989716 loss_joints: 1.2877341760031413e-05 loss_collision: 0.0009255458717234433 loss_jerk: 0.0466647744178772 loss_floor_contact: 0.016991738229990005
[75/100] loss: 0.009226412512362003 loss_joints: 1.4628958524554037e-05 loss_collision: 0.003898070892319083 loss_jerk: 0.04586842656135559 loss_floor_contact: 0.016940534114837646
[76/100] loss: 0.009199710562825203 loss_joints: 8.421150596404914e-06 loss_collision: 0.0037773235235363245 loss_jerk: 0.045867811888456345 loss_floor_contact: 0.0169071052223444
[77/100] loss: 0.008927533403038979 loss_joints: 1.808588785934262e-05 loss_collision: 0.0014692578697577119 loss_jerk: 0.0454099141061306 loss_floor_contact: 0.016886118799448013
[78/100] loss: 0.008813794702291489 loss_joints: 3.136177110718563e-05 loss_collision: 0.00023789207625668496 loss_jerk: 0.04544832929968834 loss_floor_contact: 0.016855239868164062
[79/100] loss: 0.008851908147335052 loss_joints: 1.5666073522879742e-05 loss_collision: 0.0008281717891804874 loss_jerk: 0.04544316977262497 loss_floor_contact: 0.01683642901480198
[80/100] loss: 0.008964605629444122 loss_joints: 1.28949814097723e-05 loss_collision: 0.0016474889125674963 loss_jerk: 0.045857030898332596 loss_floor_contact: 0.016805032268166542
[81/100] loss: 0.008972720243036747 loss_joints: 6.433456292143092e-05 loss_collision: 0.0011679596500471234 loss_jerk: 0.045998599380254745 loss_floor_contact: 0.016766918823122978
[82/100] loss: 0.008940041065216064 loss_joints: 6.121404294390231e-05 loss_collision: 0.001193121075630188 loss_jerk: 0.04574795439839363 loss_floor_contact: 0.016738878563046455
[83/100] loss: 0.00881972536444664 loss_joints: 4.269880446372554e-05 loss_collision: 0.0006429817876778543 loss_jerk: 0.045367155224084854 loss_floor_contact: 0.016704048961400986
[84/100] loss: 0.008717324584722519 loss_joints: 1.4690205716760829e-05 loss_collision: 0.00028025772189721465 loss_jerk: 0.045079588890075684 loss_floor_contact: 0.016666598618030548
[85/100] loss: 0.00871499814093113 loss_joints: 9.584460713085718e-06 loss_collision: 0.0005077819223515689 loss_jerk: 0.04493064805865288 loss_floor_contact: 0.016646282747387886
[86/100] loss: 0.008746679872274399 loss_joints: 2.860134918591939e-05 loss_collision: 0.0007062024669721723 loss_jerk: 0.04492507129907608 loss_floor_contact: 0.01661980152130127
[87/100] loss: 0.008749337866902351 loss_joints: 3.788657340919599e-05 loss_collision: 0.0009492255048826337 loss_jerk: 0.044685833156108856 loss_floor_contact: 0.016591783612966537
[88/100] loss: 0.008782973513007164 loss_joints: 2.3230217266245745e-05 loss_collision: 0.0015843113651499152 loss_jerk: 0.04458184167742729 loss_floor_contact: 0.016572512686252594
[89/100] loss: 0.008721072226762772 loss_joints: 1.0859559552045539e-05 loss_collision: 0.0012076281709596515 loss_jerk: 0.044508062303066254 loss_floor_contact: 0.0165545716881752
[90/100] loss: 0.00867178663611412 loss_joints: 7.345131962210871e-06 loss_collision: 0.0008689678506925702 loss_jerk: 0.044411398470401764 loss_floor_contact: 0.016545617952942848
[91/100] loss: 0.008639944717288017 loss_joints: 7.30458339148754e-07 loss_collision: 0.0007114112377166748 loss_jerk: 0.04433935880661011 loss_floor_contact: 0.016536550596356392
[92/100] loss: 0.008635761216282845 loss_joints: 1.4637607819167897e-05 loss_collision: 0.00059200992109254 loss_jerk: 0.044309619814157486 loss_floor_contact: 0.01652384176850319
[93/100] loss: 0.008598017506301403 loss_joints: 1.681757566984743e-05 loss_collision: 0.00026710497331805527 loss_jerk: 0.044247858226299286 loss_floor_contact: 0.016518814489245415
[94/100] loss: 0.008578197099268436 loss_joints: 1.0291083526681177e-05 loss_collision: 0.00019018352031707764 loss_jerk: 0.04421035572886467 loss_floor_contact: 0.016511406749486923
[95/100] loss: 0.00859569851309061 loss_joints: 1.0510744687053375e-05 loss_collision: 0.00046777891111560166 loss_jerk: 0.044131938368082047 loss_floor_contact: 0.016500864177942276
[96/100] loss: 0.008588982746005058 loss_joints: 8.565753887523897e-06 loss_collision: 0.0004680421552620828 loss_jerk: 0.04409749433398247 loss_floor_contact: 0.01649545319378376
[97/100] loss: 0.008585815317928791 loss_joints: 6.000009307172149e-06 loss_collision: 0.0005181531305424869 loss_jerk: 0.04404613748192787 loss_floor_contact: 0.016493545845150948
[98/100] loss: 0.008581174537539482 loss_joints: 3.030070729437284e-06 loss_collision: 0.0005133052472956479 loss_jerk: 0.04403828829526901 loss_floor_contact: 0.01649194024503231
[99/100] loss: 0.0085801612585783 loss_joints: 1.492187720941729e-06 loss_collision: 0.0005554258823394775 loss_jerk: 0.04400673881173134 loss_floor_contact: 0.01648981124162674
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.25_jerk0.1_skate1.0]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 324.37286                                                    ║
    ║     rollout = 146.07670                                                    ║
    ║     sdf     = 19.64065                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.00858016                                                 ║
    ║     joints    = 0.00000149                                                 ║
    ║     collision = 0.00055543                                                 ║
    ║     jerk      = 0.04400674                                                 ║
    ║     floor     = 0.01648981                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m44.728s
user	4m56.892s
sys	0m17.460s
[INFO] Running with collision=0.1, contact=0.25, jerk=0.25, skate=0.1
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<06:01,  3.65s/it]  2%|▏         | 2/100 [00:06<05:23,  3.31s/it]  3%|▎         | 3/100 [00:10<05:43,  3.54s/it]  4%|▍         | 4/100 [00:13<05:31,  3.46s/it]  5%|▌         | 5/100 [00:17<05:22,  3.39s/it]  6%|▌         | 6/100 [00:20<05:14,  3.35s/it]  7%|▋         | 7/100 [00:23<05:15,  3.40s/it]  8%|▊         | 8/100 [00:27<05:22,  3.51s/it]  9%|▉         | 9/100 [00:31<05:31,  3.64s/it] 10%|█         | 10/100 [00:35<05:31,  3.69s/it] 11%|█         | 11/100 [00:38<05:25,  3.65s/it] 12%|█▏        | 12/100 [00:42<05:18,  3.62s/it] 13%|█▎        | 13/100 [00:45<05:07,  3.54s/it] 14%|█▍        | 14/100 [00:49<05:03,  3.53s/it] 15%|█▌        | 15/100 [00:52<05:02,  3.56s/it] 16%|█▌        | 16/100 [00:56<04:57,  3.54s/it] 17%|█▋        | 17/100 [00:59<04:46,  3.45s/it] 18%|█▊        | 18/100 [01:03<04:41,  3.43s/it] 19%|█▉        | 19/100 [01:06<04:30,  3.34s/it] 20%|██        | 20/100 [01:09<04:33,  3.42s/it] 21%|██        | 21/100 [01:13<04:29,  3.41s/it] 22%|██▏       | 22/100 [01:16<04:21,  3.36s/it] 23%|██▎       | 23/100 [01:19<04:15,  3.32s/it] 24%|██▍       | 24/100 [01:23<04:13,  3.34s/it] 25%|██▌       | 25/100 [01:26<04:12,  3.36s/it] 26%|██▌       | 26/100 [01:29<04:11,  3.40s/it] 27%|██▋       | 27/100 [01:33<04:07,  3.38s/it] 28%|██▊       | 28/100 [01:36<03:58,  3.31s/it] 29%|██▉       | 29/100 [01:40<04:00,  3.39s/it] 30%|███       | 30/100 [01:43<04:05,  3.50s/it] 31%|███       | 31/100 [01:47<04:05,  3.56s/it] 32%|███▏      | 32/100 [01:50<03:58,  3.50s/it] 33%|███▎      | 33/100 [01:54<03:57,  3.55s/it] 34%|███▍      | 34/100 [01:57<03:47,  3.45s/it] 35%|███▌      | 35/100 [02:00<03:38,  3.37s/it] 36%|███▌      | 36/100 [02:04<03:35,  3.36s/it] 37%|███▋      | 37/100 [02:07<03:30,  3.33s/it] 38%|███▊      | 38/100 [02:10<03:24,  3.30s/it] 39%|███▉      | 39/100 [02:13<03:18,  3.26s/it] 40%|████      | 40/100 [02:17<03:13,  3.23s/it] 41%|████      | 41/100 [02:20<03:10,  3.23s/it] 42%|████▏     | 42/100 [02:23<03:08,  3.25s/it] 43%|████▎     | 43/100 [02:26<03:06,  3.28s/it] 44%|████▍     | 44/100 [02:30<03:06,  3.33s/it] 45%|████▌     | 45/100 [02:33<03:00,  3.29s/it] 46%|████▌     | 46/100 [02:36<02:53,  3.22s/it] 47%|████▋     | 47/100 [02:39<02:48,  3.17s/it] 48%|████▊     | 48/100 [02:42<02:40,  3.08s/it] 49%|████▉     | 49/100 [02:45<02:36,  3.06s/it] 50%|█████     | 50/100 [02:48<02:32,  3.04s/it] 51%|█████     | 51/100 [02:51<02:29,  3.04s/it] 52%|█████▏    | 52/100 [02:54<02:30,  3.14s/it] 53%|█████▎    | 53/100 [02:58<02:25,  3.11s/it] 54%|█████▍    | 54/100 [03:00<02:19,  3.04s/it] 55%|█████▌    | 55/100 [03:03<02:15,  3.02s/it] 56%|█████▌    | 56/100 [03:07<02:15,  3.07s/it] 57%|█████▋    | 57/100 [03:10<02:15,  3.14s/it] 58%|█████▊    | 58/100 [03:13<02:13,  3.17s/it] 59%|█████▉    | 59/100 [03:16<02:09,  3.16s/it] 60%|██████    | 60/100 [03:19<02:05,  3.14s/it] 61%|██████    | 61/100 [03:22<02:02,  3.13s/it] 62%|██████▏   | 62/100 [03:26<01:58,  3.11s/it] 63%|██████▎   | 63/100 [03:29<01:54,  3.11s/it] 64%|██████▍   | 64/100 [03:32<01:52,  3.12s/it] 65%|██████▌   | 65/100 [03:35<01:54,  3.28s/it] 66%|██████▌   | 66/100 [03:39<01:52,  3.30s/it] 67%|██████▋   | 67/100 [03:42<01:47,  3.26s/it] 68%|██████▊   | 68/100 [03:45<01:44,  3.25s/it] 69%|██████▉   | 69/100 [03:48<01:40,  3.25s/it] 70%|███████   | 70/100 [03:52<01:37,  3.25s/it] 71%|███████   | 71/100 [03:55<01:32,  3.19s/it] 72%|███████▏  | 72/100 [03:58<01:29,  3.20s/it] 73%|███████▎  | 73/100 [04:01<01:25,  3.18s/it] 74%|███████▍  | 74/100 [04:04<01:22,  3.18s/it] 75%|███████▌  | 75/100 [04:07<01:19,  3.17s/it] 76%|███████▌  | 76/100 [04:11<01:16,  3.19s/it] 77%|███████▋  | 77/100 [04:14<01:13,  3.21s/it] 78%|███████▊  | 78/100 [04:17<01:11,  3.27s/it] 79%|███████▉  | 79/100 [04:21<01:08,  3.28s/it] 80%|████████  | 80/100 [04:24<01:08,  3.44s/it] 81%|████████  | 81/100 [04:28<01:06,  3.49s/it] 82%|████████▏ | 82/100 [04:32<01:03,  3.51s/it] 83%|████████▎ | 83/100 [04:35<00:59,  3.50s/it] 84%|████████▍ | 84/100 [04:39<00:56,  3.54s/it] 85%|████████▌ | 85/100 [04:42<00:51,  3.47s/it] 86%|████████▌ | 86/100 [04:45<00:47,  3.41s/it] 87%|████████▋ | 87/100 [04:49<00:43,  3.37s/it] 88%|████████▊ | 88/100 [04:52<00:39,  3.31s/it] 89%|████████▉ | 89/100 [04:55<00:36,  3.27s/it] 90%|█████████ | 90/100 [04:58<00:32,  3.26s/it] 91%|█████████ | 91/100 [05:01<00:29,  3.27s/it] 92%|█████████▏| 92/100 [05:05<00:27,  3.43s/it] 93%|█████████▎| 93/100 [05:09<00:23,  3.43s/it] 94%|█████████▍| 94/100 [05:12<00:20,  3.40s/it] 95%|█████████▌| 95/100 [05:16<00:17,  3.44s/it] 96%|█████████▌| 96/100 [05:19<00:13,  3.42s/it] 97%|█████████▋| 97/100 [05:22<00:10,  3.36s/it] 98%|█████████▊| 98/100 [05:26<00:06,  3.45s/it] 99%|█████████▉| 99/100 [05:29<00:03,  3.45s/it]100%|██████████| 100/100 [05:33<00:00,  3.50s/it]100%|██████████| 100/100 [05:33<00:00,  3.33s/it]
[0/100] loss: 2.774794101715088 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.5727124214172363 loss_joints: 2.402524709701538 loss_collision: 0.15431581437587738 loss_jerk: 0.06952131539583206 loss_floor_contact: 0.549503743648529
[2/100] loss: 2.137239694595337 loss_joints: 1.9335241317749023 loss_collision: 0.2258048802614212 loss_jerk: 0.09505781531333923 loss_floor_contact: 0.629482626914978
[3/100] loss: 1.3683927059173584 loss_joints: 1.2461650371551514 loss_collision: 0.19918575882911682 loss_jerk: 0.09706990420818329 loss_floor_contact: 0.3121664524078369
[4/100] loss: 0.7754445672035217 loss_joints: 0.7272140979766846 loss_collision: 0.15788663923740387 loss_jerk: 0.1018744483590126 loss_floor_contact: 0.0278928279876709
[5/100] loss: 0.3838684558868408 loss_joints: 0.3403019309043884 loss_collision: 0.11957433819770813 loss_jerk: 0.10506990551948547 loss_floor_contact: 0.0213664211332798
[6/100] loss: 0.1599923074245453 loss_joints: 0.11175817251205444 loss_collision: 0.18219910562038422 loss_jerk: 0.09836602956056595 loss_floor_contact: 0.021690815687179565
[7/100] loss: 0.08951015025377274 loss_joints: 0.0605228915810585 loss_collision: 0.013041364029049873 loss_jerk: 0.0889449268579483 loss_floor_contact: 0.02178756333887577
[8/100] loss: 0.10652241855859756 loss_joints: 0.07042410224676132 loss_collision: 0.056056492030620575 loss_jerk: 0.1001894399523735 loss_floor_contact: 0.021781232208013535
[9/100] loss: 0.1082334890961647 loss_joints: 0.06900984048843384 loss_collision: 0.02044055610895157 loss_jerk: 0.1269529014825821 loss_floor_contact: 0.021765494719147682
[10/100] loss: 0.10630583763122559 loss_joints: 0.0643283873796463 loss_collision: 0.024882394820451736 loss_jerk: 0.1364785134792328 loss_floor_contact: 0.02147831954061985
[11/100] loss: 0.08227649331092834 loss_joints: 0.0385943166911602 loss_collision: 0.022966677322983742 loss_jerk: 0.14152872562408447 loss_floor_contact: 0.02401331067085266
[12/100] loss: 0.0553477481007576 loss_joints: 0.01078350655734539 loss_collision: 0.0497300960123539 loss_jerk: 0.13789592683315277 loss_floor_contact: 0.020469004288315773
[13/100] loss: 0.05584103614091873 loss_joints: 0.012984991073608398 loss_collision: 0.0678156167268753 loss_jerk: 0.12438290566205978 loss_floor_contact: 0.01991502195596695
[14/100] loss: 0.055981189012527466 loss_joints: 0.019072066992521286 loss_collision: 0.05377759411931038 loss_jerk: 0.10669022053480148 loss_floor_contact: 0.019435234367847443
[15/100] loss: 0.05530337244272232 loss_joints: 0.01811644434928894 loss_collision: 0.08032108098268509 loss_jerk: 0.09763505309820175 loss_floor_contact: 0.018984228372573853
[16/100] loss: 0.0480513870716095 loss_joints: 0.014528369531035423 loss_collision: 0.06683222204446793 loss_jerk: 0.08858514577150345 loss_floor_contact: 0.018774032592773438
[17/100] loss: 0.038090258836746216 loss_joints: 0.00923144817352295 loss_collision: 0.04872443526983261 loss_jerk: 0.07721196115016937 loss_floor_contact: 0.018733501434326172
[18/100] loss: 0.03338014334440231 loss_joints: 0.00403989152982831 loss_collision: 0.05639411509037018 loss_jerk: 0.075992152094841 loss_floor_contact: 0.018811209127306938
[19/100] loss: 0.03400471433997154 loss_joints: 0.004855423700064421 loss_collision: 0.05733242258429527 loss_jerk: 0.07481939345598221 loss_floor_contact: 0.018844803795218468
[20/100] loss: 0.034798964858055115 loss_joints: 0.006116495467722416 loss_collision: 0.059969186782836914 loss_jerk: 0.07193341106176376 loss_floor_contact: 0.018808791413903236
[21/100] loss: 0.031906820833683014 loss_joints: 0.004081612452864647 loss_collision: 0.05718075484037399 loss_jerk: 0.06971293687820435 loss_floor_contact: 0.018715593963861465
[22/100] loss: 0.029933568090200424 loss_joints: 0.0021135786082595587 loss_collision: 0.05854799970984459 loss_jerk: 0.06930460780858994 loss_floor_contact: 0.0185561440885067
[23/100] loss: 0.028770694509148598 loss_joints: 0.002385267522186041 loss_collision: 0.04505490884184837 loss_jerk: 0.06911907345056534 loss_floor_contact: 0.01840066909790039
[24/100] loss: 0.026812629774212837 loss_joints: 0.00313142454251647 loss_collision: 0.026191705837845802 loss_jerk: 0.06599250435829163 loss_floor_contact: 0.018255634233355522
[25/100] loss: 0.024831732735037804 loss_joints: 0.002176850801333785 loss_collision: 0.016017640009522438 loss_jerk: 0.06601711362600327 loss_floor_contact: 0.018195360898971558
[26/100] loss: 0.024965986609458923 loss_joints: 0.001263917307369411 loss_collision: 0.019467979669570923 loss_jerk: 0.06823957711458206 loss_floor_contact: 0.01878150925040245
[27/100] loss: 0.02441662736237049 loss_joints: 0.0005152737721800804 loss_collision: 0.020944315940141678 loss_jerk: 0.06757678091526031 loss_floor_contact: 0.019650904461741447
[28/100] loss: 0.0278022363781929 loss_joints: 0.00219759251922369 loss_collision: 0.04508889839053154 loss_jerk: 0.06480813026428223 loss_floor_contact: 0.019574888050556183
[29/100] loss: 0.027689702808856964 loss_joints: 0.0019455240108072758 loss_collision: 0.05215848982334137 loss_jerk: 0.06294743716716766 loss_floor_contact: 0.019165879115462303
[30/100] loss: 0.02588518336415291 loss_joints: 0.0006903923931531608 loss_collision: 0.04407317191362381 loss_jerk: 0.06292440742254257 loss_floor_contact: 0.020225489512085915
[31/100] loss: 0.02603951282799244 loss_joints: 0.0026087393052875996 loss_collision: 0.037430088967084885 loss_jerk: 0.06255176663398743 loss_floor_contact: 0.01619929075241089
[32/100] loss: 0.025238296017050743 loss_joints: 0.0016595524502918124 loss_collision: 0.03640264272689819 loss_jerk: 0.061318352818489075 loss_floor_contact: 0.018435558304190636
[33/100] loss: 0.023803723976016045 loss_joints: 0.0002687729138415307 loss_collision: 0.03285902738571167 loss_jerk: 0.061295874416828156 loss_floor_contact: 0.019700320437550545
[34/100] loss: 0.02615983411669731 loss_joints: 0.0029330856632441282 loss_collision: 0.032388459891080856 loss_jerk: 0.060984060168266296 loss_floor_contact: 0.018967555835843086
[35/100] loss: 0.027123641222715378 loss_joints: 0.004364287480711937 loss_collision: 0.02677459456026554 loss_jerk: 0.06132850423455238 loss_floor_contact: 0.018999069929122925
[36/100] loss: 0.023769346997141838 loss_joints: 0.0018545689526945353 loss_collision: 0.020566551014780998 loss_jerk: 0.060856662690639496 loss_floor_contact: 0.018575822934508324
[37/100] loss: 0.022124363109469414 loss_joints: 0.0001414419966749847 loss_collision: 0.021037278696894646 loss_jerk: 0.05992751941084862 loss_floor_contact: 0.019589252769947052
[38/100] loss: 0.02233770862221718 loss_joints: 0.0006595833110623062 loss_collision: 0.019082190468907356 loss_jerk: 0.05945472791790962 loss_floor_contact: 0.019624894484877586
[39/100] loss: 0.021026764065027237 loss_joints: 9.522702021058649e-05 loss_collision: 0.016443368047475815 loss_jerk: 0.0589030496776104 loss_floor_contact: 0.018245751038193703
[40/100] loss: 0.021588686853647232 loss_joints: 0.0011732106795534492 loss_collision: 0.014767376706004143 loss_jerk: 0.058097440749406815 loss_floor_contact: 0.017657514661550522
[41/100] loss: 0.021292906254529953 loss_joints: 0.0016112265875563025 loss_collision: 0.008341465145349503 loss_jerk: 0.05774126946926117 loss_floor_contact: 0.017648858949542046
[42/100] loss: 0.01977999322116375 loss_joints: 0.00046083328197710216 loss_collision: 0.004664053674787283 loss_jerk: 0.05772452801465988 loss_floor_contact: 0.01768648996949196
[43/100] loss: 0.020552009344100952 loss_joints: 0.0007289483910426497 loss_collision: 0.008612343110144138 loss_jerk: 0.05811171233654022 loss_floor_contact: 0.017735596746206284
[44/100] loss: 0.020785849541425705 loss_joints: 0.001279907301068306 loss_collision: 0.007781425956636667 loss_jerk: 0.05717577040195465 loss_floor_contact: 0.017735430970788002
[45/100] loss: 0.019504357129335403 loss_joints: 0.0004523317329585552 loss_collision: 0.00737568736076355 loss_jerk: 0.05556518957018852 loss_floor_contact: 0.01769263483583927
[46/100] loss: 0.01927078142762184 loss_joints: 0.000434381072409451 loss_collision: 0.0067497193813323975 loss_jerk: 0.055028825998306274 loss_floor_contact: 0.017616888508200645
[47/100] loss: 0.019641369581222534 loss_joints: 0.0008146636537276208 loss_collision: 0.006719943601638079 loss_jerk: 0.05501475930213928 loss_floor_contact: 0.01760409027338028
[48/100] loss: 0.018896829336881638 loss_joints: 0.0002841292298398912 loss_collision: 0.005784188862890005 loss_jerk: 0.05450264737010002 loss_floor_contact: 0.017634477466344833
[49/100] loss: 0.018592868000268936 loss_joints: 0.0002559259010013193 loss_collision: 0.004696566145867109 loss_jerk: 0.053776927292346954 loss_floor_contact: 0.017692212015390396
[50/100] loss: 0.018793856725096703 loss_joints: 0.00046365708112716675 loss_collision: 0.004904692526906729 loss_jerk: 0.05364248901605606 loss_floor_contact: 0.017716433852910995
[51/100] loss: 0.01845511794090271 loss_joints: 5.785442772321403e-05 loss_collision: 0.005851134657859802 loss_jerk: 0.05356025695800781 loss_floor_contact: 0.017688341438770294
[52/100] loss: 0.01854764297604561 loss_joints: 0.0002256372245028615 loss_collision: 0.006146517116576433 loss_jerk: 0.05316056311130524 loss_floor_contact: 0.01766885258257389
[53/100] loss: 0.018451331183314323 loss_joints: 0.000329216563841328 loss_collision: 0.005877047777175903 loss_jerk: 0.052469607442617416 loss_floor_contact: 0.01766802929341793
[54/100] loss: 0.018075453117489815 loss_joints: 0.0002661602047737688 loss_collision: 0.004576848819851875 loss_jerk: 0.05174892023205757 loss_floor_contact: 0.017657512798905373
[55/100] loss: 0.01771586202085018 loss_joints: 0.00010271881910739467 loss_collision: 0.004537160042673349 loss_jerk: 0.051031313836574554 loss_floor_contact: 0.017606398090720177
[56/100] loss: 0.01764676161110401 loss_joints: 0.00015003583393990993 loss_collision: 0.005611962638795376 loss_jerk: 0.0502202995121479 loss_floor_contact: 0.017521819099783897
[57/100] loss: 0.018555637449026108 loss_joints: 0.0011608253698796034 loss_collision: 0.005044791381806135 loss_jerk: 0.05013607069849968 loss_floor_contact: 0.017425265163183212
[58/100] loss: 0.018745534121990204 loss_joints: 0.0014606036711484194 loss_collision: 0.0048202890902757645 loss_jerk: 0.04983227699995041 loss_floor_contact: 0.01737932674586773
[59/100] loss: 0.018060915172100067 loss_joints: 0.0006574529106728733 loss_collision: 0.005725512746721506 loss_jerk: 0.04994475468993187 loss_floor_contact: 0.01737888716161251
[60/100] loss: 0.017430497333407402 loss_joints: 7.344281038967893e-05 loss_collision: 0.005690809804946184 loss_jerk: 0.049742281436920166 loss_floor_contact: 0.017409609630703926
[61/100] loss: 0.017726732417941093 loss_joints: 0.0003828267508652061 loss_collision: 0.005707795266062021 loss_jerk: 0.04964405298233032 loss_floor_contact: 0.01744844950735569
[62/100] loss: 0.01767916977405548 loss_joints: 0.0004718109266832471 loss_collision: 0.005332418717443943 loss_jerk: 0.04924838989973068 loss_floor_contact: 0.017448076978325844
[63/100] loss: 0.01743140257894993 loss_joints: 0.00021766600548289716 loss_collision: 0.005355498753488064 loss_jerk: 0.04929598420858383 loss_floor_contact: 0.017416762188076973
[64/100] loss: 0.0171712227165699 loss_joints: 0.00016498116019647568 loss_collision: 0.004595291335135698 loss_jerk: 0.04882321506738663 loss_floor_contact: 0.017363637685775757
[65/100] loss: 0.01724689081311226 loss_joints: 0.00022941290808375925 loss_collision: 0.004603733774274588 loss_jerk: 0.048910196870565414 loss_floor_contact: 0.017318226397037506
[66/100] loss: 0.01712462119758129 loss_joints: 0.00020304623467382044 loss_collision: 0.0041768914088606834 loss_jerk: 0.048710256814956665 loss_floor_contact: 0.01730528473854065
[67/100] loss: 0.01710752211511135 loss_joints: 0.00020992725330870599 loss_collision: 0.005494361277669668 loss_jerk: 0.048075757920742035 loss_floor_contact: 0.017316877841949463
[68/100] loss: 0.016781745478510857 loss_joints: 0.0001231734495377168 loss_collision: 0.003917076624929905 loss_jerk: 0.04776635766029358 loss_floor_contact: 0.017301099374890327
[69/100] loss: 0.016661401838064194 loss_joints: 6.619498890358955e-06 loss_collision: 0.005387792829424143 loss_jerk: 0.04720688611268997 loss_floor_contact: 0.017257127910852432
[70/100] loss: 0.016893237829208374 loss_joints: 0.0002051577903330326 loss_collision: 0.0049010878428816795 loss_jerk: 0.0475764162838459 loss_floor_contact: 0.017215467989444733
[71/100] loss: 0.016728674992918968 loss_joints: 0.0002348456036997959 loss_collision: 0.004017503932118416 loss_jerk: 0.04718732461333275 loss_floor_contact: 0.01718098856508732
[72/100] loss: 0.016549212858080864 loss_joints: 9.455898543819785e-05 loss_collision: 0.0030823582783341408 loss_jerk: 0.047431714832782745 loss_floor_contact: 0.01715395599603653
[73/100] loss: 0.016537969931960106 loss_joints: 0.00015004523447714746 loss_collision: 0.0020765678491443396 loss_jerk: 0.047574788331985474 loss_floor_contact: 0.017146283760666847
[74/100] loss: 0.016472414135932922 loss_joints: 0.00022711044584866613 loss_collision: 0.0011562854051589966 loss_jerk: 0.04739639163017273 loss_floor_contact: 0.017122305929660797
[75/100] loss: 0.0164832454174757 loss_joints: 8.903929847292602e-05 loss_collision: 0.0024356262292712927 loss_jerk: 0.04752322658896446 loss_floor_contact: 0.017079347744584084
[76/100] loss: 0.016387611627578735 loss_joints: 1.4239587471820414e-05 loss_collision: 0.0029164620209485292 loss_jerk: 0.04729640111327171 loss_floor_contact: 0.01703050173819065
[77/100] loss: 0.01633266732096672 loss_joints: 0.00012489344226196408 loss_collision: 0.001980703789740801 loss_jerk: 0.04703718051314354 loss_floor_contact: 0.01700163260102272
[78/100] loss: 0.016362760215997696 loss_joints: 0.00014069479948375374 loss_collision: 0.0018487308407202363 loss_jerk: 0.04715488851070404 loss_floor_contact: 0.016993876546621323
[79/100] loss: 0.016257626935839653 loss_joints: 3.695791747304611e-05 loss_collision: 0.0013010518159717321 loss_jerk: 0.04737282171845436 loss_floor_contact: 0.016989434137940407
[80/100] loss: 0.016180232167243958 loss_joints: 4.336782149039209e-05 loss_collision: 0.0006670918664894998 loss_jerk: 0.04731060937047005 loss_floor_contact: 0.016970012336969376
[81/100] loss: 0.016142118722200394 loss_joints: 3.576279414119199e-05 loss_collision: 0.0014742596540600061 loss_jerk: 0.046900440007448196 loss_floor_contact: 0.016935285180807114
[82/100] loss: 0.01606002263724804 loss_joints: 1.120315027947072e-05 loss_collision: 0.002353047253564 loss_jerk: 0.046360187232494354 loss_floor_contact: 0.016893872991204262
[83/100] loss: 0.015909573063254356 loss_joints: 1.883231925603468e-05 loss_collision: 0.0017830018186941743 loss_jerk: 0.04598880559206009 loss_floor_contact: 0.016860956326127052
[84/100] loss: 0.01602284237742424 loss_joints: 4.106593405595049e-05 loss_collision: 0.0016901509370654821 loss_jerk: 0.046406857669353485 loss_floor_contact: 0.016844183206558228
[85/100] loss: 0.015966981649398804 loss_joints: 2.7522837626747787e-05 loss_collision: 0.0015692231245338917 loss_jerk: 0.04630651697516441 loss_floor_contact: 0.016823632642626762
[86/100] loss: 0.015825726091861725 loss_joints: 3.2091244065668434e-05 loss_collision: 0.0010271006030961871 loss_jerk: 0.04596222937107086 loss_floor_contact: 0.016801470890641212
[87/100] loss: 0.015885142609477043 loss_joints: 5.0549362640595064e-05 loss_collision: 0.0015079776057973504 loss_jerk: 0.04594970867037773 loss_floor_contact: 0.016785472631454468
[88/100] loss: 0.01579260639846325 loss_joints: 4.5781314838677645e-05 loss_collision: 0.0007829103269614279 loss_jerk: 0.04589759558439255 loss_floor_contact: 0.016776541247963905
[89/100] loss: 0.01577647030353546 loss_joints: 1.6428910385002382e-05 loss_collision: 0.0008116264943964779 loss_jerk: 0.045947980135679245 loss_floor_contact: 0.016767531633377075
[90/100] loss: 0.015797309577465057 loss_joints: 2.1727890270994976e-05 loss_collision: 0.0011291090631857514 loss_jerk: 0.04589539021253586 loss_floor_contact: 0.01675529219210148
[91/100] loss: 0.01579148881137371 loss_joints: 3.280075907241553e-05 loss_collision: 0.0011910051107406616 loss_jerk: 0.04581070318818092 loss_floor_contact: 0.016747644171118736
[92/100] loss: 0.01571792922914028 loss_joints: 1.92208171938546e-05 loss_collision: 0.00077256397344172 loss_jerk: 0.045747917145490646 loss_floor_contact: 0.016737887635827065
[93/100] loss: 0.01579170860350132 loss_joints: 8.4456642071018e-06 loss_collision: 0.0019009991083294153 loss_jerk: 0.04564779996871948 loss_floor_contact: 0.016724849119782448
[94/100] loss: 0.015774153172969818 loss_joints: 9.926618076860905e-06 loss_collision: 0.0020132893696427345 loss_jerk: 0.04553336277604103 loss_floor_contact: 0.01671822927892208
[95/100] loss: 0.015660298988223076 loss_joints: 1.2094558769604191e-05 loss_collision: 0.001135430415160954 loss_jerk: 0.04542304575443268 loss_floor_contact: 0.016715599223971367
[96/100] loss: 0.015608271583914757 loss_joints: 1.3924844097346067e-05 loss_collision: 0.0007921192445792258 loss_jerk: 0.045344434678554535 loss_floor_contact: 0.01671610213816166
[97/100] loss: 0.015600785613059998 loss_joints: 1.1083513527410105e-05 loss_collision: 0.0009474920225329697 loss_jerk: 0.0452641099691391 loss_floor_contact: 0.016715701669454575
[98/100] loss: 0.015561241656541824 loss_joints: 5.281564426695695e-06 loss_collision: 0.0007394867134280503 loss_jerk: 0.0452151745557785 loss_floor_contact: 0.016712868586182594
[99/100] loss: 0.015514200553297997 loss_joints: 1.3814826615998754e-06 loss_collision: 0.0004116097989026457 loss_jerk: 0.04517722502350807 loss_floor_contact: 0.016709404066205025
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.25_jerk0.25_skate0.1]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 333.33267                                                    ║
    ║     rollout = 148.61316                                                    ║
    ║     sdf     = 18.68944                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.01551420                                                 ║
    ║     joints    = 0.00000138                                                 ║
    ║     collision = 0.00041161                                                 ║
    ║     jerk      = 0.04517723                                                 ║
    ║     floor     = 0.01670940                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m55.277s
user	5m6.879s
sys	0m20.547s
[INFO] Running with collision=0.1, contact=0.25, jerk=0.25, skate=0.25
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:48,  3.52s/it]  2%|▏         | 2/100 [00:07<05:42,  3.50s/it]  3%|▎         | 3/100 [00:11<06:03,  3.75s/it]  4%|▍         | 4/100 [00:14<05:34,  3.48s/it]  5%|▌         | 5/100 [00:17<05:22,  3.39s/it]  6%|▌         | 6/100 [00:20<05:13,  3.34s/it]  7%|▋         | 7/100 [00:23<05:07,  3.31s/it]  8%|▊         | 8/100 [00:27<05:00,  3.27s/it]  9%|▉         | 9/100 [00:30<04:53,  3.23s/it] 10%|█         | 10/100 [00:33<04:46,  3.19s/it] 11%|█         | 11/100 [00:36<04:54,  3.30s/it] 12%|█▏        | 12/100 [00:40<05:01,  3.43s/it] 13%|█▎        | 13/100 [00:43<04:58,  3.43s/it] 14%|█▍        | 14/100 [00:47<04:52,  3.40s/it] 15%|█▌        | 15/100 [00:50<04:51,  3.43s/it] 16%|█▌        | 16/100 [00:54<04:46,  3.42s/it] 17%|█▋        | 17/100 [00:57<04:49,  3.49s/it] 18%|█▊        | 18/100 [01:01<04:48,  3.52s/it] 19%|█▉        | 19/100 [01:05<04:49,  3.57s/it] 20%|██        | 20/100 [01:08<04:46,  3.58s/it] 21%|██        | 21/100 [01:12<04:36,  3.50s/it] 22%|██▏       | 22/100 [01:15<04:28,  3.44s/it] 23%|██▎       | 23/100 [01:18<04:21,  3.39s/it] 24%|██▍       | 24/100 [01:21<04:13,  3.34s/it] 25%|██▌       | 25/100 [01:25<04:08,  3.31s/it] 26%|██▌       | 26/100 [01:28<04:04,  3.31s/it] 27%|██▋       | 27/100 [01:31<04:04,  3.35s/it] 28%|██▊       | 28/100 [01:35<04:00,  3.34s/it] 29%|██▉       | 29/100 [01:38<04:07,  3.48s/it] 30%|███       | 30/100 [01:42<04:09,  3.57s/it] 31%|███       | 31/100 [01:46<04:02,  3.52s/it] 32%|███▏      | 32/100 [01:49<03:53,  3.44s/it] 33%|███▎      | 33/100 [01:53<03:55,  3.51s/it] 34%|███▍      | 34/100 [01:56<03:45,  3.42s/it] 35%|███▌      | 35/100 [01:59<03:43,  3.44s/it] 36%|███▌      | 36/100 [02:03<03:38,  3.41s/it] 37%|███▋      | 37/100 [02:06<03:30,  3.35s/it] 38%|███▊      | 38/100 [02:09<03:28,  3.37s/it] 39%|███▉      | 39/100 [02:13<03:28,  3.41s/it] 40%|████      | 40/100 [02:16<03:22,  3.37s/it] 41%|████      | 41/100 [02:19<03:16,  3.33s/it] 42%|████▏     | 42/100 [02:23<03:15,  3.37s/it] 43%|████▎     | 43/100 [02:26<03:09,  3.33s/it] 44%|████▍     | 44/100 [02:29<03:07,  3.35s/it] 45%|████▌     | 45/100 [02:33<03:01,  3.31s/it] 46%|████▌     | 46/100 [02:36<02:57,  3.28s/it] 47%|████▋     | 47/100 [02:39<02:55,  3.30s/it] 48%|████▊     | 48/100 [02:42<02:51,  3.30s/it] 49%|████▉     | 49/100 [02:46<02:49,  3.32s/it] 50%|█████     | 50/100 [02:49<02:45,  3.32s/it] 51%|█████     | 51/100 [02:52<02:39,  3.26s/it] 52%|█████▏    | 52/100 [02:55<02:34,  3.22s/it] 53%|█████▎    | 53/100 [02:59<02:30,  3.20s/it] 54%|█████▍    | 54/100 [03:02<02:28,  3.24s/it] 55%|█████▌    | 55/100 [03:05<02:31,  3.36s/it] 56%|█████▌    | 56/100 [03:09<02:25,  3.32s/it] 57%|█████▋    | 57/100 [03:12<02:21,  3.30s/it] 58%|█████▊    | 58/100 [03:15<02:20,  3.36s/it] 59%|█████▉    | 59/100 [03:19<02:17,  3.35s/it] 60%|██████    | 60/100 [03:22<02:09,  3.25s/it] 61%|██████    | 61/100 [03:25<02:04,  3.19s/it] 62%|██████▏   | 62/100 [03:28<02:01,  3.19s/it] 63%|██████▎   | 63/100 [03:31<01:59,  3.22s/it] 64%|██████▍   | 64/100 [03:35<01:56,  3.24s/it] 65%|██████▌   | 65/100 [03:38<01:52,  3.23s/it] 66%|██████▌   | 66/100 [03:41<01:49,  3.21s/it] 67%|██████▋   | 67/100 [03:44<01:46,  3.22s/it] 68%|██████▊   | 68/100 [03:47<01:42,  3.19s/it] 69%|██████▉   | 69/100 [03:51<01:38,  3.19s/it] 70%|███████   | 70/100 [03:54<01:36,  3.22s/it] 71%|███████   | 71/100 [03:57<01:33,  3.23s/it] 72%|███████▏  | 72/100 [04:01<01:32,  3.32s/it] 73%|███████▎  | 73/100 [04:04<01:26,  3.21s/it] 74%|███████▍  | 74/100 [04:07<01:22,  3.16s/it] 75%|███████▌  | 75/100 [04:10<01:19,  3.19s/it] 76%|███████▌  | 76/100 [04:13<01:16,  3.20s/it] 77%|███████▋  | 77/100 [04:16<01:13,  3.19s/it] 78%|███████▊  | 78/100 [04:19<01:10,  3.19s/it] 79%|███████▉  | 79/100 [04:23<01:07,  3.21s/it] 80%|████████  | 80/100 [04:26<01:04,  3.21s/it] 81%|████████  | 81/100 [04:29<01:01,  3.21s/it] 82%|████████▏ | 82/100 [04:32<00:58,  3.23s/it] 83%|████████▎ | 83/100 [04:36<00:54,  3.20s/it] 84%|████████▍ | 84/100 [04:39<00:51,  3.25s/it] 85%|████████▌ | 85/100 [04:42<00:48,  3.21s/it] 86%|████████▌ | 86/100 [04:45<00:45,  3.28s/it] 87%|████████▋ | 87/100 [04:49<00:43,  3.35s/it] 88%|████████▊ | 88/100 [04:52<00:40,  3.34s/it] 89%|████████▉ | 89/100 [04:55<00:36,  3.30s/it] 90%|█████████ | 90/100 [04:59<00:34,  3.41s/it] 91%|█████████ | 91/100 [05:03<00:30,  3.41s/it] 92%|█████████▏| 92/100 [05:06<00:27,  3.39s/it] 93%|█████████▎| 93/100 [05:09<00:23,  3.31s/it] 94%|█████████▍| 94/100 [05:12<00:19,  3.26s/it] 95%|█████████▌| 95/100 [05:15<00:16,  3.24s/it] 96%|█████████▌| 96/100 [05:19<00:12,  3.23s/it] 97%|█████████▋| 97/100 [05:22<00:09,  3.19s/it] 98%|█████████▊| 98/100 [05:25<00:06,  3.23s/it] 99%|█████████▉| 99/100 [05:28<00:03,  3.24s/it]100%|██████████| 100/100 [05:31<00:00,  3.23s/it]100%|██████████| 100/100 [05:31<00:00,  3.32s/it]
[0/100] loss: 2.774794101715088 loss_joints: 2.618968963623047 loss_collision: 0.14440971612930298 loss_jerk: 0.05721103772521019 loss_floor_contact: 0.5083255767822266
[1/100] loss: 2.5727124214172363 loss_joints: 2.402524709701538 loss_collision: 0.15431581437587738 loss_jerk: 0.06952131539583206 loss_floor_contact: 0.549503743648529
[2/100] loss: 2.137239694595337 loss_joints: 1.9335241317749023 loss_collision: 0.2258048802614212 loss_jerk: 0.09505781531333923 loss_floor_contact: 0.629482626914978
[3/100] loss: 1.3683927059173584 loss_joints: 1.2461650371551514 loss_collision: 0.19918575882911682 loss_jerk: 0.09706990420818329 loss_floor_contact: 0.3121664524078369
[4/100] loss: 0.7754445672035217 loss_joints: 0.7272140979766846 loss_collision: 0.15788663923740387 loss_jerk: 0.1018744483590126 loss_floor_contact: 0.0278928279876709
[5/100] loss: 0.3838684558868408 loss_joints: 0.3403019309043884 loss_collision: 0.11957433819770813 loss_jerk: 0.10506990551948547 loss_floor_contact: 0.0213664211332798
[6/100] loss: 0.1599923074245453 loss_joints: 0.11175817251205444 loss_collision: 0.18219910562038422 loss_jerk: 0.09836602956056595 loss_floor_contact: 0.021690815687179565
[7/100] loss: 0.08951015025377274 loss_joints: 0.0605228915810585 loss_collision: 0.013041364029049873 loss_jerk: 0.0889449268579483 loss_floor_contact: 0.02178756333887577
[8/100] loss: 0.10652241855859756 loss_joints: 0.07042410224676132 loss_collision: 0.056056492030620575 loss_jerk: 0.1001894399523735 loss_floor_contact: 0.021781232208013535
[9/100] loss: 0.1082334890961647 loss_joints: 0.06900984048843384 loss_collision: 0.02044055610895157 loss_jerk: 0.1269529014825821 loss_floor_contact: 0.021765494719147682
[10/100] loss: 0.10630583763122559 loss_joints: 0.0643283873796463 loss_collision: 0.024882394820451736 loss_jerk: 0.1364785134792328 loss_floor_contact: 0.02147831954061985
[11/100] loss: 0.08227649331092834 loss_joints: 0.0385943166911602 loss_collision: 0.022966677322983742 loss_jerk: 0.14152872562408447 loss_floor_contact: 0.02401331067085266
[12/100] loss: 0.0553477481007576 loss_joints: 0.01078350655734539 loss_collision: 0.0497300960123539 loss_jerk: 0.13789592683315277 loss_floor_contact: 0.020469004288315773
[13/100] loss: 0.05584103614091873 loss_joints: 0.012984991073608398 loss_collision: 0.0678156167268753 loss_jerk: 0.12438290566205978 loss_floor_contact: 0.01991502195596695
[14/100] loss: 0.055981189012527466 loss_joints: 0.019072066992521286 loss_collision: 0.05377759411931038 loss_jerk: 0.10669022053480148 loss_floor_contact: 0.019435234367847443
[15/100] loss: 0.05530337244272232 loss_joints: 0.01811644434928894 loss_collision: 0.08032108098268509 loss_jerk: 0.09763505309820175 loss_floor_contact: 0.018984228372573853
[16/100] loss: 0.0480513870716095 loss_joints: 0.014528369531035423 loss_collision: 0.06683222204446793 loss_jerk: 0.08858514577150345 loss_floor_contact: 0.018774032592773438
[17/100] loss: 0.038090258836746216 loss_joints: 0.00923144817352295 loss_collision: 0.04872443526983261 loss_jerk: 0.07721196115016937 loss_floor_contact: 0.018733501434326172
[18/100] loss: 0.03338014334440231 loss_joints: 0.00403989152982831 loss_collision: 0.05639411509037018 loss_jerk: 0.075992152094841 loss_floor_contact: 0.018811209127306938
[19/100] loss: 0.03400471433997154 loss_joints: 0.004855423700064421 loss_collision: 0.05733242258429527 loss_jerk: 0.07481939345598221 loss_floor_contact: 0.018844803795218468
[20/100] loss: 0.034798964858055115 loss_joints: 0.006116495467722416 loss_collision: 0.059969186782836914 loss_jerk: 0.07193341106176376 loss_floor_contact: 0.018808791413903236
[21/100] loss: 0.031906820833683014 loss_joints: 0.004081612452864647 loss_collision: 0.05718075484037399 loss_jerk: 0.06971293687820435 loss_floor_contact: 0.018715593963861465
[22/100] loss: 0.029933568090200424 loss_joints: 0.0021135786082595587 loss_collision: 0.05854799970984459 loss_jerk: 0.06930460780858994 loss_floor_contact: 0.0185561440885067
[23/100] loss: 0.028770694509148598 loss_joints: 0.002385267522186041 loss_collision: 0.04505490884184837 loss_jerk: 0.06911907345056534 loss_floor_contact: 0.01840066909790039
[24/100] loss: 0.026812629774212837 loss_joints: 0.00313142454251647 loss_collision: 0.026191705837845802 loss_jerk: 0.06599250435829163 loss_floor_contact: 0.018255634233355522
[25/100] loss: 0.024831732735037804 loss_joints: 0.002176850801333785 loss_collision: 0.016017640009522438 loss_jerk: 0.06601711362600327 loss_floor_contact: 0.018195360898971558
[26/100] loss: 0.024965986609458923 loss_joints: 0.001263917307369411 loss_collision: 0.019467979669570923 loss_jerk: 0.06823957711458206 loss_floor_contact: 0.01878150925040245
[27/100] loss: 0.02441662736237049 loss_joints: 0.0005152737721800804 loss_collision: 0.020944315940141678 loss_jerk: 0.06757678091526031 loss_floor_contact: 0.019650904461741447
[28/100] loss: 0.0278022363781929 loss_joints: 0.00219759251922369 loss_collision: 0.04508889839053154 loss_jerk: 0.06480813026428223 loss_floor_contact: 0.019574888050556183
[29/100] loss: 0.027689702808856964 loss_joints: 0.0019455240108072758 loss_collision: 0.05215848982334137 loss_jerk: 0.06294743716716766 loss_floor_contact: 0.019165879115462303
[30/100] loss: 0.02588518336415291 loss_joints: 0.0006903923931531608 loss_collision: 0.04407317191362381 loss_jerk: 0.06292440742254257 loss_floor_contact: 0.020225489512085915
[31/100] loss: 0.02603951282799244 loss_joints: 0.0026087393052875996 loss_collision: 0.037430088967084885 loss_jerk: 0.06255176663398743 loss_floor_contact: 0.01619929075241089
[32/100] loss: 0.025238296017050743 loss_joints: 0.0016595524502918124 loss_collision: 0.03640264272689819 loss_jerk: 0.061318352818489075 loss_floor_contact: 0.018435558304190636
[33/100] loss: 0.023803723976016045 loss_joints: 0.0002687729138415307 loss_collision: 0.03285902738571167 loss_jerk: 0.061295874416828156 loss_floor_contact: 0.019700320437550545
[34/100] loss: 0.02615983411669731 loss_joints: 0.0029330856632441282 loss_collision: 0.032388459891080856 loss_jerk: 0.060984060168266296 loss_floor_contact: 0.018967555835843086
[35/100] loss: 0.027123641222715378 loss_joints: 0.004364287480711937 loss_collision: 0.02677459456026554 loss_jerk: 0.06132850423455238 loss_floor_contact: 0.018999069929122925
[36/100] loss: 0.023769346997141838 loss_joints: 0.0018545689526945353 loss_collision: 0.020566551014780998 loss_jerk: 0.060856662690639496 loss_floor_contact: 0.018575822934508324
[37/100] loss: 0.022124363109469414 loss_joints: 0.0001414419966749847 loss_collision: 0.021037278696894646 loss_jerk: 0.05992751941084862 loss_floor_contact: 0.019589252769947052
[38/100] loss: 0.02233770862221718 loss_joints: 0.0006595833110623062 loss_collision: 0.019082190468907356 loss_jerk: 0.05945472791790962 loss_floor_contact: 0.019624894484877586
[39/100] loss: 0.021026764065027237 loss_joints: 9.522702021058649e-05 loss_collision: 0.016443368047475815 loss_jerk: 0.0589030496776104 loss_floor_contact: 0.018245751038193703
[40/100] loss: 0.021588686853647232 loss_joints: 0.0011732106795534492 loss_collision: 0.014767376706004143 loss_jerk: 0.058097440749406815 loss_floor_contact: 0.017657514661550522
[41/100] loss: 0.021292906254529953 loss_joints: 0.0016112265875563025 loss_collision: 0.008341465145349503 loss_jerk: 0.05774126946926117 loss_floor_contact: 0.017648858949542046
[42/100] loss: 0.01977999322116375 loss_joints: 0.00046083328197710216 loss_collision: 0.004664053674787283 loss_jerk: 0.05772452801465988 loss_floor_contact: 0.01768648996949196
[43/100] loss: 0.020552009344100952 loss_joints: 0.0007289483910426497 loss_collision: 0.008612343110144138 loss_jerk: 0.05811171233654022 loss_floor_contact: 0.017735596746206284
[44/100] loss: 0.020785849541425705 loss_joints: 0.001279907301068306 loss_collision: 0.007781425956636667 loss_jerk: 0.05717577040195465 loss_floor_contact: 0.017735430970788002
[45/100] loss: 0.019504357129335403 loss_joints: 0.0004523317329585552 loss_collision: 0.00737568736076355 loss_jerk: 0.05556518957018852 loss_floor_contact: 0.01769263483583927
[46/100] loss: 0.01927078142762184 loss_joints: 0.000434381072409451 loss_collision: 0.0067497193813323975 loss_jerk: 0.055028825998306274 loss_floor_contact: 0.017616888508200645
[47/100] loss: 0.019641369581222534 loss_joints: 0.0008146636537276208 loss_collision: 0.006719943601638079 loss_jerk: 0.05501475930213928 loss_floor_contact: 0.01760409027338028
[48/100] loss: 0.018896829336881638 loss_joints: 0.0002841292298398912 loss_collision: 0.005784188862890005 loss_jerk: 0.05450264737010002 loss_floor_contact: 0.017634477466344833
[49/100] loss: 0.018592868000268936 loss_joints: 0.0002559259010013193 loss_collision: 0.004696566145867109 loss_jerk: 0.053776927292346954 loss_floor_contact: 0.017692212015390396
[50/100] loss: 0.018793856725096703 loss_joints: 0.00046365708112716675 loss_collision: 0.004904692526906729 loss_jerk: 0.05364248901605606 loss_floor_contact: 0.017716433852910995
[51/100] loss: 0.01845511794090271 loss_joints: 5.785442772321403e-05 loss_collision: 0.005851134657859802 loss_jerk: 0.05356025695800781 loss_floor_contact: 0.017688341438770294
[52/100] loss: 0.01854764297604561 loss_joints: 0.0002256372245028615 loss_collision: 0.006146517116576433 loss_jerk: 0.05316056311130524 loss_floor_contact: 0.01766885258257389
[53/100] loss: 0.018451331183314323 loss_joints: 0.000329216563841328 loss_collision: 0.005877047777175903 loss_jerk: 0.052469607442617416 loss_floor_contact: 0.01766802929341793
[54/100] loss: 0.018075453117489815 loss_joints: 0.0002661602047737688 loss_collision: 0.004576848819851875 loss_jerk: 0.05174892023205757 loss_floor_contact: 0.017657512798905373
[55/100] loss: 0.01771586202085018 loss_joints: 0.00010271881910739467 loss_collision: 0.004537160042673349 loss_jerk: 0.051031313836574554 loss_floor_contact: 0.017606398090720177
[56/100] loss: 0.01764676161110401 loss_joints: 0.00015003583393990993 loss_collision: 0.005611962638795376 loss_jerk: 0.0502202995121479 loss_floor_contact: 0.017521819099783897
[57/100] loss: 0.018555637449026108 loss_joints: 0.0011608253698796034 loss_collision: 0.005044791381806135 loss_jerk: 0.05013607069849968 loss_floor_contact: 0.017425265163183212
[58/100] loss: 0.018745534121990204 loss_joints: 0.0014606036711484194 loss_collision: 0.0048202890902757645 loss_jerk: 0.04983227699995041 loss_floor_contact: 0.01737932674586773
[59/100] loss: 0.018060915172100067 loss_joints: 0.0006574529106728733 loss_collision: 0.005725512746721506 loss_jerk: 0.04994475468993187 loss_floor_contact: 0.01737888716161251
[60/100] loss: 0.017430497333407402 loss_joints: 7.344281038967893e-05 loss_collision: 0.005690809804946184 loss_jerk: 0.049742281436920166 loss_floor_contact: 0.017409609630703926
[61/100] loss: 0.017726732417941093 loss_joints: 0.0003828267508652061 loss_collision: 0.005707795266062021 loss_jerk: 0.04964405298233032 loss_floor_contact: 0.01744844950735569
[62/100] loss: 0.01767916977405548 loss_joints: 0.0004718109266832471 loss_collision: 0.005332418717443943 loss_jerk: 0.04924838989973068 loss_floor_contact: 0.017448076978325844
[63/100] loss: 0.01743140257894993 loss_joints: 0.00021766600548289716 loss_collision: 0.005355498753488064 loss_jerk: 0.04929598420858383 loss_floor_contact: 0.017416762188076973
[64/100] loss: 0.0171712227165699 loss_joints: 0.00016498116019647568 loss_collision: 0.004595291335135698 loss_jerk: 0.04882321506738663 loss_floor_contact: 0.017363637685775757
[65/100] loss: 0.01724689081311226 loss_joints: 0.00022941290808375925 loss_collision: 0.004603733774274588 loss_jerk: 0.048910196870565414 loss_floor_contact: 0.017318226397037506
[66/100] loss: 0.01712462119758129 loss_joints: 0.00020304623467382044 loss_collision: 0.0041768914088606834 loss_jerk: 0.048710256814956665 loss_floor_contact: 0.01730528473854065
[67/100] loss: 0.01710752211511135 loss_joints: 0.00020992725330870599 loss_collision: 0.005494361277669668 loss_jerk: 0.048075757920742035 loss_floor_contact: 0.017316877841949463
[68/100] loss: 0.016781745478510857 loss_joints: 0.0001231734495377168 loss_collision: 0.003917076624929905 loss_jerk: 0.04776635766029358 loss_floor_contact: 0.017301099374890327
[69/100] loss: 0.016661401838064194 loss_joints: 6.619498890358955e-06 loss_collision: 0.005387792829424143 loss_jerk: 0.04720688611268997 loss_floor_contact: 0.017257127910852432
[70/100] loss: 0.016893237829208374 loss_joints: 0.0002051577903330326 loss_collision: 0.0049010878428816795 loss_jerk: 0.0475764162838459 loss_floor_contact: 0.017215467989444733
[71/100] loss: 0.016728674992918968 loss_joints: 0.0002348456036997959 loss_collision: 0.004017503932118416 loss_jerk: 0.04718732461333275 loss_floor_contact: 0.01718098856508732
[72/100] loss: 0.016549212858080864 loss_joints: 9.455898543819785e-05 loss_collision: 0.0030823582783341408 loss_jerk: 0.047431714832782745 loss_floor_contact: 0.01715395599603653
[73/100] loss: 0.016537969931960106 loss_joints: 0.00015004523447714746 loss_collision: 0.0020765678491443396 loss_jerk: 0.047574788331985474 loss_floor_contact: 0.017146283760666847
[74/100] loss: 0.016472414135932922 loss_joints: 0.00022711044584866613 loss_collision: 0.0011562854051589966 loss_jerk: 0.04739639163017273 loss_floor_contact: 0.017122305929660797
[75/100] loss: 0.0164832454174757 loss_joints: 8.903929847292602e-05 loss_collision: 0.0024356262292712927 loss_jerk: 0.04752322658896446 loss_floor_contact: 0.017079347744584084
[76/100] loss: 0.016387611627578735 loss_joints: 1.4239587471820414e-05 loss_collision: 0.0029164620209485292 loss_jerk: 0.04729640111327171 loss_floor_contact: 0.01703050173819065
[77/100] loss: 0.01633266732096672 loss_joints: 0.00012489344226196408 loss_collision: 0.001980703789740801 loss_jerk: 0.04703718051314354 loss_floor_contact: 0.01700163260102272
[78/100] loss: 0.016362760215997696 loss_joints: 0.00014069479948375374 loss_collision: 0.0018487308407202363 loss_jerk: 0.04715488851070404 loss_floor_contact: 0.016993876546621323
[79/100] loss: 0.016257626935839653 loss_joints: 3.695791747304611e-05 loss_collision: 0.0013010518159717321 loss_jerk: 0.04737282171845436 loss_floor_contact: 0.016989434137940407
[80/100] loss: 0.016180232167243958 loss_joints: 4.336782149039209e-05 loss_collision: 0.0006670918664894998 loss_jerk: 0.04731060937047005 loss_floor_contact: 0.016970012336969376
[81/100] loss: 0.016142118722200394 loss_joints: 3.576279414119199e-05 loss_collision: 0.0014742596540600061 loss_jerk: 0.046900440007448196 loss_floor_contact: 0.016935285180807114
[82/100] loss: 0.01606002263724804 loss_joints: 1.120315027947072e-05 loss_collision: 0.002353047253564 loss_jerk: 0.046360187232494354 loss_floor_contact: 0.016893872991204262
[83/100] loss: 0.015909573063254356 loss_joints: 1.883231925603468e-05 loss_collision: 0.0017830018186941743 loss_jerk: 0.04598880559206009 loss_floor_contact: 0.016860956326127052
[84/100] loss: 0.01602284237742424 loss_joints: 4.106593405595049e-05 loss_collision: 0.0016901509370654821 loss_jerk: 0.046406857669353485 loss_floor_contact: 0.016844183206558228
[85/100] loss: 0.015966981649398804 loss_joints: 2.7522837626747787e-05 loss_collision: 0.0015692231245338917 loss_jerk: 0.04630651697516441 loss_floor_contact: 0.016823632642626762
[86/100] loss: 0.015825726091861725 loss_joints: 3.2091244065668434e-05 loss_collision: 0.0010271006030961871 loss_jerk: 0.04596222937107086 loss_floor_contact: 0.016801470890641212
[87/100] loss: 0.015885142609477043 loss_joints: 5.0549362640595064e-05 loss_collision: 0.0015079776057973504 loss_jerk: 0.04594970867037773 loss_floor_contact: 0.016785472631454468
[88/100] loss: 0.01579260639846325 loss_joints: 4.5781314838677645e-05 loss_collision: 0.0007829103269614279 loss_jerk: 0.04589759558439255 loss_floor_contact: 0.016776541247963905
[89/100] loss: 0.01577647030353546 loss_joints: 1.6428910385002382e-05 loss_collision: 0.0008116264943964779 loss_jerk: 0.045947980135679245 loss_floor_contact: 0.016767531633377075
[90/100] loss: 0.015797309577465057 loss_joints: 2.1727890270994976e-05 loss_collision: 0.0011291090631857514 loss_jerk: 0.04589539021253586 loss_floor_contact: 0.01675529219210148
[91/100] loss: 0.01579148881137371 loss_joints: 3.280075907241553e-05 loss_collision: 0.0011910051107406616 loss_jerk: 0.04581070318818092 loss_floor_contact: 0.016747644171118736
[92/100] loss: 0.01571792922914028 loss_joints: 1.92208171938546e-05 loss_collision: 0.00077256397344172 loss_jerk: 0.045747917145490646 loss_floor_contact: 0.016737887635827065
[93/100] loss: 0.01579170860350132 loss_joints: 8.4456642071018e-06 loss_collision: 0.0019009991083294153 loss_jerk: 0.04564779996871948 loss_floor_contact: 0.016724849119782448
[94/100] loss: 0.015774153172969818 loss_joints: 9.926618076860905e-06 loss_collision: 0.0020132893696427345 loss_jerk: 0.04553336277604103 loss_floor_contact: 0.01671822927892208
[95/100] loss: 0.015660298988223076 loss_joints: 1.2094558769604191e-05 loss_collision: 0.001135430415160954 loss_jerk: 0.04542304575443268 loss_floor_contact: 0.016715599223971367
[96/100] loss: 0.015608271583914757 loss_joints: 1.3924844097346067e-05 loss_collision: 0.0007921192445792258 loss_jerk: 0.045344434678554535 loss_floor_contact: 0.01671610213816166
[97/100] loss: 0.015600785613059998 loss_joints: 1.1083513527410105e-05 loss_collision: 0.0009474920225329697 loss_jerk: 0.0452641099691391 loss_floor_contact: 0.016715701669454575
[98/100] loss: 0.015561241656541824 loss_joints: 5.281564426695695e-06 loss_collision: 0.0007394867134280503 loss_jerk: 0.0452151745557785 loss_floor_contact: 0.016712868586182594
[99/100] loss: 0.015514200553297997 loss_joints: 1.3814826615998754e-06 loss_collision: 0.0004116097989026457 loss_jerk: 0.04517722502350807 loss_floor_contact: 0.016709404066205025
[End] Optimizing Routine
# ------------------------ #
[Done] Results are at [/home/davidbl/iDART/mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000/optim/learning_rate_0.1/contact_thresh_0.2/cabE-path2-run12-4000_collision0.1_contact0.25_jerk0.25_skate0.25]

    ╔════════════════════════════════════════════════════════════════════════════╗
    ║                                Optimization Results                        ║
    ╠════════════════════════════════════════════════════════════════════════════╣
    ║ Times:                                                                     ║
    ║     total   = 331.96998                                                    ║
    ║     rollout = 147.91601                                                    ║
    ║     sdf     = 18.50066                                                     ║
    ║     nbr it. = 100                                                          ║
    ║                                                                            ║
    ║ Losses:                                                                    ║
    ║     total     = 0.01551420                                                 ║
    ║     joints    = 0.00000138                                                 ║
    ║     collision = 0.00041161                                                 ║
    ║     jerk      = 0.04517723                                                 ║
    ║     floor     = 0.01670940                                                 ║
    ╚════════════════════════════════════════════════════════════════════════════╝
    

real	5m53.544s
user	5m8.705s
sys	0m17.229s
[INFO] Running with collision=0.1, contact=0.25, jerk=0.25, skate=0.5
/work/courses/digital_human/6/miniconda3/envs/DART/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
denoiser model type: transformer
denoiser model args: {'h_dim': 512, 'ff_size': 1024, 'num_layers': 8, 'num_heads': 4, 'dropout': 0.1, 'activation': 'gelu', 'cond_mask_prob': 0.1, 'clip_dim': 512, 'history_shape': (2, 276), 'noise_shape': (1, 256)}
TRANS_ENC init
Loading denoiser checkpoint from ./mld_denoiser/mld_fps_clip_repeat_euler/checkpoint_300000.pt
vae model args: {'arch': 'all_encoder', 'ff_size': 1024, 'num_layers': 7, 'num_heads': 4, 'dropout': 0.1, 'normalize_before': False, 'activation': 'gelu', 'position_embedding': 'learned', 'latent_dim': (1, 256), 'h_dim': 256, 'nfeats': 276}
Loading vae checkpoint from ./mvae/mvae_fps_clip/checkpoint_200000.pt
latent_mean: 0.005734771955758333
latent_std: 0.8744232654571533
diffusion_args: {'diffusion_steps': 10, 'respacing': 'ddim10', 'noise_schedule': 'cosine', 'sigma_small': True}
######## HALLO #######
./config_files/config_hydra/motion_primitive/mp_h2_f8_r8.yaml
./data/seq_data_zero_male
loading mean and std from data/seq_data_zero_male/mean_std_h2_f8.pkl
Batch sizes: 66 = (8*8 + 2) * 1
# ------------------------ #
[Start] Optimizing Routine
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:03<05:20,  3.24s/it]  2%|▏         | 2/100 [00:06<05:07,  3.13s/it]  3%|▎         | 3/100 [00:10<05:41,  3.52s/it]  4%|▍         | 4/100 [00:13<05:35,  3.49s/it]  5%|▌         | 5/100 [00:17<05:26,  3.44s/it]  6%|▌         | 6/100 [00:20<05:28,  3.50s/it]  7%|▋         | 7/100 [00:23<05:14,  3.38s/it]  8%|▊         | 8/100 [00:27<05:07,  3.35s/it]  9%|▉         | 9/100 [00:30<05:02,  3.32s/it] 10%|█         | 10/100 [00:33<04:54,  3.27s/it]slurmstepd: error: *** JOB 52767 ON studgpu-node17 CANCELLED AT 2025-06-04T01:33:25 DUE TO TIME LIMIT ***
